%https://github.com/phasetr/math-textbook/blob/master/math_textbook_en.tex
\documentclass[openany, a4paper, oneside]{book}

\input{./mymacro.tex}
\renewcommand{\thethm}{\arabic{section}.\arabic{subsection}.\arabic{thm}}
\author{Soutenni P (@phasetr)\thanks{phasetr@gmail.com, https://github.com/phasetr/math-textbook, http://phasetr.com, http://phasetr.com/members/formadd, http://math-accessory.com}}
\date{\today}
\title{Math textbook}
\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\begin{document}

\maketitle
\tableofcontents


\part{Aim of this book}

I would like to write this math textbook by \textbf{social coding} Github.
It will be written in English and Japanese.
I will also write numerical computation, animation,
or simulation codes by some computer languages.

At first, the content is mainly from manuscripts
of my seminars for students in department of mathematics or physics.

I start programming.
In programmers' community, OSS softwares or social coding using Github
is very popular.
I want to introduce this to mathematics and physics,
especially writing textbooks!

I want to gather our knowledge.
There are many mathematics books written by physicists or engineers,
and physics books written by engineers or mathematicians.
Each is written in their own interest.

I hear that a mathematician (teacher) said,
``professors of the department of engineering tell me
I hope your lecture and the content will be engineering students friendly.
But I do not understand their interest.
I want to write books I can understand!"

OK, I will do it.
I studied physics in my bachelor days and studied mathematics
in my master days.
So I will be ``human sacrifice" for this difficult, but very
interesting and exciting project.

There are many many good books,
but they are systematic and ``boring" sometimes.
I want to fill the gaps:
I want to write applicative contents in physics, engineering or mathematics itself,
and connections among many branches.
\part{Writhing mathematical/physical English}

Japanese only.
\part{Set theory}

\chapter{Introduction to cardinal number}

I will write this content from my movie in nicovideo.
\part{Linear Algebra}

\chapter{Talk: Linear algebra and Calculus: Introduction to university mathematics}

This note is based on a course for newcomers in the spring of 2014 at the Tokyo Institute of Technology.
See also \cite{MasahikoSaitoh1, AsaoArai3, AraiEzawa1, AraiEzawa2, KenjiFukaya2, ToshioNiwa1}.
\section{Introduction}

We talk about linear algebra, especially
it's relation to calculus, i.e., differentiation and integration.

In this talk we speak in Japanese but write in English on blackboard.
It is because I want newcomers to get used to writing and reading in English.
\section{What is linear algebra?}

Main targets of linear algebra are vectors and matrices.
We learn them in high school but linear algebra in
university mathematics has somewhat different flavor from one in high school.
Furthermore linear algebra is difficult to imagine
where we use it compared to calculus.
So we first consider its different points and its usage
in mathematics and physics.

In high school we consider vectors as geometric objects.
However we now consider them as algebraic objects,
since they are ones in linear ``algebra"!
Our vectors are a generalized/abstract version of ones in high school.
A vector needs not have direction nor length.
Then, what properties should vectors have?
\subsection{Abstract definition of vectors}

In the following we sometimes use the terms linear spaces or vector spaces.
These words have the same meaning.
In the below definition a set of scalers is the set of real numbers $\bbR$ for simplicity\footnote{Of course a field may be general (positive characteristic) field.
For applications to information science characteristic sometimes must be positive, e.g. for code theory or
cryptographically secure pseudo random number generator (Mersenne twister).}.

\begin{defn}[Definition of linear/vector spaces]
Let $\bbR$ be a field of real numbers: a real number is also called a scaler.
A set $L$ is called a \upbf{linear space} if its elements have the following properties.
Elements $x, y, z \in L$ are vectors and $a, b \in \bbR$ are real numbers in the following expressions.
1) Associativity:
 \begin{align}
  \rbk{x + y} + z
  =
  x + \rbk{y + z}, \quad \forall x, y, z \in L.
 \end{align}
2) Commutativity of sum:
 \begin{align}
  x + y = y + x,  \quad \forall x, y \in L.
 \end{align}
3) Existence of unit for sum: there is an element $0 \in L$ such that
 \begin{align}
  x + 0 = x, \quad \forall x \in L.
 \end{align}
4) Existence of an inverse element for sum: for any $x \in L$ there is an element $y \in L$ such that
 \begin{align}
  x + y = 0
 \end{align}
   for the above $0$.
   In fact we can prove the uniqueness of an inverse element.
5) Relation of scalers (real numbers) and vectors:
 \begin{align}
  a \cdot \rbk{x + y}
  &=
  a \cdot x + a \cdot y, \\
  \rbk{ab} \cdot x
  &=
  a \cdot \rbk{b x}, \\
  \rbk{a + b} \cdot x
  &=
  a \cdot x + b \cdot x,
 \end{align}
6) Multiplication law for a scaler unit in $\bbR$:
 \begin{align}
  1 \cdot x = x, \quad \forall x \in L.
 \end{align}
\end{defn}
Important points are
\begin{enumerate}
\item vectors are summable and sum is commutative operation, and
\item vectors and scalers satisfy some multiplication laws.
\end{enumerate}

The above properties hold for geometric vectors in high school, of course.
Our purpose is that we consider vectors as algebraic objects and
we derive many interesting properties using (mainly) algebraic thinking!
\subsection{Examples of linear spaces}

\begin{enumerate}
\item The set of real numbers $\bbR$ itself with scaler $\bbR$.
\item The set of complex numbers $\bbC$ itself with scaler $\bbR$.
\item The set of complex numbers $\bbC$ itself with scaler $\bbC$.
\item A plane $\bbR^2$ with scaler $\bbR$.
\item A three dimensional space $\bbR^3$ with scaler $\bbR$.
\item Higher dimensional space $\bbR^d$ ($d \geq 4$) with scaler $\bbR$.
\item Some subsets of (numerical) sequence, e.g., $c_0$, $c_{\infty}$, $\ell^2$ with scaler $\bbR$.
\item Some subsets of function spaces, e.g., $C^k(\Omega)$, $L^p \rbk{\Omega}$, $H^k \rbk{\Omega}$ with scaler $\bbR$.
\item A set of linear operators with scaler $\bbR$.
\end{enumerate}

Today's main targets are introduction to the last three items and its relation to calculus.
\subsection{Examples of finite, but higher dimensional spaces than three\label{linear-algebra-and-calculus-8}}

We have many examples for higher dimensional objects in real world, e.g.,
\begin{enumerate}
\item (time evolution of) stock prices,
\item players' movement in soccer,
\item computerized control in robots.
\end{enumerate}
For (time evolution of) stock prices,
there are many listing companies and its time evolution is important in real world.
This evolution is mathematically representable in higher dimensional space picture.

Other examples are also characterized similarly.
These are related to analytical mechanics in physics.
Moreover analytical mechanics is closely related to geometry.
See \cite{KenjiFukaya1, NakamuraYamamoto1, NakamuraYamamoto2}.
\subsection{Function as a vector}

First recall the definition of vectors in three dimension:
letting $f = (f(1), f(2), f(3))$ and $g = (g(1), g(2), g(3))$ be three dimensional vectors
then their sum $f + g$ is defined by
\begin{align}
 f + g
 \defeq
 \rbk{f\rbk{1} + g \rbk{1}, f(2) + g(2), f(3) + g(3)}.
\end{align}
I.e., sum of vectors is defined by component-wise.
Hence we also try to define a sum of functions as
\begin{align}
 f + g
 \defeq
 \rbk{f(x) + g(x), f(y) + g(y), \dots}.
\end{align}
In short hand notation we define a sum by
\begin{align}
 \rbk{f + g} (x)
 \defeq
 f(x) + g(x).
\end{align}
For scalar multiplication we set
\begin{align}
 \rbk{\alpha f} (x)
 \defeq
 \alpha f (x).
\end{align}
Sum and scalar multiplication defined above satisfy the axioms of a linear space.
Thus we conclude a space of functions is a linear one\footnote{A function space becomes linear if images of functions belonging to it are linear.
Function spaces can be non-linear, e.g., images of functions belonging to it are manifolds or general sets.
That is, it depends on the algebraic structure of images of functions belonging to a function space
whether a function space has an algebraic structure.}.


\subsection{Function spaces: examples of infinite dimensional spaces}

We have infinitely many infinite dimensional objects.
Examples are weather maps and wind direction maps.

Take a point in a world map,
and then there are infinitely many directions to blow wind at the point.
In the viewpoint of classical physics there are infinitely many space points,
and hence there are also infinitely many patterns how the wind blows
depending on directions and strength of the wind at each space point.

How do we represent this infinitely many probability of the wind in real world?
We use functions in several variables, $w(x,y,z,t) \in \bbR^3$.
A value of a function $w(x,y,z,t)$ at a space-time point $\rbk{x, y, z, t}$
represents a direction of wind and its strength (length of a vector).
We always use this type of mathematics in physics.

Furthermore there are infinitely many types of wind distribution,
i.e., we have infinitely many functions.
For systematic thinking it is useful to think where functions live in.
This is called a function space.
There are many useful function spaces and we select a proper space as the situation demands.

In this way, in mathematics we will encounter various types of spaces
other than a three dimensional geometric space.
We consider spaces where functions live and ones where spaces itself live.
\subsection{Dimension}

We use the terms, finite or infinite dimension, but we have not define the term, dimension.
Furthermore not all function spaces are infinite dimensional.

Firstly we define the concept of dimension and related concepts,
and then we consider the details after that.
\begin{defn}[Linear combinatin.]
Suppose $L$ is a linear space and $f_1, f_2, \dots, f_k \in L$.
For a set of real numbers $c_1, \dots, c_k \in \bbR$ vectors of the following form is called
a linear combination of vectors $f_1, f_2, \dots, f_k$.
\begin{align}
 c_1 f_1 + c_2 f_2 + \cdots + c_k f_k
\end{align}
\end{defn}
\begin{defn}[Linearly dependent/indepedent]
Suppose $L$ is a linear space and $f_1, f_2, \dots, f_k \in L$.
Vectors $f_1, \dots, f_k$ are called linearly dependent if
the following expression holds for a set of real numbers $c_1, \dots, c_k \in \bbR$ one of which is not 0:
\begin{align}
 c_1 f_1 + c_2 f_2 + \cdots + c_k f_k = 0.
\end{align}
We can say that ``we have a nontrivial linear combination."

Conversely the set of vectors $f_1, \dots, f_k$ is linearly independent
if the above expression holds only if $c_1 = c_2 = \cdots = c_k = 0$.
We can say that ``we have only trivial linear combination."
\end{defn}
\begin{defn}[finite/infinite dimension]
A linear space $L$ is called finite dimensional
if there is a set of vectors $f_1, f_2, \dots, f_k \in L$ with finite number
such that each vector in $L$ is expressed by linear combination of $f_1, f_2, \dots, f_k$.
A space $L$ is called infinite dimensional if $L$ is not a finite dimensional space.
\end{defn}
\begin{defn}[basis]
Suppose $L$ is a linear space and vectors $f_1, f_2, \dots, f_k$ are in $L$.
A set of vectors $f_1, \dots, f_k$ is called a basis of $L$ if it satisfies
the following 2 conditions.
1. Vectors $f_1, f_2, \dots, f_k$ are linearly independent.
2. Each vector in $L$ is expressed by a linear combination of $f_1, f_2, \dots, f_k$.
\end{defn}
\begin{defn}[dimension]
The dimension of a (finite dimensional) linear space is
defined by the cardinal number of a set of basis.
\end{defn}

Firstly we explain the concept of dimension.
In geometric viewpoint in high-school
the number of dimension corresponds to the one
how much we need to specify the all points in a space.
That the dimension is 3 corresponds to the fact that
we need information, vertical, horizontal, and height to specify a point in space.

We see the dimension the degree of freedom.
In section \ref{linear-algebra-and-calculus-8} we take an example, the player's movement in soccer.
In this case the dimension of space is $22 \times 2 = 44$ for
there are 22 players and they move in a plane (play field).
Computerized control of robots is a little more complex:
the dimension of space roughly corresponds to the number of joints.
In fact we have constraints between them:
e.g. we cannot expand the arm if the length of it is 40 cm.
The dimension corresponds to the number of freedom with these constraints\footnote{In fact the space for computerized control for robots is curved so we can consider it as a manifold.
For details see the books on analytical mechanics \cite{NakamuraYamamoto1, NakamuraYamamoto2} or
the theory of dynamical system.}.

We can get a point for the definition of a basis in plane.
Usually, if we take 3 vectors in plance,
we can express one of a vector by the other 2 vectors.
If the 3 vectors are colinear their linear combination expresses only the point on the line.
We must define a basis to exclude this situation.

Finally we remark the definition of infinite dimensional spaces.
We do not define it directly due to difficulty in defining algebraically infinite sum\footnote{We can consider algebraically infinite sum,
e.g, the ring of formal power series.}.

If a linear combination for an infinite dimensional space is defined by $\sum_{k=1}^{\infty} c_k f_k$ naively,
we cannot take the numbers $(c_k)$ arbitrarily because we must consider the convergence of serieses in application to analysis.
Furthermore we consider only algebraic structure, do not consider other structures, i.e., convergence (topology).

At the last of this section we take examples.
The space of $\bbR^d$ is a $d$ dimensional linear space, of course.
We pick up examples of function spaces with ``basis"\footnote{When considering infinite dimensional spaces
we do not usually use basis, and
the concept of a complete (orthonormal) system is important
in a Hilbert space which we use frequently in quantum mechanics, e.g.}.

\begin{ex}[a space of sequence]
The space of absolutely summable sequences $\ell^1$ is an infinite dimensional space.
Here we define vectors
\begin{align}
 e_i
 =
 \rbk{0, \dots, 0, \dots, 1, \dots},
\end{align}
whose components are all 0 other than $i$-th component which is 1,
and then the set $\rbk{e_i}$ becomes a basis.
\end{ex}
\begin{ex}[A infinite dimensional function space]
The space of square integrable functions in the sense of Lebesgue $L^2 (- \pi, \pi)$ is infinite dimensional.
For a ``basis" we can take the set of functions $\rbk{e^{i k \pi}}_{k \in \bbZ}$.
This corresponds to the Fourier series expansion.
\end{ex}
\begin{ex}[A finite dimensional function space: the solution space for a differential equation]
Consider the following differential equation (equation of motion).
\begin{align}
 m \frac{d^2 x}{dt^2}
 =
 -k x.
\end{align}
The general solution of the above is described by
\begin{align}
 x(t)
 =
 A \sin \omega t + B \cos \omega t
 =
 A \sim \rbk{\omega t + \theta}, \quad \omega = \sqrt{k / m}
\end{align}
This solution space becomes linear: a linear combination of solutions also becomes a solution.

The dimension of the space is 2.
This corresponds to the degree of freedom of an amplitude $A$ and the initial phase $\theta$.
Note that not all function space is infinite dimensional.
Furthermore this teaches us that there is not always natural topology in linear spaces.
What is natural topologies for this solution space?
\end{ex}
\subsection{Linear maps, Linear functionals}

We usually consider maps instead of functions in university mathematics.
In fact a map is just a function whose domain and range are general sets.
First we define a linear map and linear functional.
\begin{defn}
Assume $L_1$ and $L_2$ are linear spaces.
Then a function $F \colon L_1 \to L_2$ is called a \upbf{map or operator}.
If $F$ preserves linearity, i.e., $F$ has a property
\begin{align}
 F \rbk{\alpha f + \beta g}
 =
 \alpha F(f) + \beta F(g), \quad \alpha, \beta \in \bbR, f, g \in L_1,
\end{align}
then an operator $F$ is called a \upbf{linear operator}.

If $L_2$ is $\bbR$ then $F$ is usually called a \upbf{functional}.
Furthermore $F$ is called a \upbf{linear functional} if it is linear.
\end{defn}
Here are some examples.
\begin{ex}
 We show some examples.
 1) Coordinate maps. Let $f = (f(1), f(2), \dots, f(d)) \in \bbR^d$.
    We write a vector $f = (f_1, f_2, \dots, f_d)$ as $f = (f(1), f(2), \dots, f(d))$ for later use.
    This is just a notational convention.
    Then we get functionals by
   \begin{align}
    x_i \colon f \mapsto f(i).
   \end{align}
    This is a linear functional since this has a property
   \begin{align}
    x_i \rbk{\alpha f + \beta g}
    =
    \alpha x_i \rbk{f} + \beta x_i \rbk{g}.
   \end{align}
 2) Definite integrals: First we define a map $I$ as
   \begin{align}
     I \colon
     f \mapsto \int_{\bbR^d} f(x) dx \in \bbR.
   \end{align}
    This is a linear functional since this has a property
   \begin{align}
    I \rbk{\alpha f + \beta g}
    =
    \alpha I \rbk{f} + \beta I \rbk{g}.
   \end{align}
 3) Another type of a definite integral:
   \begin{align}
    E \colon
    f \mapsto \int_{\bbR^d} \rbk{\abs{\nabla f(x, t)}^2 + \rbk{\frac{\partial f(x, t)}{\partial t}}^2} dx. \label{linear-algebra-and-calculus-4}
   \end{align}
   This is a nonlinear functional.
   In physics this $E$ is called an energy functional.
 4) Differential operators: Define an operator as
   \begin{align}
    D \colon f \mapsto \frac{d}{dx} f.
   \end{align}
    This is a \textup{linear operator} since it satisfies
   \begin{align}
    D \rbk{\alpha f + \beta g}
    =
    \alpha Df + \beta Dg.
   \end{align}
\end{ex}
In this way we connect linear algebra with calculus.
For analysis of nonlinear functionals we also need various linear spaces and
some technique from linear algebra.
\subsection{Eigenvalues, eigenvectors}

These are not learned explicitly in high school.
However they sometimes appears in entrance exams.
\begin{defn}
 Let $A$ be a linear operator on a linear space $L$.
 A real number $\lambda$ resp. a vector $f$ are called an \upbf{eigenvalue} resp. \upbf{eigenvector}
 if they satisfy
 \begin{align}
  A f = \lambda f, \quad
  f \neq 0.
 \end{align}
\end{defn}
Here are examples.
\begin{ex}
 Let $D^2$ be a second order differential operator (this is linear) with respect to time and consider
  \begin{align}
   m D^2 x
   =
   -k x,
  \end{align}
 i.e.,
  \begin{align}
   m \frac{d^2 x (t)}{dt^2}
   =
   -k x(t).
  \end{align}
 This is an equation of motion for a spring in physics.
 A solution (eigenvector) is
  \begin{align}
   x(t)
   =
   A \sin \rbk{\omega t + \theta}, \quad
   \omega
   =
   \sqrt{\frac{k}{m}}.
  \end{align}
 We can write a solution using a celebrated Euler's formula:
  \begin{align}
   x(t)
   =
   A e^{i \rbk{\omega t + \theta}}.
  \end{align}
 Consideration of eigenvalues for a differential equation is somewhat difficult and we omit it.
 See, e.g., \cite{HaimBrezis1, HaimBrezis2} for details.
\end{ex}
\subsection{Mathematical application of linear algebra}

There many branches related to linear algebra.
Here are some examples.
See also \cite{phasetr2}.
\begin{enumerate}
\item Theory of Lie group and its representation theory.
\item General algebra.
\item Algebraic geometry.
\item Analysis of differential equations.
\item Functional analysis.
\item Operator algebra.
\end{enumerate}
\subsection{Physical application}

There many branches related to linear algebra in physics, too.
See also \cite{phasetr2}.

For example, in quantum mechanics, one of the most fundamental physical theory,
linearity is important and fundamental.
We say ``a superposition principle valids for wave functions,"
and this ``superposition" means linearity.

In high school we learn a superposition principle for wave.
This holds because our wave equation is linear in high school.
\subsection{Linear algebra and statistics}

We use statistics in many branches, including humanities and sociology.
E.g., natural language processing has many humanity and information theoretic elements.
This area needs broad knowledge including probability and statistics.
Interested readers should learn, e.g., principal component analysis.
\subsection{Linear algebra and computer/information science}

We have applications in computer science.
In numerical analysis we use linear algebra.
See the code theory, pseudo random numbers, image compression, or Google's
PageRank for real world application\footnote{See, e.g, my movies,
\url{http://www.nicovideo.jp/watch/sm7599426}, \url{http://www.nicovideo.jp/watch/sm10684363}.}.
\section{Integration}

\subsection{Let's define inner products!}

In this talk we mainly consider real linear spaces, e.g., $\bbRd$.
You may consider complex linear spaces if you know complex numbers.

We assume you agree with the existence of higher dimensional spaces.
We want to define angles and length of vectors as in two or three dimensional ones.
One reason to consider them is application to physics.
There is a projection hypothesis in quantum mechanics:
this projection comes from orthogonal projection,
and it is just a shadow of objects in three dimensional objects when
one shine a light from above.

At first we consider how to define angles between infinite dimensional vectors,
especially, functions.
Take a look at the following inner product formula in high school.
\begin{align}
 a \cdot b
 =
 \abs{a} \, \abs{b} \cos \theta.
\end{align}
We deform this:
\begin{align}
 \cos \theta
 =
 \frac{ a \cdot b} {\abs{a} \, \abs{b}}.
\end{align}
We can derive an angle $\theta$ from the value of the cosine function.
Lengths\footnote{In general we call it a norm of a vector.
We can consider many norms for a vector since there are many senses of distances.} of vectors can be computed by inner products,
from $\abs{a}^2 = a \cdot a$.
So we can derive angles if we can define an inner product.
Hence we have to define an inner product.
Note that an inner product is not a divine concept.
At first we write an inner product in $\bbR^3$.
We write a vector $f = (f_1, f_2, f_3)$ as $f = (f(1), f(2), f(3))$ for later use.
This is just a notational convention.
We define an inner product for three dimensional vectors $f$ and $g$ as
\begin{align}
 f \cdot g
 \defeq
 \bkt{f}{g}
 \defeq
 \sum_{k=1}^3 f(k)g(k).
\end{align}
The first notation is one in high school.
The second is usual one when considering a functional inner product.
There are several notations for an inner product such as
\begin{align}
 \rbk{f, g}, \quad \rbk{f | g}, \quad \langle f | g \rangle.
\end{align}
The last one is the famous Dirac's braket notation in quantum mechanics.
\subsubsection{Inner products in higher dimensional spaces}

We wrote an inner product as
\begin{align}
 \langle f , g \rangle
 =
 \sum_{k=1}^3 f(k)g(k).
\end{align}
Since there is no reason to restrict our consideration to a three dimensional space
we generalize a dimension three to general $d$.
\begin{align}
 \langle f , g \rangle
 =
 \sum_{k=1}^d f(k)g(k),
\end{align}
where we set
\begin{align}
 f = \rbk{f(1), f(2), \dots, f(d)}, \quad
 g = \rbk{g(1), g(2), \dots, g(d)}.
\end{align}
If you want to consider one in $\bbC^d$ you should set
\begin{align}
 \bkt{f}{g}
 =
 \sum_{k=1}^d \overline{f(k)} g(k)
\end{align}
because it is desirable that a length (norm) of a vector is
properly defined, i.e., $\norm{f}^2 \defeq \bkt{f}{g} \geq 0$.

We take a limit $d \to \infty$.
We face a problem whether a series converges or not,
but we can overcome this by considering converging ones.
\begin{align}
 \bkt{f}{g}
 =
 \sum_{k=1}^{\infty} f(k)g(k).
\end{align}

\begin{rem}
An infinite dimensional vector $f = (f(1), f(2), \dots)$
can be viewed as a sequence.
In quantum mechanics we use sequences and matrices living in an infinite dimensional space
when considering Heisenberg's matricial mechanics.
\end{rem}

Note that our temporal task is to make how to define an inner product for functions.
Let's go back to a finite sum, think $1 = \Delta k$, and rewrite a sum as
\begin{align}
 \sum_{k=1}^{d} f(k)g(k) \Delta k.
\end{align}

Rewrite $k$ as $k/d$ and $\Delta k$ as $1/d$.
Then we get a sum
\begin{align}
 \sum_{k=1}^{d} f \left( \frac{k}{d} \right) g \left( \frac{k}{d} \right) \frac{1}{d}.
\end{align}
This is an expression, known as 区分求積法 in high school\footnote{This is a definition of the Riemann integral.}.
Taking a limit $d \to \infty$ the above sum becomes an integral.
\begin{align}
 \langle f, g \rangle
 =
 \int_{0}^{1} f(x) g(x) dx.
\end{align}
Now the interval is $[0, 1]$ here,
but we can take any (measurable) subset of $\bbR$.

Hence we find that an inner product for functions
can be defined using integral.
In fact anything is good if it satisfies the axiom of an inner product.

A linear space with inner product is called pre-Hilbert space.
A pre-Hilbert space is called a Hilbert space if it is complete for metric induced by inner product.
A Hilbert space is famous as a space where wave functions in quantum mechanics live.
\subsection{Axiom for inner products}

\begin{axm}
 Let $L$ be a linear space and $\bkt{\cdot}{\cdot} \colon L \times L \to \bbR$ is a map of two variables.
 The pair $\rbk{L, \bkt{\cdot}{\cdot}}$ is an inner product space if the map $\bkt{\cdot}{\cdot}$ is an inner product,
 i.e., it satisfies the following properties.
 1) Symmetry:
  \begin{align}
   \bkt{f}{g} = \bkt{g}{f}.
  \end{align}
 2) Linearity in the second argument:
  \begin{align}
   \bkt{f}{\alpha g + \beta h}
   =
   \alpha \bkt{f}{g} + \beta \bkt{f}{h}.
  \end{align}
 3) Positive definiteness:
  \begin{align}
   \bkt{f}{f} \geq 0, \quad
   \bkt{f}{f} = 0 \Longleftrightarrow f = 0.
  \end{align}
\end{axm}
\begin{rem}
 The usual three dimensional inner product satisfies the above, of course.
\end{rem}
\subsection{Examples of inner products}

There are many inner products in a function space.
Denote the set of nonnegative real numbers as $\bbR_{\geq 0}$.
Let $\Omega$ be a (open) subset of $\bbR$ and $h \colon \Omega \to \bbR_{\geq 0}$ be a function satisfying
\begin{align}
 h(x) \geq 0, \quad
 h \neq 0, \quad
 0 < \int_\Omega h(x) dx < \infty.
\end{align}
Then the following becomes an inner product:
\begin{align}
 \bkt{f}{g}_{h}
 \defeq
 \int_{\Omega} f(x) g(x) h(x) dx.
\end{align}
We show some examples of inner products.
\begin{align}
 \bkt{f}{g}_1
 &\defeq
 \int_{-1}^{1} f(x) g(x) dx, \\
 \bkt{f}{g}_2
 &\defeq
 \int_{0}^{\infty} f(x) g(x) e^{-x} dx, \\
 \bkt{f}{g}_3
 &\defeq
 \int_{\bbR} f(x) g(x) e^{-x^2} dx.
\end{align}
The above inner products are related to
the Legendre polynomials, Laguerre polynomials, Hermite polynomials.
These are used to solve linear partial differential equations,
especially, in electromagnetism or quantum mechanics.

Furthermore we take the following inner product.
\begin{align}
 \int_{- \pi}^{\pi} f(x) g(x) dx.
\end{align}
Then we get the following expressions.
\begin{align}
 \frac{1}{\pi} \int_{-\pi}^{\pi} \sin nx \sin mx
 &=
 \delta_{n,m}, \\
 \frac{1}{\pi} \int_{-\pi}^{\pi} \cos nx \cos mx
 &=
 \delta_{n,m}, \\
 \frac{1}{\pi} \int_{-\pi}^{\pi} \cos nx \sin mx
 &= 0.
\end{align}
This means that the functions $\cbk{\cos nx}$ and $\cbk{\sin nx}$ are orthogonal.
This relates to the famous Fourier series expansion.
This is used for wave analysis in physics.
\subsection{Physics for the space $L^2 \rbk{\Omega}$}

The symbol $L^2 \rbk{\Omega}$ in the title means
the space of square integrable functions in the sense of Lebesgue on $\Omega$.

We introduce a physical meaning of the space $L^2 \rbk{\Omega}$.\footnote{To be precise the proper space is not $L^2$ but $H^1$.}
The elements of the space $L^2 \rbk{\Omega}$ have finite energy.
Let us consider a wave equation.
\begin{align}
 \frac{\partial^2 u}{\partial t^2}
 =
 \Delta u.
\end{align}
The energy for its solution is written by
\begin{align}
 E
 =
 \int_{\mathbb{R}^d} \rbk{\rbk{\nabla u}^2 + \rbk{\frac{\partial u}{\partial t}}^2}dx.
\end{align}
We want to restrict solutions whose energy is finite
since it is physically meaningless to consider solutions with infinite energy.
The elements of $L^2$ have finite energy, by definition,
and hence it is the reason why the space $L^2$ is important in physics.
To be precise our derived functions are in $L^2$, so
we have to consider a Sobolev space $H^1$.

In quantum mechanics probabilistic interpretation forces us to
consider functions in $L^2$.
Furthermore we have to impose more severe restriction to functions,
i.e., the domain of Hamiltonians.

Linear operators have their domains
and, for Hamiltonians, their domains are functions having finite energy.
\section{Differentiation}

\subsection{Taylor expansion}

We start from Taylor's theorem.
Assume a function $f$ is differentiable.
Fundamental theorem of calculus and integration by parts lead
\begin{align}
 f(x) - f(x_0)
 &=
 \int_{x_0}^{x} f'(y) dy
 =
 \int_{x_0}^x (x - y)^{0} f'(y) dy \\
 &=
 \sqbk{- \rbk{x - y} f'(y)}_{x_0}^x + \int_{x_0}^x \rbk{x - y} f^{(2)} (y) dy \\
 &=
 (x - x_0) f'(x_0) + \sqbk{- \frac{(x-y)^2}{2} f^{(2)}(y)}_{x_0}^x + \int_{x_0}^x \frac{(x - y)^2}{2} f^{(3)} (y)dy. \\
 &=
 (x - x_0) f'(x_0) + \frac{(x-x_0)^2}{2} f^{(2)}(x_0) + \int_{x_0}^x \frac{(x - y)^2}{2} f^{(3)} (y)dy.
\end{align}
Further iteration leads the following Taylor's theorem.
\begin{align}
 f(x)
 =
 \sum_{k=0}^{n} \frac{(x - x_0)^k}{k!} \left( D^k f \right) (x_0) +
  \int_{x_0}^{x} \frac{(x - y)^{n}}{n!} f^{(n+1)} (y) dy,
\end{align}
where $D^k f$ is a shorthand notation for  $d^k f/ dx^k$,
the last term of the RHS is called the remainder term
and denoted by $R_n$.

Now assume the remainder term $R_n$ converges to 0 as $n \to \infty$
and the above series also converges in some suitable sense.
Let $x_0 = 0$.
Then we get
\begin{align}
 f(x)
 =
 \sum_{k=0}^{\infty} \frac{x^k}{k!} \left( D^k f \right) (0).
\end{align}
This series is called a \textbf{Taylor series} around 0 and
this power series expansion is called a \textbf{Taylor expansion} around 0.

A Taylor expansion of an exponential function $e^x$ around $0$ is as follows.
\begin{align}
 e^{x}
 =
 \sum_{k=0}^{\infty} \frac{x^k}{k!}.
\end{align}
We compare the above two expressions and
set $x$ to $x D$ in the expansion of $e^x$.
Then we have the following clear expression.
\begin{align}
 f(x)
 =
 \left( e^{xD} f \right) (0)
\end{align}
If we use quantum mechanical notation, $p = -i D$, the above expression becomes
\begin{align}
 f(x)
 =
 \left( e^{ixp} f \right) (0).
\end{align}
\subsection{Unitary representation of a group}

The above story closely related to a unitary representation theory of a group.
Simply speaking a underlying space $\bbR$ itself is a group
and it acts on itself.
This action lifts up to a function space living on a underlying space.
See \cite{KobayashiOshima1} for details.

One point.
Physicists often define functions of operators by Taylor expansion.
However it is not good and insufficient in view of mathematics.
We can see it when we consider the action of $e^{ixp}$.

The operator $e^{i x p}$ shifts an argument of a function $x$,
and this shift is defined without differentiability of functions,
i.e., we can define an action of $e^{ixp}$ for more general functions.
However if we define it by a Taylor expansion,
the operator $e^{ixp}$ is defined for only analytic functions.
\subsubsection{Fourier expansion}

A simple argument can deduce a Fourier expansion.
We can formally consider for $\bbR$,
but this is a little bit mathematically problematic.
Instead we consider on an interval $[ - \pi, \pi]$.

Consider a linear differential equation (eigenequation for
self-adjoint operator $p$)
\begin{align}
 p f
 &=
 k f, \quad k \in \bbR, \\
 f(-\pi)
 &=
 f(\pi).
\end{align}
Then the above solutions are
\begin{align}
 f_k(x)
 =
 e^{ikx}
\end{align}
for each $k \in \bbZ$.
Note that computation shows the set of eigenvalues $\cbk{k}$ is, in fact, $\bbZ$ and that
the above solutions $\cbk{f_k}$ are the eigenfunctions of each eigenequation $p f_k = k f_k$ \footnote{The proof for uniqueness of the eigenequation for each $k \in \bbZ$ needs the
uniqueness theorem for (linear) ordinary differential equations.}.
Euler's formula says
\begin{align}
 e^{ikx}
 =
 \cos kx + i \sin kx,
\end{align}
and this leads a Fourier expansion.
\subsection{Analitical mechanics and quantum mechanics}

In quantum mechanics a momentum becomes a differential operator
and denotes $p = -i D$.

In analytical mechanics a momentum
can be viewed as a generator of space shift.
A differential operator $- i d/dx$ is also
a generator of space shift in view of representation theory.
Hence these are common property, generator of space shift.
This is an important \textbf{formal} connection to classical mechanics and quantum mechanics.
This connection is also important in geometry.
\subsection{Physics and representation theory}

Representation theory is also important for
theory of relativity and relativistic quantum field theory.
See \cite{TakeshiHirai1, TakeshiHirai2} for details.
\section{Variational problem: mixture of differentiation and integration}

A variational problem is an infinite dimensional version of differential theory.
This is important and interesting in both physics and mathematics.

It is a mathematically and physically famous problem that why soap bubble becomes round.
This type of problems is called a geometric variational problem.
See \cite{SeikiNishikawa1} for details.
\subsection{Examples of variational problems}

\subsubsection{shortest time problem}

Assume you are a lifesaver on beach and there is a person drowning.
You have to save the person.
How do you determine a path to the person in the shortest possible time?
This is a famous variational problem.

You have to determine a path and it is a function mathematically.
Hence you have to search a function in a function space.
How to search it?

A similar physical problem is discussed in high school: optics, refraction.
In society this is related to how to design optical fibers to reduce light-loss.
\subsection{Mathematical formulatrion: functionals, linear operators}

We formulate the above problem mathematically.
In usual we make a some \textbf{functional} and search a function
which optimize, i.e., minimize or maximize the value of it.
In this procedure we differentiate a functional by functions,
and this is a variational derivative.

Recall an energy functional (\ref{linear-algebra-and-calculus-4}).
This energy functional is a mixed type functional of differential and integral.
We often face this type of functionals in theory of partial differential equations,
in particular, quantum mechanics and we need a minimum value of $E$ and its minimizer.
These are physically important quantities, ground state energy and ground state.
Some types of quantum mechanical problems are formulated as a variational problem.
\chapter{Miscellaneous results on eigenvalue problems}

線型代数応用編. 意外と知らないよね, くらいのお話.\footnote{From a yukimi's page, \url{http://yukimigo.com/math/}.
The original version is reprinted with the written consent of the author.}
おおむね笠原 \cite{KoujiKasahara1}の内容です.
モチベーションはクーラント・ヒルベルト \cite{CourantHilbert1}とか？
\section{Gershgorinの定理}

以下 $\mathbb{C}^n$ で考える. ただし対称行列のときはもちろん $\mathbb{R}^n$  でよい.
\begin{thm}[Gershgorinの定理]
 正方行列 $A = (a_{ij})$ の固有値は $\mathbb{C}$ 上の半径
  \begin{align}
   r_i
   =
   \sum_{j\neq i}^n \abs{a_{ij}},
  \end{align}
 中心 $a_{ii}$ の閉球にふくまれる.
\end{thm}

\begin{proof}
$A$ のある固有値を $\lambda$, それに属する固有ベクトルを
$l$ とすると,
\begin{align}
 \lambda l
 =
 Al
\end{align}
だから,
\begin{align}
 \lambda l_i
 =
 \sum_{j=1}^n
 a_{ij} l_j
 =
 \sum_{j \neq i} a_{ij} l_j  + a_{ii} l_i
\end{align}
によって
\begin{align}
 \rbk{\lambda - a_{ii}} l_i
 =
 \sum_{j \neq i} a_{ij} l_j
\end{align}
となっている.
$\max \abs{l_k} = \abs{l_i}$ とすると,
\begin{align}
 \abs{\lambda - a_{ii}}
 =
 \abs{l_i}
 \le
 \sum_{j \neq i} \abs{a_{ij}} \abs{l_j}
 \le
 \abs{l_i} \sum_{j \neq i} \abs{a_{ij}}
\end{align}
だから, $|l_i|$ で割ればよい.
\end{proof}
\section{固有値の性質}

さて, ここですこしだけ線型代数の復習をしよう.
一般に対称行列 $A$ は直交行列によって対角化される.
固有値を $\lambda_1, \dots, \lambda_n$ とすると適当なベクトル $y$ によって二次形式の標準形が次のようになる.
\begin{align}
 \bkt{x}{Ax}
 =
 \lambda_1 y_1^2 + \dots + \lambda_n y_n^2
\end{align}
そこで次の定理がなりたつ.
\begin{thm}
 $A$ を対称行列とすると,
 \begin{align}
  W(A)
  \defeq
  \set{\bkt{x}{Ax}}{|x| = 1}
 \end{align}
 は実数の閉区間になり, その両端はそれぞれ $A$ の最小, 最大の固有値に等しく,
 その両端の値を取る $\bkt{x}{Ax}$ の $x$ は $A$ の固有ベクトルになる.
\end{thm}
\begin{proof}
\begin{align}
 \bkt{x}{Ax}
 =
 \sum_{i=1}^n \lambda_i y_i^2
\end{align}
で, てきとうに番号を入れかえて $\lambda_1 \le \dots \le \lambda_n$ としておく.
ふつうに計算して
\begin{align}
 \lambda_1 \sum_i y_i^2
 \le
 \sum_i \lambda_i y_i^2
 \le
 \lambda_n \sum_i y_i^2
\end{align}
だから, $\abs{x}=1$ とすると
\begin{align}
 \lambda_1
 \le
 \sum_i \lambda_i y_i^2
 \le
 \lambda_n
\end{align}
によって $W(A) \subset [\lambda_1, \lambda_n]$
となる.
$\lambda_1, \lambda_n \in W(A)$ であればよい.
どちらでもおなじで, $\lambda_1$ の固有ベクトルを $l$ とすると $\bkt{l}{Al} \in W(A)$ で
\begin{align}
 \bkt{l}{Al}
 =
 \lambda_1 \abs{l}^2
 =
 \lambda_1
\end{align}
となる.
\end{proof}
\section{Min-Maxの原理}

つぎは量子力学でとても重要だけどあまり知られていない.
らしい(田崎 \cite{HalTasaki3}の付録によると).
というわけでかんたんな場合をかいておこう.
もっと一般に関数解析をばりばり使う場合はLieb-Loss \cite{LiebLoss1}にある.
ちなみに悪名高いRuelle \cite{DavidRuelle1}にもあるそうで.
\begin{thm}[Min-Max Principles]
 $A$ を対称行列とし, その固有値を $\lambda_1 \le \dots \le \lambda_n$
 とする.
 $F$ を $\mathbb{R}^n$ の部分空間とするとき,
 \begin{align}
  \lambda_k
  =
  \min_{\dim F=k} \max_{x \in F} \set{\bkt{x}{Ax}}{\abs{x} = 1}
 \end{align}
 がすべての $k$ でなりたつ.
\end{thm}
\begin{proof}
$A$ の固有ベクトルからなる ONS を $l_1, \dots , l_n$ とする.
てきとうに番号をつけかえて
\begin{align}
 Al_i
 =
 \lambda_i l_i
\end{align}
としてよい.
$l_k, \dots , l_n$ で張られる部分空間を $E_{n-k+1}$ とすると,
その次元は $n-k+1$ だから, 任意の $k$ 次元部分空間 $F$ とゼロでない共有元をもつ.
それを $x$ として,
\begin{align}
 x
 =
 y_k l_k + \dots + y_n l_n \quad (\abs{x} = 1)
\end{align}
とすると,
\begin{align}
 \bkt{x}{Ax}
 &=
 \lambda_k y_k^2 + \dots + \lambda_n y_n^2 \\
 &\ge
 \lambda_k |x|^2
 =
 \lambda_k
\end{align}
だから
\begin{align}
 \max_{x\in F } \set{\bkt{x}{Ax}}{\abs{x} = 1}
 \ge
 \lambda_k
\end{align}
となっていて, $F$ は任意だから
\begin{align}
 \min_{\dim F=k} \max_{x\in F} \set{\bkt{x}{Ax}}{\abs{x} = 1}
 \ge
 \lambda_k
\end{align}
がなりたっている.
一方, $l_1, \dots , l_k$ で張られる部分空間 $F_k$ は $k$ 次元だから $x \in F (\abs{x} = 1)$ を
\begin{align}
 x
 =
 y_1 l_1 + \dots + y_k l_k
\end{align}
とかくと,
\begin{align}
 \bkt{x}{Ax}
 &=
 \lambda_1 y_1^2 + \dots + \lambda_k y_k^2  \\
 &\le
 \lambda_k \norm{x}x^2
 =
 \lambda_k
\end{align}
だから
\begin{align}
 \max_{x \in F_k} \set{\bkt{x}{Ax}}{\abs{x} = 1}
 \le
 \lambda_k
\end{align}
によって前の結果とあわせて
\begin{align}
 \lambda_k
 \le
 \min_{\dim F=k} \max_{x \in F} \set{\bkt{x}{Ax}}{\abs{x} = 1}
 \le
 \max_{x \in F_k } \set{\bkt{x}{Ax}}{\abs{x} = 1}
 \le
 \lambda_k
\end{align}
となって, 証明できた.
\end{proof}
\chapter{{\bfseries\sffamily TODO} REWRITE AND TRANSLATE Linear algebra written in my undergraduate three years}

\section{はじめに}

\subsection{数学「を」学ぶ}

これは基本的に数学の本です.
物理現象を解析するのに, ある数学の理論が有用なので,
実際の解析を視野に入れつつ, そうした数学を展開していこう, という趣旨です.
物理学にとって, 数学とは驚異的に役に立つもので,
場合によっては数学的な考察から新たな物理を生み出すことさえあるほどです.
しかし, 物理を学び, 研究する際に何故数学を用いるのでしょうか?

物理現象の解析に数学を用いたのは, Galilei によると言われています.
彼は「哲学は宇宙という大書物に書かれている」と考えていたようで,
物理現象を数学的に定式化することに成功しました.
実際にどんな現象が起こっているのかを確かめるために, (再現可能な) 実験を行って,
位置の時間変化などを数値として表し, その上でその数値を比較する,
という方法は, 確かに優れたものだと思います.
うまく数値を扱うために, 数値の扱いに関してすでに整った体系を持っていた
数学を用いよう, というのは自然な発想でしょう.

しかしこれから私たちが学ぶ数学には, 単なる数値の扱いを超えた,
かなり高級なものも含まれています.
何故こうした数学を学ばなければならないのか考えてみると,
そうすると現象の解析に便利だから, というだけです.
他にもっと楽な方法はないのか, と思わないでもありません.
そもそも, 物理を学ぶのに何故数学が必要なのか, 役に立つのか.
非常に不思議です.
Feynman は, 物理学を日常言語で表現できないうちは
まだまだ (人類の) 自然界への理解が足りないのだ, と考えていたようです.
数学で表現された物理学の理論が (全てとはいわずとも) 日常言語に翻訳可能である,
という事実も, 良く考えてみると驚くべきことです.

現在の物理学を見渡す限り, 数学は
なくてはならない重要な道具であることは間違いないでしょう.
しかしそれだけでしょうか.
Bohr は前期量子論において, その理論構築の中で, 実験結果とあわせるために,
振動数の量子条件を数学的な関係式として導入したようですが,
後になって, この物理的な意味が, 物質波の理論とともに
de Broglie によって与えられました.
このように, 数学的な考察がはじめにあり,
その後に数学に物理的な生命を吹き込むという作業を行う場合があります.
こうした事例は数学が, 物理を数学的・抽象的な舞台に持ち込むことで,
逆に単なる直感を超えた議論が展開できるようになり,
物理的直観を伴った深い理解をもたらす可能性を示唆します.

何はともあれ, 以下, 本書では数学に対して
\begin{center}
\textbf{何故だか分からないがとても役に立つ.}

\textbf{道具というよりもむしろ武器である.}
\end{center}
というスタンスのもと, 物理学を学ぶのに有用な数学の理論を展開していきます.
とにかく実際に自然界で何が起こっているか良く分からないので,
そうした化け物を人間のつつましい能力で扱うための武器である数学は,
自然界の事物の本質に従うべきもので,
すっきりきれいにまとまるものばかりというわけにはいかないでしょう.
いきおい泥臭い話にならざるを得ない部分があります.
そして, 頼みの武器がなまくらでは困ります.
物理学を埋め込むのに, 時として抽象性が高く, 難しい数学を用いなければならない
ことがありますが, これらは全て物理学のためです.
頑張って食らいついてください.

また, 単に理論を紹介するということなら, すでに世に良い本はたくさん出回っています.
(筆者だけかもしれませんが, 以前, 特に数学の) 本を読む際に一番退屈だったのは,
定義がごちゃごちゃと出てくるところです.
しかし, 近い将来私達がそうした理論を作ろうというときがやってきます.
このとき一番重要になるのは, 先程「退屈」といった定義のところでしょう.
何故かというと, 一般的に何かを調べようというとき,
そもそも何を調べるか, どう調べるかということが一番の問題になります.
調べたい事柄に対し, それを良く反映した物理量を導入 (定義) していくことになるでしょう \footnote{後で具体例を加える.}.
こうした点を踏まえ (筆者の勉強もかねて), この本では
なるべくどのような定義を何故導入するかということに神経を使っていくことにします.
これらは筆者が一番納得できると思った定義と論法であり, 他の人から見れば,
気に食わない定義・論法かもしれません.
そういう場合, 自分で積極的に納得のいく定義を考えてください.
数学での例になりますが, L. Schwartz という人が超関数の理論を考え出しました \footnote{これは物理学において Dirac が導入したデルタ関数を数学的に正当化する理論であり,
非常に重要な理論です.}
しかし, 日本人数学者の佐藤幹夫は, この定義がひどく気に食わなかったようで,
今日「佐藤超関数」として知られる理論体系を組み上げ, 世界的に有名になりました.
納得のいかない定義を納得のいくものにすることで世界的な業績をあげてしまった, このような例があります.
定義は納得するまで考えてください.
定義こそが生命線です.
\subsection{数学「で」学ぶ}

作りかけ.
\subsection{一年で物理の講義がほとんど無い理由}

人によっては衝撃的なタイトルであるかもしれません.
応物・物理に来たというのに, 一年生では物理をほとんどやらない, というのですから.
しかしこれにはもっともな理由があります.
まず物理の代わりに何をやるのかということですが, 数学をやります.
先程述べたように, 現在の枠組みの中では,
物理学の理論を埋め込むべき数学を知らないと, 物理学が理解出来ないからです.

例をあげます.
一年の授業で物理学 A という講義がありますが, これはいわゆる力学です.
一般に空間の点はベクトルで表されますが, この点の動きを力学的に追跡するのに
速度・加速度という概念を必要とします.
数学的には, 速度は位置 (変位) を時間微分したもの,
加速度はもう一回位置 (変位) を時間微分したものです.
運動方程式は加速度を含んだ式ですが,
$\vr = (x, y, z)$ を位置ベクトル,
$\vf (\vr, t)$ を力のベクトルとすると
\begin{equation}
 m\frac{d^{2}\vr}{dt^{2}}=\vf (\vr, t)
\end{equation}
と書けます \footnote{高校で学んだ記法 $\vec{r}$ の代わりにこのように肉太の文字で書きます.
普通の文字, $r$ (肉太のものは $\vr$) と区別して下さい.
実際に手書きするときは $\bbA$ のように書きます.}.
これは数学的には\textgt{2 階の常微分方程式}となります.
もちろん (物理学を学ぶのに必要になるレベルの) 微分方程式は高校で学んでいないはずです.
高校で力として重力, 摩擦力, 垂直抗力, 電磁力など色々学んだと思いますが,
その中に Lorentz 力というのがありました.
これをベクトルで書くと
\begin{equation}
 \vf \rbk{\vr,t } = q \cbk{ \vE  \rbk{ \vr ,t } + \vr \times \vB \rbk{\vr,t } }
\end{equation}
となります.
右辺にある $\times$ はベクトルとベクトルの外積を表す記号として使われます.
おそらく数学 A (線形代数) の講義で出て来る前に力学で出てくるでしょう.

また高校で位置エネルギーや電位というのを学んだでしょうが,
これらはまとめてポテンシャルと呼ばれます.
あまりいい加減なことをいうのも良くないのですが,
ポテンシャルというのは空間微分すると力 (の成分) が出てくるものだと思いましょう.
実際に重力ポテンシャルから重力を出してみます:
\begin{equation}
 \vf \rbk{ \vr,t } = - \frac{ \pd \rbk{ mgz }}{ \pd z} = -mg.
\end{equation}
ここでまた変な記号が出てきますが, 一般式はポテンシャルを $U ( \vr,t)$ として
\begin{gather}
 \vf \rbk{ \vr,t }
 =
 -\grad U \rbk{ \vr,t } \\
 \grad
 \defeq
 \ve_{1} \frac{ \pd }{\pd x} + \ve_{2} \frac{ \pd }{\pd y}
        +\ve_{3} \frac{ \pd }{\pd z} \\
 \ve_{1}
 \defeq
 \ve_{x}
 =
 \vecc{1}{0}{0}
 , \quad
 \ve_{2}
 \defeq
 \ve_{y}
 =
 \vecc{0}{1}{0}, \quad \ve_3
 \defeq
 \ve_{z}
 =
 \vecc{0}{0}{1}
\end{gather}
のようになります.
ここで「 $\defeq$ 」は「右辺を左辺で定義する」という意味です.

ポテンシャルに限らず, 物理に登場する関数は
一般に空間と時間を変数に持ちますから, 4 変数関数です,
そこで 4 変数関数の微分が出来るようになる必要があります.
多変数の微積分は後期の数学 B で学ぶことになっていますが, 遅すぎます.
慣れれば別にどうということもないですが, 慣れるまでが大変なのです.
そうかといって, 詳しく数学を教えていたら物理の講義になりません.
したがって数学の説明は必要最小限にして話がどんどん進みます.

以上, 簡単に物理学 A のはじめの部分を書いてみました.
この時点で「数学が便利」というのはよく分からないと思いますが,
数学が必要ということは分かってもらえたと思います.
そしてこんな講義についていけるのかと思う人が大半でしょう.

例えていえば, 数学が分からないということは実験するのに実験装置の使い方が分からない,
ひどい場合は説明書すら読めない, ということです.
しかし実験装置は説明書を読むだけでなく, 実際に使いながら操作法を学んでいくものです.
数学書を (1 人で) 読み進めながら学んでいくことは非常に難しいことですが,
物理がしたくて大学に来たのですから「何のために数学をするのか」という
モチベーションが無いとどうしても途中で挫折してしまうでしょう.
ここに生じる隙間を埋めるには, 実際にいろいろ物理で遊んでみて,
どんな所でどのような数学を, どのように用いて,
何をやるのかを自分で見てくることがよいでしょう.

本書ではその一例として, 振動・波動現象の解析を実際に行ない, その中で
どのような数学がどのように現れるかを示してみたいと思います.
何故振動・波動を扱うのかというと, これが建築物の耐震性, 共振の防止などの
実用的な観点からも重要なだけでなく, 物理でも振り子の連成振動が
ニュートリノに質量があることを証明したニュートリノ振動の力学モデルであること,
電磁場が実は調和振動子の集合であることなど,
初等的な所から最先端まで, 物理学のいたるところに登場する重要なものだからです.
そして, 重要な数学もたくさん登場します.
物理・数学共にそれ程詳しく論じるスペースはありませんが,
この 2 年間の経験からこれだけあれば十分物理で遊べる,
といえるぐらいの内容は盛り込んであります.

時にはかなり細かい注がついていることがあります.
これらには (進んだ注) という,
見なくても分からなくても良い注だという印をつけておきます.
きちんと考えるとややこしいことがあるようだ, ということだけ把握してあれば十分です.
\subsection{物理で使う数学}

基本的に物理学で使う数学は, 微分・積分と線形代数です.
これらの計算と, 多少の理論を (理解できずとも) 知ってさえいれば,
物理学の中で遊びまわれます.
表題のとおり, 各分野で使う数学を列挙してみます. 大体の説明もつけます.

(一般, 古典) 力学では行列式の計算や対角化, 各種計算の為に (多変数の) 微分
積分, 現象を記述するための重要な道具である微分方程式が必要になります.

解析力学ではかなり込み入った偏微分の計算が出来なくてはなりません. 2 年
の講義では電磁場の解析力学なども扱いますが, その為にベクトル解析が使え
ると便利です.

電磁気学では何よりもまずベクトル解析を使いこなせないといけません. これは
電磁場の数学的取り扱いを非常に容易にしてくれます. 数学的・形式的な面だけ
でなく, ベクトルによる物理法則の記述は相対論的共変性という観点からみて物
理的に本質的な役割を果たします. また, Maxwell (マクスウェル) の方程式を実
際に解くことがありますが, その際に Fourier (フーリエ) 級数・ Fourier 変換が
非常に便利な道具として活躍します. 電磁気学から特殊相対性理論が生まれたわ
けですが, そこでは線形代数の理解が重要です. 〓重ね合わせ〓の理解にも線形代
数の理解が不可欠です.

熱力学では偏微分と凸関数の解析が出来ればどうにかなります.

回路理論は応物の皆さんは 2 年で必修になります. ここでは回路方程式をきちんと
扱えるようにするために, 複素数, (常) 微分方程式, Fourier 級数, Fourier 変
換, Laplace 変換が必要になります.

量子力学の基礎数理は線形代数です. 透徹とした線形代数の世界を見せられることになります.
また具体的な問題を解こうと思うと微分方程式 (Schr\"odinger 方程式) を解くことになります
が, そこでは特殊関数などを自由自在に使いこなせると便利です. これまでと異な
り, もはや厳密解を求めることが出来ないようなケースを扱うことになりますが,
そこで「摂動」という手法が出てきます. 要は近似の度合いを上げたいということ
なのですが, そこで微分積分の計算力を問われます.

統計力学では: 書きかけ.

相対性理論の一番基本的なところは線形代数と Taylor 展開 (一次近似) さえ出来れば
完璧に理解できます (100 年の記念で節目の年です. Einstein の論文を読みましょう). .
もう少し細々としたところまで扱おうとするならば,
テンソルや群論の力を借りて数学的な議論をなるべく簡単に済ませたいところです.

これだけでは実際にどういう数学をどこでどう使うのか,
ということは良く分からないでしょうが, 一年で学ぶ線形代数, 微分積分, ベクトル解析を良く使うことは分かると思います.

見た方が早いです.
実際に振動現象の解析に入ってみましょう.
\subsection{数学記号の記法}

本書では記述を簡便にするために, 数学の記法をいくつか導入します.
その中で基本的な記法と概念をいくつかここで紹介します.

作りかけ.

本書では\textbf{振動・波動現象}の解析を通じて, 数学を学んでいくことにします.
最終目標は, *Fourier (フーリエ) 解析*\footnote{簡単にいうと, 三角関数で色々な関数を展開 (近似) しよう, というものです.
三角関数は周期を持っているので, 特に周期関数の近似で威力を発揮します.}
に慣れ親しみ, きちんと使えるようになることです.
物理としては本末転倒ですが,
本書では振動・波動を次の 2 つの (線形の微分) 方程式に支配される現象であると定義します \footnote{誤解のないように言っておきますが, これらの式に従わない「波動」が存在します.
非線形波動と呼ばれる現象群がその代表です.
ソリトンだとか色々あるようです.}:
\begin{align}
 \frac{d^2 u \rbk{t} }{d t^2}
 &=
 -\omega^2 u \rbk{t} - \gamma \frac{d u \rbk{t}}{dt} , \\
 \frac{1}{v^2} \frac{\pd^2 u \rbk{ \vx , t }}{\pd t^2}
 &=
 \frac{\pd^2 u \rbk{\vx , t}}{\pd x^2} + \frac{\pd^2 u \rbk{\vx , t}}{\pd y^2} + \frac{\pd^2 u \rbk{\vx , t}}{\pd z^2}.
\end{align}
余計な項が入っていますが, 上の式 (で \$$\gamma$ = 0\$とした式) は,
高校でも学んだ\textbf{単振動の方程式}です.
下の式は, その名もずばり\textbf{波動方程式}です.

さて振動・波動を取り上げる理由ですが, これは 2 つあります.
第一に, 振動・波動は物理のなかでよく出てきます.
単振動は一つの例ですが, これは電気回路の式とも数学的に等価です.
2 つのおもりをバネでつないだモデルが,
ニュートリノに質量があることを証明したニュートリノ振動の力学モデルであること \footnote{2 年のときに筑波の高エネルギー加速研に行ったことがあるのですが,
そこの先生からこのお話を聞いたので間違いありません.
「一つのモデルでたくさんの現象が説明できるのが物理の面白いところなんだ! 」と力説していました.},
電磁場が空間の中を伝わるとき波動として伝わっていくことなど,
初歩から最先端まで, いたるところに出てきます.
実用的なところでは, 建築物の耐震性, 共振の防止を
モデル化して考えたとき. この方程式が出てきます.
もう一つは, 色々な数学が出てくることです.
これに付いては以下の本書の構成の中で説明します.

第 2 章は線形代数です.
高校でいうと, 行列とベクトルの理論です.
物理としては, たくさんの質点をバネでつなげ, この振動を調べたいと思います.
特に一般の \$n\$個の質点があるとき (これは例えば, 固体物理学で結晶の格子振動の模型として出てきます). に,
これをスマートに調べようと思うと,
線形代数の力を借りるのが便利であることが分かります.
また, あるポテンシャルが支配する質点系は,
ポテンシャルの安定点近傍で微小振動することが分かっています.
これを微分積分の章で証明するとき, ここで使った議論の助けを借ります.

他にも, 線形代数は量子力学を学ぶときに決定的に重要な役割を果たします.
ここで使われるのは, 線形代数の抽象論 (\textbf{線形空間論}) です.
本書ではここに重点を置いて議論を展開します.

最後に, 無限次元の線形代数を扱います.
これは本書の目標, Fourier 解析の舞台です.
ここで Fourier 解析の「こころ」を学ぶことにしましょう.
本書のエッセンスがここに詰まっていて, 読むのも大変と思いますが,
頑張ってついてきてください.

第 3 章は微分積分です.
物理としては, ポテンシャルの安定点近傍での微小振動を証明します.
まず復習をかねて 1 変数関数の微分を見直します.
この 1 変数の微分をもとに, 多変数関数の微分 (偏微分) を考えます.
次に積分ですが, 物理でよく出てくる 1 変数の積分の計算結果と
多変数の積分 (重積分) の変数変換を中心に扱うことにします.

第 4 章は常微分方程式論 (初期値問題) です.
単振動の方程式は高校で学んだ, としてきましたが, これを考えなおします.
物理としては, よく出てくる常微分方程式の解の性質を調べてみます.
これらに関しては, 式を見ただけで解の様子が把握できるようになってください.
数学としては, 常微分方程式の初期値問題の解の存在と一意性の議論が中心です.
簡単な解法にも触れます.

第 5 章はベクトル解析です.
物理としては, やはり電磁気学です.
いくつかの実験式から Maxwell (マクスウェルの方程式) を導出し,
これから電磁場が波として伝わることを見ます.

第 6 章は複素関数論です.
第 2 章で Fourier 解析を扱うときに\textbf\{\index{おいらーのこうしき@Euler の公式}{Euler (オイラー) の公式}\}
\begin{align}
    e^{i \theta}
    =
    \cos \theta + i \sin \theta
\end{align}
を紹介します.
これは指数関数の複素領域への拡張ですが, これが一意的であることを証明したいと思います.
他にも留数解析などの重要な計算法を紹介します.
物理として本質的なのはやはり量子力学なのでしょうが, 本書の程度を超えます.
この章は物理の色が少し薄いかもしれません.

第 7 章は偏微分方程式です.
様々な物理法則は偏微分方程式で記述されます.
学部レベルの物理で出てくるのは, ほぼ線形の偏微分方程式です,
波動方程式はもちろんこの中の 1 つです.
これらを解法を中心に説明していきます.
ここで Fourier 解析をガンガン使います.

第 8 章は群論です.
物理法則には共変性を要求するのが自然です.
この共変性は群論という数学と深く関わっていることが知られています.
これを電磁気学での Lorentz 変換と絡めて説明しようと思います.
\subsection{物理と近似: まだ書きかけ}

良い近似とは何か, みたいなことを書きたい.
まだうまくまとまらない.
節のタイトルも問題か?

本書では, 数学的に厳密な解を (主に三角関数を使って) 具体的に書き下せる物理現象しか扱いません.
これは, 物理現象を暴力的に単純化しているからです.
例を挙げましょう.
結晶を考えます.
結晶は規則正しく格子状に原子が並んでいる, というイメージを持っていると思います.
そして原子は, 格子点のまわりで熱振動しているでしょう.
温度が高くなると, 原子の熱振動の振幅が大きくなり,
最後には結合が切れて液体になると考えられます.
ここから, 結晶では原子はバネでつながっているというモデルが作れます.
このとき, バネでつなげたのは, すぐ隣の原子どうしです.

ちょっと考えると, 想像を絶する単純化をしていることが分かります.
まず, 原子を結び付けているのは Coulomb (クーロン) 力のはずですが,
これは距離の 2 乗に反比例する力です.
これをバネ (距離に比例) と近似しています.
また, Coulomb 力は遠くの原子にもはたらきますが, この効果を切り捨てています.

しかし, 実験と比較してみると, この乱暴なモデルでも定量的に精度良く説明できる現象があります.
格子振動とその量子化, フォノンといった概念を登場させ, 物理を豊かにしてくれます.
むしろ, Avogadro (アボガドロ) 数くらい原子が集まる (\textbf{多体系}) と,
少数粒子の系とは全く違うふるまいを見せてくれることを教えてくれます.

物理では, 近似はただの単純化ではありません.
色々な意味で, 1 番強烈な例は熱力学でしょう.
例えば気体の熱力学を考えます.
気体は Avogadro 数個の原子からなります.
しかし, 熱力学では Avogadro 数個の原子を直接扱う (ミクロな取り扱いをする) ことはありません.
体積, 温度, 圧力といったマクロな量だけを用いて, この大自由度の系を特徴づけできないかと考えます.
1 つ 1 つの原子を全く考えない, というある意味では暴力的な近似とも考えられます.

しかし, 熱力学は定量的にも厳密な結果が出せる, 物理の中でも 1, 2 を争うほど正確な理論です.
それだけではなく, 単純なミクロな系のあつまりではありえない不可逆過程や相転移といった現象や,
いわゆる「熱」まで含めたエネルギー保存則の拡張など,
新たな物理を見せ, 説明してくれます.
多体系での原子たちは, 少数粒子のときとは全く別の論理に従っているようです.
\section{調和振動子と線型代数}

\subsection{導入}

高校で単振動を学んだことと思います.
これは調和振動とも呼ばれます.
以下では調和振動で統一します.
調和振動の式 (運動方程式) を書くと \footnote{時間微分を  $\dot{x}(t)$ のように上に点を打つことで表します.
2 階の時間微分は  $\ddot{x}(t)$ です.},
\begin{equation}
m\ddot{x}(t) = -kx (t).
\end{equation}
そしてこの方程式 (微分方程式) の解が
\begin{equation}
x (t) = A \sin (\omega t + \phi ), \quad \omega \defeq \sqrt{ \frac{k}{m} }
\end{equation}
であることは知っているとします \footnote{微分方程式の章でもう少し詳しく触れます.}.
これから両端が壁につながった 3 本のばね定数 $k$ のばねの間に質量 $m$ のおもりが 2 つつながれている系のを調べます.
受験問題でもよく見かけるような状況です. これは固体の格子振動の模型などで重要です.
2 つのおもりの平衡点からのずれを $x_{1}(t),x_{2}(t)$ として, おもりの運動方程式を書くと \footnote{変数の時間 $t$ を書くと煩雑であり, また明らかなものなので省略しました.
よくこうした省略をします.
慣れてください.},
\begin{align}
m\ddot{x}_{1} = -kx_{1} + k (x_{2} - x_{1}) \\
m\ddot{x}_{2} = - k (x_{2} - x_{1}) - kx_{2}
\end{align}
となります. あとできちんとやりますが, 天下りに,
\begin{align}
X_{1} \defeq \frac{1}{\sqrt{2}}\left ( x_{1} - x_{2} \right) \\
X_{2} \defeq \frac{1}{\sqrt{2}}\left ( x_{1} + x_{2} \right)
\end{align}
として上の式に代入して整理すると,
\begin{align}
    m\ddot{X}_{1} &= - 3kX_{1} \\
    m\ddot{X}_{2} &= -kX_{2}
\end{align}
となり実に綺麗に分解できてしまいました.
こうすると高校でやってきたのと同じように
\begin{align}
    X_1 &= A_1 \sin \left ( \sqrt{\frac{ 3k }{m}} \, t + \phi _1 \right) \\
    X_2 &= A_2 \sin \left ( \sqrt{\frac{ k }{m}} \, t + \phi _2 \right)
\end{align}
となり,  $X_1, X_2$ の定義式から $x_1,x_2$ が求まります.
今度は同じ状況ですが, ばねが 4 つで 3 つの質点がそのばねの間につなげられている系を考えます.
先程と同様に質点の平衡点からのずれを $x_{i}\,\,,\,\,i=1,2,3$ として運動方程式は
\begin{align}
m\ddot{x}_{1} &= -kx_1 - k (x_1 - x_2 ) \\
m\ddot{x}_{2} &= + k (x_1 - x_2 ) - k (x_2 - x_3) \\
m\ddot{x}_{3} &= -kx_3 +k (x_2 - x_3 )
\end{align}
となります. またもや天下りに
\begin{align}
X_1 &\defeq \frac{1}{2} \left ( \sqrt{2}x_1 + x_2 - x_3 \right) \\
X_2 &\defeq \frac{1}{2} \left ( \sqrt{2}x_2 + \sqrt{2}x_3 \right) \\
X_3 &\defeq \frac{1}{2} \left ( -\sqrt{2}x_1 + x_2 - x_3 \right)
\end{align}
として上の式に代入して整理すると
\begin{align}
m\ddot{X}_1 &= -2X_1 \\
m\ddot{X}_2 &= -(2 - \sqrt{2}) X_2 \\
m\ddot{X}_3 &= -(2 + \sqrt{2}) X_3
\end{align}
となり, これ以降は 2 質点の時と同じです.

これをさらに $n$ 質点系へと一般化しましょう. 何故一般化するのかということは当然の疑問ですが,
上述の格子振動などでも一般には多数の質点の集まりですから, 一般の $n$ での解析が必要です.
また弾性体 (例えば弦) の振動を扱おうとすると, これは $n\rightarrow \infty$ とした極限を考えることになります.
この一般化を見通しよく行なう為に私たちは線型代数学の力を借りることになります.
2 質点ぐらいなら適当にやっていてもどうにかなりそうですが, 3 質点ではもう既になかなか
直観的にいけそうな気配がありません. 一般の $n$ 質点では適当にやってどうにかするのはとても無理そうです.
付記しておくと,  $2$ 質点系の場合の $X$ は重心座標と相対座標になっています.
つまりこれらは現象の見やすい座標系への座標系の変換であったとみなせます.
しかし $3$ 質点系では一見して良く分かる, というわけにはいきません.
こうした座標系の変換をどう見つけるかという考察をしたいというわけです \footnote{他にも線型代数は建築などで巨大行列の行列式の計算をすることがよくあるらしく,
その為の行列式の計算の効率の良いプログラミングの作成などは今でも研究対象となっているようです.}
次章では一般のポテンシャルに対し,
安定点が存在すればその近傍ではそのポテンシャルに支配された系の運動が微小振動になることを証明します.
そこへの接続に十分な範囲での議論をしなければなりませんが, それ以外にも重要なことは補足しながらいくことにします.
\subsection{記法の確認と線型写像}

いくつかの一般的な記法をまとめておきます.
今この場で覚えようとしても無理なので, 使いながら覚えていって下さい.
つまらないですが少し我慢して下さい.

数学的対象となるものの集まりを\textgt{集合}\index{しゅうごう@集合}といいます.
実数全体, 自然数全体などはいずれも集合です. 1 つの集合 $A$ があるとき,
 $A$ を構成する個々のものを $A$ の\textgt{元}\index{げん@元}(ゲンと読む) といいます.
 $x$ が $A$ の元であることを記号 $x\in A$ あるいは $A\ni x$ で表します.
集合 $A$ と $B$ があったとし,  $A$ の全ての元が $B$ の元となっているとき, すなわち任意の $A$ の元 $a$ が \$a $\in$ B \$ となるとき,
\textgt\{ $A$ は $B$ の部分集合\index{ぶぶんしゅうごう@部分集合}である\}と言い,  $A \subset B$ または $B\supset A$ と書きます.
元が 1 つもない集合も特別な集合とみなし, これを\textgt{空集合}\index{くうしゅうごう@空集合}と呼び,  $\emptyset$ と書きます.
これは任意の集合の部分集合です.


集合 $A$ が元 $x_{1},x_{2},\dots,x_{n},\dots$ からなるとき, 記号
\begin{align}
    A &= \{ x_{1},x_{2},\dots,x_{n},\dots \}  \\
    &= \{ x \, ; \, x_{n}\, , \, n\in \bm{N} \}
\end{align}
で表すことがあります. すぐあとで述べますが $\bm{N}$ は自然数の集合です.
一般にある条件 $C (x)$ を満たす元の集合を
\begin{align}
    \left \{ x \, ; \, C (x) \right \}
\end{align}
と書きます. 具体的には
\begin{align}
    \left \{ x \, ; \, x \leq 3\, , \, x \in \bm{N} \right \}
\end{align}
などです.



集合 $A,B$ があり, \textgt{写像}\index{しゃぞう@写像} \footnote{数のことだと思って下さい.
細かいことを言うと定義域, 値域が一般の集合のとき主に写像といい,
これら実数や複素数のときに主に関数というようです.}
$f$ が $A$ を定義域とし $B$ を値域とするとします.
これを
\begin{align}
f &:  A \rightarrow B \\
f &: A\ni  a \mapsto     b=f (a)\in B
\end{align}
などと書きます.
\textgt{自然数}\index{しぜんすう@自然数} \footnote{ここでは自然数は $0$ を入れます.}, \textgt{整数}\index{せいすう@整数}, \textgt{有理数}\index{ゆうりすう@有理数},
\textgt{実数}\index{じっすう@実数}, \textgt{複素数}\index{ふくそすう@複素数} \footnote{自然数, 整数, 有理数, 実数, 複素数は各々英語で natural number, integral number (integer),
rational number, real number, complex number といいます.  $\bm{N}$ ,  $\bm{R}$ ,  $\bm{C}$ はその頭文字です.}
全体の集合を各々
$\bm{N}$ ,  $\bm{Z}$ ,  $\bm{Q}$ ,  $\bm{R}$ ,  $\bm{C}$ と書きます \footnote{それぞれ手書きするときは $\mathbb{N},\mathbb{Z},\mathbb{Q},\mathbb{R},\mathbb{C}$ と書きます.}.
また\textgt{正の整数}\index{せいのせいすう@正の整数}
は
$\bbZ^+ \defeq \{ 1, 2 , \dots , \}$,
\textgt{正の実数}\index{せいのじっすう@正の実数}
は
 $b_R^+ \defeq [ 0 , \infty )$
と書くことがあります.
他にも\textgt{ $n$ 次元空間}を普通の数のように $\bm{R}$ の $n$ 乗ということで $\bm{R}^{n}$ と書きます.
あとで\textgt{複素 $n$ 次元空間} $\bm{C}^{n}$ も使います.
さらに, \textgt{ $n\times m$ 複素行列全体の集合}を $M \left ( n,m \, ;\bm{C}^n \right)$ と書きます.

ここからは行列の記法の確認です. 特に行列式のところで証明を含めて大体のことを 3 次正方行列について書きます \footnote{正確には $n$ 次元でも同じように出来るけれども, 一般的に行なうのが非常に面倒な場合に 3 次でやります.
次元による面倒が全く無いような場合がありますから, そういう場合に $n$ 次で書くことがあります.}.
2 次だと単純すぎていろいろ簡単になってしまっていることがあり,
4 次以上は書くのが面倒だからです.
証明については一般の $n$ 次でも成立するようなものをつけます.
まず $A$ を 3 次正方行列としその $(i,j)$ 成分を $a_{ij}$ としましょう. このとき, 行列 $A$ を次のように書きます.
\begin{align}
    A = (a_{ij})
    = \begin{pmatrix} a_{11} & a_{12} & a_{13} \\ a_{21} & a_{22} & a_{23} \\ a_{31} & a_{32} & a_{33} \end{pmatrix}
    = \begin{pmatrix} \bm{a}_{1} & \bm{a}_{2} & \bm{a}_{3} \end{pmatrix} \\
\intertext{ただし}
    \bm{a}_{1} = \begin{pmatrix} a_{11} \\ a_{21} \\ a_{31} \end{pmatrix} ,
    \bm{a}_{2} = \begin{pmatrix} a_{12} \\ a_{22} \\ a_{32} \end{pmatrix} ,
    \bm{a}_{3} = \begin{pmatrix} a_{13} \\ a_{23} \\ a_{33} \end{pmatrix} .
\end{align}

また, 適当な場所もないようなので, この場で
\textgt{ $n$ 項単位ベクトル}\index{えぬこうたんいべくとる@ $n$ 項単位ベクトル}を導入しておきます.
 $n=3$ として書くと
\begin{align}
    \bm{e}_{1} \defeq
        \begin{pmatrix} 1 \\ 0 \\ 0 \end{pmatrix} ,\,
    \bm{e}_{2} \defeq
        \begin{pmatrix} 0 \\ 1 \\ 0 \end{pmatrix} ,\,
    \bm{e}_{3} \defeq
        \begin{pmatrix} 0 \\ 0 \\ 1 \end{pmatrix} \, .
\end{align}

\textgt{単位行列}\index{たんいぎょうれつ@単位行列}を $I$ と書くことにしますが,
ついでに\textgt{Kronecker (クロネッカー) の $\delta$ }\index{くろねっかーのでるた@Kronecker の $\delta$ }と呼ばれるもの
を定義します. これは
\begin{align}
    \delta _{ij} \defeq \begin{cases} 1 & i = j \\
0 & i \not = j
\end{cases}
\end{align}
というもので, これを使うと単位行列は $I = (\delta _{ij})$ と書けます.
零行列\index{ぜろぎょうれつ@零行列}は $O$ と書きます.

単位行列を定義したので次は逆行列\index{ぎゃくぎょうれつ@逆行列}を定義しておきましょう.
ある行列 $A$ に対し $X$ という行列が存在して $AX = I$ となったとしましょう. このとき $X$ を\textgt{右逆行列}と呼びます.
左逆行列も同様に定義します. 有限次行列 \footnote{次元についてはあとできちんと述べます.}
の場合, 片方の逆行列が存在するともう片方の逆行列が存在して, この 2 つが一致します.
実際,  $X$ を $A$ の右逆行列,  $Y$ を $A$ の左逆行列とすると
\begin{align}
    X = IX = (Y A) X = Y (A X) = Y I = Y \,\, . \,\, \blacksquare
\end{align}
また逆行列が存在する行列のことを\textgt{正則行列}\index{せいそくぎょうれつ@正則行列}\index{せいそく@正則}といいます.
次に高校で学ばなかったと思いますが, \textgt{転置行列}\index{てんちぎょうれつ@転置行列} ${^t}A$ というものがあります. これの定義は
\begin{align}
    {^t}A \defeq (a_{j i})
    = \begin{pmatrix}
        a_{11} & a_{21} & a_{31} \\
        a_{12} & a_{22} & a_{32} \\
        a_{13} & a_{23} & a_{33}
    \end{pmatrix}
\end{align}
です. 元の行列の\textgt{行と列をひっくり返したもの}です.

書き忘れていましたが一般にベクトルは全て列ベクトルとします. 行ベクトルはあまり使わないのですが,
スペースの関係もあって使いたいことがありますから, その為に今の転置の記法を流用します. またこれを用いて以下のように
転置行列を書くことがあります.
\begin{align}
    {^t}\bm{a}_{1} \defeq \begin{pmatrix}  a_{11} \, a_{21} \, a_{31} \end{pmatrix}
    {^t}\bm{a}_{2} &\defeq \begin{pmatrix}  a_{12} \, a_{22} \, a_{32} \end{pmatrix}
    {^t}\bm{a}_{3} \defeq \begin{pmatrix}  a_{13} \, a_{23} \, a_{33} \end{pmatrix} \\
    {^t}A &= \begin{pmatrix} {^t}\bm{a}_{1} \\ {^t}\bm{a}_{2} \\ {^t}\bm{a}_{3}\end{pmatrix} .
\end{align}

転置行列と元の行列が一致する行列, すなわち $^{t} A = A$ となる行列を\textgt{対称行列}\index{たいしょうぎょうれつ@対称行列}といいます.
一番初めに見せた運動方程式を行列でまとめたときに出てくるのは対称行列です. 実際に書いてみると分かります.
\begin{align}
    m\ddot{x}_{1} &= -kx_1 - k (x_1 - x_2 ) \notag \\
    m\ddot{x}_{2} &= + k (x_1 - x_2 ) - k (x_2 - x_3) \notag \\
    m\ddot{x}_{3} &= -kx_3 +k (x_2 - x_3 )  \notag \\
    \Longleftrightarrow
    m \begin{pmatrix} \ddot{x}_{1} \\ \ddot{x}_{2} \\ \ddot{x}_{3} \end{pmatrix}
    &= -k \begin{pmatrix} 2 & -1 & 0 \\ -1 & 2 & -1 \\ 0 & -1 & 2 \end{pmatrix}
    \begin{pmatrix} x_{1} \\ x_{2} \\ x_{3} \end{pmatrix} \notag
\end{align}

あとで少し使うので対称行列の性質を 1 つ証明しておきます. それは $^{t}(AB) =\, ^{t}B \, ^{t}A$ という性質です.
具体的に両辺を計算するとすぐ分かります. やってみましょう.

(証明) $A=(a_{ij})$ という書き方を使います.
記述の便宜を図るため,  $^{t}A = (a_{j i}) = (^{t}a_{ij})$ という記法も一時的に使います.
\begin{align}
    {^t}(AB)
    = {^t} \left ( \sum_{k=1}^3 a_{i k}b_{k j} \right)
    = \left ( \sum_{k=1}^3 a_{j k}b_{k i} \right)
    = \left ( \sum_{k=1}^3 {^t}b_{i k} {^t}a_{k j} \right)
    = {^t}B {^t}A \blacksquare
\end{align}

あともう 1 つ転置について重要なものとして\textgt{直交行列}\index{ちょっこうぎょうれつ@直交行列}というものがあります.
これは $^{t}U U=I$ となるような行列のことです.
すなわち $^{t}U = U^{-1}$ ということです.


複素行列 $A$ の\textgt{共役}をとる操作を普通の複素数のとき同様に $\overline{A}$ と上にバーを書くことで
表します.
これにより, \textgt{随伴行列}\index{ずいはんぎょうれつ@随伴行列} $A^{*}$ を
\begin{equation}
    A^{*} \defeq {^t}\overline{A}
\end{equation}
と定義します. ここで先程の対称行列・直交行列に対応するものがありますから, それを定義しておきましょう.
 $A^{*}=A$ となる行列を\textgt{Hermite (エルミート) 行列}\index{えるみーとぎょうれつ@Hermite 行列},
 $A^{*}A = I$ となる行列を\textgt{ユニタリ行列}\index{ゆにたりぎょうれつ@ユニタリ行列}と呼びます.



また\textgt{対角行列}\index{たいかくぎょうれつ@対角行列}なるものがあります.
一般に $a_{ii}$ の形の成分を\textgt{対角成分}\index{たいかくせいぶん@対角成分}といいます.
対角行列というのは対角成分しか持たない行列のことです.
すなわち $A = (a_{i} \delta _{ij} )$ という行列です. はじめに書いた運動方程式
を $X$ で書き直したものを行列で表現すると対角行列になります.
\begin{align}
    m \begin{pmatrix} \ddot{X}_{1} \\ \ddot{X}_{2} \\ \ddot{X}_{3} \end{pmatrix}
    &= -k \begin{pmatrix} 2 & 0 & 0 \\ 0 & 2- \sqrt{2} & 0 \\ 0 & 0 & 2 + \sqrt{2} \end{pmatrix}
    \begin{pmatrix} x_{1} \\ x_{2} \\ x_{3} \end{pmatrix} \notag
\end{align}

次に\textgt{上三角行列}\index{うえさんかくぎょうれつ@上三角行列}を定義します.
上三角行列というのは行列の対角成分より下,  $a_{ij}$ の $j< i$ となるところが
 $0$ となる行列です. 具体的にこう書くと分かるでしょう.
\begin{align}
    \begin{pmatrix} a_{11} & a_{12} & a_{13} \\
                    0 & a_{22} & a_{23} \\
                    0 & 0 & a_{33}
    \end{pmatrix}
\end{align}
\textgt{下三角行列}\index{したさんかくぎょうれつ@下三角行列}も同様に定義します.

行列 $A$ が\textgt{正規行列}\index{せいきぎょうれつ@正規行列}であるということを次の式で定義します.
これは対角化のところで用います.
\begin{align}
    AA^{*} = A^{*}A
\end{align}
上の条件は $A$ と $A^{*}$ が交換可能であるということであり, \textgt{Hermite 行列やユニタリ行列はこれを満たします}.
行列が Hermite, ユニタリであるというのはそれぞれ $A^{*}=A$ ,  $A^{*} = A^{-1}$ が成立するということでした.
実数の範囲で考えれば, これは対称行列・直交行列のことです.

次は\textgt{部分 (線型) 空間}\index{ぶぶんくうかん@部分空間}という概念です.
 $W$ が $\bm{C}^n$ の部分空間とすると,
任意の $W$ の元 $\bm{x},\bm{y}$ と任意の複素数 $\alpha,\beta$ に対し
\begin{align}
    \alpha \bm{x} + \beta \bm{y} \in W
\end{align}
が成立します. これだけ分かりづらいでしょうが, 具体例としては $\bm{R}^3$ 内の平面や直線などです.

重要な注意ですが, \textgt{部分集合とは違います}.
例えば平面内の半径 1 の円板は部分集合ですが, 部分空間ではありません.
 $\bm{x}$ を円板内の任意のベクトルとしましょう.
 $\alpha \geq 1/\mid \bm{x} \mid$ としてみましょう. この $\alpha$ に対し $\alpha \bm{x}$ は円板内に
いません. 平面内の線分などでも駄目です. 円板内の場合と同じようにある程度大きい値に対してはみだしてしまいます.
ここから考えて, 部分空間というのはかなり大きい集合であることが分かります.

また\textgt{部分空間 $W_1,W_2$ が直交する}というのは任意の $\bm{x}_1 \in W_1,\bm{x}_2 \in W_2$ が直交することを言います.
さらに部分空間 $W_1$ の\textgt{直交補空間}\index{ちょっこうほくうかん@直交補空間}を $W^{\perp}$ \footnote{気軽に空間と書きましたが, これは本当に部分空間になっているでしょうか?
$\bm{x},\bm{y} \in W^{\perp},\, \bm{z} \in W$ としましょう.
$(\alpha \bm{x} + \beta\bm{y},\bm{z}) = \alpha (\bm{x},\bm{z}) + \beta (\bm{y},\bm{z}) =0$
で, 確かに部分空間になっています.}
とすると,  $W^{\perp}$ とは
 $W_1$ と直交する元全ての集合です.
さらに\textgt{ $W$ が $W_1$ と $W_2$ の直和}\index{ちょくわ@直和}であるとは,  $W = W_1 \cup W_2$ であって
かつ $W_1 \cap W_2 = \{ \bm{0} \}$ となることをいいます.
このとき $W = W_1 \bigoplus W_2 = W_1 \amalg W_2$ などと書きます.

以上でつまらない定義の羅列は一旦終わりです.
ここから少し線型代数の説明に入ります.

線型代数で重要な概念の 1 つに \textbf{線型写像} があります.
それでは線型写像の説明を, と行きたいところですが
その前に\textgt{関数}\index{かんすう@関数}と\textgt{関数値}\index{かんすうち@関数値}の区別をはっきりさせておきます.
\begin{align}
1 \longrightarrow 1 ,\,\,\, 2 \longrightarrow 4 ,\,\,\, 3 \longrightarrow 9
\end{align}
という対応関係があったとしましょう. 矢印の左にある数字が右側では 2 乗されています
このときの対応を関数の形で書くと当然 $y = f (x) = x^{2}$ となります.
関数値というのは\textgt{ $x$ に対して対応させられている値 $y=f (x)$ }のことです. それでは関数は, というと,
\textgt{この対応関係を与えるもの}であり,  $f$ が関数です.
また, 上の式を\textgt\{実数 $x$ に関数 $f$ が作用して実数 $x^{2}$ になった\}と読んでもいいでしょう.
このとき関数 $f$ に\textgt{作用}という視点が与えられます.
ここからこのような対応 $f$ を\textgt{作用素}\index{さようそ@作用素}と呼ぶことがあります.
「作用」を与える「素」だから「作用素」です
あるものが何らかの作用を受けると当然何か他のものに変わります.
つまり作用は\textgt{変換}\index{へんかん@変換}ということもできます.
こうした言い換えは良く使いますから, 慣れ親しんでおいて下さい.

現時点で関数と関数値の
区別の重要性を理解するのはなかなか難しいと思います. 3 年で学ぶ (人もいる) Lebesgue 積分論や関数解析学において
関数を元とする集合 (関数空間) を考えねばならなくなりますが, そのときにこの区別をきちんとする必要がでてきます.
要するに量子力学の数理です.
あとで関数と関数値の区別の為の具体例を出します.

さて, ここからやっと線型写像です.  $f$ を $\bm{R}^{n}$ から $\bm{R}^{m}$ への写像 (関数) であるとしましょう.
この $f$ が\textgt{線型写像}\index{せんけいしゃぞう@線型写像}であるというのは次の 2 つの性質が成立することを言います.
\begin{align}
    f ( x + y ) &= f (x) + f (y) \\
    f ( \alpha x ) &= \alpha f (x) ,\,\alpha \in \bm{R} \\
    \intertext{またはこれらを一本にまとめて}
    f ( \alpha x + \beta y ) &= \alpha f (x) + \beta f (y) ,\, \alpha , \beta \in \bm{R} .
\end{align}
ここで $\alpha \in \bm{R}$ というのは $\alpha$ が実数であることを表すのでした.
まず $f$ を $\bm{R}^{1}$ から $\bm{R}^{1}$ への写像, すなわち高校で学んできた普通の関数である場合で
この定義が何を言っているのかを見てみましょう. 線型写像の名が示すとおり, このとき $\alpha$ を適当な実数とすると
$f$ は $f (x) = \alpha x$ という対応を与える一次関数 (直線!) です \footnote{(進んだ注)
$f$ が連続であるとき, 上の条件を満たす関数が本当に一次関数しかないことが実数の連続性を用いて証明されます.
$f (1)=3$ などという適当な条件をつけると, 定数 $\alpha$ までが完全に決定できます. 証明は島内剛一, 「数学の基礎」, 日本評論社,
p445- を参照して下さい.
大略を述べると, 自然数に対して成立することを述べたのち, 整数に拡大して, さらに有理数に拡大し,  $f$ の連続性から実数に拡大します.}.
線型写像の「線型」たる所以が分かったかと思います. 一般の $n,m$ に対しては適当な行列 $A$ を選ぶと
$\bm{y} = A \bm{x}$ と書けます.
実数を 1 次正方行列とみなせば, 自然な一般化になっていることが分かります.

すぐあとで使う一般の写像 (関数) に対する性質も述べておきます.
 $f (x,y)=-f (y,x)$ という性質を満たす写像のことを\textgt{交代性がある}\index{こうたいせい@交代性}といいます.
例えば $f (x,y)=x-y$ が一番分かりやすいでしょうか. 高校で学んだ二次の行列の行列式にもこの交代性があります.

線型写像と行列には密接な関連があることさえ把握しておけば, 今は十分です.
細かいことは気にせず今は突っ走ってみましょう.
\subsection{線型空間の導入\label{線型空間の導入}}

\subsubsection{物理法則とベクトル}

本章は主に行列に関することを述べるのですが, その前に
線型代数で最も重要な概念である\textgt{線型空間 (ベクトル空間)}について議論することにします.
現段階では振動・波動との直接の関係は少し薄れますが,
これは量子力学の数理の基礎となる非常に重要なものであり,
そこまで行かずとも物理学にとって基本的で重要な概念です.

私達が物理学を学ぶ, 研究するというとき中心となるのは,
やはり\textgt{物理法則}\index{ぶつりほうそく@物理法則}に関する理解・考察を深めることでしょう.
しかし物理法則というものは一体何のことを指すのでしょうか?
抽象的な言い方になってしまいますが,
これは\textgt{人間が何らかの形で自然を理解できたとき, それを言葉や数式 (方程式) で表現したもの}とでも表現できるでしょう.
今考えたいのは, 「数式で表現」という部分です.
物理学に限らず自然科学の理論は実験結果との整合性がなければなりません.
また実験結果というとき, 例えば同じ日の同じ時間に日本で彗星の運動を観察した結果とアメリカで彗星の運動を観察した結果や,
適当に条件を合わせたときにある日に実験した結果とその 3 ヵ月後に実験した結果などが一致するようなものでないと困ります.
ある理論が自然現象を記述できているというならば, この実験結果が再現できなければなりません.
つまり適当な条件が満たされている限り,
任意の観測時間のずれと観測点のずれに対して, 同じ実験結果を与えられるようなものでなくてはなりません.\footnote{もっと上手い言い方を模索中.
そしてこれは私自身指摘されて気づいたことですが, 観測時間・観測点のずれに対して同じ結果を与える
ということと, 任意の時間と位置で成立するということは違います.}

これは物理法則と呼ばれるものの性質を規定する条件です.
つまり物理法則は, 現象を観測する時間と位置によらず成立するべきである
ということです.
物理法則は方程式で表現されることがありますが, 当然この方程式自体も観測する位置と時間によらず
成立するようなものでなければいけません.
こうなると実際に我々が物理法則を方程式の形にするとき, 方程式に対して何らかの制限を加えないといけません.
その制限とは何かを考えます.
私達は物理現象を調べる際に直交座標・極座標など様々な座標系 (基底) を用いますが,
物理法則そのものの意味が座標系によって変わってもらっては困ります.
ここで「意味が変わらない」ということをきちんと考える必要があります.
例えば運動方程式は言葉で書けば「運動量の時間変化は加わる力に比例し, この力の方向に起こる」ということであり,
数式で書けば
 $m \ddot{ \bm {r} } = \bm{f}$
と定式化されます.
具体的な座標系で加速度 $\ddot{ \bm {r} }$ を考えましょう.
これを直交座標で表現するか極座標で表現するかで
\begin{align}
    \ddot{ \bm {r} }
    =
    \begin{pmatrix}
        \ddot{x},\ddot{y},\ddot{z}
    \end{pmatrix}
    =
    \begin{pmatrix}
        \frac{d v} {dt},\frac{v^2} {\rho },0
    \end{pmatrix}
\end{align}
のように加速度の「表現」の仕方が変わりますが, 加速度であることそのものは変化しません.
この例で重要なのは, \textgt{運動方程式自体は具体的な座標表示によらずに書かれている}ということです.
また一般に質量, 加測度, 力のような物理的に意味のある量を\textgt{物理量}\index{ぶつりりょう@物理量}と呼びますが, 物理法則は何らかの形で
これら物理量の間の関係を述べたものとして定式化されるでしょう.
上の例を見ればこれら物理量自体が具体的な座標によらずに書かれています.
そうするとそもそも物理的に意味のある量 (物理量) とは具体的な座標表示によらない意味を持つものである,
ということまで要求しなければならないかもしれません.

以上のような考察を経て, 物理法則に対して以下のような要請をします.
\begin{req}
ある方程式がどの慣性系で見ても同じ形の方程式を満たすとき,
その方程式は座標の変換に対し\textgt{共変性を持つ}\index{きょうへんせい@共変性}という.
全ての物理法則は共変性を持つ.
\end{req}
この要請に沿えば物理法則が物理量の間の関係である以上, \textgt{物理量も共変性を持たねばなりません}.
私達はこれら物理法則を実際に方程式にしなければならないのですが, その際
\textgt{自動的に共変性が満たされているような上手い数学的な表現法}があれば非常に便利です.
答から言うならば, それは\textgt{ベクトル}(一般にはテンソル) によって物理法則を表現すれば良いことが分かっています.
\subsubsection{抽象ベクトル}

ここでベクトルについて考察を深めます.
上で「物理現象を調べる際に様々な座標系を用いる」と書きましたが,
ベクトルによる物理法則の記述が座標系によらない意味を持つならば,
ベクトルという概念自体座標系によらないものでなければいけません.
つまりベクトルは\textgt{座標系とは関係なく存在}するものであるべきです.
ここで座標系の入っていない, ベクトルのみが存在する空間を\textgt{(抽象) ベクトル空間}と呼び,
これを $V$ と書きましょう.
これは法則が成立するべき空間 (抽象ベクトル空間) と,
私達が実際に現象の解析を行なう空間をはっきり区別した, ということです.
ここまでは抽象ベクトルという言葉の意味 (抽象ベクトルの定義) をはっきりさせていません.
これから抽象ベクトルの持つべき性質を考え, 矛盾のないような抽象ベクトルの理論を作ります.
重要なのは抽象ベクトルとは何か, 抽象ベクトルがどんな性質を持っていて欲しいのかは
\textgt{自分で考えて自分で決めるものであり, また決めてよい}ということです.

まず記述に必要な言葉を用意します.
高校までは平面 (空間) 上の点を表すのに $x y$ -平面というものを考えていました.
これと対応する形で, 現象を調べる際には適当に座標原点を取った上で $x$ 軸や $y$ 軸,  $z$ 軸を設定していました.
このとき, 空間内のある点 $\bm{r}$ の座標が $(x,y,z)$ であるというのは,
\begin{align}
    \bm{e}_1
    =
    \bm{e}_x
    =
    \begin{pmatrix}
        1 \\ 0 \\ 0
    \end{pmatrix},
    \quad
    \bm{e}_2
    =
    \bm{e}_y
    =
    \begin{pmatrix}
        0 \\ 1 \\ 0
    \end{pmatrix},
    \quad
    \bm{e}_3
    =
    \bm{e}_z
    =
    \begin{pmatrix}
        0 \\ 0 \\ 1
    \end{pmatrix}
\end{align}
としたとき,
\begin{align}
    \bm{r}
    =
    x \bm{e}_1 + y \bm{e}_2 + z \bm{e}_3
\end{align}
と表せる, ということです.
このとき,
$\langle \bm{e}_1 , \bm{e}_2, \bm{e}_3 \rangle = \langle \bm{e}_i \rangle _{i=1}^3$
を\textgt{座標系 (基底)}, $x,y,z$ を (座標系に対する)\textgt{座標 (座標成分)}といいます.
このとき上の $\bm{r}$ が (抽象) ベクトル空間の元であるとすると,
これを適当な座標系で表現した右辺は普通の空間ベクトルです.
空間ベクトルには自然に備わった (高校で学んだ) 和 (差) とスカラー倍 (定数倍) という演算があります.
右辺の空間ベクトルが和とスカラー倍のできるものである以上, 左辺も和とスカラー倍ができないといけません.
数学者が色々解析した結果, 以下の 8 つの代数的な関係式が満たされていれば
いかなるベクトルの和とスカラー倍も普通の空間ベクトルと同じように成立することが分かりました.
これが抽象ベクトルの代数です.
\begin{enumerate}
\item  $\bm{x} + \bm{y} = \bm{y} + \bm{x}$
\item  $(\bm{x} + \bm{y} ) + \bm{z} = \bm{x} + ( \bm{y} + \bm{z})$
\item 全ての $\bm{x}$ に対し,  $\bm{x} + \bm{0} = \bm{x}$ を満たすベクトル $\bm{0}$ がただ 1 つ存在する.
\item 全ての $\bm{x}$ に対し,  $\bm{x} + \bm{x}' = \bm{0}$ を満たすベクトル $\bm{x}'$ がただ 1 つ存在する.
\item  $1\bm{x} = \bm{x}$
\item  $\alpha (\beta \bm{x}) = (\alpha \beta) \bm{x}$
\item  $\alpha (\bm{x} + \bm{y} ) = \alpha \bm{x} + \alpha \bm{y}$
\item  $(\alpha + \beta ) \bm{x} = \alpha \bm{x} + \beta \bm{x}$
\end{enumerate}

これで抽象ベクトルの代数的な性質を確立しました.
その他に現象の解析に必要なのは, ベクトルの\textgt{長さ}と 2 つのベクトルのなす\textgt{角度}です \footnote{例えば万有引力は 2 点の距離の 2 乗に反比例します.
角度についてはフレミングの左手の法則など, 各種「向き」の関わる法則を記述する際に重要です.}.
高校ではこれらが\textgt{内積}を用いて表現できることを学びました.
ただし高校では
 $\bm{x} = x_1 \bm{e}_1 + x_2 \bm{e}_2 + x_3 \bm{e}_3$ ,
 $\bm{y} = y_1 \bm{e}_1 + y_2 \bm{e}_2 + y_3 \bm{e}_3$
としたときの
\begin{align}
    \bm{x} \cdot \bm{y}
    = ( \bm{x} , \bm{y} )
    = x_1 y_1 + x_2 y_2 + x_3 y_3
\end{align}
という形の内積しか考えていません.
これを座標系 (と原点) に依存しない形で書くことを考えなければいけません.
このためには内積で表現すべき, 長さと 2 つのベクトルのなす角度を基点にします.
長さ・角度共に\textgt{どの座標系を取るかに関わらず一定}であってもらわないと困ります.
特に長さは自分自身との内積 $(\bm{x},\bm{x})$ で表現されますが, この値が必ず正になってもらわないと困ります.
具体的な座標系を取ったときに内積に必要な演算が全て正当化されねばならないという要請をしたとき,
内積の性質は次のように規定すればよいことが分かっています.
\begin{enumerate}
    \item[1)] $( \bm{x} , \bm{x} ) \geq 0$
    \item[2)] $( \bm{x} , \bm{x} ) = 0 \Longleftrightarrow \bm{x} = \bm{0}$
    \item[3)] $( \bm{x} , \bm{y} ) = ( \bm{x} , \bm{y})$
    \item[4)] $(\alpha \bm{x}_1 + \beta \bm{x}_2 , \bm{y} ) = \alpha ( \bm{x}_1 , \bm{y} ) + \beta ( \bm{x}_2 , \bm{y} )$
\end{enumerate}
ただしこれで本当に抽象ベクトルの長さと 2 つの抽象ベクトルのなす角度が座標系と原点によらず定まるのか, というのは当然の疑問です.
そして単に変換というとき, 数学的にはスカラー倍といった変換も含みますが,
この変換に対して 2 つのベクトルのなす角度が不変であっても\textgt{長さは変わる}というのは直観的に分かるでしょう.
長さ・ 2 つのベクトルのなす角度を\textgt{同時に}不変にする変換それ自体も考察しないといけません.
少し話が本筋からそれてしまいますが, 先にこれを考えます.
まず変換というものは, 何らかの作用を受けた結果であると考えることができます.
\textgt{作用は適当な写像 (関数) で表現できる}ということを前節で説明しました.
長さ, 角度を同時に不変にする変換は特殊な\textgt{線型変換}\index{せんけいへんかん@線型変換}で表現できます.
線型変換とは線型写像で表される変換です.
また\textgt{線型写像は行列で表現出来る}ということが証明できます.
定理の証明前に予備考察を行ないます.
まず長さを変えてはいけないので, いわゆる拡大・縮小に対応する変換ではいけません.
そのほか角度というところから回転という変換が思いつきます.
実際この\textgt{回転}\index{かいてん@回転}が長さと 2 つのベクトルのなす角度を変えない変換です.
拡大・縮小のない回転で長さは当然不変であり,
同時に同じだけ 2 つのベクトルを回転させれば角度も当然変換に対して不変になります.
\subsubsection{回転の表現}

そこでこれから回転を数理的に定式化します.
下調べとして平面で考えましょう.
角度 $\theta$ だけ回す回転を表す写像を $R$ とし, 適当に $\bm{x} , \bm{y} \in \bbR^2$ を考えます.
標準基底に関して $R$ を行列 $\hat{R}_{\theta}$ で表現すると
\begin{align}
    \hat{R} _{ \theta }
    =
    \begin{pmatrix}
        \cos \theta & \sin \theta \\
        -\sin \theta & \cos \theta
    \end{pmatrix}
\end{align}
となります.
これから
\begin{gather}
    \hat{R} _{ \theta } \bm{x}
    =
    \begin{pmatrix}
        x_1 \cos \theta + x_2 \sin \theta \\
        -x_1 \sin \theta + x_2 \cos \theta
    \end{pmatrix}
    , \quad
    \hat{R} _{ \theta } \bm{y}
    =
    \begin{pmatrix}
        y_1 \cos \theta + y_2 \sin \theta \\
        -y_1 \sin \theta + y_2 \cos \theta
    \end{pmatrix} \\
    \hat{R} _{ \theta } ( \bm{x} + \bm{y} )
    =
    \begin{pmatrix}
        ( x_1 + y_1 ) \cos \theta + (x_2 + y_2) \sin \theta \\
        -( x_1 + y_1 ) \sin \theta + ( x_2 + y_2 ) \cos \theta
    \end{pmatrix}
\end{gather}
と書けます.
これから平面の場合には回転が行列で表示でき, したがって線型写像で表現できることが分かります.
ここでは省略しますが, 一般の次元でも同様に示せます.
そこで問題は回転がどのような行列で表現できるか, というところです.
結果からいうと, これは\textgt{直交行列}\index{ちょっこうぎょうれつ@直交行列}です.
これを証明します.
証明自体は一般の (複素化した) ユニタリ行列に対して行ないます.
ここで複素ベクトルを考えたときの内積は $( \bm{x} , \bm{y} ) \defeq \sum_{i=1}^3 x_i \overline{y}_i$
で定義します.

\begin{thm}
 $n$ 次正方行列 $A$ に関する次の 4 条件は同値である.
\begin{enumerate}
    \item[1)] $A$ はユニタリ行列である.
    \item[2)] 任意の $n$ 項 (複素) 列ベクトル $\bm{x}$ に対して $| A\bm{x} | = | \bm{x} |$ が成立する.
    \item[3)] 任意の $n$ 項 (複素) 列ベクトル $\bm{x},\bm{y}$ に対して $(A\bm{x},A\bm{x})=(\bm{x},\bm{y})$ が成立する.
    \item[4)] $A=(\bm{a}_1,\dotsb,\bm{a}_n)$ とすれば,  $(\bm{a}_i,\bm{a}_j)=\delta_{ij}$ である.
\end{enumerate}
\end{thm}
(証明) 1) $\Rightarrow$ 2)
 $|A\bm{x}|^2 = ( A \bm{x} , A \bm{x} ) = {^t} \bm{x} {^t} A \overline{A} \overline{\bm{x}} = {^t} \bm{x} \bm{x} = |\bm{x}|^2$ .

\begin{enumerate}
\item $\Rightarrow$ 3) 仮定より次の式が成立します.
\begin{align}
    |\bm{x}+\bm{y}|
    &=
    |\bm{x}|^2 + (\bm{x},\bm{y}) + \overline{(\bm{x},\bm{y})} + |\bm{y}|^2\\
    |A (\bm{x}+\bm{y})|
    &=
    |A\bm{x}|^2 + (A\bm{x},A\bm{y}) + \overline{(A\bm{x},A\bm{y})} + |A\bm{y}|^2
\end{align}
\end{enumerate}
これと条件 2) から, $(\bm{x},\bm{y}) + \overline{(\bm{x},\bm{y})}=(A\bm{x},A\bm{y}) + \overline{(A\bm{x},A\bm{y})}$
が成立し, したがって $(\bm{x},\bm{y})$ と $(A\bm{x},A\bm{y})$ の実部が
等しいことが分かります.
一方,  $\bm{x}$ の代わりに $i\bm{x}$ を代入すれば,
$i\{(\bm{x},\bm{y})-\overline{(\bm{x},\bm{y})}\}=i\{(A\bm{x},A\bm{y}) - \overline{(A\bm{x},A\bm{y})}\}$
によって $(\bm{x},\bm{y})$ と $(A\bm{x},A\bm{y})$ は虚部も等しいことが分かります.
したがって $(A\bm{x},A\bm{x})=(\bm{x},\bm{y})$ .

\begin{enumerate}
\item $\Rightarrow$ 1) 任意の $\bm{x},\bm{y}$ に対して
\end{enumerate}
\begin{align}
 (\bm{x},(A^*A-I)\bm{y})
 =
 (\bm{x},A^*A\bm{y})-(\bm{x},\bm{y})
 =
 (A\bm{x},A\bm{y})-(\bm{x},\bm{y})
 = 0.
\end{align}
したがって $A^*A-I=O$ となります.

\begin{enumerate}
\item $\Leftrightarrow$ 4)
\end{enumerate}
$A^*A=(c_{ij})$ とすれば $c_{ij}=\overline{(\bm{a}_i,\bm{a}_j)}$ であり,
これから同値はすぐ分かります.  $\blacksquare$

この定理によって長さと 2 つのベクトルのなす角度を変えない変換,
すなわち回転は直交行列で表現できることが分かりました.
上で述べたように行列の作用は線型写像に翻訳できます.
線型写像は行列と異なり, 座標系の取り方に依存しません.
ここで一般に, 内積を変えない, つまり
$( T_O ( \bm{x} ) , T_O ( \bm{y} ) ) = ( \bm{x} , \bm{y} )$ となる
線型変換  $T_O$  を\textgt{直交変換}\index{ちょっこうへんかん@直交変換}と呼びます.
\subsubsection{Galilei の相対性原理}

ここで物理法則の記述という問題に帰ります.
現象の解析を行なう際には適当な座標系 (と座標原点) を取ると書きました.
さらにはじめにも例を挙げたように, 現実には時間原点の設定もしないといけません.
時間も含め座標系の選択にはかなりの自由度がありますから, これら異なる座標系の間の変換則が欲しいところです.
抽象的に物理法則, といっていてもはじまらないので,
ここでは力学の基本法則たる\textgt{運動方程式}とこれを不変にする変換を考えます.
力学は大概のことが運動方程式から導かれるので, 運動方程式の
\textgt{形不変性}\index{かたちふへんせい@形不変性}(form invariance) が最も重要です.

考えるのが座標系と時間の変換ですから, まず Newton 力学の基礎にある
時空間に関する概念を確認しなければなりません.
1 つ言葉を定義しておきます.
物理現象は常にある時にある場所で起こります.
ある時刻に空間の 1 点で起こる出来事を\textgt{事象}\index{じしょう@事象}と呼びます.
\begin{enumerate}
    \item[1)] 任意の 2 個の事象の時間間隔はどの座標系で見ても同一である.
    \item[2)] 任意の 2 個の同時刻の事象の間の距離はどの座標系で見ても同一である.
\end{enumerate}
性質 1) は座標系 $S$ と $S'$ のそれぞれと共に動く時計で測定された任意の事象 A, B の
時間間隔が $t_B - t_A = t'_B - t'_A$ であることを意味しています.
これが常に成立する為には
\begin{gather}
    \varDelta t'
    =
    \varDelta t
    \Longleftrightarrow
    t'
    =
    t - \theta \,\,\, ( \theta = \mathrm{const.} )
\end{gather}
でなければなりません.
ここから $\varDelta t' = 0 \Leftrightarrow \varDelta t =0$ となり,
2 つの事象の同時性は座標系の選択に依存しません.
後でも使いますが, このとき微分作用素 $d/dt$ は
\begin{gather}
    \frac{d} {dt}
    =
    \frac{dt'} {dt} \frac{d} {dt'}
    =
    \frac{d} {dt'}
\end{gather}
という変換を受けます.

同様に性質 2) は事象 A, B が同時刻であるとき,
その間の距離が
 $| \bm{r}_A - \bm{r}_B | = | T_O ( \bm{r}_A ) - T_O ( \bm{r}'_B ) | ( = | \bm{r}'_A - \bm{r}'_B | )$
であることを意味します.
これが常に成り立つ為には, 上で示したように直交変換 $T_O$ を用いて
\begin{gather}
    \varDelta \bm{r} = T_O ( \varDelta \bm{r} ) ( = \varDelta \bm{r}' )
\end{gather}
でなければなりません.

さて, Newton 力学の原理は\textgt{運動方程式}\index{うんどうほうていしき@運動方程式}
(\textgt{運動の第 2 法則}\index{うんどうのだいにほうそく@運動の第 2 法則})
\begin{gather}
    m \ddot{ \bm{r} }
    =
    \bm{F}
\end{gather}
で与えられます.
ここで $\bm{F}=\sum \, \bm{f}$ と表され,  $\bm{f}$ は着目している物体に
他から働く力で実体的な (物理的) な起源があり, $\bm{F}$ はその合力です.
特に他の諸物体から十分遠くに離れた物体 (孤立した物体) に対しては
事実上 $\bm{F}=\bm{0}$ としてよく, このとき
\begin{gather}
    m \ddot{ \bm{r} }
    =
    \bm{0}
    \Longrightarrow
    \dot{ \bm{r} }
    =
    \bm{v}_0 ( \text{定ベクトル} )
\end{gather}
となります.
すなわち, 外から力の働いていない物体は同一の運動状態 (等速度運動) にあり続けます.
通常このことを\textgt{慣性の法則}\index{かんせいのほうそく@慣性の法則}と呼んでいます.
そして慣性の法則が成立する座標系を\textgt{慣性座標系}\index{かんせいざひょうけい@慣性座標系},
または簡単に\textgt{慣性系}\index{かんせいけい@慣性系}と呼びます.
ここで慣性の法則の独立した論理的な意味は
\begin{req}
宇宙には, 力を受けていない物体が等速度運動を続ける座標系 (慣性座標系) が少なくとも 1 つ存在する.
\end{req}
という\textgt{慣性系の存在要請}と考えるべきです.
そうしないと, 慣性の法則が運動方程式の特別な場合として運動の第 2 法則に含まれてしまいます.
慣性の法則が\textgt{運動の第 1 法則}\index{うんどうのだいいちほうそく@運動の第 1 法則}である理由です.
\textgt{運動の第 3 法則}\index{うんどうのだいさんほうそく@運動の第 3 法則}は
\textgt{作用・反作用の法則}\index{さようはんさようのほうそく@作用・反作用の法則}です.

ここで時間と空間の性質として上記の 2 つの仮定を認めた上での慣性系どうしの
座標変換を\textgt{Galilei 変換}\index{がりれいへんかん@Galilei 変換}(Galilean transformation) といいます.
Galilei 変換 $\bm{r} \mapsto \bm{r}' , t \mapsto t'$ では
$d/dt = d/dt'$ であることから
\begin{gather}
    \ddot{ \bm{r} }
    =
    \bm{0}
    \Longleftrightarrow
    \frac{d^2} {dt'^2} T_O ( \bm{r} )
    =
    \bm{0}
\end{gather}
とならなければなりません.
座標系の変換で長さ, 2 つのベクトルのなす角度が変わってはならないので,
 $\ddot{ \bm{r} }$ から $\ddot{ \bm{r} }'$ への線型変換は直交変換になります.
つまり直交変換 $T_O$ を用いて
\begin{gather}
    \ddot{ \bm{r} }
    =
    T_O \left ( \ddot { \bm{r} } \right)
    =
    \frac{d^2} {dt'^2} \left ( T_O ( \bm{r} )  \right)
    =
    \ddot{ \bm{r} }'
\end{gather}
と書けます.
積分すれば
\begin{gather}
    \bm{r}
    =
    T_O \left ( \bm{r} \right) - \bm{u} t - \bm{ \alpha }
\end{gather}
となります. ここで $\bm{u} , \bm{ \alpha }$ は定ベクトルです.

特に $T_O = I$ (恒等写像), $\bm{\alpha} = \bm{0} , \theta = 0$ のとき
\begin{gather}
    \bm{r}
    \mapsto
    \bm{r}'
    =
    \bm{r} - \bm{u} t
    , \quad
    t
    \mapsto
    t'
    =
    t
\end{gather}
となります.
これはもとの座標系に対して速度 $\bm{u}$ で動いている座標系への変換であり,
これを\textgt{Galilei ブースト}\index{がりれいぶーすと@Galilei ブースト}といいます.
Galilei ブーストに伴う速度の変換則は
\begin{gather}
    \bm{v}
    =
    \dot { \bm{r} }
    \mapsto
    \bm{v}'
    =
    \dot{ \bm{r} }'
    =
    \bm{v} - \bm{u}
\end{gather}
で与えられます.
この結果は当然, と思うかもしれませんが,
Newton 力学での時空間に対する仮定と変換則に支えられて得られたものである,
つまり相対論的な力学では破壊される変換則であることを注意しておきます.
せっかくなので相対論的な速度の変換則を紹介しておきます.
\begin{gather}
    \bm{v}'
    =
    \frac{d \bm{r}'} {dt'}
    =
    \frac{ \sqrt{ 1- \frac{ \bm{v}^2 }{ c^2 } } \bm{v}_{\perp} + \bm{v}_{\|} - \bm{u}   }
        { 1 - \frac{ \bm{u} \cdot \bm{v} } { c^2 }  } .
\end{gather}

ここで要請を 1 つおきましょう.
\begin{req}
全ての慣性系は対等であり, したがって\textgt{力学}法則はどの慣性系で見ても同じでなければならない,
つまり Galilei 変換で形を変えてはならない.
この性質を\textgt{Galilei 共変性}\index{がりれいきょうへんせい@Galilei 共変性},
そしてこの要請を\textgt{Galilei の相対性原理}\index{がりれいのそうたいせいげんり@Galilei の相対性原理}という.
\end{req}
これが上で述べた物理法則の形不変性につながっています.

この要請を運動方程式に適用すれば, 力は時間に $t$ に陽によらず\index{ようによらない@(時間に) 陽によらない}
かつ力は変換則
\begin{gather}
    \bm{F}
    =
    T_O ( \bm{F} )
\end{gather}
にしたがわなければなりません

最後に Galilei 変換 $G$ を標準基底に関して行列表示してみましょう.
まず\textgt{4 元ベクトル}\index{よんげんべくとる@4 元ベクトル}
 $\bm{R} \defeq {^t} (x_0 \,\, x_1 \,\, x_2  \,\, x_3 ) = {^t} (ct \,\, x_1 \,\, x_2  \,\, x_3 )$
と定義します.
定数 $c$ は速度の次元を持ってさえいれば良いのですが, 一応光の速さとしておきます.
ここで\textgt{非斉次ベクトル}\index{ひせいじべくとる@非斉次ベクトル} $\tilde{ \bm{R} }$ を
 $\tilde{ \bm{R} } = {^t} ( \bm{R} \,\, 1 ) = {^t}(x_0 \,\, x_1 \,\, x_2 \,\, x_3 \,\, 1 )$ と定義します.
この記法で Galilei 変換を書き直すと
\begin{gather}
 G:
 \begin{cases}
  x_0 \mapsto x'_0 = x_0 - \delta \\
  \bm{r} \mapsto \bm{r}' = O \bm{r} - \bm{\alpha} \bm{\beta} x_0
 \end{cases}
\end{gather}
となります. ただし $\bm{\beta} \defeq \bm{u} / c , \delta \defeq c \theta$ です.
さらに $O$ は $\bm{r}$ が適当な座標系で表現されているものとして,
直交変換 $T_O$ が直交行列 $O$ で表現しておきました.
Galilei 変換を表す行列を $\hat{G}$ とすると,
\begin{gather}
    G:
    \tilde{ \bm{R} }
    \mapsto
    \tilde{ \bm{R} }'
    =
    \hat{G} \tilde{ \bm{R} }
    =
    \left (
        \begin{array}{@{\,}c|ccc|c@{\,}}
            1 & 0 & 0 & 0 & -\delta \\ \hline
            -\beta_1 & & & & -\alpha_1 \\
            -\beta_2 & & O & & -\alpha_2 \\
            -\beta_3 & & & & -\alpha_3 \\ \hline
            0 & 0 & 0 & 0 & -1 \\
        \end{array}
    \right)
    \tilde{ \bm{R} }
\end{gather}
となります.
この計算をした後,  $\tilde{ \bm{R} }'$ のはじめの 4 つの成分を取れば,
めでたく座標変換が得られます.
\subsubsection{抽象ベクトルの微分}

さて, 実はここまで曖昧にぼかしてきた部分があります.
それは\textgt{抽象ベクトルの微分とは何者か}ということです.
まだきちんと議論していない偏微分を使ってしまうことになりますが,
これで例を出します.
電場を $\bm{E}(\bm{r}, t)$ とします.
Maxwell 方程式から $\bm{ \nabla } \cdot \bm{E}( \bm{r} , t ) = \rho ( \bm{r} , t ) / \vep_0$ となりますが,
これは $\bm{r} = (x ,y , z)$ としたとき
\begin{gather}
 \frac{ \partial \bm{E} } { \partial x } + \frac{ \partial \bm{E} } { \partial y }
  +\frac{ \partial \bm{E} } { \partial z }
 =
 \frac{1} { \vep _0 } \rho ( \bm{r} , t )
\end{gather}
と書くことになります.
$\partial / \partial x$ というのは,
他の変数 $y,z,t$ を定数とみなして (固定して),
$x$ についてだけ微分を取るものです.
例えば, $f (x, y ,z , t) = x^2 + x y^3 +  \log y z + \sin z t$ としたとき
\begin{gather}
    \frac{ \partial f } { \partial x }
    =
    2 x + y^3 ,\quad
    \frac{ \partial f } { \partial y }
    =
    3x y^2 + \frac{1} {y} ,\quad
    \frac{ \partial f } { \partial z }
    =
    \frac{1} {z} + t \cos z t ,\quad
    \frac{ \partial f } { \partial t }
    =
    z \cos z t
\end{gather}
などとなります.
ここで具体的に座標系 (基底) を取る前の $\bm{ \nabla } \cdot \bm{E}( \bm{r} , t ) = \rho ( \bm{r} , t ) / \vep_0$ は
どう考えるべきでしょうか?
$\partial / \partial x$ という表記を見ても分かるように, 微分というものは
\textgt{本質的に}座標の取り方に深く関わるものです.
当然本節においては具体的な座標系 (基底) を選択する前の
\begin{gather}
    \frac{d} {dt} \bm{r}
\end{gather}
とは何者か, ということが問題です.
さらに微分作用素それ自体も座標系の選択に深く依存しているので,
微分作用素の表現自体もどうするか考えなければなりません.

この問題は, 数学的には幾何学における\textgt{多様体論}\index{たようたい@多様体}で深く考察される問題です.
現在, そもそも (偏) 微分自体が制御不可能なので, 本小節では簡単に論じるにとどめます.

解決策はとりあえず二つほど考えられます.
 つは, まず適当な座標系 (基底) を選択し, そのもとで微分を計算します.
ここで\textgt{全ての}座標系 (基底) に対して成立するような,
つまり\textgt{座標変換に対して不変な性質}を見出し,
それを抽象ベクトルの微分の性質とする, という方法です.
どういうことか説明しましょう.
まず適当な座標系 (基底) を取ったとき, 微分の値
$\partial f (x ,y , z) / \partial x , \partial f (r , \theta, \varphi) / \partial r$ などは
\textgt{一般には変化します}.
例えば $f (x, y) \defeq x + y = r \cos \theta + r \sin \theta = f ( r, \theta)$ とします.
\begin{gather}
 \frac{\partial  f ( x, y )} { \partial  x }
 =
 1, \quad
 \frac{\partial f ( x, y ) } { \partial  y }
 =
 1, \\
 \frac{\partial f (r, \theta )} { \partial r }
 =
 \cos \theta + \sin \theta, \quad
 \frac{\partial f (r, \theta )} { \partial \theta }
 =
 -r \sin \theta + r \cos \theta
\end{gather}
となります.
そもそも微分する変数自体が変わっているので, 当たり前といえば当たり前で,
微分する変数を変えずに $\partial f (r , \theta) / \partial x$ を考えれば, これは当然
 $\partial f ( x , y) / \partial x$ に一致します.
ここで, このときに変わらない (であろう) 性質としては,
ある座標系 (基底) を取ったときのある点において微分係数が $0$ にならないとき,
どんな座標系を取ろうともその同じ点においては微分係数が $0$ にならない, ということです.
もう少し何か書く. 作りかけ.

2 つ目ははじめから\textgt{座標系 (基底) の変換で不変な微分の形式を確立する}というものです.
これが多様体上で微分を行なう際に重要になる微分の形式で,
\textgt{(外) 微分形式}\index{びぶんけいしき@微分形式}といいます.
これは物理の方では解析力学 (の非常に高度な数学的定式化) で基本的かつ重要な役割を果たすほか,
どうも素粒子理論の方でも良く使うようです.
普通の微分ですらまともに論じていないので, ここであまり踏み込んだ議論はしません.
ただこちらはベクトル解析のところで多少触れるかもしれません.

ところで肝心の抽象ベクトルの微分はどうするのか, ということですが,
現時点では, 結局のところ, 詳細な解析をする際には
(都合のよい, 上手い) 具体的な座標系 (基底) を選んで現象の解析を行なう,
ということがありますので,
第一の方法に従うことにしましょう
作りかけ.
\subsubsection{定理の証明}

最後に積み残した「有限次元の間の線型写像は行列で表現出来る」ということを証明します.
まず 1 つ言葉を定義します.
\textgt{ある $(m,n)$ 型行列によって定まる線型写像}\index{あるえむえぬがたぎょうれつによってさだまるせんけいしゃぞう@ある $(m,n)$ 型行列によって定まる線型写像}
とは $(m,n)$ 型行列 $A$ に対して
\begin{align}
 f_{A} ( \bm{x} )
 =
 A \bm{x}, \quad \bm{x} \in \bC^n
\end{align}
として定まる $\bC^n$ から $\bC^m$ への写像 $f_A$ のことをいいます.
まずは標準基底 $\langle \bm{e}_i \rangle _{i=1}^n,\langle \bm{e}'_i \rangle _{i=1}^m$ に関して定式化します.
\begin{thm}
 $\bC^n$ から $\bC^m$ への写像が線型写像であるための必要十分条件は,
 写像がある $(m,n)$ 型行列 $A$ によって定まることである.
 またこのとき $A$ はただ 1 つに定まる.
\end{thm}
(証明)
十分性の方は
\begin{align}
    f_A ( a \bm{x} + b \bm{y} )
    =
    A ( a \bm{x} + b \bm{y} )
    =
    a ( A \bm{x} ) + b ( A \bm{y} )
    =
    a T_A \bm{x} + b T_A \bm{y}
\end{align}
からすぐに分かります.

必要性を示しましょう.
一般の $n$ 次でも大した手間はないので, 一般の状況で示します.
$f : \bC^n \to \bC^m$ が線型写像であるとしましょう.
$\bC^n$ の座標系を $n$ 項単位ベクトルの組 $\langle \bm{e}_i \rangle _{i=1}^n$
(\textgt{標準基底}\index{ひょうじゅんきてい@標準基底}) に取ります.
これらが $f$ で写される先を $\bm{a}_j$ とします.
すなわち
\begin{align}
    f \bm{e}_j
    =
    \bm{a}_j
    , \quad
    ( j = 1, 2, \dotsb , n)
\end{align}
とします.
 $\bm{a}_j \in \bC^m$ , つまり $\bm{a}_j$ は $m$ 項列ベクトルです.
ここで $(m,n)$ 型行列 $A$ を $A\defeq(\bm{a}_1,\dotsb,\bm{a}_n)$ として定義し,
 $A$ によって定まる $\bC^n$ から $\bC^m$ への線型写像を $T_A$ とすれば,
\begin{align}
    f_A ( \bm{e}_j )
    =
    A \bm{e}_j
    =
    \bm{a}_j
    =
    f \bm{e}_j.
\end{align}
$\bC^n$ の任意のベクトル $\bm{x}$ は,
\begin{align}
    \bm{x}
    =
    \sum_{i=1}^n x_i \bm{e}_i
\end{align}
と表せますから,
\begin{align}
    f_A ( \bm{x} )
    &=
    f_A \left ( \sum_{i=1}^n x_i \bm{e}_i \ \right)
    =
    \sum_{i=1}^n x_i f_A ( \bm{e}_i ) \\
    &=
    \sum_{i=1}^n x_i f ( \bm{e}_i )
    =
    f \left ( \sum_{i=1}^n x_i \bm{e}_i \right)
    =
    f ( \bm{x} ).
\end{align}
したがって $f=f_A$ です.

次に一意性を示します.
 $(m,n)$ 行列 $B$ が存在して任意の $\bm{x}\in\bbR^n$ に対し $f ( \bm{x} ) = B \bm{x}$ となるとします.
このとき
\begin{align}
    \bm{a}_j
    =
    A \bm{e}_j
    =
    f \bm{e}_j
    =
    B \bm{e}_j
    =
    \bm{b}_j
    ( j = 1 , \dotsb , n )
    \Rightarrow
    B = A. \, \blacksquare
\end{align}

上では標準基底で示しましたが, それ以外の適当な座標系を取ったときを考えます.
まず予備定理を証明します.
\begin{thm}
 $f : \bC^n \to \bC^m$ を線型写像,  $\bC^n, \bC^m$ の新たな座標系を
 それぞれ $\langle \bm{u}_i \rangle _{i=1}^n,\langle \bm{v}_j \rangle _{j=1}^m$
 とする.
 さらに $\bm{\xi} \defeq {^t} ( \xi_1 \dotsb \xi_n )$ ,  $\bm{\eta} \defeq {^t} ( \eta_1 \dotsb \eta_m)$ とする.
 このとき $(m,n)$ 型行列 $B$ がただ 1 つ存在し, 次の関係が成立する.
 \begin{align}
  ( f ( \bm{u}_1 ) \dotsb f ( \bm{u}_n ) )
  =
  ( \bm{v}_1 \dotsb \bm{v}_m) B, \quad
  \bm{\eta}
  =
  B \bm{\xi} .
 \end{align}
\end{thm}
(証明)
$\bm{x} = \xi_1 \bm{u}_1 + \dotsb + \xi_n \bm{u}_n$ の $f$ による像は
$f ( \bm{x} ) = \xi_1 f ( \bm{u}_1 ) + \dotsb + \xi_n f ( \bm{u}_n )$ となります.
そこで $f (\bm{u}_j)$ の $\langle \bm{v}_j \rangle _{j=1}^m$ に関する座標成分を
\begin{align}
    \bm{b}_j
    =
    {^t} ( b_{1j} \dotsb b_{n j} )
    \Longleftrightarrow
    f ( \bm{u}_j )
    =
    ( \bm{v}_1 \dotsb \bm{v}_m ) \bm{b}_j
     \, ( j = 1 , \dotsb , n )
\end{align}
として $B \defeq ( \bm{u}_1 \dotsb \bm{u}_n )$ とするとこれは $(m,n)$ 行列で
次が成立しています.
\begin{align}
    ( f ( \bm{u}_1 ) \dotsb f ( \bm{u}_n ) )
    =
    ( \bm{v}_1 \dotsb \bm{v}_m ) B .
\end{align}
そして
\begin{gather}
    f ( \bm{x} )
    =
    \xi_1 f ( \bm{u}_1 ) + \dotsb + \xi_n f ( \bm{u}_n )
    =
    ( f ( \bm{u}_1 ) \dotsb f ( \bm{u}_n ) ) \bm{\xi} \\
    =
    ( \bm{v}_1 \dotsb \bm{v}_m ) B \bm{\xi}
\end{gather}
一方
\begin{gather}
    f ( \bm{x} )
    =
    \sum_{j=1}^m \eta_j \bm{v}_j
    =
    ( \bm{v}_1 \dotsb \bm{v}_m ) \bm{\eta}
\end{gather}
でありこれが上の式と等しく,  $\langle \bm{v}_j \rangle _{j=1}^m$ が座標系であって,
 $f ( \bm{x} )$ の座標成分は一意に決まっているので
\begin{gather}
    \bm{\eta}
    =
    B \bm{\xi} .
\end{gather}

これから $B$ の一意性を証明します.
 $(m,n)$ 型行列 $C$ が存在し,  $\bm{\eta} = C \bm{\xi}$ を満たすとします.
このとき $\bm{x} = \bm{u}_j$ とすると $\bm{\xi} = \bm{e}_j ( j = 1,\dotsb, n)$ となります.
 $f (\bm{u}_j) = \eta_{1j} \bm{v}_1 +  \dotsb + \eta_{m j} \bm{v}_j$ とすると,
\begin{gather}
    \bm{b}_j
    =
    B \bm{e}_j
    =
    {^t} ( \eta_{1j} \dotsb \eta_{m j} )
    =
    C \bm{e}_j
    =
    \bm{c}_j
    \quad
    (j = 1, \dotsb ,n)\\
    \Rightarrow
    B=C . \quad \blacksquare
\end{gather}

\begin{rem}
実は本定理で現れた $B$ は座標系として $\langle \bm{u}_i \rangle _{i=1}^n,\langle \bm{v}_j \rangle _{j=1}^m$
を取ったときに線型写像 $f$ を表現する行列になっています.
\end{rem}

それでは本題に入りましょう.
\begin{thm}
 $\bC^n$ から $\bC^m$ への写像 $f$ が線型写像であるための必要十分条件は,
 任意に座標系 (基底) を定めたとき写像がある $(m,n)$ 型行列によって定まることである.
 またこのとき $A$ は各座標系に対しただ 1 つに定まる.
\end{thm}
(証明)
まず $\langle \bm{e}_i \rangle _{i=1}^n \to \langle \bm{u}_i \rangle _{i=1}^n$ ,
 $\langle \bm{e}'_j \rangle _{j=1}^m \to \langle \bm{v}_j \rangle _{j=1}^m$ の座標系の変換をあらわす行列をそれぞれ $P,Q$ とすると,
両方共に座標系であることから変換したきり逆に戻せないということはなく, きちんと逆変換が存在することから,
対応して $P, Q$ には逆行列が存在します.
これは
\begin{gather}
    ( \bm{u}_1  \dotsb  \bm{u}_n )
    =
    ( \bm{e}_1  \dotsb  \bm{e}_n ) P
    , \quad
    ( \bm{v}_1  \dotsb  \bm{v}_m )
    =
    ( \bm{e}'_1  \dotsb  \bm{e}'_m ) Q
\end{gather}
と書けます.
さらに $\bm{X} \defeq {^t} ( x_1 \dotsb x_n )$ ,  $\bm{Y} \defeq {^t} ( y_1 \dotsb y_m)$ を
標準基底での $\bm{x},\bm{y}$ の座標成分
(このようなベクトルを\textgt{座標ベクトル}\index{ざひょうべくとる@座標ベクトル}) とします.
すぐ上の注意から
\begin{gather}
    \bm{Y}
    =
    A \bm{X}
\end{gather}
となります.
 $\bm{x} , f ( \bm{x} )$ を各座標系で表現すると
\begin{gather}
    \bm{x}
    =
    ( \bm{e}_1 \dotsb \bm{e}_n ) \bm{X}
    =
    ( \bm{u}_1 \dotsb \bm{u}_n ) \bm{\xi} \\
    f ( \bm{x} )
    =
    ( \bm{e}'_1 \dotsb \bm{e}'_m ) \bm{Y}
    =
    ( \bm{v}_1 \dotsb \bm{v}_m ) \bm{\eta}
\end{gather}
のようになります.
以上から
\begin{gather}
    f ( \bm{x} )
    =
    f \left ( ( \bm{u}_1 \dotsb \bm{u}_n ) \bm{\xi} \right)
    =
    f \left ( ( \bm{e}_1 \dotsb \bm{e}_n ) P \bm{\xi} \right)
    =
    A P \bm{\xi} , \\
    f ( \bm{x} )
    =
    ( \bm{v}_1 \dotsb \bm{v}_m ) \bm{\eta}
    =
    ( \bm{e}'_1  \dotsb  \bm{e}'_m ) Q \bm{\eta}
    =
    Q \bm{\eta}
\end{gather}
定理の前の注意から $\bm{\eta} = B \bm {\xi}$ であり,  $P^{-1}$ が存在することから
\begin{gather}
    A \bm{X}
    =
    Q B P^{-1} \bm{X}
\end{gather}
となります.
ここで $\bm{x} = \bm{e}_j$ とすると $\bm{X} = \bm{e}_j$ ですから,
\begin{gather}
    A\text{の第 $j$ 列}
    =
    A \bm{e}_j
    =
    ( Q B P^{-1} ) \bm{e}_j
    =
    Q B P^{-1} \text{の第 $j$ 列}
\end{gather}
となります.
これから
\begin{gather}
    A
    =
    Q B P^{-1}
    \Longleftrightarrow
    B
    =
    Q^{-1} A P
\label{eq:基底変換}
\end{gather}
が成立します.
これから任意の座標系で線型写像は行列で表現でき,
その行列は標準基底で線型写像を表現した行列と座標系の変換 (基底変換の行列) で
表されることが分かりました.  $\blacksquare$
\subsection{行列式}

前節で述べたように
線型変換は座標系 (基底) を選んだ上で一意的に行列で表すことが出来ます.
物理法則の形不変性 (form invariance) の観点からみても, ある (線型の) 座標変換に逆変換が存在するかどうか
調べることは重要なことです.
これは行列で線型変換を具体的に表示して, その行列に逆行列があるか否かを調べれば良さそうです.
というわけで, いくつかある逆行列の存在・非存在の判定法のうち, ここでは行列式を用いたものを紹介します.

高校でも 2 次正方行列の行列式を学びました. よく使う行列式の記法を確認しておきます.
行列 $A = (a_{ij}) = (\bm{a}_{1}\, \bm{a}_{2} \, \bm{a}_{3})$ に対し
\begin{align}
 \begin{vmatrix} a_{11} & a_{12} & a_{13} \\ a_{21} & a_{22} & a_{23} \\ a_{31} & a_{32} & a_{33} \end{vmatrix} , \,
 \begin{vmatrix} \bm{a}_{1} & \bm{a}_{2} & \bm{a}_{3} \end{vmatrix} ,\,
 \det \left ( \bm{a}_{1} \, \bm{a}_{2} \, \bm{a}_{3} \right)
\end{align}
などと書きます. 唐突ですが, 2 次の行列式には以下のような性質がありました.
暗算でも確かめられるでしょう.
\begin{align}
 \det \left ( \bm{a}_{1} \, \bm{a}_{2} \right)
 &= - \det \left ( \bm{a}_{2} \, \bm{a}_{1} \right) \\
 \det \left ( \alpha \bm{a}_{1} + \beta \bm{a}^{'}_{1}  \,\, \bm{a}_{2} \right)
 &= \alpha \det \left ( \bm{a}_{1} \, \bm{a}_{2} \right)
 +\beta \det \left (  \bm{a}^{'}_{1}  \, \bm{a}_{2} \right) \\
 \det \left ( \bm{a}_{1} \,\, \alpha \bm{a}_{2} + \beta \bm{a}^{'}_{2}  \right)
 &= \alpha \det \left ( \bm{a}_{1} \, \bm{a}_{2} \right) + \beta \det \left (  \bm{a}_{1}  \, \bm{a}^{'}_{2} \right) \\
 \det \left ( \bm{e}_{1} \, \bm{e}_{2} \right) &= \begin{vmatrix} E \end{vmatrix} = 1
\end{align}
\textgt{この性質を一般の $n$ 次行列式にも要求します}. 3 次でいくつか具体的に書くと
\begin{align}
 \det \left ( \bm{a}_{1} \, \bm{a}_{2} \, \bm{a}_{3} \right)
 &= - \det \left ( \bm{a}_{2} \, \bm{a}_{1} \, \bm{a}_{3} \right) \\
 \det \left ( \bm{a}_{1} \, \bm{a}_{2} \, \bm{a}_{3} \right)
 &= - \det \left ( \bm{a}_{1} \, \bm{a}_{3} \, \bm{a}_{2} \right) \\
 \det \left ( \alpha \bm{a}_{1} + \beta \bm{a}^{'}_{1}  \, \bm{a}_{2}  \, \bm{a}_{3} \right)
 &=
 \alpha \det \left ( \bm{a}_{1} \, \bm{a}_{2} \, \bm{a}_{3} \right)
 +\beta \det \left (  \bm{a}^{'}_{1}  \, \bm{a}_{2} \, \bm{a}_{3} \right) \\
 \det \left ( \bm{e}_{1} \, \bm{e}_{2} \, \bm{e}_{3} \right) &= \mid E \mid = 1
\end{align}
などです.
前節で説明した言葉を使ってこの性質をまとめると以下のようになります.
\begin{defn}
 \textgt{行列式}\index{ぎょうれつしき@行列式}とは定義域が $M \left ( n,n \, ; \bm{C}^n \right)$ で値域が $\bm{C}$ の,
 単位行列に対し 1 を対応させる, 列に関する交代性を持った多重線型写像である.
\end{defn}

ここで $M \left ( n,m \, ; \bm{C}^n \right)$ とは $n \times m$ 型行列全体の集合でした.
\textgt{多重線型性}\index{たじゅうせんけいせい@多重線型性}というのは,
行列式は多変数写像 (関数) ですが, この全ての変数 (全ての列) に対し
線型性を要求するということです.
この性質を用いて $n$ 次行列式の持つ性質をいくつか調べて, 具体的に計算できるようにします.

最終目標をはじめに示しておきます.
\begin{align}
 \begin{vmatrix} a_{11} & a_{12} & a_{13} \\
  a_{21} & a_{22} & a_{23} \\
  a_{31} & a_{32} & a_{33}
 \end{vmatrix}
 =
 a_{11}
 \begin{vmatrix} a_{22} & a_{23} \\
  a_{32} & a_{33}
 \end{vmatrix}
 -a_{21}
 \begin{vmatrix}
  a_{12} & a_{13} \\
  a_{32} & a_{33}
 \end{vmatrix}
 +a_{31}
 \begin{vmatrix}
  a_{12} & a_{13} \\
  a_{22} & a_{23}
 \end{vmatrix}
\end{align}
これが出来れば, 2 次の行列式の計算は知っているわけですから, 3 次の行列式が計算できるというわけです.
4 次での対応する結果を書いておくのは無駄ではないでしょう. 下に記しておきます.
\begin{gather}
 \begin{vmatrix} a_{11} & a_{12} & a_{13} & a_{14} \\
 a_{21} & a_{22} & a_{23} & a_{24} \\
 a_{31} & a_{32} & a_{33} & a_{34} \\
 a_{41} & a_{42} & a_{43} & a_{44}
 \end{vmatrix}\\
 =
 (-1)^{1+1}a_{11}
 \begin{vmatrix} a_{12} & a_{13} & a_{14} \\
 a_{22} & a_{23} & a_{24} \\
 a_{32} & a_{33} & a_{34}
 \end{vmatrix}
 +(-1)^{2+1}a_{21}
 \begin{vmatrix}
 a_{12} & a_{13} & a_{14} \\
 a_{32} & a_{33} & a_{34} \\
 a_{42} & a_{43} & a_{44}
 \end{vmatrix} \\
 +(-1)^{3+1}a_{31}
 \begin{vmatrix}
 a_{12} & a_{13} & a_{14} \\
 a_{22} & a_{23} & a_{24} \\
 a_{42} & a_{43} & a_{44}
 \end{vmatrix}
 +(-1)^{4+1}a_{41}
 \begin{vmatrix} a_{12} & a_{13} & a_{14} \\
 a_{22} & a_{23} & a_{24} \\
 a_{32} & a_{33} & a_{34}
 \end{vmatrix}
\end{gather}

まず次の定理を示しましょう.
\begin{thm}
 二つの列が一致すれば $\det A = 0$ となる.
\end{thm}
(証明)
これは交代性からほとんど明らかです. 確認してみましょう. 例えば $\bm{a}_{1}=\bm{a}_{2}$ とすると交代性から
\begin{align}
    \det ( \bm{a}_{1} \, \bm{a}_{1} \, \bm{a}_{3} ) = - \det ( \bm{a}_{1} \, \bm{a}_{1} \, \bm{a}_{3} )
    \Longrightarrow \det ( \bm{a}_{1} \, \bm{a}_{1} \, \bm{a}_{3} ) = 0
\end{align}
他の列の場合でも同様に成立することが示せます.  $\blacksquare$

次の定理にいきましょう.
\begin{thm}ある列に他のある列の定数倍を加えて得られる行列の行列式は, もとの行列の行列式 $\det A$ に等しい.
\end{thm}
意味が分からないかもしれないので, 何を示せばよいのかをまず確認しましょう. 式で書くと
\begin{align}
    \det ( \bm{a}_{1} \,\, \bm{a}_{2} + c\bm{a}_{1} \,\, \bm{a}_{3} ) = \det ( \bm{a}_{1} \,\, \bm{a}_{2} \,\, \bm{a}_{3} ).
\end{align}
といったことです.

(証明) 多重線型性から
\begin{align}
    \det ( \bm{a}_{1} \,\, \bm{a}_{2} + c\bm{a}_{1} \,\, \bm{a}_{3} )
    = \det ( \bm{a}_{1} \,\, \bm{a}_{2} \,\, \bm{a}_{3} ) + c \det ( \bm{a}_{1} \,\, \bm{a}_{1} \,\, \bm{a}_{3} )
\end{align}
前定理から $\det ( \bm{a}_{1} \,\, \bm{a}_{1} \,\, \bm{a}_{3} )=0$ なので
\begin{align}
    =\det ( \bm{a}_{1} \,\, \bm{a}_{2} \,\, \bm{a}_{3} )
\end{align}
先程同様, 他の列あるいは行の場合でも同じです.  $\blacksquare$

次に示すのは
\begin{thm}転置行列と元の行列式の行列式の値は等しい.
\end{thm}
つまり,
\begin{align}
    {\det} \, {^{t}A} &= \det A
\intertext{すなわち}
    \det \begin{pmatrix} ^{t}\bm{a}_1 \\ ^{t}\bm{a}_2 \\ ^{t}\bm{a}_3 \end{pmatrix}
    &=
    \det \begin{pmatrix} \bm{a}_1  \bm{a}_2  \bm{a}_3 \end{pmatrix}
\end{align}
です. これが示されると, \textgt{列ベクトルに対して示した結果が行ベクトルに対しても成立する}ことになります.
つまり
\begin{thm}二つの行が一致すれば $\det A = 0$ となる.
\end{thm}
\begin{thm}ある行に他のある行の定数倍を加えて得られる行列の行列式は, もとの行列の行列式 $\det A$ に等しい.
\end{thm}
という定理を直接証明せずとも良いことが分かります. また定義としても
    \begin{defn}\textgt{行列式}は定義域が $M \left ( n,m \, ; \bm{C}^n \right)$ で値域が $\bm{C}$ の,
単位行列に対し 1 を対応させる, \textgt{行}に関する交代性を持った多重線型写像である.
    \end{defn}
を採用してよいことが分かります.
転置行列と元の行列式の行列式の値が等しいことは多重線型性を用いて証明します.

(定理の証明)
\begin{align}
    \bm{a}_{i} = \sum_{k=1}^3 a_{k i} \bm{e}_{k} ,
    \quad
    ^{t}\bm{a}_{i} = \sum_{k=1}^3 a_{k i} \, ^{t}\bm{e}_{k}
\end{align}
と書けますから, これを用いて
\begin{gather}
    \det \begin{pmatrix} ^{t}\bm{a}_1 \\ ^{t}\bm{a}_2 \\ ^{t}\bm{a}_3 \end{pmatrix}
    =  \det \begin{pmatrix} \sum_{i=1}^3 a_{i1} \, ^{t}\bm{e}_{i} \\ \sum_{j=1}^3 a_{j2} \, ^{t}\bm{e}_j
    \\ \sum_{k=1}^3 a_{k3} \, ^{t}\bm{e}_{k} \end{pmatrix} \\
    = \sum_{i=1}^3 \sum_{j=1}^3 \sum_{k=1}^3 a_{i1} a_{j2} a_{k3}
        \det \begin{pmatrix} ^{t}\bm{e}_{i} \\ ^{t}\bm{e}_{j} \\ ^{t}\bm{e}_{k} \end{pmatrix}\text{(多重線型性)} ,\\
    \det \begin{pmatrix} \bm{a}_1 \,\, \bm{a}_2 \,\, \bm{a}_3 \end{pmatrix}
    = \det \left (  \sum_{i=1}^3 a_{i1} \, \bm{e}_{i}  \,\,\,  \sum_{j=1}^3 a_{j2} \, \bm{e}_{j}
            \,\,\,  \sum_{k=1}^3 a_{k i} \, \bm{e}_{k}  \right) \\
    = \sum_{i=1}^3 \sum_{j=1}^3 \sum_{k=1}^3 a_{i1} a_{j2} a_{k3}
        \det \left ( \bm{e}_{i} \, \bm{e}_{j} \, \bm{e}_{k} \right) \text{(多重線型性)}  \\
    \Longleftrightarrow
    0 = \sum_{i=1}^3 \sum_{j=1}^3 \sum_{k=1}^3 a_{i1} a_{j2} a_{k3}
                                \left \{            \det \begin{pmatrix}
                                                    ^{t}\bm{e}_{i} \\ ^{t}\bm{e}_{j} \\ ^{t}\bm{e}_{k}
                                                 \end{pmatrix}
                                            -\det \left ( \bm{e}_{i} \, \bm{e}_{j} \, \bm{e}_{k} \right)
                                \right \}
\end{gather}
示すべき式はこのようになります. したがって焦点は
\begin{align}
    \det \begin{pmatrix} ^{t}\bm{e}_{i} \\ ^{t}\bm{e}_{j} \\ ^{t}\bm{e}_{k} \end{pmatrix}
    =
    \det \left ( \bm{e}_{i} \, \bm{e}_{j} \, \bm{e}_{k} \right)
\end{align}
が示せるかどうかです. 先程示した定理から $i\, , \,j \, , \, k$ のうちのいずれか 2 つ以上が一致するときは両辺 $0$ ,
つまりこのときはきちんと等号が成立します.
そこで問題は $i\, , \,j \, , \, k$ が異なる場合です.

実際に一致するのですが, 全部確認するのは面倒なのでいくつか具体的に見てみましょう.
\begin{align}
    \det \begin{pmatrix} ^{t}\bm{e}_{1} \\ ^{t}\bm{e}_{2} \\ ^{t}\bm{e}_{3} \end{pmatrix}
    &= \begin{pmatrix} 1 & 0 & 0 \\
                      0 & 1 & 0 \\
                      0 & 0 & 1
      \end{pmatrix}
    =
    \det \left ( \bm{e}_{1} \, \bm{e}_{2} \, \bm{e}_{3} \right)
\end{align}
\begin{align}
    \det \begin{pmatrix} ^{t}\bm{e}_{2} \\ ^{t}\bm{e}_{3} \\ ^{t}\bm{e}_{1} \end{pmatrix}
    &= \begin{pmatrix} 0 & 1 & 0 \\
                      0 & 0 & 1 \\
                      1 & 0 & 0
      \end{pmatrix} \\
    &= - \begin{pmatrix} 1 & 0 & 0 \\
                        0 & 0 & 1 \\
                        0 & 1 & 0
      \end{pmatrix} \text{(交代性を用いて 1 列と 2 列を交換)} \\
    &= \begin{pmatrix} 0 & 0 & 1 \\
                      1 & 0 & 0 \\
                      0 & 1 & 0
      \end{pmatrix} \text{(交代性を用いて 1 列と 3 列を交換)} \\
    &=
    \det \left ( \bm{e}_{2} \, \bm{e}_{3} \, \bm{e}_{1} \right)
\end{align}
したがって上の等号が確かに成立します.  $\blacksquare$

さらに次に示すのは
\begin{thm}(行列式の展開 1)
\begin{align}
    \begin{vmatrix} 1 & a_{12} & a_{13} \\
                    0 & a_{22} & a_{23} \\
                    0 & a_{32} & a_{33}
    \end{vmatrix}
    =
    \begin{vmatrix} a_{22} & a_{23} \\
                    a_{32} & a_{33}
    \end{vmatrix}
\end{align}
\end{thm}
です. 3 次行列の行列式と 2 次行列の行列式を結ぶ式ですから, 重要そうな気配がするわけです.

(定理の証明)
前に示した定理と多重線型性から
\begin{gather}
    \begin{vmatrix} 1 & a_{12} & a_{13} \\
                          0 & a_{22} & a_{23} \\
                          0 & a_{32} & a_{33}
    \end{vmatrix}
    =
    \det (\bm{e}_{1} \, \bm{a}_{2} \, \bm{a}_{3} )  \\
    =
    \det (\bm{e}_{1} \,\,\, -a_{12}\bm{e}_{1} + \bm{a}_{2} \,\,\, -a_{13}\bm{e}_{1} + \bm{a}_{3} )\\
    =
    \begin{vmatrix} 1 & 0 & 0 \\
                    0 & a_{22} & a_{23} \\
                    0 & a_{32} & a_{33}
    \end{vmatrix}
    =
    a_{22}\begin{vmatrix} 1 & 0 & 0 \\
                          0 & 1 & a_{23} \\
                          0 & 0 & a_{33}
    \end{vmatrix}
    +a_{32}\begin{vmatrix} 1 & 0 & 0 \\
                            0 & 0 & a_{23} \\
                            0 & 1 & a_{33}
    \end{vmatrix} \\
    =
    a_{22} \left (
    a_{23}\begin{vmatrix} 1 & 0 & 0 \\
                          0 & 1 & 1 \\
                          0 & 0 & 0
    \end{vmatrix}
    +a_{33}\begin{vmatrix} 1 & 0 & 0 \\
                           0 & 1 & 0 \\
                           0 & 0 & 1
    \end{vmatrix}
    \right) \\
    +a_{32}\left (
    a_{23}\begin{vmatrix} 1 & 0 & 0 \\
                          0 & 0 & 1 \\
                          0 & 1 & 0
    \end{vmatrix}
    +a_{33}\begin{vmatrix} 1 & 0 & 0 \\
                           0 & 0 & 0 \\
                           0 & 1 & 1
    \end{vmatrix}
    \right)
\intertext{ここで前定理により第 1 項と第 4 項が $0$ になります. 第 2 項と第 3 項には交代性を用いて}
    =
    a_{22} a_{33} \begin{vmatrix} 1 & 0 & 0 \\
                           0 & 1 & 0 \\
                           0 & 0 & 1
    \end{vmatrix}
    +a_{23} a_{32}(-1)\begin{vmatrix} 1 & 0 & 0 \\
                           0 & 1 & 0 \\
                           0 & 0 & 1
    \end{vmatrix}  \\
    =
    a_{22} a_{33} - a_{23} a_{32}
    =
    \begin{vmatrix} a_{22} & a_{23} \\ a_{32} & a_{33} \end{vmatrix}
\end{gather}
これで証明終了です.  $\blacksquare$

準備が整ったので, はじめの懸案を片付けましょう. 示すべきは
\begin{thm}(行列式の展開 2)
\begin{align}
    \begin{vmatrix} a_{11} & a_{12} & a_{13} \\
                    a_{21} & a_{22} & a_{23} \\
                    a_{31} & a_{32} & a_{33}
    \end{vmatrix}
    =
    a_{11}   \begin{vmatrix} a_{22} & a_{23} \\
                        a_{32} & a_{33}
            \end{vmatrix}
    -a_{21} \begin{vmatrix} a_{12} & a_{13} \\
                        a_{32} & a_{33}
            \end{vmatrix}
    +a_{31} \begin{vmatrix} a_{12} & a_{13} \\
                        a_{22} & a_{23}
            \end{vmatrix}
\end{align}
\end{thm}
(証明) まず $\bm{a}_{1} = a_{11}\bm{e}_{1} + a_{21}\bm{e}_{2} + a_{31}\bm{e}_{3}$ を用いて多重線型性から
\begin{gather}
    \begin{vmatrix} a_{11} & a_{12} & a_{13} \\
                    a_{21} & a_{22} & a_{23} \\
                    a_{31} & a_{32} & a_{33}
    \end{vmatrix} \\
    =
    a_{11}\begin{vmatrix} 1 & a_{12} & a_{13} \\
                          0 & a_{22} & a_{23} \\
                          0 & a_{32} & a_{33}
          \end{vmatrix}
    +a_{21}\begin{vmatrix} 0 & a_{12} & a_{13} \\
                            1 & a_{22} & a_{23} \\
                            0 & a_{32} & a_{33}
            \end{vmatrix}
    +a_{31}\begin{vmatrix} 0 & a_{12} & a_{13} \\
                            0 & a_{22} & a_{23} \\
                            1 & a_{32} & a_{33}
            \end{vmatrix}
\end{gather}

まず右辺第一項から考えましょう. つい先程示した定理から
\begin{align}
    \begin{vmatrix} 1 & a_{12} & a_{13} \\
                    0 & a_{22} & a_{23} \\
                    0 & a_{32} & a_{33}
    \end{vmatrix}
    =
    \begin{vmatrix} a_{22} & a_{23} \\
                    a_{32} & a_{33}
    \end{vmatrix}
\end{align}
となります. 第 2 項は交代性を用いて
\begin{align}
    \begin{vmatrix} 0 & a_{12} & a_{13} \\
                    1 & a_{22} & a_{23} \\
                    0 & a_{32} & a_{33}
    \end{vmatrix}
    =
    -\begin{vmatrix}1 & a_{22} & a_{23} \\
                     0 & a_{12} & a_{13}  \\
                     0 & a_{32} & a_{33}
    \end{vmatrix}
    =
    -\begin{vmatrix} a_{12} & a_{13}  \\
                      a_{32} & a_{33}
    \end{vmatrix}
\end{align}
となります. 第 3 項も同様です. これで証明終了です.  $\blacksquare$

手間暇はかかりますが, 全く同じようにして一般の $n$ 次の行列式をこのように「展開」することが出来ます.

行列式に関する定理をもう 2 つ紹介しておきます.
\begin{thm}2 つの行列の積の行列式はそれぞれの行列式の積に等しい. すなわち $\det A \det B = \det (AB)$
\end{thm}
(証明) これも多重線型性が命です.
\begin{align}
    \det (AB) &= \det \left ( \sum_{i=1}^3 b_{i1}\bm{a}_i
                    \,\,\, \sum_{j=1}^3 b_{j2}\bm{a}_j  \,\,\, \sum_{k=1}^3 b_{k3}\bm{a}_k \right) \\
              &= \sum_{i=1}^3 \sum_{j=1}^3 \sum_{k=1}^3 b_{i1} b_{j2} b_{k3}
                            \det (\bm{a}_i \,\,\, \bm{a}_j \,\,\, \bm{a}_k )
\end{align}
ここで交代性から $i,j,k$ のうちで一致するものがあると 0 で, このうちのどれか一つの添え字を
ひっくり返したものにはマイナスがつきますから,
\begin{gather}
 \det (AB) \\
 =  b_{11} b_{22} b_{33} \det (\bm{a}_1 \,\,\, \bm{a}_2 \,\,\, \bm{a}_3 )
 +b_{11} b_{32} b_{23} \det (\bm{a}_1 \,\,\, \bm{a}_3 \,\,\, \bm{a}_2 ) \\
 +b_{21} b_{12} b_{33} \det (\bm{a}_2 \,\,\, \bm{a}_1 \,\,\, \bm{a}_3 )
 +b_{21} b_{32} b_{13} \det (\bm{a}_2 \,\,\, \bm{a}_3 \,\,\, \bm{a}_1 ) \\
 +b_{31} b_{22} b_{13} \det (\bm{a}_3 \,\,\, \bm{a}_2 \,\,\, \bm{a}_1 )
 +b_{31} b_{12} b_{23} \det (\bm{a}_3 \,\,\, \bm{a}_1 \,\,\, \bm{a}_2 ) \\
 =
 ( b_{11} b_{22} b_{33} - b_{11} b_{32} b_{23} - b_{21} b_{12} b_{33}
 +b_{21} b_{32} b_{13} - b_{31} b_{22} b_{13} + b_{31} b_{12} b_{23} ) \\
 \times \det (\bm{a}_1 \,\,\, \bm{a}_2 \,\,\, \bm{a}_3 ) \\
 = \{ b_{11}(b_{22}b_{33} - b_{32}b_{23}) - b_{12}(b_{21}b_{33} - b_{23}b_{31})
 +b_{13}(b_{21}b_{32} - b_{22}b_{31}  \} \\ \times \det (\bm{a}_1 \,\,\, \bm{a}_2 \,\,\, \bm{a}_3 ) \\
 =
 \left ( b_{11} \begin{vmatrix} b_{22} & b_{23}  \\
 b_{32} & b_{33}
 \end{vmatrix}
  -b_{21} \begin{vmatrix} b_{12} & b_{13} \\
  b_{32} & b_{33}
 \end{vmatrix}
 +b_{31} \begin{vmatrix} b_{12} & b_{13} \\
 b_{22} & b_{23}
 \end{vmatrix}
 \right) \det (\bm{a}_1 \,\,\, \bm{a}_2 \,\,\, \bm{a}_3 ) \\
 = \det (\bm{b}_1 \,\,\, \bm{b}_2 \,\,\, \bm{b}_3 )\det (\bm{a}_1 \,\,\, \bm{a}_2 \,\,\, \bm{a}_3 )
\end{gather}
最後のところで先程の行列式の展開を用いました.  $\blacksquare$

あとで用いる連立一次方程式に関する結果をここで示しておきます.
\begin{thm}
連立一次方程式
    \begin{align}
        & c_{11} x_1 + c_{12} x_2 + \dots + c_{1n} x_n = 0 \\
        & c_{21} x_1 + c_{22} x_2 + \dots + c_{2n} x_n = 0 \\
        & \vdots \\
        & c_{n1} x_1 + c_{n2} x_2 + \dots + c_{n n} x_n = 0
    \end{align}
が $x_i \not= 0$ となる $i$ が存在するような解の組 $\bm{x} \defeq (x_1 \,\, \dotsb \,\, x_n)$
を持つ必要十分条件は係数 $c_{ij}$ のなす正方行列 $C \defeq (c_{ij})$ の行列式 $\det C$ が $0$ になることである.
\label{th:連立一次方程式}
\end{thm}
(証明)
まず連立一次方程式は行列で $C \bm{x} = \bm{0}$ と書けることに注意します.

(必要性)
背理法で証明します.
 $\det C =0$ としましょう.
すると逆行列が存在するので, これをかけると $\bm{x} = \bm{0}$ となり, 仮定に反します.

(十分性)
一般には帰納法で証明できますが, 帰納法で何をやっているのかを確認することにもなりますから,
 $n=1,2,3$ で具体的に調べてみます.
 $n=1$ のときは連立方程式は $c_{11}x_1=0$ で $\det C = c_{11} = 0$ なので,
 $x_1 \not=0$ となる解が存在することはすぐに分かります.

$n=2$ のとき, 2 行目に $c_{11}$ をかけ, 1 行目に $c_{21}$ をかけて, 2 行目から 1 行目を引くと
\begin{align}
        & c_{11} x_1 + c_{12} x_2 = 0 \\
        & 0 x_1 + (  c_{11}c_{22} - c_{12} c_{21} ) x_2 = 0 \\
\end{align}
となります.
 $x_2$ の係数は $- \det C = 0$ なので,  $x_2 \not= 0$ としてもよいことが分かります.
 $x_i \not = 0$ となる $i$ が存在することさえ示せればよいので, これで十分です.

 $n=3$ のとき, もし全ての $c_{ij}$ が $0$ ならば, 当然 $\det C =0$ です.
そして任意の $\bm{x}$ が解となるので, 証明終了です.
次に $c_{ij} \not= 0$ となる $i,j$ が存在するとします.
例えばそれが $c_{22}$ であったとしましょう.
1 行目と 2 行目を入れ替え, 1 列と 2 列目を入れ替えると,  $c_{22}$ が $c_{11}$ の位置に来ます.
こうして得られたものにあらためて番号を振りなおすと $c_{11} \not= 0$ となります.
このようなことを考慮に入れると $c_{11} \not= 0$ と仮定してもよいことに注意しましょう.
$n=2$ のときと同じようにして,
\begin{align}
 & c_{11} x_1 + c_{12} x_2 + c_{13} x_3 = 0 \\
 & 0 x_1 + ( c_{11} c_{22} - c_{21} c_{12} ) x_2 + ( c_{11} c_{23} - c_{21} c_{13} ) x_3 = 0 \\
 & 0 x_1 + ( c_{11} c_{32} - c_{31} c_{12} ) x_2 + ( c_{11} c_{33} - c_{31} c_{13} ) x_3 = 0
\end{align}
となります.
$n=2$ のときと同様にして今度は 3 行目の $x_2$ の係数を $0$ にします.
このとき $3$ 行目の $x_3$ の係数を計算すると,
\begin{gather}
 ( c_{11} c_{22} - c_{21} c_{12} ) ( c_{11} c_{33} - c_{31} c_{13} )
 -( c_{11} c_{32} - c_{31} c_{12} ) ( c_{11} c_{23} - c_{21} c_{13} )
\end{gather}
となります.
ここで $\det C$ を計算してみます.
$C$ の第 $i$ \textgt{行}ベクトルを $\bm{c}_i$ として今まで証明してきた定理を色々使うと
\begin{gather}
 0
 =
 \det C
 =
 \begin{vmatrix}
 \bm{c}_1 \\
 \bm{c}_2 \\
 \bm{c}_3
 \end{vmatrix}
 =
 \begin{vmatrix}
 \bm{c}_1 \\
 -c_{21} \bm{c}_1 + c_{11} \bm{c}_2 \\
 -c_{31} \bm{c}_1 + c_{11} \bm{c}_3
 \end{vmatrix} \\
 =
 \begin{vmatrix}
 c_{11} & c_{12} & c_{13} \\
 0 & c_{11} c_{22} - c_{21} c_{12} & c_{11} c_{23} - c_{21} c_{13} \\
 0 & c_{11} c_{32} - c_{31} c_{12} & c_{11} c_{33} - c_{31} c_{13}
 \end{vmatrix} \\
 =
 c_{11} \det
 \begin{vmatrix}
 c_{11} c_{22} - c_{21} c_{12} & c_{11} c_{23} - c_{21} c_{13} \\
 c_{11} c_{32} - c_{31} c_{12} & c_{11} c_{33} - c_{31} c_{13}
 \end{vmatrix}
\end{gather}
$c_{11} \not= 0$ なので $x_3 \not = 0$ と選べます.

一般の場合は帰納法で示せますがここでは省略します.
これで証明終了です.

ここ本節はじめに述べた, 「線型変換に逆変換があるかどうかを行列による表示だけから判定できるか? 」
という問題の答が述べられます.
線型変換 $f$ に対する行列表示, は適当に座標系 (基底) を選んだときに一意的に定まるものです.
標準基底を取った時の線型写像を表す行列を $A$ , 別の座標系 $\langle \bm{u}_i \rangle _{i=1}^3$ を
取った時の線型写像を表す行列を $B$ とし,
座標系の変換を表す行列を $P$ とします.
このとき p \pageref{eq:基底変換}, (\ref{eq:基底変換}) から $A = P B P^{-1}$ となります.
今示した定理と $P^{-1} P = I$ から
\begin{gather}
    \det A
    =
    \det ( P B P^{-1} )
    =
    \det P \, \det B \, \det P^{-1} \\
    =
    \det ( P P^{-1} ) \det B
    =
    \det I \, \det B
    =
    \det B
\end{gather}
となります.
高校でも学んだとおり逆行列が存在することと行列式が $0$ でないことは同値です.
上の式から適当な座標系で行列式が $0$ でないならば, いかなる座標系で行列式を計算しようとも
行列式の値は $0$ ではありません.
すなわち逆変換が存在するか否かは適当な座標系を取ったときの行列式を計算すれば十分であることが分かりました.
\subsection{内積と外積}

内積から書きます.
ここでの内積は高校のときと同じです.
$\bm{x}= \sum_{i=1}^n x_{i}\bm{e}_{i} \in \bm{C}^n$  , $\bm{y} = \sum_{i=1}^n y_{i}\bm{e}_{i} \in \bm{C}^n$ としましょう.
このとき $\bm{x}$ と $\bm{y}$ の\textgt{内積} $(\bm{x}, \bm{y})$ を以下のように定義します.
\begin{defn} $\bm{x}$ と $\bm{y}$ の\textgt{内積}\index{ないせき@内積} $(\bm{x}, \bm{y})$ とは
\begin{align}
(\bm{x}, \bm{y} ) \defeq \sum_{i=1}^n x_{i} \overline {y_{i}}
\end{align}
\end{defn}
$y_{I}$ についたバーは複素共役を表します.
もちろん実数のときはあってもなくても同じです.
また行列の積を用いると内積はこうも書けます.
\begin{align}
    (\bm{x},\bm{y}) = \, ^{t}\bm{x} \overline{\bm{y}}
\end{align}
内積を $\langle \bm{x} \mid \bm{y} \rangle$ ,  $\langle \bm{x},\bm{y} \rangle$ と書くこともあります.
ややこしいですが, 本冊子でも物理の記述をするときには従来どおり内積を $\bm{x} \cdot \bm{y}$ と書くことがあるでしょう.
また定義から $(\bm{x},\bm{x})\geq 0$ ですが, これを\textgt{ベクトルの長さ}と呼び,
\begin{align}
    \sqrt{(\bm{x},\bm{x})}=\mid \bm{x} \mid
\end{align}
と書くことも高校と同じです.

その他内積の値が一般に複素数になることが分かります.
高校で
$\cos \theta = ( \bm{x} , \bm{y} ) / ( | \bm{x} | | \bm{y} | )$
という 2 つのベクトルのなす角度が余弦の形で計算できる式を学んだはずですが,
これがそのまま成立するとすれば,  $\cos$ の値が複素数になります.
複素関数論を学んだ後では別にどうということもないのですが,
角度を定義するという観点からみると,  $\theta$ が複素数になってしまって
まともな角度でなくなる (実数でなくなる) ので少し困ります.
これの解決法としては, 複素ベクトルの範囲で角度を考えるときは
\textgt{内積の値が 0 $\Leftrightarrow$ 2 つのベクトルは直交}というところにだけ着目して,
後の角度に関する事項は一切考えない, というものがあります.
実際問題として, 直交性は非常に重要な役割を果たすことがよくありますが,
それ以外の角度を論じることはほとんどありませんので, 特に問題ありません.

次に外積です. これから書く外積\index{がいせき@外積}は\textgt{ $\bbR^3$ のときにしか定義されない}ことに注意して下さい
$\bm{x}=\, ^{t}(x_{1},x_{2},x_{3})$ ,  $\bm{y}=\, ^t (y_{1},y_{2},y_{3})$ として\textgt{外積}を以下のように定義します.
\begin{defn} $\bm{x}$ と $\bm{y}$ の\textgt{外積} $\bm{x} \times \bm{y}$
\begin{align}
\bm{x} \times \bm{y} \defeq \begin{pmatrix} x_{2}y_{3} - x_{3}y_{2} \\
x_{3}y_{1} - x_{1}y_{3} \\
x_{1}y_{2} - x_{2}y_{1}
\end{pmatrix}.
\end{align}
\end{defn}
簡単な記憶法を紹介します. このために行列式の後にしたのですが, 行列式を用いた記憶法です.
\begin{align}
 \bm{x} \times \bm{y}
 =
 \begin{vmatrix}
   \bm{e}_{1} & \bm{e}_{2} & \bm{e}_{3} \\
   x_{1} & x_{2} & x_{3} \\
   y_{1} & y_{2} & y_{3}
 \end{vmatrix}
\end{align}
これを第 1 行に関して展開します. 先程は列に関して展開しましたが, 今度は行です. すると
\begin{align}
 \bm{x} \times \bm{y}
 =
 (x_{2}y_{3} - x_{3}y_{2})\bm{e}_{1}
 +(x_{3}y_{1} - x_{1}y_{3}) \bm{e}_{2}
 +(x_{1}y_{2} - x_{2}y_{1}) \bm{e}_{3}
\end{align}
となり, 確かに上の定義と一致します. これを記憶法といって定義としなかった理由は
成分にベクトルと実数が共存する行列式を定義していないからです.
\subsection{線型独立と基底, 次元 \label{sec:basis}}

とりあえず天下りですが, 線型結合と線型独立, 線型従属の定義を述べます.
あまり変わらないので, 本節は一般の $n$ で述べます.
 $\bm{C}^n$ のベクトル $\bm{a}_{1},\bm{a}_{2},...,\bm{a}_{m}$ に対して
\begin{align}
    c_{1}\bm{a}_{1} + c_{2}\bm{a}_{2} + \dots + c_{m}\bm{a}_{m}
\end{align}
の形のベクトルを $\bm{a}_{1},\bm{a}_{2},...,\bm{a}_{m}$ の\textgt{線型結合}\index{せんけいけつごう@線型結合}といいます.
高校では一次結合と呼んでいたかもしれません.

ベクトル $\bm{a}_{1},\bm{a}_{2},...,{a}_{m}$ の間の関係
\begin{align}
    c_{1}\bm{a}_{1} + c_{2}\bm{a}_{2} + \dots + c_{n}\bm{a}_{m} = \bm{0}
\end{align}
を\textgt{線型関係}\index{せんけいかんけい@線型関係}と呼びます. 全ての $c_{i}$ が $0$ の場合がありますから, 線型関係は必ず存在します.
これを\textgt{自明な}線型関係といいます.
自明でない線型関係はあるとは限りませんが,
    \begin{defn}自明でない線型関係が存在するとき,  $\bm{a}_{1},\bm{a}_{2},...,\bm{a}_{m}$ は
\textgt{線型従属}\index{せんけいじゅうぞく@線型従属}である
自明な線型関係が存在しないとき,  $\bm{a}_{1},\bm{a}_{2},...,\bm{a}_{m}$ は\textgt{線型独立}\index{せんけいどくりつ@線型独立}である.
    \end{defn}
と定義します.

次に基底の定義を述べましょう.
    \begin{defn} $\bm{C}^n$ の有限個のベクトル $\bm{e}_{1},\bm{e}_{2},...,\bm{e}_{m}$ が次の 2 条件を満たすとき,
これらのベクトルが\textgt{基底}\index{きてい@基底}であるという.
\begin{enumerate}
    \item  $\bm{C}^n$ の任意のベクトルは $\bm{e}_{1},\bm{e}_{2},...,\bm{e}_{m}$ の線型結合として表される.
    \item  $\bm{e}_{1},\bm{e}_{2},...,\bm{e}_m$ は線型独立である.
\end{enumerate}
    \end{defn}
定義から, 基底は何か特定の一組のものを指しているわけではありません.
また基底はその順番も大事なので, 順番を込めたものとして
基底を $\langle \bm{e}_1,\dots,\bm{e}_{m} \rangle = \langle \bm{e}_{i} \rangle _{i=1}^m$ などとも書きます.
とりあえずはこれを座標軸のようなものだと考えておいて下さい.
座標軸の選び方が色々あった方がいいので, それを数学的に定式化したものが基底です.
これまで何度となく使ってきた (ものの $n$ 次元版の) $n$ 項単位ベクトルの組
 $\bm{e}_{i} \, , \, i=1,2,\dotsb,n$ (上のものとは別!) は標準基底\index{ひょうじゅんきてい@標準基底}と呼ばれます.

座標軸の選び方が色々あった方がいい, ということがよく分からないと思いますが,
これは物理からの要請とも言えます.  $\bm{R}^3$ で考えてみましょう.

どういうことかというと, 例えば固体の結晶構造を解析したいとします.
手持ちの「キッテル固体物理学入門」によりますと, 三斜晶系, 単斜晶系, 斜方晶系,
正方晶系, 立方晶系, 菱面体晶系, 六方晶系というのがあるようで, さらにこれに格子の数がどうのこうのとあります.
今調べたい結晶の原子配列を見てみたら, お互いに 60 度の角度をなす, 長さの比が 2:1:1 のベクトルの先に原子がちょうど
上手く乗っていたとしましょう. このときこのようなベクトルを取ってやれば, 現象の記述に便利そうです.
この少し斜めに傾いた結晶の解析をするのに, 先程の「まっすぐ」な標準基底をとって調べるような人間がいたら,
その人間の心は曲がっています.

そういうわけでこうした都合の良いベクトルを用いていきたいわけですが, これが標準基底と数学的に同じような
資格をもっていて欲しいわけです. 物理的には良くても数学的に問題があるようでは困ってしまいますから.
ここで「標準基底と数学的に同じような資格」と書きましたが, これがまた曲者です.
どういうことかというと, 「標準基底の持っている性質」というのが何なのかよく分かっていないといけない訳ですが,
これが良く分かりません. 困ってしまったわけですが, こういうとき数学でよく行なう手法というのがありまして,
それを紹介します. それというのは, \textgt{標準基底がどんな性質を持っているかではなく, どんな性質を持っていて欲しいかを考える}
ということです.

 $\bm{R}^3$ の標準基底が持っていて欲しい性質を考えましょう. まず 1 つは標準基底で\textgt{空間内の全ての点を表現出来ない}と困ります.
これは固体内の全ての原子の位置を書き表せないと困る, ということです.
ここから標準基底が持っていて欲しい性質を一つ要請しましょう. それは\textgt{ある程度たくさんのベクトルからなること}です.
例えば上の定義から基底は複数のベクトルからなるのが一般的だそうですが, 仮に基底がただ 1 つのベクトル $\bm{a}_{1}$ からなったとしましょう.
そうすると $\bm{a}_{1}$ では直線上の点しか記述できません. 少なくとも基底がある程度たくさんのベクトルからなっていないと困るわけです.
実際上で述べた標準基底はそうなっています.

そうなるとどのくらい多ければいいのか, というのを考えたいわけです. あまり多くても邪魔なので, 少なめにしたいところです.
あまり少ないと先程の 1 つということになってしまうので, 少し考えないといけません.
これもまた, \textgt{空間内の全ての点を表現出来ない}と困るというところが重要です.
先程同様, 基底が 2 つのベクトルからなるとしても高校で学んだとおり, 良くて平面上の点しか記述出来ません.
というわけで 3 本以上は欲しいことがわかります.
詳しく述べるのはやめますが, 3 次元空間内では 4 本以上あるとこれは上で定義した言葉を使うと, このベクトルの組は線型従属になります.
線型従属だと, その中のベクトルのうちいくつかはその組の中のベクトルのいくつかで書くことが出来, 空間の点を全て表現する,
という観点からは別に無くても不自由しません.
ということで,  $\mathbb{R}^3$ の基底は 3 つあればよい, ということです. 実際標準基底はそうなっています.

今までのことをまとめると, 基底は\textgt{空間内の点を全て表現できること}, \textgt{数がなるべく少ないこと}という性質
を持っていて欲しいということになりました. 基底の定義と比べると, 「空間内の点を全て表現できること」が 1,
〓数がなるべく少ないこと」が 2 に対応することが分かります.

ちなみに 2 を考慮に入れると, 定義で $m$ と書いたところは実は $n$ であったことが分かります.
この数 $n$ のことを次元\index{じげん@次元}といいます.
ある空間の次元を $\dim$ で表します. 今の例で言えば,  $\dim \bm{R}^3 =3$ です.

基底に関して 1 つ重要なことを述べておきます. それは\textgt{正規直交基底}\index{せいきちょっこうきてい@正規直交基底}というものです.
これは $\langle \bm{e}_{i} \rangle_{i=i}^m$ を基底としたとき,
\begin{align}
    (\bm{e}_{i},\bm{e}_{j}) = \delta _{ij}
\end{align}
となるもののことです. ここで $\delta _{ij}$ は Kronecker の $\delta$ であり,  $i=j$ で $1$ ,  $i \not = j$ で $0$ になるというものでした.
ここの言葉の意味を説明しておきましょう. \textgt{正規}というのは $\sqrt{(\bm{e}_{i},\bm{e}_{i})}=\mid \bm{e}_{i} \mid = 1$
となるもの, つまりベクトルの長さが $1$ であるということです. \textgt{直交}というのはもちろん $i\not = j$ のとき
 $(\bm{e}_{i},\bm{e}_{j})=0$ となることです. 例えば標準基底は正規直交基底です.
\subsection{固有値, 固有ベクトル \label{eigen}}

まず固有値・固有ベクトルを定義しましょう.
    \begin{defn}行列 $A$ に対し零ベクトルでないベクトル $\bm{x}$ と\textgt{複素数} \$$\lambda$ \$
が以下の関係式を満たすとき,  $\lambda$ を\textgt{固有値}\index{こゆうち@固有値},
 $\bm{x}$ を\textgt{固有ベクトル}\index{こゆうべくとる@固有ベクトル}という.
\begin{align}
    A \bm{x} = \lambda \bm{x}
\end{align}
    \end{defn}
要するに, 行列の作用により方向を変えないベクトルを固有ベクトルといい,
そのとき行列の作用は当然定数倍にしかなりえないわけですが, その倍数を固有値といいます.

また固有値を一般に複素数といいましたが, この理由を具体例で考えます.
\begin{align}
    R (\theta ) \defeq      \begin{pmatrix} \cos \theta & - \sin \theta \\
                    \sin \theta & \cos \theta
    \end{pmatrix}
\end{align}
この行列の固有値を考えてみましょう. 幾何学的に考えると, この行列をあるベクトルにかける (作用させる) ことは
平面内での回転を意味します. 回転させるので, 「方向を変えない」ということは $\theta = 2n \pi , \, n \in \bm{N}$ のとき
しかありえません. 実際この行列の固有値は $\cos \theta + i \sin \theta$ であって複素数です.
実行列だけを考えていても複素数の固有値が出てくるので, はじめから複素数で話を進めようということです.

また固有ベクトルを零ベクトルでないとした訳は, 当然ながら零ベクトルであれば固有値が何であれ上の式を満たしてしまうからです.

上の固有値・固有ベクトルの定義式では, 行列だけ分かっていて一般には固有値・固有ベクトルは未知です.
これを求める方法を見つけないといけませんが, 一度に両方見つけようというのは欲張りです.
1 つずつ見つけることにしましょう. 上の式を以下のように変形します.
\begin{gather}
    A \bm{x} = \lambda \bm{x} = \lambda I \bm{x} \,\,\,\,\,\, \text{( $I$ は単位行列)} \\
    \Longleftrightarrow \left ( \lambda I - A \right) \bm{x} = \bm{0} \label{eigenvec}
\end{gather}
固有ベクトルはゼロベクトルではないとしていますから,  $\det (\lambda I - A )=0$ が従います.

ここで行列式の計算をすると $n$ 次行列のとき, 一般に行列式は $\lambda$ の $n$ 次方程式になります.
代数学の基本定理により, 重複を含めて
 $n$ 個の根 (解) が必ず存在します. つまり固有値が存在します. ここで求まった固有値を定義式に代入して
固有ベクトルを求めます. この手続きは 1 度やってみないと分からないと思いますので, 1 つ例をやってみましょう.

後で使うのにもちょうど良いので, 一番初めの運動方程式のところで出てきた行列を使いましょう.
\begin{align}
    A = \begin{pmatrix} 2 & -1 & 0 \\ -1 & 2 & -1 \\ 0 & -1 & 2 \end{pmatrix}
\end{align}
つまり上の $A$ の固有値・固有ベクトルをを求めます. 上の教えにしたがってまず行列式を計算します.
行列式の具体的な計算練習も兼ねて, 少し丁寧にやりましょう.
\begin{align}
 0 =
 \det ( \lambda I - A )
 &=
 \begin{vmatrix} \lambda -2 & 1 & 0 \\
 1 & \lambda -2 & 1 \\
 0 & 1 & \lambda -2
 \end{vmatrix} \\
 &=
 (\lambda - 2 ) \begin{vmatrix} \lambda -2 & 1 \\
 1 & \lambda -2
 \end{vmatrix}
 -1\times \begin{vmatrix} 1 & 1 \\
 0 & \lambda - 2
 \end{vmatrix} \\
 &= (\lambda - 2 ) \{ (\lambda - 2 )^2 - 1 \}
 -( \lambda - 2) \\
 &= (\lambda - 2 )\{ \lambda - ( 2 + \sqrt{2} )\} \{ \lambda - ( 2 - \sqrt{2} ) \}
\end{align}
したがって固有値は $2 , \,\, 2 + \sqrt{2}, \,\, 2 - \sqrt{2}$ と分かりました.

固有ベクトルを求めましょう. 分かりやすいように各固有値に対する固有ベクトルを
 $\bm{u}_{2}$ ,  $\bm{u}_{2 + \sqrt{2}}$ ,  $\bm{u}_{2 - \sqrt{2}}$ とします.
式 (\ref{eigenvec}) から
\begin{gather}
    (2 I - A )\bm{u}_{2} = \bm{0} \\
    \Longleftrightarrow
    \begin{pmatrix} 0 & 1 & 0 \\
                    1 & 0 & 1 \\
                    0 & 1 & 0
    \end{pmatrix}
    \begin{pmatrix} u_{2,1} \\ u_{2,2} \\ u_{2,3} \end{pmatrix}
    = 0 ,\,\,\,\, \bm{u}_{2} \defeq \begin{pmatrix} u_{2,1} \\ u_{2,2} \\ u_{2,3} \end{pmatrix} \\
    \Longrightarrow
    \bm{u}_{2}
    =
    \frac{1}{\sqrt{2}} \begin{pmatrix} 1 \\ 0 \\ -1 \end{pmatrix}
\end{gather}
定義から分かるとおり,  $\bm{u}$ が固有ベクトルだとすれば任意の実数 $c$ に対して $c \bm{u}$ も固有ベクトルです.
つまり, 固有ベクトルの大きさは特に指定されていません. それを良いことに固有ベクトルの大きさを $1$ に取っておきました.
後々 $1$ の方が都合がいいのです. ついでに述べておきますと $\bm{u}_{2} = 1/\sqrt{2} \, ^{t}( -1 \,\, 0 \,\, 1)$ でも構いません.
これについては趣味です. 同様にして $\bm{u}_{2 + \sqrt{2}} = 1/2 \, ^{t}(1 \,\, -\sqrt{2} \,\, 1)$ ,
 $\bm{u}_{2 - \sqrt{2}} = 1/2 \, ^{t}(1 \,\, \sqrt{2} \,\, 1)$ となります.

固有値について注意をいくつかしておきます.
\textgt{1 つの固有値に対して固有ベクトルが 1 つであるとは限りません}.
具体的に見てみましょう.
\begin{align}
    \begin{pmatrix} 2 & 1 & 1 \\
                    1 & 2 & 1 \\
                    1 & 1 & 2
    \end{pmatrix}
\end{align}
上の行列の固有値は $1,4$ ですが, 固有値 $1$ の固有ベクトルは $2$ つあります. 選び方には任意性がありますが,
例えば $^{t} (1 \,\,\, -1 \,\,\, 0 ),\,^{t}(1\,\,\,0 \,\,\, -1)$ です.
さらに重要な注意として, 上の固有ベクトルは
\textgt{互いに直交する大きさ 1 のベクトルに選ぶ}ことが出来ます.
最後の以下の定理を証明しておきます.
\begin{thm}
任意の Hermite 行列 $H$ , ユニタリ行列 $U$ の互いに異なる固有値に対する固有ベクトルは直交する.
\end{thm}
(証明)
互いに異なる固有値を $\lambda_1,\lambda_2$ , 対応する固有ベクトルを $\bm{x}_1,\bm{x}_2$ とします.
まず Hermite から示します.
定義から $H^* = H$ であり, 内積の定義から $A$ に対して $( A \bm{x} , \bm{y} ) = (  \bm{x} , A^* \bm{y} )$ となることを思い出して下さい.
まず Hermite 行列の固有値が (複素数ではなく) 実数になることを示します.
\begin{gather}
    ( H \bm{x} , \bm{x} )
    =
    \lambda ( \bm{x} , \bm{x} ) \\
    ( H \bm{x} , \bm{x} )
    =
    ( \bm{x} , H \bm{x} )
    =
    \overline{\lambda} ( \bm{x} , \bm{x} ) \\
    \Longrightarrow
    \lambda = \overline{\lambda}
\end{gather}
これから
\begin{align}
    ( H \bm{x}_1 , \bm{x}_2 )
    &=
    \lambda_1 ( \bm{x}_1, \bm{x}_2 ) \\
    ( H \bm{x}_1 , \bm{x}_2 )
    &=
    ( \bm{x}_1 , H \bm{x}_2 )
    =
    \lambda_2 ( \bm{x}_1, \bm{x}_2 )
\end{align}
となりますから, 辺々引くと $( \lambda_1 - \lambda_2 ) ( \bm{x}_1 , \bm{x}_2) = 0$ であり,
固有値が異なるので,  $( \bm{x}_1 , \bm{x}_2) = 0$ となります.

ユニタリについてもほぼ同様に示せます.
ユニタリの場合は $U^* = U^{-1}$ なので,  $U \bm{x}_i = \lambda_i \bm{x}_i$ から
 $U^* \bm{x}_i = ( 1 / \lambda _i) \bm{x}_i$ となります.
さらに
\begin{align}
    ( \bm{x} , \bm{x} )
    =
    ( U^* U \bm{x} , \bm{x} )
    =
    ( U \bm{x} , U \bm{x} )
    =
    ( \lambda \bm{x} , \lambda \bm{x} )
    =
    \lambda \overline{\lambda} ( \bm{x} , \bm{x} )
\end{align}
から $\lambda \overline{\lambda} = 1$ が分かります. これから
\begin{align}
    ( U \bm{x}_1 , \bm{x}_2 )
    &=
    \lambda_1 ( \bm{x}_1 , \bm{x}_2 ) \\
    &=
    ( \bm{x}_1 , U^* \bm{x}_2 )
    =
    ( \bm{x}_1 , \frac{1} {\lambda_2} \bm{x}_2 )
    =
    ( \bm{x}_1 , \overline{\lambda_2} \bm{x}_2 )
    =
    \lambda_2 ( \bm{x}_1 , \bm{x}_2 )
\end{align}
となるので, 先程と同様にして $( \bm{x}_1 , \bm{x}_2 ) = 0$ です.  $\blacksquare$
\subsection{対称行列の対角化とスペクトル分解\label{taikakuka}}

さて行列の話も大詰めです. ここでは\textgt{対称行列が対角化可能である}ことを示します.
対角化\index{たいかくか@対角化}とは, ある行列 $A$ に適当な行列 $U$ をかけることで対角行列 $\Lambda$ にしてしまうことです.
これがあると何が嬉しいかということは次節で明らかになります.

さて, まず本節で示す定理の最も一般的な形を紹介します.
行列 $A$ が\textgt{正規行列}であるということは $AA^{*} = A^{*}A$ で定義されました.
ここで $A^{*}$ は $A^{*} = \,^{t}\overline{A}$ で定義される随伴行列と呼ばれるものでした.
ここで示したい定理は
\begin{thm}
 正方行列 $A$ に対し $U^{-1}AU$ が対角行列になるようなユニタリ行列 $U$ が存在する為には
 $A$ が正規行列であることが必要十分である.
\end{thm}
というものです.
しかし実用性の観点からは次の定理を示せば十分です.
また実 Hermite 行列は直交行列であることを思い出して下さい.
\begin{thm}
Hermite 行列 $H$ は適当なユニタリ行列によって対角化可能である.
\end{thm}
(証明)
分かりやすくするために 3 次行列に対して証明します. 全く同様にして一般の $n$ 次でも出来ます.
$H$ の固有値を $h_1,h_2,h_3$ , 対応する固有ベクトルをそれぞれ $\bm{u}_1,\bm{u}_2,\bm{u}_3$ とします.
固有ベクトルは規格化 (大きさが 1) しておきます.
また $U = ( \bm{u}_1 \, \bm{u}_2 \, \bm{u}_3 )$ としておきます.

一旦全ての固有値が異なるとして証明します.
積の行列 $U^* H U$ の $(i,j)$ 成分を計算すると
\begin{gather}
    U^* H U
    =
    \begin{pmatrix}
        \bm{u}_1^* \\
        \bm{u}_2^* \\
        \bm{u}_3^* \\
    \end{pmatrix}
    ( H \bm{u}_1 \, H \bm{u}_2 \, H \bm{u}_3 ) \\
    =
    \begin{pmatrix}
        \overline{ (\bm{u}_1 , H \bm{u}_1 ) } & \overline{ (\bm{u}_1 , H \bm{u}_2 ) } & \overline{ (\bm{u}_1 , H \bm{u}_3 ) } \\
        \overline{ (\bm{u}_2 , H \bm{u}_1 ) } & \overline{ (\bm{u}_2 , H \bm{u}_2 ) } & \overline{ (\bm{u}_2 , H \bm{u}_3 ) } \\
        \overline{ (\bm{u}_3 , H \bm{u}_1 ) } & \overline{ (\bm{u}_3 , H \bm{u}_2 ) } & \overline{ (\bm{u}_3 , H \bm{u}_3 ) }
    \end{pmatrix}
\end{gather}
となります. つまり $U^* H U = \left ( \overline{ \left ( \bm{u}_i , H \bm{u}_j \right) } \right)$ です.
ここで $i,j$ を $1,2,3$ のいずれかとして,
\begin{align}
    ( \bm{u}_i , H \bm{u}_j )
    =
    \overline{h_j} ( \bm{u}_i , \bm{u}_j )
    =
    \overline{h_j} \delta _{ij}
\end{align}
となりますから,  $U^* H U$ は対角行列です.

固有値に重複があったときは, 重複した固有値に対する固有ベクトルが複数存在することになりますが,
これらを全て互いに直交するように選びなおすことが出来ます.
したがって上の議論がほぼそのままで成立します.
これで定理が完全に証明されました.  $\blacksquare$

ここで前に正規行列を紹介したので, \textgt{スペクトル分解}\index{すぺくとるぶんかい@スペクトル分解}を紹介したいと思います.
まず\textgt{射影} $P$ を定義します.
$W$ の直交補空間を $W^{\perp }$ とすると,  $\bm{C}^n$ の任意のベクトル $\bm{x}$ は
\begin{align}
    \bm{x} = \bm{x}' + \bm{x}" , \,\,\, \bm{x}' \in W, \,\,\, \bm{x}" \in W^{\perp}
\end{align}
と一意的に分解されます. このとき $\bm{x}$ に対して上手く $P\bm{x}=\bm{x}'$
となる行列 $P$ を部分空間 $W$ への射影であるといいます. また $P$ は
\begin{align}
    P^2 = P\,\,\,\,,\,\,\,\,P^{*}=P
\end{align}
を満たします.

ここで $W_1,W_2$ を $\bC^n$ の 2 つの部分空間とし,  $P_1,P_2$ をそれぞれ $W_1,W_2$ への
射影としましょう. このとき部分空間 $W_1,W_2$ が直交する必要十分条件は $P_1 P_2 = P_2 P_1 = O$ となります.

実際,  $W_1$ と $W_2$ が直交すれば $W_1 \subset W_2 ^{\perp}$ から $P_1 P_2 \bm{x}= \bm{0}$ です.
逆に $P_1 P_2 = O$ ならば, 任意の $\bm{x}_1 \in W_1,\bm{x}_2 \in W_2$ に対し,
\begin{align}
    (\bm{x}_1,\bm{x}_2) = (P_1 \bm{x}_1,P_2 \bm{x}_2) = (\bm{x}_1,P_1 P_2\bm{x}_2) = \bm{0}
\end{align}
となり, 証明終了です.  $\blacksquare$

$A$ を正規行列としましょう.  $A$ の異なる固有値全部を $\beta _1, \beta _2,\dots,\beta _k$ , 対応する
$i$ に対し $W_i \defeq \{ \bm{x} \, ; \, A\bm{x}=\beta _i \bm{x} \}$ とします.
このとき各 $W_i$ は互いに直交し,  $\bC^n$ はこれらの部分空間の直和になります.
$P_i$ を各 $W_i$ への射影とすると
\begin{gather}
P_1 + P_2 + \dots + P_k = I , \,\, P_i P_j = O \,\,\, , \,\,\,i \not = j \\
A = \beta _1 P_1 + \beta _2 P_2 + \dots + \beta _k P_k
\end{gather}
が一意的に成り立ちます. これを正規行列 $A$ の\textgt{スペクトル分解}と言います.

スペクトル分解の意味を少し説明しておきましょう.
一番重要なのは\textgt{固有ベクトルに対しては行列の積の作用が単なる定数倍になる}ということです.
きちんと証明していませんが, ある行列に対してはその行列の固有ベクトルを基底として選べることがあります.
この行列を $A$ , 固有ベクトルからなる基底を $\bm{u}_1,\bm{u}_2,\bm{u}_3$ ,
固有値はそれぞれ $\lambda_1,\lambda_2,\lambda_3$ とします.
すなわち $A\bm{u}_i=\lambda{i} \bm{u}_i$ です.
この固有ベクトルで任意のベクトル $\bm{x}$ を $\bm{x}=x_1\bm{u}_1+x_2\bm{u}_2+\bm{u}3$ と展開します.
このとき行列の作用を考えると,
\begin{align}
    A \bm{x}
    &=
    A (x_1 \bm{u}_1 + x_2 \bm{u}_2 + x_3 \bm{u}_3 )\\
    &=
    x_1 \lambda_1  \bm{u}_1 + x_2 \lambda_2  \bm{u}_2 + x_3 \lambda_3  \bm{u}_3\\
    &=
    x_1 ( \lambda_1 I ) \bm{u}_1 + x_2 ( \lambda_2 I ) \bm{u}_2 + x_3 (\lambda_3 I ) \bm{u}_3
\end{align}
と書けます. ここで $I$ は単位行列です.
こうすると「行列をかける (作用させる) 」という直観的に捉えにくいものが, ただの定数倍に還元され, 非常に見やすくなります.
あとでスペクトル分解と Fourier 解析との関係を少し紹介する予定なので, 軽く紹介してみました.
\subsection{物理への適用}

準備が終わったので, 早速これをはじめに言ってあった現象の解析に応用してみましょう.
3 質点系での解析を行ないます. 問題を再録しましょう.
\begin{align}
    m\ddot{x}_{1} &= -kx_1 - k (x_1 - x_2 ) \notag \\
    m\ddot{x}_{2} &= + k (x_1 - x_2 ) - k (x_2 - x_3) \notag \\
    m\ddot{x}_{3} &= -kx_3 +k (x_2 - x_3 )  \notag \\
    \Longleftrightarrow
    m \begin{pmatrix} \ddot{x}_{1} \\ \ddot{x}_{2} \\ \ddot{x}_{3} \end{pmatrix}
    &= -k \begin{pmatrix} 2 & -1 & 0 \\ -1 & 2 & -1 \\ 0 & -1 & 2 \end{pmatrix}
    \begin{pmatrix} x_{1} \\ x_{2} \\ x_{3} \end{pmatrix} \notag
\end{align}
\begin{align}
    \Longleftrightarrow
    m \ddot{\bm{x}} = -k A \bm{x} \,\,\, , \,\,\,
    \bm{x} \defeq \begin{pmatrix} x_1 \\ x_2 \\ x_3 \end{pmatrix} \,\,\, , \,\,\,
    A \defeq \begin{pmatrix} 2 & -1 & 0 \\ -1 & 2 & -1 \\ 0 & -1 & 2 \end{pmatrix} \notag
\end{align}
ここで $A$ が対称行列 (正規行列) になっていますから, これが対角化できます.

対角化すれば一番初めに見せた $X$ のようなものが上手く見つけられたことに相当し, 首尾よく問題が解けたことになります.
というわけで, \ref{taikakuka}節で示したように $A$ を対角化するようなユニタリ行列を見つけられれば良い, ということになります.
 $A$ の固有値, 固有ベクトルは\ref{eigen}節で求めてしまいました.
これにより $A$ を対角化するには\ref{taikakuka}節のはじめに示した定理を使えば十分です.
つまり, 固有ベクトルから作ったユニタリ行列 $U$ を使えば良いということです.

\ref{eigen}節から固有値, 固有ベクトルを再録してきましょう.
\begin{align}
    \bm{u}_{2}
    =
    \frac{1}{\sqrt{2}} \begin{pmatrix} 1 \\ 0 \\ -1 \end{pmatrix} ,
    \bm{u}_{2 + \sqrt{2}}
    =
    \frac{1}{2} \begin{pmatrix} 1 \\ -\sqrt{2} \\ 1 \end{pmatrix} ,
    \bm{u}_{2 - \sqrt{2}}
    =
    \frac{1}{2} \begin{pmatrix} 1 \\ \sqrt{2} \\ 1 \end{pmatrix}
\end{align}
したがって $U = (\bm{u}_2 \,\, \bm{u}_{2+\sqrt{2}} \,\, \bm{u}_{2-\sqrt{2}})$ とすれば
この $U$ で $U^{*}AU=\Lambda$ として対角化できます. \ref{taikakuka}節のはじめに示した定理によれば,
対角成分には固有値が並びます. このあたりが固有値を「固有」値と呼ぶ所以でしょう.

$\Lambda$ を実際に書いてみると
\begin{align}
    \Lambda = \begin{pmatrix} 2 & 0 & 0 \\
                              0 & 2 + \sqrt{2} & 0 \\
                              0 & 0 & 2 - \sqrt{2}
              \end{pmatrix}
\end{align}
ここで $\bm{X}\defeq U^{*}\bm{x}=\, ^{t} (X_1 \, X_2 \, X_3)$ とします. 上の行列に左から $U^{*}$ をかけて
\begin{gather}
    m U^{*}\ddot{\bm{x}} = -k U^{*}A\bm{x} = -k U^{*}AUU^{*}\bm{x} \\
    \Longleftrightarrow
    m\bm{X} = -k \Lambda \bm{X}
\end{gather}
あとは各 $X_i$ について解くだけです. もちろん, はじめに天下りに出した $X_i$ がこれらです.
これらはこのようにして導き出したものです.

あと詳しく詰めるのは各人で練習してみて下さい. 弾性体への拡張 ( $n \rightarrow \infty$ への拡張) も
適当な本を見ると載っていますから, まずは自分でアタックしてみて下さい.
本節もまだ残り一節ありますが, 次の予告をしましょう.
次章は一般のポテンシャルとその安定点近傍での振動です. 数学的には微分積分学です.
\subsection{無限次元の線型代数学}

この節は後々への接続と量子力学のためのものです
気楽に読んでみて下さい.
\subsubsection{抽象ベクトル 2}

\ref{線型空間の導入}節ではベクトルについて少し突っ込んだ議論をしました.
ここではもう少し踏み込んでいきます.
まず,  $\bC^n$ のベクトルを\textgt{幾何ベクトル}といいます.
ということで他のベクトルがあるということを匂わすわけですが,
その前に一般のベクトルが持つべき性質を考えて見ましょう.
 $\bm{x},\bm{y},\bm{z}$ を任意の幾何ベクトル,  $\alpha, \beta$ を任意の複素数としましょう.
このときこれらは以下の関係式を満たします.
\begin{enumerate}
    \item  $\bm{x} + \bm{y} = \bm{y} + \bm{x}$
    \item  $(\bm{x} + \bm{y} ) + \bm{z} = \bm{x} + ( \bm{y} + \bm{z})$
    \item 全ての $\bm{x}$ に対し,  $\bm{x} + \bm{0} = \bm{x}$ を満たすベクトル $\bm{0}$ がただ 1 つ存在する.
    \item 全ての $\bm{x}$ に対し,  $\bm{x} + \bm{x}' = \bm{0}$ を満たすベクトル $\bm{x}'$ がただ 1 つ存在する.
    \item  $1\bm{x} = \bm{x}$
    \item  $\alpha (\beta \bm{x}) = (\alpha \beta) \bm{x}$
    \item  $\alpha (\bm{x} + \bm{y} ) = \alpha \bm{x} + \alpha \bm{y}$
    \item  $(\alpha + \beta ) \bm{x} = \alpha \bm{x} + \beta \bm{x}$
\end{enumerate}

ここで\textgt{一般のベクトルにも全く同じ性質を要求します}. また時として, 今まで持ってきた
ベクトルの幾何学的な描像は\textgt{理解の妨げ}になります.
例として普通の $n$ 次元ベクトルでも幾何学的な描像が思い描きにくいようなものをあげましょう.

我々が八百屋だとします. 仕入れなどの問題もありますから, 野菜の売上というものは気にかかるものです.
よく売れる品物や品種を調べたりしたいわけですが, このとき $3$ 品目を扱っているとすると
この $3$ 品目の個数を時間変化を調べてみればそれなりに売れ行きが分かるでしょう.
確かにこれは $3$ 次元の空間ベクトルですが, これに空間的な描像を対応させる人は
あまりいないでしょう.
ここではそれをさらに先鋭化させていきます.
\subsubsection{線型空間}

ここで一般的なベクトルの定義 (線型空間の定義) をしてもう一度はっきりさせておきましょう.
\begin{defn}
ある集合 $V$ が $\bC$ 上の\textgt{(複素) 線型空間}\index{せんけいくうかん@線型空間}であるとは,
$f,g \in V$ に対して\textgt{和 (加法)}と呼ばれる演算
があって $f+g$ が定まり, かつ $f+g \in V$ となり, 複素数 $\alpha$ と $f\in V$ に対して
\textgt{スカラー積}と呼ばれる演算があって
$\alpha f$ が定まり, かつ $\alpha f \in V$ となって, これらが次の演算規則を満たすことをいう
\begin{enumerate}
\item  $f + g = g + f$
\item  $(f + g ) + h = f + ( g + h )$
\item 全ての $f$ に対し,  $f + \theta = f$ を満たすベクトル $\theta$ がただ 1 つ存在する.
\item 全ての $f$ に対し,  $f + f' = \theta$ を満たすベクトル $f$ がただ 1 つ存在する.
\item  $1f = f$
\item  $\alpha (\beta f) = (\alpha \beta) f$
\item  $\alpha (f + g ) = \alpha f + \alpha g$
\item  $(\alpha + \beta ) f = \alpha f + \beta f$
\end{enumerate}
\end{defn}
このとき 3 で存在を要請した $\theta$ を\textgt{零ベクトル}\index{ぜろべくとる@零ベクトル}と言います.
零ベクトルは概念的には数の $0$ とは異なりますが, 全く無関係でもありません. 実際,  $0f=\theta$ が成立します.

これを示すには 8 から
\begin{align}
    0f= (0+0) f=0f + 0f
\end{align}
この両辺に $4$ で存在を要請した $(0f)'$ を加えて $2$ と $3$ を用いると
\begin{align}
    \theta = 0f + \{ 0f + (0f)' \} = 0f + \theta = 0f \,\, \blacksquare
\end{align}

 $4$ で存在を要請した $f'$ を $-f$ と書き, \textgt{ $f$ の逆元}と呼びます. ここでマイナス記号を使って
混乱が無いのは $(-1) f=-f$ が成立するからです. 実際
\begin{gather}
    \theta = 0f = (1-1) f = 1f + (-1) f \\
    \Longrightarrow
    (-1) f = -f \,\, \blacksquare
\end{gather}
この他, 今まで使った来たベクトルに対する算法は基本的に\textgt{全て成立することが証明できます}.

そろそろベクトルに対して今までの $\bm{x}$ と異なり, 太字ですら無い $f$ をつかっている理由を説明しましょう.
ここから出てくるベクトルは\textgt{無限次元}を射程に入れた議論をしています.
主に扱うものは\textgt{数列, 関数 (写像), 線型作用素}です.
ここで数列は自然数を定義域とした複素数を値域とする関数 (写像) ですから, 関数の取り扱いを基本とします.
本冊子で扱う線型作用素はほぼ\textgt{微分作用素, 積分作用素}です.
高校までに学んできた微分・積分は「演算」という印象が強かったと思います.
ここでは作用という性質を前面に出します.

まずは次の定理を証明します.
\begin{thm}
関数空間\index{かんすうくうかん@関数空間} $\mathcal{F}(\bC,\bC)$
は線型空間である.
\end{thm}
(証明)
ここではじめの方に述べた「関数」と「関数値」の区別が重要になります.
先程の定義によれば和とスカラー倍を定義しないといけません. 早速定義しましょう.
 $f,g,h$ を $\bC^n$ から $\bC^n$ への関数,  $\alpha,\beta,z$ を複素数とします.
このとき和とスカラー倍は
\begin{gather}
    f + g \longrightarrow  (f+g) (z) \defeq f (z) + g (z) \\
    \alpha f \longrightarrow (\alpha f) (z) \defeq \alpha f (z)
\end{gather}
という風に, 関数の\textgt{作用を用いて定義}します.
前に関数の対応や作用という面を強調したのはこの為です.
また零元 (零ベクトル) $\theta$ は, 恒等的に $0$ を与える関数 (零関数) です. つまり任意の $z$ に対し $\theta (z)=0$ .
ある関数 $f$ が恒等的に $0$ を与える (つまり零関数) とき,  $f\equiv \theta$ と 3 本線で書くことがあります.

また 2 つの関数 $f,g$ が等しいことも作用で定義します. つまり\textgt\{任意の複素数に対し $f (z)=g (z)$ が成立するとき
関数として (ベクトルとして) $f$ と $g$ が等しい\}と言います.
ベクトルであることの証明ですが, 関数値は複素数なので,
上に述べた性質を満たすのは明らかでしょう. 一度きちんとやってみます. 1 は
\begin{align}
    (f+g) (z) &= f (z) + g (z) \\
    &= g (z) + f (z) \\
    &= (g+f) (z)    \\
    \intertext{つまり}
    f+g&=g+f
\end{align}
2 は,
\begin{align}
    \{ (f+g) +h \}(z) &= (f+g) (z) + h (z) \\
    &= f (z) + g (z) + h (z) \\
    &= f (z) + (g+h) (z) \\
    &= \{ f+ (g+h) \} (z) \\
    \intertext{つまり}
    (f+g) + h &= f+ (g+h)
\end{align}
3 は,
\begin{align}
    (f+\theta ) (z) &=f (z) + \theta (z) \\
    &= f (z) \\
    \intertext{つまり}
    f+\theta &= f
\end{align}
4 は,
\begin{align}
    \{ f + (-f) \} (z) &= f (z) + (-f) (z) \\
    &=f (z) - f (z) \\
    &= 0 = \theta (z) \\
    \intertext{つまり}
    f + (-f) &= \theta
\end{align}
確かにこのとき $f$ の逆元 $-f$ は一意的です. 5 は,
\begin{align}
    (1f) (z) &= 1 \times f (z) \\
    &= f (z) \\
    \intertext{つまり}
    1f &= f
\end{align}
6 は,
\begin{align}
    \{ \alpha (\beta f) \} (z) &= \alpha (\beta f) (z) \\
    &= \alpha \beta f (z) \\
    &= (\alpha \beta ) f (z) \\
    \intertext{つまり}
    \alpha (\beta f) &= (\alpha \beta ) f
\end{align}
7 は,
\begin{align}
    \{ (\alpha + \beta ) f\} (z) &= (\alpha + \beta ) f (z) \\
    &= \alpha f (z) + \beta f (z) \\
    &= \{ (\alpha f + \beta f) \} (z) \\
    \intertext{つまり}
    (\alpha + \beta ) f &= \alpha f + \beta f
\end{align}
8 は,
\begin{align}
    \{ ( \alpha + \beta ) f \} (z) &= (\alpha + \beta ) f (z) \\
    &= \alpha f (z) + \beta f (z) \\
    &= ( \alpha f + \beta f ) (z) \\
    \intertext{つまり}
    (\alpha + \beta ) f &= \alpha f + \beta f
\end{align}
以上で関数がベクトルである証明は終わりました.  $\blacksquare$
これで関数の集合が線型空間であることが示されました. 線型空間としての関数の集合を
\textgt{関数空間}と呼ぶことがあります.

作用素についても同じように出来ます. 作用素を $A$ とします.
作用素の場合, あくまで「作用」なので作用する空間を設定しないといけません.

例えば微分作用素のとき, 後でも使いますが,  $r$ 回微分可能でかつ各階の導関数が連続な,  $\Omega \in \bbR$ から
$\bbR$ への関数全体の集合を $C^{r}(\Omega,\bbR)$ と書きますが, その上での作用素, といったような位置付けになります.
今は作用素が作用する空間として適当な空間 $V$ を取ります.
このとき作用素を $A,B$ , 作用する空間の元を $f\in V$ を取り, 作用素の和とスカラー倍は以下のように定義します.
\begin{gather}
A + B \longrightarrow (A + B) f\defeq Af + Bf \\
\alpha A \longrightarrow  (\alpha A ) f \defeq \alpha Af
\end{gather}
\subsubsection{線型独立と次元, 基底 2}

退屈な話が続きました.
そろそろもう少し身のある話に行きます. ここからは今までに有限次元 ( $\bC^n$ ) でしてきた話を
無限次元を視野に入れて話しなおします.

まずは線型独立性です.
\begin{defn} $V= \{ f_{\lambda} \, ; \, \lambda \in \Lambda \}$ の元
が\textgt{線型独立}\index{せんけいどくりつ@線型独立}であるというのは
任意の有限個の $V$ の元 $f_{\lambda _1},\dots,f_{\lambda _n}$ が線型独立であることをいう.
    \end{defn}
直接に無限個の一次独立性を言わないのは, 無限個の元の線型結合を考えると
級数の収束の問題が入ってきて線型結合の係数に余計な制限が加わるからです.

次に次元\index{じげん@次元}です.
    \begin{defn}ある正数 $K$ が存在して $V$ の任意の線型独立な元の組
 $\{ f_i \} _{i=1}^r$ に対し $r \leq  K$ となるとき,  $V$ は\textgt{有限次元}であるという.
一方, どんなに大きい正数 $K$ をとってもある線型独立な元の組 $\{ f_i \} _{i=1}^r$
が存在して $r \geq  K$ となるとき,  $V$ は\textgt{無限次元}であるという.
    \end{defn}



基底はあまり変わりありません.
\begin{defn} $V$ の部分集合 $E=\{ f_{\lambda}\, ; \, \lambda \in \Lambda \}$ が
\textgt{基底}\index{きてい@基底}であるというのは次の 2 条件が成り立つときである.
\begin{enumerate}
\item  $V$ の任意の元は $E$ の元の線型結合として表される.
\item  $E$ は線型独立である.
\end{enumerate}
\end{defn}

ここで
\begin{thm}
 関数空間は無限次元である.
\end{thm}
を証明しましょう.
関数空間としては, 一旦実数から実数への関数の集合を取ります. この部分集合としては $f_n (x) = x^n$ となる関数の集合
 $\mathcal{F}= \{ f_n \, ; \, n \in \mathbb{N} \}$ を取ります.
 $\mathcal{F}$ は無限個の元からなっています. したがってこの任意の有限個の元の線型結合がベクトルとしての零,
つまり零関数 $\theta$ であることを示せば良いわけです. 簡単のため,  $g=c_{0}f_{0}+c_{1}f_{1}+ \dots + c_{n}f_{n}$ を考えましょう.
たまたま $g$ は微分できるのでそれを使いましょう.
 $g (x)=0$ の両辺を $k$ 階微分して $0$ を代入すると
 $g^{(k)}(0)=n (n-1) \dotsb (n-k+1) c_k=0$ となりますから, 任意の $k$ について $c_k=0$ です.
したがって $g=\theta$ を示すことが出来ました.  $\blacksquare$

ついでに言っておくと, この $f_n$ は適当な $V$ の部分空間を取ると, その基底になることがあります.
このあたりは後で Taylor 展開と絡めて説明する予定です.
\subsubsection{内積}

次に内積の話をします. 無限次元での内積をどう定義するか, ということですが, まずは有限次元を思い出しましょう.
 $\bm{x},\bm{y} \in \bC^n$ とします. このとき内積は
\begin{align}
    (\bm{x},\bm{y} ) = \sum_{i=1}^n x_i \overline{y_i}
\end{align}
で定義しました. ここで数列 $(a_n)_{n \in \bN},(b_n)_{n \in \bN}$ を考えます.
これを縦に無限に長い列ベクトルのようにみなし, 上の内積の定義の $n$ を $\infty$ を無限大に飛ばしたものを考えると,
内積のようなものが出来ました.
\begin{align}
    (a_n, b_n ) \defeq \sum _{n=1}^{\infty}a_n b_n
\end{align}

無限級数になってしまったので, 収束の問題が真っ先に登場します. 以後は和が上手く収束するような
ものだけ考えましょう. これを\textgt{ $l^2$ 空間}といいます.  $l^2$ と略して言うこともあります.
「空間」とつけてしまいましたが, これは問題があります. 何故かと言うと, これは数列全体の部分集合には
なりますが, 部分\textgt{空間}になるか分かりません. きちんと部分空間になることを示しましょう.
後できちんと書くか分かりませんが,
\begin{thm}
 上に有界な単調増加実数列は収束する.
\end{thm}
\begin{thm}
 絶対収束する数列は収束する.
\end{thm}
という 2 つの定理を拝借してきます.

部分空間の定義から
和とスカラー倍がまた $l^2$ の元でないといけません. スカラー倍については良いでしょう.
和を考えます.
\begin{align}
\abs{a_n + b_n}^2 \leq 2 (|a_n|^2 + |b_n|^2)
\end{align}
という簡単な不等式を使います.
両辺の和を取ると, まず右辺は収束します. 左辺は正数の和ですから単調増加で,
さらに収束級数の和で抑えられていますから上に有界です. 上の定理によりこれは収束します.
これで $l^2$ が線型空間であることが分かりました.  $\blacksquare$

次は $l^2$ の元の内積がきちんと収束することを示さないといけません. こちらもまた初等的な不等式ですが,
\begin{align}
\abs{a_n b_n}
\leq (|a_n| + |b_n|)^2 \leq 2 (|a_n|^2 + |b_n|)
\end{align}
を使います. これもまた和を取ると右辺は収束します. 先程同様これから左辺が収束しますが,
これは絶対値の級数なので, 絶対収束しています. したがって元の級数, すなわち内積も収束します.  $\blacksquare$

ちなみに「内積」とは言いますが, 有限次元の内積が持つような性質を無限次元でも同様に持っていてもらいたいわけです.
それでは有限時限の内積が持つ性質とは何でしょうか? これは以下に述べるようなものです. それを定義として採用します.
\begin{defn}\textgt{内積}\index{ないせき@内積}とは線型空間 $V$ の 2 元 $f,g$ に対して複素数を対応させ, かつ以下の性質を満たす写像である.
\begin{align}
    (f,f) &\geq 0 \\
    (f,f) &= 0 \Longleftrightarrow f = \theta \\
    (f,g) &= \overline{(g,f)} \\
    (\alpha f_1 +\beta f_2 ,g) &= \alpha (f_1,g) + \beta (f_2,g)
\end{align}
\end{defn}
上の 2 つの性質は\textgt{正定値性}\index{せいていちせい@正定値性}と呼ばれます. これを使うと内積は
\textgt{正定値性を持つ双線型写像}であると言えます.

また記法として主に無限次元のベクトルに対して, 今後ベクトルの長さを
\begin{align}
    \| f \| \defeq (f,f)
\end{align}
と書きます. こう書くときは長さではなく\textgt{ノルム}\index{のるむ@ノルム}と呼びます.

内積から以下のようにして角度 (正確には余弦) が定義できました.
\begin{align}
\cos \theta = \frac{(f,g)}{\| f \| \, \| g \|}
\end{align}
有限次元でこれが定義できるには $\cos \theta \leq 1$ から $|(f,g)| \leq \|f\| \, \|g \|$ を満たさないといけなかったわけですが,
これは Cauchy-Schwarz の不等式で確かに成立していました. Cauchy-Schwarz の不等式を再録しましょう.
\begin{align}
\abs{(f,g)} \leq \| f \| \, \| g \|
\end{align}

無限次元と言わず, 有限次元でも一般に内積が複素数なので,  $\cos \theta$ が複素数値になってしまいます.
(複素) 関数論を学んだあとなら別にあまり問題もないと思うのですが, それなりに困ったものではあります.
しかも正規直交基底の定義に内積を使っているので, 内積は無いと困ります.
ここで方向転換をしまして, 基本的に内積で角度を測るときは直交しているかしていないか, つまり内積が $0$ かどうかだけ
見ているものだと思いましょう.
無条件ではありませんが, 無限次元でも Cauchy-Schwarz の不等式は成立します.

$l^2$ で考えましょう. テクニカルで腹立たしいですが, 紙数の都合もあるのでこんなものを考えます.
\begin{align}
    \sum_{n=1}^{\infty} |ta_n + b_n|^2
    =
    t^2\sum_{n=1}^{\infty} |a_n|^2 + 2t \sum_{n=1}^{\infty} |a_n|\,|b_n| +\sum_{n=1}^{\infty} |b_n|^2
\end{align}
これを $t$ の 2 次式と考えましょう.  $\sum_{n=1}^{\infty} |a_n|^2=0$ のときは $(a_n)_{n \in \mathbb{N}}=\theta$ ですから,
Cauchy-Schwarz の両辺は $0$ で成立します.  $0$ でないとき判別式が負とならねばならないわけですが, これがそのまま
Cauchy-Schwarz の不等式です.  $\blacksquare$

というわけで内積が上手く定義できることがわかります.
ここから正規直交基底なども定義できます.

次は内積を関数について定義してみましょう. 手がかりはもちろん $l^2$ です.
高校で区分求積法を学んだはずですが, それを使います.
\begin{align}
\int _{0}^1 f (x)\overline{g (x)}dx
=
\lim_{n \to \infty }\frac{1}{n}\sum_{k=1}^{n}f\left ( \frac{k}{n}\right) \overline{g\left ( \frac{k}{n}\right)}
\end{align}
積分区間が $(0,1)$ である必要は無いのですが, ひとまず書いてみました.
とりあえず無限級数さえ出てきてくれれば良いです.  $a$ として \$-$\infty$ \$ を $b$ として \$$\infty$ \$ を許して,
関数の内積を
\begin{align}
(f,g) \defeq \int_a^b f (x)\overline{g (x)}dx
\end{align}
とします. こうするとこれは内積の性質を全て持ちます.
当然これから直交などという事も色々でてきます.
Lebesgue の意味で 2 乗絶対可積分な関数空間にこの内積を入れた空間を\textgt{ $L^2$ 空間}といいます.
本冊子ではとても触れることは出来ませんが, これまでに述べた $l^2$ や $L^2$ 空間は
Hilbert (ヒルベルト) 空間と呼ばれるものの具体例です.
これが量子力学の数理の主戦場です.
\textgt{可分な Hilbert 空間は全て同型である}という同型定理と呼ばれるものがありますが,
 $l^2$ ,  $L^2$ 空間はそれぞれ可分な Hilbert 空間です.
量子力学は当初 Heisenberg (ハイゼンベルク) の行列力学と Schr\"odinger (シュレディンガー) の波動力学という形式があって,
これが物理的な解釈なり何なり色々異なって大論争があったそうですが,
物理的な結果は全く同じものを与えるので非常に不思議がられていたそうですが,
これは数学的に行列力学は $l^2$ で考え, 波動力学 $L^2$ で考えていたので, 同型定理から
数学的には同じ結果が出てもおかしくない, とかいう紆余曲折があったそうです.
\subsubsection{直交多項式と基底}

打って変わって基底のところで「この $f_n$ は適当な $V$ の部分空間を取ると, その基底になることがあります」と書きました.
そのような基底になる直交多項式としていくつか挙げておきましょう.
\begin{align}
P_n (x) &\defeq \frac{1}{2^n n!}\frac{d^n}{dx^n}(x^2-1)^n \\
H_n (x) &\defeq (-1)^n e^{x^2} \frac{d^n}{dx^n}e^{-x^2} \\
L_n^{\alpha}(x) &\defeq \frac{d^n}{dx^n}\left ( e^{-x} x^{n + \alpha} \right) \\
J_{\nu }(z) &\defeq \sum_{k=o}^{\infty} \frac{(-1)^k \left \{ \frac{z}{2} \right \}^{\nu + 2k}}
{\Gamma (k + 1) \Gamma (k + \nu +1)}
\,\,\, , \,\,\, \Gamma (z) \defeq \int_0^{\infty}e^{-t}t^{z-1}dt
\end{align}
これらははじめから順に Legendre (ルジャンドル) 多項式, Hermite (エルミート) 多項式,
Laguerre (ラゲール) 多項式, Bessel (ベッセル) 多項式, 最後のおまけは $\Gamma$ 関数といいます.
本当はもう少し言わないといけないことがありますが, 紙数の都合もあり略します.

基底といえば, 我々は今振動・波動の数理を扱っているのであり, 振動・波動と言えば三角関数であり,
振動・波動と言えば重ね合わせの原理というのもあり, ということで
\textgt{基底として三角関数を選んで, それで波動を表す関数を三角関数の重ね合わせでかけると嬉しいな}, と
思ってみたりするわけですが, それは既に昔々 (確かフランス人の) Fourier\index{ふーりえ@Fourier}(フーリエ) さんが考えていまして, 関数を
三角関数の重ね合わせで書く事を\textgt\{関数を Fourier 級数展開\index{ふーりえきゅうすう@Fourier 級数}
(または Fourier 変換\index{ふーりえへんかん@Fourier 変換}) する\}といいます.
紙数の余裕があればあとでやりますが, とりあえず展開式だけ書いておきましょう.
\begin{gather}
f (x)
\sim
\frac{1}{2}a_0 + \sum_{n=0}^{\infty} \left ( a_n \cos nx + b_n \sin nx  \right) \\
a_n \defeq \int_{-\pi}^{\pi}f (t)\cos n t dt \,\, , \,\,
b_n \defeq \int_{-\pi}^{\pi}f (t)\sin n t dt \\
f (x)
=
\frac{1}{ \sqrt{ 2 \pi } } \int_{-\infty}^{\infty}  \hat{f}( \xi ) e^{i\xi x}d\xi \\
\hat{f}(\xi)
=
\int_{-\infty}^{\infty} f (x) e^{-i \xi x} \, dx
\end{gather}
\subsubsection{微分方程式と Fourier 解析ことはじめ}

そろそろ筆者の知識と認識の限界に来ているのですが, もう少し書きましょう.
線型作用素についてです.  $t$ を時間として微分作用素を $D\defeq\frac{d}{dt}$ とします.
 $D^2=\frac{d^2}{dt^2}$ としましょう.
見やすくするため,  $x (t) = f (t)$ と書きます. 運動方程式は以下のような方程式になります.
\begin{align}
    D^2f = -\omega ^{2} f \,\,\, , \,\,\, \omega \defeq \sqrt{\frac{k}{m}}
\end{align}
これをもって何とするか, ですが, 前に $A\bm{x}=\lambda \bm{x}$ というのをやりました.
固有値の話です. \textgt{全く同じ形}をしています. すなわち運動方程式 (微分方程式) は
無限次元空間での固有値問題\index{こゆうちもんだい@固有値問題}を考えている, ということです.
あとで証明しますが, ある条件下で\textgt{微分方程式には解の存在と一意性}が言えます.
いつであっても, 適当な場所から適当な速度で放り出した物体が同一条件下では同じ運動をしてくれないと困るのですが,
この定理は数学的にもきちんとそれが示された, という点で非常に有意義です.

上で述べたように解が存在してしかも一意的です. そんな訳で解を見つけてこられれば, それで全て片がつきます.
解自体は高校の段階で既に見つかっていまして, 三角関数でした. ここでそれを知らないとしてどうするかを考えてみましょう.
1 回微分して自分自身に戻る関数として, 指数関数 $g (x)=e^{kx}$ があります. これを運動方程式に代入してみましょう.
\begin{align}
    D^2 g = k^2 g = - \omega ^{2} g
\end{align}
となるわけです. となると,  $k^2=-\omega^2$ となる数を探してくれば答が見つかります.
2 乗して負になる数として虚数単位の $i$ さんがいらっしゃいました. したがって $k=\pm i\omega$ です.
ここで実は何処かの誰かがこの方程式の解として三角関数がある, ということを教えてくれたとしましょう.
実は 2 階の常微分方程式の解は 2 次元の線型空間になっていまして,  $\cos \omega t,\sin \omega t$ は基底になっています
一意性から $e^{i\omega x}$ は三角関数の線型結合で書けないと困ります. しかも虚数が入っているので
係数に虚数を含んだ線型結合になるでしょう. 結果としてはご存知の方もたくさんいることでしょう.
Euler (オイラー) の公式という次式になります.
\begin{align}
    e^{ix} = \cos x + i \sin x
\end{align}
虚数乗とはこれいかに, といった問題も色々あって結構困るのですが,
関数論の解析接続というものがあって, これはきちんと数学的に正当化されます.
今のところはこれが虚数乗の定義だとでも思っておいて下さい.
微分積分の Taylor 展開のところでも再び登場させるつもりです.

あまりにもとんでもないところまで来てしまいましたが, これは本冊子の目標到達点です.
そして非常に難しいので, 現段階で分からなくても全く問題ありません.

それではそろそろ微分積分に行きましょう.
\chapter{Application to Google's pagerank}

I will translate.
\chapter{量子力学を理解するために斎藤正彦『線型代数入門』\cite{MasahikoSaitoh1}を読む人が注目すべき点}

Togetter からの転載.

\cite{MasahikoSaitoh1} について見るべき所を挙げておきたい.
まず p120 からが決定的に重要.
例 3 で関数空間 (多項式空間) に内積を叩き込んでいる.
量子力学で出てくる線型空間は原則関数空間なので, 正にここを使う.
ヒルベルトとか鬱陶しいのはひとまずいい.

p122 例 5:ルジャンドル多項式.
多項式空間での基底としてのルジャンドルを出してきている.
関数のノルム (ベクトルの「長さ」) も出している.
ルジャンドルは電磁気でも出てくる.
マクスウェルは電磁場の「線型」方程式なので上手くはまってくれる.

p126 例 7, 有限フーリエ級数.
フーリエは知っていると仮定するが, 正にフーリエが線型代数の枠内で議論出来る (部分もある) 事を明示している.
三角関数が (適当な内積空間での) 「正規直交基底」になる.
これは高校の教科書にも計算問題としては書いてある.

問題 7. これは量子統計で使う.
(平衡) 状態はオブザーバブル $A$ に対して適当な複素数を返す関数だが,
これは必ず (密度) 行列を使ってトレースで書けることを言っている.
ただしうるさいことを言うと原則有限次元でしか使えないので, 物理としては役に立たないと言い切ってもいいのだが.

p128 問題 8:ある種の変分とか何とか.
問題 10, 色々な内積とラゲール多項式:他にもこの系で電磁気・量子力学で出てくる「\textasciitilde{}多項式」が再現される.
問題 12, 双対空間:初学者にとって直接どうというのが言いづらいが, 少し進んだ話をするとそれなりに使うはず.
数学としては大事.

第 5 章:量子力学の魂.
p137 例 8, 数列空間:数列も線型代数の枠内で議論できる (部分がある) ということ.

p138 例 9. 線型常微分方程式.
先程から電磁気などそれっぽいのを挙げているが, 微分方程式論を応用先に持つことがここではっきりと分かる.

p144:スペクトル分解. 要するに対角化だが, スペクトル分解は無限次元化出来て量子力学で直接使える.
射影の値域がその固有値の固有空間で, 縮退度が固有空間の次元に対応したりとか何とか.

定理 2.10:行列の極分解.
量子力学的な解釈としては行列は大体複素数と思える.
複素数ならば極形式で表現出来るか考えたくなるのが人情らしいのでそれをやってみた.

定理 2.11:変分原理.
量子力学で基底エネルギーを評価するときに使う.

第 7 章. 行列の関数を定義するという荒業.
ハミルトニアンを $H$ とすると, その系の時間発展は $U_t=e^{itH}$ となる.
ここで行列の指数関数が出てくる.
あと量子光学でコヒーレンス扱うときもこの辺が出てくる.

量子力学ではより激しく微分作用素の指数関数も出てくる:
運動量作用素を $p=-id/dx$ として $e^{itp}$ が出てくる.
この場合, 数学的に正確な定義は面倒だが, とりあえず指数のテイラー展開に直接代入で「納得」されたい.
ついでに言うとこれは本当にテイラー展開になる.

p217, ペロン・フロベニウスの定理.
正確に言うと別のバージョンだが, 固体物性, 磁性のモデルで使うハバードモデルの「研究」で本当に使う.
詳しくは田崎さんの本 \cite{HalTasaki6} を参考にされたい.
Google のページランクでも使う定理で応用は広い.
\part{Calculus}

\chapter{Is 0 area for a point, line segment, line?}

動画から適当に切り出してくる.
\chapter{Volume and surface area of the $n$-dimensional sphere}

I will translate this chapter from the Japanese version.
\chapter{{\bfseries\sffamily TODO} REWRITE AND TRANSLATE Potential behavior and its relation to calculus}

\section{導入}

前章ではばねにつながれた質点の運動の解析を行ないました.
本章では一般のポテンシャルにしたがう力学系 (多数の質点) の運動の解析を行ない
ます.

まずポテンシャル\index{ぽてんしゃる@ポテンシャル}とは何かですけれども,
系のエネルギーを書いたとき, 運動エネルギー以外に
$\frac{1}{2}kx^2,-G\frac{Mm}{r}$ などの項が
現われることがありますが, それのことです.
正確には力 $\bm{f}$ に対し
\begin{align}
\bm{f} =
\frac{ \partial U }{\partial x}\bm{e}_{x} + \frac{ \partial U}{\partial y}\bm{e}_{y} +
\frac{ \partial U}{\partial z}\bm{e}_{z}
\end{align}
となる実数値関数 $U$ が存在するとき,  $\bm{f}$ はポテンシャル $U$ を持つといいます.
一般にポテンシャルは $U,V$ などで表します.
ここでは一般のポテンシャルにしたがう力学系が
\textgt{つりあいの状態から少しずらすとその系は微小振動をする}
ことを示します.

具体的な状況を考えてみましょう.
先程のばねではつりあいの状態はばねの長さが 0 となるところです.
これは振幅の小さいところでは振動します.
これ以外には, 例えば振り子の振動を考えましょう.
あまり高くない適当な位置から振り子を静かに放すと, 摩擦などが無いとすればずっ
と振動を続けるでしょう.
鉛直方向から少しだけずらしたところでは, 完全に単振動となることは高校で学んだ
と思います.
他には放物線 $y=x^2$ に沿って質点を静かに放すと, これも摩擦が無いとすれば
放物線に沿って転がりつづけるでしょう.
ある程度の高さまで上ったらまた放物線に沿って戻ってくるということも問題ないで
しょう.

上の例では適当に座標系を取ると, 原点でつりあいの状態になります.
これらは全て\textgt{安定なつりあい}\index{あんていなつりあい@安定なつりあい}になっています.
安定なつりあいというのは, 少しずらしただけならばまたその元の状態に\textgt{自然に}戻ろうとする
ような状態のことです.
不安定なつりあいを考えてみると良く分かるでしょう.
 $y=-x^2$ の放物線に沿った運動では原点はつりあいの点ですが, 少し動かすと
放物線に沿って転がり落ちていき, 原点に自然に戻ってくることはありません.
これが不安定な釣り合いです.

少々唐突ですが, 今の状況を考えると 1 変数では
\textgt{下に凸な曲線に従った運動は安定である}
といえそうです. もちろん $y=x^2$ や (半) 円が基礎です.
ただ, これを高次元に一般化しようと思うと大変です.
大変そうな具体例が作れます.

例えば $z=f (x,y)=x^2-y^2$ を考えます.
これの微分をどう考えるか, という問題がまずありますが,
それよりも比較的楽に図が描けるので, その図を元に考えます.
はじめに言っておくと, 原点で変な挙動を取ります.

原点の近くを $x$ 軸に沿って進んでみましょう.
つまり $z=f (x,0)=x^2$ に沿って進みます.
すると $z$ は原点で極小になります.
一方で $y$ 軸に沿って進んでみましょう.
つまり $z=f (0,y)=-y^2$ に沿って進みます.
すると今度は $z$ が原点で極大になります.
ある方向から近づくと極大値を取り, ある方向から近づくと
極小になるような点が存在します.
また実はこの点で微分が 0 になりますから,
微分が 0 になり, かつ極大とも極小ともいえないような
変な点が存在することになります.
ちなみにこの点を\textgt{鞍点}\index{あんてん@鞍点}といいます.

次に $z=y^2$ を $z$ 軸の周りに回転させたものを考え,
これを $z=f (x,y)$ としましょう.
これは簡単に想像できるでしょう.
このとき, 直観的に原点が安定点になることが分かります.
先程との比較で言うと, こちらは
\textgt{どの方向から原点に近づいても $z=f (x,y)$ は極小になる}
事がわかります.

以上から, どの方向から原点に近づいても, というような条件を
数学的にどう定式化していくかが鍵になりそうです.

そして私たちは前章で線型代数を学びました.
出来ればそれを上手く使っていけると嬉しいわけです.
その方法として
\textgt{線型化}\index{せんけいか@線型化}
ということを考えます.
高校で微分を用いた一次近似式を学んだと思います.
接線, といえばもっとはっきりするでしょう.
これは曲がったものでも, ある点の十分近くで考えれば
それはまっすぐとみなせる, ということです.
これは日常経験で常に感じていることです.

私たちは地球表面上に住んでいますが, 地球は楕円形です.
要するに曲がっているわけですが, 普段私たちは地面が
曲がっているとは感じないで, まっすぐになっていると感じています.
これは曲がったものを十分小さいところで考えてまっすぐのものとみなす
考えは, 日常的な行為であり直観的にも正当なものであると考えられます.

私たちはこれを\textgt{線型化}と呼びましょう.
そして上に述べた直観を数学の理論として取り込むべく,
線型化法として微分を考えてみましょう.
せっかくなので本章では微分だけでなく積分も説明します.
こちらは微分方程式の実際の解法を考えることから導入してみたいと思います.
\section{$\varepsilon$ - $\delta$ 論法と収束}

\subsection{$\varepsilon$ - $\delta$ 論法}

これから微分・積分を論じます.
積分は微分の逆, という感じであまり極限の香りがしないと思っている方もいるかもしれません.
しかし微分を考えれば分かるように, これから極限についての考察をすることになりますが,
場合によっては非常に精密な取り扱いを要求されることがあります.
その際, 高校での極めていい加減な極限の定義では, ほとんど全く何も議論できません.
そこでもっと議論しやすくするために極限の精密な定義を与えます.

 $\lim_{n \to \infty}a_n=a$ というものを考えましょう.
これは高校では「 $n$ が限りなく大きくなる時 $a_n$ は $a$ に
限りなく近づく」ということを意味している, という事でした.
これを再考します.

今何か適当な実験, 例えば重力加速度の測定実験をするとしましょう.
まず考えるべきは実験の精度をどこまで高めたいか, という事です.
高校でも実験をしてきたでしょうが,
こうした実験では誤差がある程度大きくても許されるでしょう.
一方で値の正確さを競うような研究の現場のレベルの実験においては
可能な限り精度を高めねばならず, 京大に国際重力基準点というのがあるそうですが,
そこで行なっている実験では 9 桁の精度で重力加速度を測定しているようです.
さらには実験を行なう際,
高出力を出し過ぎると危険な装置もありますし, 何処かの施設に行って
時間制限のある中でやらねばならないこともあるでしょう.
この際, \textgt\{これぐらいの結果を出したい (出力したい) が
そのためにはどれぐらいの入力を行なえばよいか\}ということを
事前にきっちり決めておかないといけません.

ここで前章に述べた, 「数列は関数の一種であり, 関数とは対応である」
ということを思い出しましょう.
各種の入力 (気温や湿度, 装置の精度
など) に対しある実験データが出てきますから, その出力の平均のようなものを対応させる関数 (数列) を考えます.
このとき, 各種の入力が精度の順で適当に順序付けできるものとします.
ここで上に述べたことを実行するには, 出力に対しその出力を得られるような
上手い入力を見つけることが重要になります.
例えば理論で予測される値が $a$ であったとして,
 $a$ の付近に適当な誤差で
値が散らばるような実験が行ないたいものとします.

精度の程度 (レベル) を自然数で $n$ とし, それに対し
実験値を与える対応 (数列) を $(a_n)_{n \in \bm{N}}$ としましょう.
理論値と実験で得るべき値との誤差を $\varepsilon >0$ とします. すなわち
 $|a_n -a| < \varepsilon$ となってくれれば良いわけです.
今 $a$ の値を実現するような $n$ が存在したとし, それを $N$ とします.
 $n$ の値については, ある精度の実験をすれば上の不等式を満たすのならば,
それ以上の精度では必ず上の不等式を満たすでしょう.
つまり適当な自然数 $N$ が存在して $n \geq N$ ならば
 $|a_n -a|<\varepsilon$ となるはずです. .

以上をまとめると,
誤差範囲 $\varepsilon >0$ を決めたのち, ある精度レベル $N$ の実験で
結果が上手くその誤差の範囲に収まるならば,
その精度以上の実験 $n \geq N$ をすれば, 実験結果 $a_n$ と出したい値 $a$
の差は $|a_n -a| < \varepsilon$ に収まってくれるだろう,
ということです.
ここで $\varepsilon \to 0$ をすると, 誤差が
「限りなく」小さくなるので, それに対応して入力も極めてシャープに
せざるを得ず,  $N \to \infty$ となるでしょう.
こうした現実を踏まえ, これ以降極限を次の定義で置き換えます.
\begin{defn}( $\vep$ - $\delta$ 論法 1)\index{いぷしろんでるたろんぽう@ $\vep$ - $\delta$ 論法}
実数列\index{すうれつ@数列} $(a_n)_{n \in \mathbb{N}}$ が実数 $a$ に
\textgt{収束する}\index{しゅうそく@収束}とは, 任意の正数 $\varepsilon$ に対して
自然数 $N$ が存在し,  $n\geq N$ を満たす
全ての $n$ に対し $|a_n-a|<\varepsilon$ が成立することをいう.
このとき $a$ は $(a_n)_{n \in \bm{N}}$ の\textgt{極限}\index{きょくげん@極限}であるといい,
\begin{align}
    a = \lim_{n \to \infty}a_n ,\,\, a_n \to a \, (n \to \infty)
\end{align}
などとかく.
\end{defn}

これを関数について言うと以下のようになります.
\begin{defn}( $\vep$ - $\delta$ 論法 2)
区間 $I$ 上定義された実数値関数 $f$ が $x \to a$
で $\alpha$ に\textgt{収束する}\index{しゅうそく@収束}とは, 任意の正数 $\varepsilon$ に対して
実数 $\delta >0$ が存在し,  $|x-a|<\delta$ を満たす
全ての $x$ に対し $|f (x)-a|<\varepsilon$ が成立することをいう.
このとき $a$ は $f (x)$ の\textgt{極限}\index{きょくげん@極限}であるといい,
\begin{align}
    \alpha = \lim_{x \to a}f (x) ,\,\, f (x) \to \alpha \, (x \to a)
\end{align}
などと
\end{defn}

最後に極限について 1 つ注意をしておきます.
それは\textgt{一般に極限をとる順序は交換出来ない}ということです.
例えば二重数列 $a_{mn}=\frac{m}{m+n}$ というものを考えてみると
\begin{gather}
    \lim_{m\to\infty} \lim_{n\to\infty}a_{mn}
    =
    \lim_{m\to\infty}0
    =
    0,
    \qquad
    \lim_{n\to\infty} \lim_{m\to\infty}a_{mn}
    =
    \lim_{n\to\infty}1
    =1\\
    \Longrightarrow
    \lim_{m\to\infty} \lim_{n\to\infty}a_{mn}
    \not=
    \lim_{n\to\infty} \lim_{m\to\infty}a_{mn}
\end{gather}
となります. 物理にもよく出てくる極限の順序交換は
\textgt{微分と積分の順序交換}, \textgt{多変数の高階微分の順序交換}です.
物理をやっている場合, 普通は性質の良いものを扱うからこうした順序交換が許される, という仮定の元でどんどん計算を進めていきますが,
量子力学では, こうした演算の順序が交換出来ないということが本質的な条件として登場してきますので, 一応注意を喚起しておきます.
\subsection{Cauchy 列と実数の性質}

高校までは基本的に具体的な数列を扱い (例えば $a_n = 1/n$ ),
かつ極限も比較的楽に求まるようなものばかり扱ってきたと思います.
しかしこれからはかなり一般的な数列を扱い, さらに具体的な数列であろうとも
極限がまともに求まらないような数列まで扱うようになります.
後で色々証明しますが, 収束するだけことは分かっても収束する値が
全く分からないことも良くあります.
その際, 収束先が分かっていないのに上の極限の定義で極限値を
表に出すのは気が引けるというものです.
それで以下の Cauchy (コーシー) 列を導入します.
\begin{defn}数列 $(a_n)_{n \in \bm{N}}$ が\textgt{Cauchy 列 (基本列)}\index{こーしーれつ@Cauchy 列}であるとは,
任意の $\varepsilon >0$ に対し自然数 $N$ が存在して
 $n,m \geq N$ ならば $|a_n - a_m|<\varepsilon$ となることを言う.
\end{defn}
すぐあとで使うこともあり, 解析学で良く使う基本的な不等式である三角不等式を載せておきます.
簡単に証明できるので証明は各自行なってみて下さい.
\begin{align}
    |a+b|<|a|+|b|,
    \quad
    \bigl | |a|-|b| \bigr | < |a-b|
\end{align}
ここで\textgt{収束列が Cauchy 列である}ことを証明します.
 $\an$ が収束列で,  $a$ に収束するものとすると, 収束の定義から任意の $\vep>0$ に対して
自然数 $N$ が存在して,  $n,m\geq N$ ならば $|a_n-a|<\vep/2,|a_m-a|<\vep/2$ が成立します.
三角不等式を用いて
\begin{align}
    |a_m - a_n|
    \leq
    |a_m - a | + |a - a_n |
    <\vep/2 + \vep/2
    =
    \vep. \blacksquare
\end{align}
問題はこの逆, \textgt{Cauchy 列は収束列である}が成立するかどうかです.
Cauchy 列というのは,  $n$ と $m$ が十分大きければ $a_n$ と $a_m$ がいくらでも近い値を取るということなので,
直観的にはこれが満たされそうな気がしますが, 例えば
\textgt{有理数の集合内で考えたとき Cauchy 列は収束しない}ことがあります.
例えば数列
\begin{align}
    a_1=1,
    \quad
    a_{n+1}
    =
    \frac{2a_n+2} {a_n+2}
\end{align}
を考えます. これが $a$ に収束するとすれば, 漸化式の両辺で $n\to\infty$ とすれば,
 $a=\frac{2a+2}{a+2}$ から $a=\sqrt{2}$ を得ます.
 $\an$ は初項が 1 で有理数, 漸化式から全ての $n$ について $a_n$ が有理数ですが, 収束先の $a$ は無理数です.

当然この原因は窮屈な有理数の中だけで考えている為に起こる現象です.
したがって実数列ではこのようなことが起こらないという\textgt{要請}をおきましょう.
\begin{axm}Cauchy 列は収束列である.
\end{axm}
この他にももう 1 つの性質を要請します.
\begin{axm}(Archimedes の原理)\index{あるきめですのげんり@Archimedes の原理}任意の実数 $a,b>0$ に対し,  $n a>b$ となる自然数 $n$ が存在する.
\end{axm}
この Archimedes (アルキメデス) の原理は以下の式と同等です.
\begin{align}
    \lim_{n\to\infty}n=\infty,
    \qquad
    \lim_{n\to\infty}2^n=\infty.
\end{align}

これと同値な\textgt{連続の公理}を述べるのにいくつか新しい概念が必要なので, それを紹介します.
1 つは最大値を一般化した\textgt{上限}と呼ばれるものです.
まず最大値をきちんと定義しておきます.
\begin{defn}
ある集合 $A$ の\textgt{最大値}\index{さいだいち@最大値}が $M$ であるというのは,  $M\in A$ であって,
任意の $x\in A$ に対して $x\leq M$ となるものである. 最小値\index{さいしょうち@最小値}も同様に定義する.
\end{defn}
重要なのは $M\in A$ というところです.
具体的に開区間 $I=(0.1)$ を考えてみましょう.
 $I$ の最大値とは何でしょうか?
当然真っ先に思いつくのは $1$ という答ですが,  $1\notin I$ であり, 1 は最大値ではありません.
しかし最大値のようなものを持ち出して議論をしたいときがあり,
1 に最大値のような資格を与えておくと便利なことが多々あります.
これを定式化したものが上限です.
その前に上界を定義しておきます.
\begin{defn}
$u$ が $A$ の\textgt{上界}\index{じょうかい@上界}であるというのは, 任意の $a\in A$ に対して $a\leq u$ となる $u$ のことである.
$A$ の上界全体の集合を $U (A)$ と書く.
さらに\textgt{下界}\index{かかい@下界}も同様に定義する. こちらは $L (A)$ と書く.
\end{defn}
ここで上界には必ず最小元が存在します.
この最小元を上限と定義します.
\begin{defn}
\textgt{上限}\index{じょうげん@上限}とは上界の最小の元,  $\min U (A)$ のことである.
これを $\sup U (A)$ と書く.
\textgt{下限}\index{かげん@下限}も同様に定義する. こちらは $\inf L (A)$ と書く.
\end{defn}
これを用いてもう 1 つ新しい概念を導入します.
\begin{defn}
ある集合 $A$ が\textgt{上に有界}\index{うえにゆうかい@上に有界}であるというのは, 有限な上界が存在することである.
すなわち $U (A)\not=\emptyset$ である. \textgt{下に有界}\index{したにゆうかい@下に有界}も同様に定義する.
上下に有界な集合を単に\textgt{有界}\index{ゆうかい@有界}であるという.
\end{defn}
直観的には $\pm\infty$ を含まない, といったようなことです.

さて, やっとのことで連続の公理\index{れんぞくのこうり@連続の公理}です. いくつかあるのでそれを列挙します.
\begin{axm}(Weierstrass)
上に有界な空でない集合 $A\not=\emptyset$ は上限を持つ.
\end{axm}
上に有界というのは $A$ が一定以上の大きな値を元に持たないということですから,
直観的にはこれも正しいと感じられるのではないでしょうか.
\begin{axm}
\begin{enumerate}
\item[1)] 上に有界な単調増加数列 $\an$ は収束し, 極限は $\sup \, a_n$ に等しい.
\item[2)] 下に有界な単調減少数列 $\bn$ は収束し, 極限は $\inf \, b_n$ に等しい.
\end{enumerate}
\end{axm}
これは上に有界ならば, 数列の各項はある値以上にはなれません.
さらに単調増加なので, 数列の各項はそのある値にいくらでも近くなれるでしょう.
ただ近くなるだけでなく, 実際にその値に収束までしてしまうことを述べた (要請した) ものです.
\begin{axm}(区間縮小法)
 $I_n\defeq[a_n,b_n]$ で $\an$ は単調増加数列,  $\bn$ は単調減少数列であるとする.
すなわち $a_1\leq a_2\leq \dotsb a_n \leq b_n \leq \dotsb b_2\leq b_1$ であり,
全ての自然数 $n$ に対して $I_n \supset I_{n+1}$ であるとする.
このとき $\displaystyle \lim_{n\to\infty}(b_n - a_n)=0$ ならば,  $I_n$ の共通部分は
1 点 $a$ のみからなる.
\end{axm}
これはある区間 $I=[a,b]$ には隙間無く実数が詰まっていることを表しています.
有理数と対比させると分かりやすいでしょう.
\begin{axm}(Bolzano-Weierstrass)
有界数列は収束部分列を持つ.
\end{axm}
数列 $\an$ の\textgt{部分列}というのは $\an$ の各項を $a_1,a_5,a_78,\dotsb$ などのように適当に選んできたとき,
上手い選び方をすると, もとの数列が何であろうとも有界でさえあれば, その部分列が上手く収束する
ことを述べています. 例えば $a_n=(-1)^{n}$ を考えると $a_n$ 自体は収束しませんが,
偶数番目, 奇数番目だけ集めた数列 $(a_{2n})_{n\in\bN},(a_{2n+1})_{n\in\bN}$ はそれぞれ $+1,-1$ に収束します.
これらの公理は全て同値ですが, この同値性を証明するのは面倒なので略します.
\subsection{数列, 級数の収束}

本冊子では全ての定理を完全に証明しきることは出来ませんが,
あとで登場する Taylor の定理ぐらいはきちんと証明したいので, そのための準備をします.
ただひたすらに証明を行ないます.
3 つ言葉を定義しておきます. 各項が正, すなわち任意の
 $n \in \mathbb{N}$ に対して $a_n \leq 0$ となる級数 $\sum a_n$ を
\textgt{正項級数}\index{せいこうきゅうすう@正項級数}と呼びます. さらに数列 (一般に関数などでも良い) が
\textgt{上に有界である}とは定数 $M \in \mathbb{R}$ が存在し,
任意の $n \in \mathbb{N}$ に対し $a_n \geq M$ となることをいいます.
また $x$ のべき $x^n$ からなる級数 $\sum \, a_n x^n$ を\textgt{べき級数}\index{べききゅうすう@べき級数}といいます.

\begin{thm}[級数に関する Cauchy の収束条件]
級数 $\sum\, a_n$ に対し次の 2 条件は互いに同値である.
\begin{enumerate}
    \item[1)] $\sum\,a_n$ は収束する. すなわち部分和の数列 $\sn$ が収束する.
    \item[2)] 任意の $\vep>0$ に対してある $n_0\in\bN$ が存在して,
     $n>m\geq n_0$ となる全ての自然数 $n,m$ に対して $|a_{m+1}+\dotsb+a_n|<\vep$ となる.
\end{enumerate}
\end{thm}
(証明)
\begin{enumerate}
\item は $\sn$ が Cauchy 列であるということです.
\end{enumerate}
Cauchy 列は収束することを公理として要請していますから, 定理の statement が成立します.  $\blacksquare$

\begin{thm}
 $\sum\,|a_n|$ が収束するとき,  $\sum \, a_n$ も収束する.
\end{thm}
(証明)
三角不等式から $|a_{m+1}+\dotsb+a_n|\leq |a_{m+1}|+\dotsb|a_n|$ ですから,
$\sum\,|a_n|$ が前定理の Cauchy の収束条件を満たすとき,
$\sum\,a_n$ も Cauchy の条件を満たします.  $\blacksquare$
またこの定理を元にして, 級数 $\sum\, a_n$ が\textgt{絶対収束}するというのは各項を絶対値にした級数
 $\sum\, |a_n|$ が収束することを言います.

\begin{thm}
正項級数 $\sum a_n$ が収束するためには
部分和の数列 $(s_n)_{n \in \mathbb{N}}$ が上に有界となることが
必要十分である.
\end{thm}
(証明)
まず十分性から示します. 部分和の数列とは $s_n=\sum_{k=0}^n a_k$ のことでした.
任意の $n\in \mathbb{N}$ に対し,
 $a_n \leq 0$ から部分和の数列 $(s_n)_{n \in \mathbb{N}}$ が
上に有界ならば「上に有界な単調増加列は収束する」という公理から, この数列は収束します.

次に必要性を示しましょう.  $(s_n)_{n \in \mathbb{N}}$ が収束するならば,
収束先を $s$ とすると
定義により任意の $\varepsilon$ に対し $N \in \mathbb{N}$ が存在し,
 $n \leq N$ ならば $|s_n - s| < \varepsilon$ となります.
 $\varepsilon$ を適当に固定します. 色々な本を見ると大抵 1 にとってあるでしょう.
別に何でもよいのでここでは $\varepsilon =10^{-2098}$ とでもしておきます.
このときにも自然数 $N_0$ が存在して $n \leq N_0$ ならば
 $|s_n - s| < 10^{-2098}$ となります. これから
\begin{align}
    n \leq N_0 \Longrightarrow s_n <s + 10^{-2098}.
\end{align}
ここで $M\defeq\mathrm{max} \{ |s_0|,|s_1|,\dotsb,|s_{N_0-1}|,s+10^{-2098} \}$
としましょう. ここで $\mathrm{max}\{\dotsb \}$ とは $\{\dotsb \}$ の中の最大数を
表すものとします.
第 $n$ 項 $s_n$ を考えたとき,  $n\leq N_0$ ならば $\mathrm{max}$ の定義から
 $s_n \leq M$ で,  $n \geq N_0$ でも $s_n <s+10^{-2098} \leq M$ であり,
確かに上に有界です. これは「収束する数列は有界である」
を示したことになります.  $\blacksquare$

\begin{thm}[比較定理]
 $\sum a_n,\sum c_n$ は正項級数で
 $\sum c_n$ は収束するものとする. このとき全ての $n$ に対し $a_n \geq c_n$
ならば $\sum a_n$ は収束する.
\end{thm}
(証明)
このとき, 級数 $\sum c_n$ の部分和の数列は級数が収束することから
上に有界です. 仮定から $\sum a_n$ の部分和の数列も上に有界となり,
 $\sum a_n$ が単調増加数列になることから
「上に有界な単調増加数列は収束する」という公理を用いることで
この級数が収束することが分かります.  $\blacksquare$

\begin{thm}
正項級数 $\sum a_n$ に対し,  $0\geq k <1$ となる実数
 $k$ が存在し, ある $n_0$ より大きな全ての $n \in \mathbb{N}$ に対し
 $a_{n+1}/a_{n} \leq k$ となるとき,  $\sum a_n$ は収束する.
\end{thm}
(証明)
 $a_{n+1}\leq k a_{n}$ から $a_n<k^{n-1}a_0$ となります. 両辺の和を取ると
左辺は公比が 1 より小さいので収束します. よって上の比較定理から
 $\sum a_n$ は収束します.  $\blacksquare$


\begin{thm}[ratio test]
正項級数 $\sum a_n$ に対して
\begin{align}
    \lim_{n \to \infty}\frac{a_{n+1}}{a_n}=l
\end{align}
が存在するとき,  $l$ が 1 より小さいならば $\sum a_n$ は収束する.
\end{thm}
(証明)
このとき収束の定義から十分大きな $n \in \mathbb{N}$ を取ると
\begin{align}
    \frac{a_{n+1}}{a_n} < l + \varepsilon < k <1
\end{align}
をみたす実数 $k$ が存在します. これから $\frac{a_{n+1}}{a_n}<k<1$ となり,
前定理より級数 $\sum a_n$ は収束します.  $\blacksquare$
\subsection{開集合, 閉集合, 近傍}

後の叙述の便宜の為にいくつかの概念を紹介します.
まず\textgt{集合族 (系)}\index{しゅうごうぞく@集合族}というものを定義します.
標語的には\textgt{集合を元とする集合}です.
具体的にいうと,  $\mathcal{O} = \{ A, B, \dotsb \}$ が集合族であるというのは,
その元である $A,B,\dotsb$ がまた集合であるということです.
さらに $\bbR^n$ の開区間とは,  $(a_1,b_1) \times \dotsb \times (a_n,b_n)$ の形の集合とします.
その上で開集合系を以下のように定義します.
\begin{defn}
開区間の適当な個数 (有限個でも無限個でも良い) の和集合で書ける集合を\textgt{開集合}\index{かいしゅうごう@開集合}という.
開集合からなる集合系を\textgt{開集合系}といい,  $\mco$ と書く.
開集合系には全空間 $\bbR$ と空集合 $\emptyset$ も含む.
\end{defn}
このように開集合とは開区間の一般化であると考えて構いません.

他にもいくつか言葉を定義します.
\begin{defn}
 $\bbR^n$ の部分集合 $A$ の 1 点 $\bm{a}\in A$ の\textgt{ $\vep$ -近傍}\index{いぷしろんきんぼう@ $\vep$ -近傍}を,
    \begin{align}
        U ( a ; \vep )
        \defeq
        \{ \bm{x} \in \bbR^n \, ; \, |\bm{x} - \bm{a}| < \vep \}
    \end{align}
で定義する. これは中心を $\bm{a}$ とし, 半径 $\vep$ の円 (球) のことであり, さらに開集合である.
\end{defn}
\begin{defn}
 $\bbR^n$ の部分集合 $A$ の 1 点 $\bm{a}\in A$ が\textgt{内点}\index{ないてん@内点}であるというのは,
ある $\vep>0$ が存在して,  $\bm{a}$ の $\vep$ -近傍全体が $A$ に含まれることである.
すなわち $U (\bm{a};\vep) \subset A$ .
\end{defn}
近傍というとき普通 $\vep$ の値は小さいとして考えるのが普通です.
したがって $\bm{a}$ の近傍とは文字通り $\bm{a}$ のすぐまわりの点の集合です.
 $a$ が $A$ の内点であるというのは,  $a$ のある程度近くの点が全て $A$ に属するということです.
さらに定義から $a \in A$ が前提です.
例えば $I=[0,1)$ とします.
 $0,1$ の近くには $I$ の点がありますが, 一方ですぐ近くに $I$ に属さない点があります.
つまり $0,1$ は $I$ の内点ではありません.
 $-1,9$ などはそもそも $A$ の点ですらありません.
したがって内点ではありません.
 $I$ の内点とは開区間 $(0,1)$ の点です.
重要なことですが, 開集合の点は全て内点です.

閉集合書く.

まだ作りかけ. 収束の話はなるべくきちんとする.
\subsection{コンパクト性}

作りかけ.
\subsection{連続と一様連続}

作りかけ.
\subsection{連結と弧状連結}

領域
\subsection{完備な空間}

\section{1 変数の微分と Taylor 展開}

まずは定義域が開区間 $I =(a,b) \in \bm{R}$ の 1 変数実数値関数
 $f (x)$ の線型化\index{せんけいか@線型化}を考えてみましょう.
 $y=f (x)$ のグラフを考えます.
簡単のため, はじめは座標を適当にとって原点の近くで考えることにします.
直観的な描像から原点の近くで関数値の差が直線になっていてくれれば
よさそうです.  $x$ を十分小さくとったとき,  $A$ をある定数とすると
\begin{align}
    f (x) - f (0) = A (x-0) + O\left ( (x-0)^2 \right)
\end{align}
とすれば, 原点の十分近くでは直線になっているでしょう.
ここで $O\left ( (x-0)^2 \right)$ は $h$ がある程度大きくなってくると当然曲がりが大きくなる
ので, その補正です. 曲がりなので $(x-0)^2$ 以上の項で適当に近似できるものと考えます.

ここで原点の十分近くでの線型化ですから, 定数 $A$ は
原点のみで決まって欲しいと思います.
つまり $x$ が十分小さいうちは $A$ だけで $f (x)$ の挙動が完璧
に把握できるものとしたいわけです.
したがって $A$ は\textgt{原点のみの関数}であることを要求します.
また $O\left ( (x-0)^2 \right)$ は 2 次以上の挙動をあらわすので,  $x \rightarrow 0$ で
 $O\left ( (x-0)^2 \right) / (x-0) \rightarrow 0$ となることを要求します.

この事情を, 原点を一般の点 $x_0$ にして次のように定義します.
\begin{defn}
$\bbR$ の開区間 $I=(a,b)$ で定義された実数値関数 $f$ と $x \in I$ に対して
\begin{gather}
 f(x) - f(x_0)
 =
 A (x_0) (x-x_0) + O \rbk{(x-x_o)^2} \\
 \lim_{x \to x_0} \frac{O \rbk{(x-x_0)^2}} {x-x_0}
 = 0
\end{gather}
と書けるとき, $f$ は $x_0$ で線型化可能 (\textgt{微分可能})\index{びぶんかのう@微分可能}であるといい,
$A$ を $f$ の $x_0$ における\textgt{導値}\index{どうち@導値}または\textgt{微分係数}\index{びぶんけいすう@微分係数}という.
このとき,
\begin{align}
 A
 =
 f'(x_0)
 =
 \frac{df}{dx}
 =
 \frac{df}{dx} \Big|_{x=x_0} (Df) (x_0)
 =
 \rbk{f(x)}'
 =
 \rbk{f(x)}' \big|_{x=x_0}
 \end{align}
などと書く.
$I$ の各点で $f$ が微分可能であるとき, $I \to \bm{R}$ への関数
$f' \colon x \mapsto f'(x)$ が生じる.
これを $f$ の\textgt{導関数}\index{どうかんすう@導関数}という.
\end{defn}

これが高校で学んできた微分可能性の定義と一致する事を確認しましょう.
\begin{align}
    \lim_{x \to x_0}\frac{ f (x) - f (x_0) }{x-x_0} &=\lim_{x \to x_0}
    \left \{ A + \frac{O\left ( (x-x_0)^2 \right) }{x-x_0} \right \}\\
        &=A
\end{align}
となり, 確かに一致しました.

線型化はあくまで近似ですから近似の度合いを高め, さらに正確なものが得られる
かどうかということを考えてみましょう.
考えるのは $O\left ( (x-0)^2 \right)$ を正確に評価することです.
ここで高校で学んだ平均値の定理を考えましょう.
\begin{thm}[平均値の定理]
 $a<b$ とする.  $f:I=[a,b]\to \bm{R}$ が
 $I$ で連続,  $I^i=(a,b)$ で微分可能ならば定数 $\theta \in (0,1)$ が存在して, \begin{align}
            f (b)-f (a)=f'\left ( b+\theta (b-a)\right) (b-a)
    \end{align}\end{thm}
この定理は\textgt{証明なしに認めます}.
これで $b=x,\, a=x_0$ として
    \begin{align}
        f (x)-f (x_0) &= f'(x + \theta _1 (x-x_0)) (x-x_0)
    \end{align}
が出ます.

ここで $f$ が\textgt{ $I$ で 2 階微分可能である}とします. すると $f'$ が線型化できて,
\begin{gather}
 f'(x + \theta _1 (x-x_0)) - f'(x_0) \\
 =
 \frac{1}{2}D^2f (x_0) (x+ \theta _1 (x-x_0)-x_0)
  +O\left ( (x-x_0)^2 \right)
\end{gather}
となります.
$D^2$ の前の $1/2$ は, 上の式に代入した式を両辺 2 階微分して
$x \to x_0$ としたときにきちんと両辺が一致するようにつけたものです.
上の式に代入して
\begin{gather}
 f (x)-f (x_0) \\
 = \biggl \{ Df (x_0)
 +\frac{1}{2}D^2f (x_0)\{ x
 +\theta _1 (x-x_0)-x_0) \}
 +O\left ( (x-x_0)^2 \right) \biggr \}(x-x_0) \\
 = Df (x_0) (x-x_0)
 +\frac{1}{2}D^2f (x_0) (x-x_0)^2 \\
 +\frac{1}{2}
 D^2f (x_0)\theta _1 (x-x_0)^2O\left ( (x-x_0)^2 \right)     \\
 = Df (x_0) (x-x_0)
 +\frac{1}{2}D^2f (x_0) (x-x_0)^2
 +O\left ( (x-x_0)^3 \right)
\end{gather}
となります. ここで $O\left ( (x-x_0)^3 \right)$ は 3 次以上の補正項です.
これは $D^2f (x_0)$ の分 $f$ の情報が多くなっているので
近似の度合いは高まっていることが予測されます.

これを繰り返していくことで以下の定理が得られます.
\begin{thm}[Taylor (テイラー) の定理]\index{ていらーのていり@Taylor の定理}
$\bm{N} \ni n \geq 1$ とする.
区間 $I = [a,x]$ または $I = [x,a]$ で $n$ 回微分可能な実数値関数 $f$ に対し
\begin{align}
 f (x)
 =
 f(a) + \frac{Df(a)}{1!} (x-a) + \frac{D^2 f(a)}{2!} (x-a)^2 \\
  +\cdots + \frac{D^{n-1} f(a)}{(n-1)!} (x-1)^{n-1} + R_n (x)
\end{align}
によって $R_n$ を定義するとき, 定数 $\theta$ が存在して
\begin{align}
 R_n (x)
 =
 \frac{D^n f(x + \theta (x-a))}{n!} (x-a)^n
\end{align}
と書ける.
これはまた積分を使って
\begin{align}
  R_n (x)=\int_a^x \frac{(x-t)^{n-1}}{(n-1)!}D^nf (t) dt
\end{align}
と書くこともできる.
ここで $R_n$ のことを\textgt{ $n$ 次剰余項}という.
\end{thm}

上の式を\textgt{Taylor の公式}\index{ていらーのこうしき@Taylor の公式}といいます. これを用いて関数がある条件を満たすとき
 $x$ の多項式で関数の近似を行なうことが出来ます.
 $x$ の多項式ならば様子が簡単に掴めるので, これは非常に有用な定理です.
さらに関数の性質が非常によいものならば, これはある区間で
 $x$ の\textgt{べき級数に展開できます}.

これを定理として提出しましょう.
\begin{thm}[Taylor 展開]
 \begin{enumerate}
  \item $f$ が $a$ を含む区間 $I$ において $C^{\infty}$ 級で,  $I$ の各点 $x$ で
   \begin{align}
    \lim_{n \to \infty}R_n (x)=0
   \end{align}
   を満たすとき,  $f$ は $I$ 上で
   \begin{align}
    f (x)
    =
    \sum_{n=0}^{\infty}\frac{D^n f (a)}{n!}(x-a)^n
   \end{align}
   の形の級数 ( $a$ を中心とするべき級数) で表される.
   これを $f$ の $a$ を中心とする\textgt{Taylor 展開}\index{ていらーてんかい@Taylor 展開}という.
  \item 定数 $C\geq 0,M\geq 0$ が存在して, 全ての $n \in \bm{N}$ および
   $x\in I$ に対し
   \begin{align}
   \abs{Df^n (x)}\leq CM^n
   \end{align}
   を満たすとき,  $f$ は $a$ を中心として Taylor 展開できる.
 \end{enumerate}
\end{thm}
(証明) まずは 1 から.  $S_n$ を
\begin{align}
    S_n (x)\defeq \sum_{k=0}^n \frac{D^k f (a)}{k!}
\end{align}
とします. 仮定から $f$ は $C^{\infty}$ 級であり, Taylor の定理から
\begin{align}
    f (x)-S_n (x)=R_{n+1}(x)
\end{align}
とかけます. ここで仮定から,  $R_{n+1}$ が任意の $x$ に対し $0$ に収束しますから,
\begin{align}
    \lim_{n \to \infty}\{ f (x)-S_n (x) \} =0
\end{align}
となり, 証明終わりです.

次に 2 を示しましょう. こちらは少々長くなります.
仮定と剰余項の形から $c=x+\theta (x-a)$ として
\begin{align}
    |R_n (x)|=\frac{|D^nf (c)|}{n!}|x-a|^n \leq C\frac{M^n}{n!}|x-a|^n
\end{align}
となります. ここで前節で示した定理により級数
 $\sum CM^n|x-a|^n/n!$ は収束します.
高校でも学んだと思いますが,
級数 $\sum a_n$ が収束するとき $a_n$ は 0 に収束しますから, 1 の条件が満たされ
 $f$ は Taylor 展開可能です.  $\blacksquare$

次節ではいくつか良く使う Taylor 展開がありますから
それを示すことにします.
\section{初等超越関数の Taylor 展開}

何はともあれ初等超越関数とは何か, ですが $\cos x,\sin x,e^x, \log x$ のことです.
まずはこれらの Taylor 展開を求めます.
はじめに 0 のまわりの Taylor 展開の式を書いておきます.
ほとんど 0 の場合しか使いませんので, これだけで十分です.
\begin{align}
    f (x)  &=\sum_{n=0}^{\infty}\frac{D^nf (0)}{n!}x^n \\
    \cos x &=\sum_{n=0}^{\infty}\frac{(-1)^n}{(2n)!}x^{2n} \\
    \sin x &=\sum_{n=0}^{\infty}\frac{(-1)^n}{(2n+1)!}x^{2n+1} \\
    e^x &=\sum_{n=0}^{\infty}\frac{1}{n!}x^{n} \\
    \log (1+x) &= \sum_{n=1}^{\infty}\frac{(-1)^{n-1}}{n}x^n
\end{align}

無限級数なので収束の話をいつでも考えないといけないのですが,
まずは $n$ 階微分を計算して上の計算が合っているかを確かめましょう.
 $\cos x$ は$D\cos x=-\sin x,\, D^2\cos x=-\cos x,\,D^3\cos x=\sin x,
\,D^4\cos x=\cos x$
ですから,
\begin{align}
    D^n \cos x |_{x=0} = \begin{cases} (-1)^{n/2}
                    \, ,\, \text{( $n$ は偶数)}
                \\ 0  \, , \, \text{( $n$ は奇数)}
            \end{cases}
\end{align}
となり, 上の展開式は正しいです.
 $\sin$ はほとんど同じなので省略します.  $e^x$ は $D^n e^x|_{x=0}=1$ なのでやはり正しいです.
次に $\log$ ですが,  $D\log (1+x)=\frac{1}{1+x}=(1+x)^{-1}$ であり,
 $D^n \log (1+x)|_{x=0} = (-1)^{n-1}(n-1)!$ となり, やはり正しいです.

問題は収束です. Taylor 展開の式を
 $f (x)=\sum a_n \, , \, a_n=D^nf (0) x^n/n!$ と書きましょう.

 $\cos x, \sin x$ についてはまず $x^{2n},x^{2n+1}$ を一律に $y^n$ として考えます.
前節に示した収束に関する定理を使います.
具体的には ratio test です. まずは $\cos$ .
\begin{align}
    \frac{a_{n+1}}{a_n}
    =\frac{(-1)^{n+1}y^{n+1}}{(2n+2)!} \frac{(2n)!}{(-1)^n y^{n}}
    =\frac{-y}{2n+2} \to 0 \, , \, n \to \infty
\end{align}
上の収束は $y$ によらないので, 任意の実数 $y$ に対して上の Taylor 展開が成立します.
ここで $y=x^{2n}$ としたものが $\cos$ です.
この展開はある点のそばでの線型化 (近似) からはじまったものですが,
その近似を高めていったところ任意の実数に対して成立してしまいました.
恐るべき結果です.  $\sin$ もほとんど同じです. ついでに $e^x$ もほとんど同じです.

 $\log$ は何でもそう上手くいくものではないということを教えてくれるので
それを見てみましょう.
\begin{align}
    \left| \frac{a_{n+1}}{a_n} \right|
    =\left | \frac{(-1)^{n}x^{n+1}}{n+1}  \right|
        \left| \frac{n}{(-1)^{n-1} x^{n}} \right|
    =\frac{nx}{(n+1)} \to x \, , \, n \to \infty
\end{align}
これは $n \to \infty$ が $x$ に依存します. ratio test によれば
この極限値が $1$ より小さいところならば級数が収束するのですから,
対数の場合は Taylor 展開は 1 より小さいところでしか成立しません.
ただ $\log (1+x)$ の 0 まわりの展開が $|x|<1$ でしか成立しない
と言っているだけですから, 1 のまわり, 2 のまわりで展開すれば
また少し事情が変わるはずです.
\section{Euler の公式}

Euler (オイラー) の公式\index{おいらーのこうしき@Euler の公式}とは以下の想像を絶する式です.
\begin{align}
    e^{ix} = \cos x + i \sin x
\end{align}
ここで $e$ の肩に乗っていて右辺の $\sin$ の前に燦然と輝く $i$ は
虚数単位の $i$ です. この公式を「導出」しましょう.
前節の $e^x$ の Taylor 展開の式で $x\to ix$ とすると
\begin{align}
    e^{ix} &= \sum_{n=0}^{\infty}\frac{1}{n!}(ix)^n \\
        &= \sum_{n=0}^{\infty}\left \{ \frac{1}{(2n)!}(ix)^{2n} +
            \frac{1}{(2n+1)!}(ix)^{2n+1} \right \} \\
        &= \sum_{n=0}^{\infty}\left \{
             \frac{1}{(2n)!}i^{2n}x^{2n} +
            i \frac{1}{(2n+1)!}i^{2n}x^{2n+1} \right \} \\
        &= \sum_{n=0}^{\infty}\frac{1}{(2n)!}(-1)^{n}x^{2n}
            +i \sum_{n=0}^{\infty}
             \frac{1}{(2n+1)!}(-1)^{n}x^{2n+1}
\end{align}
ここで $\cos, \sin$ の Taylor 展開と比べて上の式を得ます.

虚数に対して級数展開が成立するか, 虚数乗とは何者か,
といった大問題があるのですが, (複素) 関数論をきちんとやらないと
決着がつきません.
解析接続を持ち出すと,
一般の複素数 $z$ に対し $e^z=\cos z +i\sin z$ が成立しこれが複素数への
ただ一つの拡張の仕方であることが分かります.
余裕があれば後で触れるでしょう.
今は有用な公式としてどんどん使っていくことにします.
振動・波動との関連はとても分かりやすいと思います.
我々は三角関数の新たな表現を手に入れたことになります.
特に微分方程式を解くとき, これを導入すると計算が著しく簡単になります.
\section{多変数の微分と Taylor 展開}

変数が多いとややこしくなるので主に 2 変数 $x,y$ (定義域は適当に $(a_1,b_1)\times (a_2,b_2)$ としておきます) の
実数値関数に対して話を進めます.
つまり $z=f (x,y)$ を考えていきます.
1 変数の実数値関数のときの扱いと比べると, これが「平面」内の「曲線」を取り扱うことに相当したのと同様に
今度は「空間」内の「曲面」を扱うことになり, ある程度は直観を働かせることも出来ます.

まず 2 変数の線型化 (線型近似)\index{せんけいか@線型化}が何になるかを考えてみます.
1 変数のときは高校で学んだとおり直線でした.
直線とは 1 次元のものです.
これから 2 変数での線型近似は 2 次元のもの, 平面で行なうのが妥当であると考えられます.
高校では空間内の平面をあまりやっていないものと思うので, 少しこれを補足します.
高校の教科書にも軽く載っていたと思いますが, ある平面は一直線上にない 3 点 $A,B,C$ を適当に取ることで指定することが出来ます.
3 点が一直線上にないので, 例えば $\overrightarrow{AB},\overrightarrow{AC}$ を考えれば, これらは線型独立であって, 平面内の任意の点が
この 2 本のベクトルの線型結合で書けることになります.

つまり, 1 変数の実数値関数のときは平面内の曲線の挙動を捉えるのに直線 (接線) による線型化を用いましたが,
2 変数の実数値関数では空間内の曲面の挙動を捉えるのに平面 (接平面) による線型化を用い,
さらに曲面上の各点での平面の挙動は 2 本の直線で捉えるということです.

それでは実際に線型化を開始します.
適当に $\bm{x}=\,^t (x,y)$ を取り, 十分小さい $h,k$ を取って $\bm{h}=\,^t (h,k)$ とし,
 $\bm{r}+\bm{h}$ での様子を考えてみます.
\begin{align}
    f (x+h,y+k) - f (x,y)
    =
    ah + bk + O (h^2,h k,k^2)
\end{align}
ここで $O (h^2,h k,k^2)$ は 1 変数のとき同様曲がった部分の補正項ですが, 2 変数なので 2 次の項のバリエーションが増えています.
このままでは色々と面倒なので, これを少し整理しておきます.
1 変数のときを参考にすると,  $O$ の項は微小増分 $\Delta x$ が 0 に近づく時,  $O (\Delta x)/\Delta x \to 0$ となれば良い, ということでした.
ベクトルの割り算というものが正体不明である (定義していない) 以上, 直接 $O (h^2,h k,k^2)/\bm{h}\to0$ とすることは出来ません.
そこで不等式 $\min \{ h^2,k^2  \} \leq |h k|\leq h^2 + k^2$ を参考にして, 2 次の挙動は
 $(h^2,h k,k^2)/|\bm{h}|^2\to0$ で上手く押さえられるものとします.

さて, この線型化を 1 変数のときと同じように一次関数の形で書いてみましょう.
 $A\defeq(a,b),\bm{h}\defeq\,^t (h,k)$ とすれば,
\begin{align}
    f (x+h,y+k) - f (x,y)
    =
    A \bm{h} + O (h^2,h k,k^2)
\end{align}
1 変数の場合と同じ形式で書いてみると, \textgt{微分係数が行ベクトル ( $1\times2$ 行列)}になる事がわかります.
直接に $\bm{h}$ を出してくると, 左辺が実数, 右辺がベクトルというすさまじい式になってしまいますから, 行列の形にすることが必要である, ともいえます.
ここではあまり詳しくやりませんが, 多変数のベクトル値関数ではもっと露骨な形で行列になります.
ここで一旦 2 変数 (多変数) の\textgt{微分}の定義をしておきましょう.
    \begin{defn} $\bbR^2$ のある開区間 $I=(a_1,b_1)\times (a_2,b_2)$ で定義された
実数値関数 $f$ と $\bm{x} \in I$ に対して
\begin{gather}
    f (\bm{x}+\bm{h}) - f (\bm{x}) = A (\bm{x})\bm{h} + O\left ( |\bm{h}| \right) \\
    \lim_{\bm{h} \to \bm{0}}\frac{O (h^2,h k,k^2 )}{|\bm{h}|}=0
\end{gather}
と書けるとき,  $f$ は $\bm{x}$ で\textgt{微分可能}\index{びぶんかのう@微分可能}であるといい,
 $A$ を $f$ の $\bm{x}$ における\textgt{導値}\index{どうち@導値}または\textgt{微分係数}\index{びぶんけいすう@微分係数}という.
このとき,
   \begin{align} A=f'(\bm{x})=(Df) (\bm{x})=\left ( f (\bm{x}) \right) '
   \end{align}
などと書く.  $I$ の各点で $f$ が微分可能であるとき,  $I \to \bm{R}$ への関数
$f':x \mapsto f'(x)$ が生じる. これを $f$ の\textgt{導関数}\index{どうかんすう@導関数}という.
\end{defn}

ここから重要な役者である\textgt{偏微分}に登場してもらいます.
上では $\bm{h}=\,^t (h,k)$ として $h,k$ 両方が動いていたわけですが, 今度は $k$ を $k_0$ に固定しておいて $h$ だけに動いてもらいましょう.
 $k=k_0$ を固定すると $z=f (x,k_0)\defeq g (x)$ は曲面を平面 $y=k_0$ で切った断面上を動くことになりますから,
幾何学的には $g$ の接線を求める作業へ移ることに対応します.
本節はじめに述べたことと対応させると, 接平面を決める為の 2 本のベクトルの内の一本を決めることにあたります.
演算的な側面から言うと, 偏微分とは
\textgt{ある着目している変数以外全て止めて (定数とみなし), 着目した変数に対する関数の挙動を調べる}ということです.

1 階の偏微分の定義にいきたいところなのですが, 後での都合もあるのでもう少し寄り道をします.
読者の皆さんがそうだと思いますが,
\begin{align}
 \bm{x}=x \bm{e}_x + y \bm{e}_y,
 \bm{e}_x=\bm{e}_1=\begin{pmatrix}1\\0\end{pmatrix},
 \bm{e}_y=\bm{e}_2=\begin{pmatrix}0\\1\end{pmatrix}
\end{align}
 として考えていると思います.
$\bm{e}_i$ は前章で言うところの標準基底というものでした.
上では当然このつもりで説明をしてきました.
これから述べる偏微分を標準基底を用いて表せば,
$f (\bm{x}+t\bm{e}_1)=g (t)$ の $t$ についての (1 変数の) 微分ということになります.
この $\bm{e}_1$ を一般に $\bm{n}$ としたものを\textgt\{ $\bm{n}$ 方向への方向微分\}\index{ほうこうびぶん@方向微分}と言います.
何故こんなことを言い出すのか, 数学上の衒学的趣味ではないか, と言う人もいるかと思いますが,
物理でも電磁気学などで「 (曲面上での) 法線方向への微分」というものを考えることがあります.
それ以上に, 我々の目的の 1 つに安定点の定式化がありますが, これは
\textgt{どの方向から近づいても微分が 0 になる点である}と定式化出来そうである, という予備考察があります.
方向微分とは, まさしくこのような方向性に沿うものとしての期待が持てます.

さて, ここで方向微分と特殊な方向微分としての偏微分を定義しましょう.
\begin{defn}
 $\bm{a}$ は $\bbR^2$ の開区間 $I=(a_1,b_1)\times (a_2,b_2)$ の 1 点で,
 $f$ は $I$ で定義された実数値関数であるとする.
今 $\bbR^2$ の任意の元 $\bm{e}$ に対して実変数 $t\in\bbR$ の関数
 $g (t)\defeq f (\bm{a}+t\bm{e})$ が $(-\vep,\vep),\vep>0$ で定義されているとする.
この関数 $g$ が $t=0$ で微分可能ならば, 関数 $f$ は $a$ において
\textgt{ $\bm{e}$ 方向に微分可能}であるといい,  $g'(0)$ を $f$ の
 $a$ における\textgt{ $\bm{e}$ 方向の導値}(または\textgt{微分係数}) といい,
    \begin{align}
        g'(o)
        =
        (D_ef) (\bm{a})
        =
        \frac{\partial f} {\partial \bm{e}}(\bm{a})
    \end{align}
などと記す.  $(D_ef) (\bm{a})$ が $I$ の各点 $\bm{a}$ で定義されるとき,  $I$ 上の関数
 $D_ef:\bm{a}\mapsto (D_ef) (\bm{a})$ を,  $f$ の\textgt{ $\bm{e}$ 方向の導関数}という.
\end{defn}
\begin{defn}
 $\bm{x}=x\bm{e}_x+y\bm{e}_y=x_1\bm{e}_1+x_2\bm{e}_2$ と表すこととし,
 $\bm{a}$ は $\bbR^2$ の開区間 $I=(a_1,b_1)\times (a_2,b_2)$ の 1 点で,
 $f$ は $I$ で定義された実数値関数であるとする.
 $f$ が $\bm{a}\in\bbR^2$ で $\bm{e}_i$ 方向に微分可能であるとき,
 $f$ は第 $i$ 座標 $x_i$ について\textgt{偏微分可能}\index{へんびぶんかのう@偏微分可能}という.
 $(D_{\bm{e}_i}f) (\bm{a})$ を $f$ の $\bm{a}$ における $x_i$ についての\textgt{偏導値}\index{へんどうち@偏導値}
(または\textgt{偏微分係数}\index{へんびぶんけいすう@偏微分係数}) といい,
\begin{align}
 (D_{\bm{e}_i}f) (\bm{a})
 =
 \frac{\partial f} {\partial x_i}(\bm{a})
 =
 f_{x_i}(\bm{a})
 =
 (D_if) (\bm{a})
 =
 \partial _i f (\bm{a})
\end{align}
などと記す.
これを極限を用いて表せば,
\begin{align}
 D_1f (x,y)
 =
 \frac{\partial f} {\partial x}
 =
 \lim_{h\to 0}\frac{f ( \bm{r} + h \bm{e}_1 ) - f (\bm{r}) } {h}
\end{align}
などとなる.
$f$ が $I$ の各点で $x_i$ について微分可能であるとき, $f$ の $x_i$ についての\textgt{偏導関数}\index{へんどうかんすう@偏導関数}
\begin{align}
 \frac{\partial f}{\partial x_i}:\bm{a} \mapsto \frac{\partial f}{\partial x_i}(\bm{a})
\end{align}
が生じる.  $f$ から $\partial f/ \partial x_i$ を得ることを $f$ を $x_i$ について\textgt{偏微分する}という.
\end{defn}

さらに高階の偏導関数を先に定義してしまいましょう.
\begin{defn}
 $x_i$ に関する偏導値 $(D_if) (\bm{a})$ が $I$ の全ての点 $\bm{a}$ で定義されるとき,
 $I$ 上で $D_if:\bm{a}\mapsto (D_if) (\bm{a})$ が定義される.
 $D_i$ を $f$ の第 $i$ 成分 $x_i$ に関する\textgt{偏導関数}という.
もし $D_if$ が第 $j$ 座標に関して偏微分可能ならば\textgt{2 階偏導関数} $D_j (D_if)$ が定義される. これを
    \begin{align}
        D_j (D_if) (\bm{x})
        =
        (D_{i,j}f) (\bm{x})
        =
        f_{x_i,x_j}(\bm{x})
        =
        \partial j \partial i f (\bm{x})
        =
        \begin{cases}
            \frac{\partial ^2 f}{\partial x_j \partial x_i}(\bm{x})&,(i\not= j)\\
            \frac{\partial ^2 f} {\partial x_i\,^2}(\bm{x})&,(i=j)
        \end{cases}
    \end{align}
などと記す. 同様に高階の偏導関数も定義される.
\end{defn}
\begin{defn}
 $k\in\bN$ とする.  $I=(a_1,b_2)\times (a_2,b_2)$ で定義された関数 $f$ は,  $f$ の $k$ 階までの全ての偏導関数
($\sum_{l=1}^k n^l$ 個ある) が存在して $I$ 上連続であるとき,  $I$ 上で\textgt{ $C^k$ 級}\index{しーけーきゅう@ $C^k$ 級}である,
または\textgt{ $k$ 回連続微分可能}であるという.
全ての $k\in\bN$ に対し $C^k$ 級であれば, \textgt{ $C^{\infty}$ 級}または\textgt{無限回微分可能}という.
\end{defn}

ここで本節はじめに述べた (多変数での) 微分係数と偏微分係数の関係を述べておきます.
\begin{align}
    f (x+h,y+k)-f (x,y)
    =
    ah + bk + O (h^2,h k,k^2)
\end{align}
において $k=0$ とすると,
\begin{align}
    f (x+h,y)-f (x,y)
    =
    ah + O (h^2)
\end{align}
1 変数の微分の定義と上に示した偏微分の定義から, 辺々 $h$ で割って $O (h^2)/h\to0 (h\to0)$ から
 $a=D_1f (\bm{x})=\partial f/\partial x$ となります.
同様にして $b=D_2 (f (\bm{x})=\partial f/\partial y$ です.
これから微分係数 $A$ は
\begin{align}
    A
    =
    (a \quad b)
    =
    \left ( \frac{\partial f} {\partial x} \quad \frac{\partial f} {\partial y} \right)
\end{align}
と書けることになります.



前にも述べましたが, 偏微分の順序は一般に交換できません.
つまり一般に $D_iD_j\not=D_jD_i$ です.
しかし比較的緩い条件でこの交換が可能になります.
後でも使うので先んじてその証明を載せておきましょう.

\begin{thm}
 $I=(a_1,b_1)\times (a_2,b_2)$ で定義された実数値関数 $f$ に対し,
点 $\bm{c}\in I$ で $f_{xy},f_{yx}$ が共に存在し $\bm{c}$ で連続ならば
偏微分の順序が交換できる. すなわち
    \begin{align}
        f_{xy}(\bm{c})
        =
        f_{ys}(\bm{c}).
    \end{align}
\end{thm}
(証明) 定義によれば,  $f_{xy}$ は偏微分を 2 階続けて行なったものであり,
1 つの変数についての極限操作を 2 回繰り返すことで得られます.
ところがこれを 2 次元空間 $\bbR^2$ における一つの極限で書くことが出来ます.
今 $\bm{l}=\,^t (h,k)\in\bbR^2$ を小さく取り,  $\bm{c}+\bm{l}\in I$ となるようにします.
また $\varphi (x)\defeq f (x,b+k)-f (x,b)$ とすれば,  $\varphi'(x)=f_x (x,b+k)-f_x (x,b)$ となります.
今
\begin{align}
    \Delta (h,k)
    \defeq
    f (a+h,b+k) - f (a+h,b) - f (a,b+k) + f (a,b)
\end{align}
とします. 平均値の定理から $0<\theta,\theta'<1$ となる $\theta,\theta'$ が存在して,
\begin{align}
    \Delta (h,k)
    &=
    \varphi (a+h) - \varphi (a)
    =
    h\varphi' (a+\theta h)\\
    &=
    h\{ f_x (a+\theta h,b+k) - f_x (a+\theta h,b) \}\\
    &=
    hkf_{xy}(a+\theta h,b+\theta' k)
\end{align}
となります. 今 $\bm{l}\to\bm{0}$ とすれば,
\begin{align}
 \begin{pmatrix}
  a+\theta\\ b+\theta' k
 \end{pmatrix}
 \to
 \begin{pmatrix}
 a\\
 b
 \end{pmatrix}
 =
 \bm{c}
\end{align}
であり, 仮定から\$ f$_{\text{xy}}$\$が連続ですから, 上式から
\begin{align}
 f_{xy}(\bm{c})
 =
 \lim_{(h,k)\to\bm{0},h k\not= 0}\frac{\Delta (h,k)} {h k}
\end{align}
を得る. 今定理の仮定が $x,y$ について対称なので, 同じ議論を繰り返すことで
\begin{align}
f_{yx}(\bm{c})
=
\lim_{(h,k)\to\bm{0},h k\not= 0}\frac{\Delta (h,k)} {h k}
\end{align}
と出来ます. これで $f_{xy}(\bm{c})=f_{yx}(\bm{c})$ が証明されました.  $\blacksquare$
\section{微分公式}

この節では合成関数の微分と関数の積の微分公式を扱います.
まず合成関数の微分公式を示します.
\begin{thm}
 $\bm{f}$ を $\Omega_1 \subset \mbr^n$ から $\mbr^m$ への関数,
 $\bm{g}$ を $\Omega_2 \subset f ( \Omega_1 ) \subset \mbr^m$ から $\mbr^{l}$ への関数とし,
 $\bm{f}$ が点 $\bm{a} \in \Omega_1$ で微分可能,  $\bm{g}$ が点 $\bm{b} = \bm{f} ( \bm{a} ) \in \Omega_2$ で微分可能とする.
 このとき合成関数 $\bm{ \varphi } \defeq\bm{g} \circ \bm{f}$ は点 $\bm{a}$ で微分可能であり
 \begin{gather}
 D \bm{ \varphi }
 =
 D ( \bm{g} \circ \bm{f} )
 =
 D \bm{g} \cdot D \bm{f}
 , \\
 \frac{\partial \varphi _r} {\partial x_j}
 =
 \sum_{l=1}^m \frac{\partial g_r} {\partial  y_l} \frac{\partial f_l} {\partial x_j}
 \quad ( 1 \leq r \leq p,  1 \leq j \leq n ).
 \end{gather}
 \end{thm}
(証明)
次元 $n,m$ がほとんど表に出てきませんので, 一般の形で示していきます.
$\bm{f},\bm{g}$ の微分可能性から,
\begin{gather}
\bm{f} ( \bm{a} + \bm{h} )
=
\bm{f} ( \bm{a} ) + A \bm{h} + O ( | \bm{h} |^2 ) , \quad A \defeq D \bm{f} \\
\bm{g} ( \bm{b} + \bm{k} )
=
\bm{g} ( \bm{b} ) + B \bm{k} + O ( | \bm{k} |^2 ) , \quad B \defeq D \bm{g}
\end{gather}
となります.
$\bm{b} = \bm{f} ( \bm{a} )$ を $g$ の式に代入して,
\begin{gather}
\bm{g} \left ( \bm{f} ( \bm{a} + \bm{h} ) \right)
=
\bm{g} \left ( \bm{f} ( \bm{a} ) + A \bm{h} + O ( | \bm{h} |^2 ) \right) \\
=
\bm{g} \left ( \bm{f} ( \bm{a} ) \right)
+B \left ( A \bm{h} + O ( | \bm{h} |^2 ) \right) + O \left ( | A \bm{h} + O ( | \bm{h} |^2 ) |^2 \right) \\
=
( \bm{g} \circ \bm{f} ) ( \bm{a} )
+B A \bm{h} + O \left ( | \bm{h} |^2 \right)
\end{gather}
と書けます.
合成 $\bm{h} = \bm{g} \circ \bm{f}$ が点 $\bm{a}$ で微分可能ならば,
\begin{gather}
\bm{h} ( \bm{a} + \bm{h} )
=
\bm{h} ( \bm{a} ) + C \bm{h} + O ( | \bm{h} |^2 )
\end{gather}
なるので, これを上の式と比べると合成の微分可能性と $C = BA = D \bm{g} \cdot D \bm{f}$ が分かります,
というのが直観的な議論です.

以下きちんと議論しなおします.
$\bm{f}$ の変数を $\bm{x}$ で,  $\bm{g}$ の変数を $\bm{y}$ で書くことにします.
各関数の微分可能性から,  $\bm{ \vep}  , \bm{ \delta }$ を
$\bm{h} \to \bm{0} \Rightarrow \bm{\vep}( \bm{h} ) \to \bm{0} , \bm{k} \to \bm{0} \Rightarrow \bm{\delta} ( \bm{k} ) \to \bm{0}$
となる関数として
\begin{gather}
\bm{f} ( \bm{x} + \bm{h} ) - \bm{f} ( \bm{x} )
=
A \bm{h} + | \bm{h} | \vep ( \bm{h} ) \\
\bm{g} ( \bm{y} + \bm{k} ) - \bm{g} ( \bm{y} )
=
B \bm{k} + | \bm{k} | \delta ( \bm{k} )
\end{gather}
と書けます.
ここで
\begin{gather}
\bm{k}
=
\bm{k} ( \bm{h} )
=
\bm{f} ( \bm{x} + \bm{h} ) - \bm{f} ( \bm{x} )
\end{gather}
とすれば,  $\bm{f}$ の連続性から $\bm{h} \to \bm{0} \Rightarrow \bm{k} ( \bm{h} ) \to \bm{0}$ となります.
合成関数 $\bm{ \varphi}$ について考えると,
\begin{gather}
\bm{\varphi} ( \bm{x} + \bm{h} ) - \bm{ \varphi } (\bm{x})
=
\bm{g} \left ( \bm{f} ( \bm{x} + \bm{h} ) \right) - \bm{g} \left ( \bm{f} (\bm{x}) \right) \\
=
\bm{g} ( \bm{y} + \bm{k} ) - \bm{g} ( \bm{y} )
=
B \bm{k} ( \bm{h} ) + | \bm{k} ( \bm{h} ) | \bm{ \delta } \left ( \bm{k} ( \bm{h} ) \right) \\
=
B \left ( A \bm{h} + | \bm{h} | \bm{ \vep } ( \bm{h} ) \right)
+| \bm{k} ( \bm{h} ) | \bm{ \delta } \left ( \bm{k} ( \bm{h} ) \right) \\
=
BA \bm{h} + | \bm{h} | \bm{\rho} ( \bm{h} ), \quad
\bm{ \rho } ( \bm{h} )
\defeq
B \bm{ \vep } ( \bm{h} ) + \frac{ | \bm{k} ( \bm{h} ) | }  { | \bm{h} | } \bm{ \delta } \left ( \bm{k} (\bm{h}) \right)
\end{gather}
となります.
ここで $(m,n)$ 行列 \$A = ( a$_{\text{ij}}$ ) \$ に対して
\begin{gather}
\abs{A}
\defeq
\left ( \sum_{i=1}^{m} \sum_{j=1}^{n} | a_{ij} | ^2 \right)^{ \frac{1} {2} }
\end{gather}
と書くことにします.
$A$ の第 $i$ \textgt{行}ベクトルを $\bm{a}_i$ とすれば,
\begin{gather}
\abs{A \bm{x}}|^2
=
\sum_{i=1}^m | \bm{a}_i  \bm{x} |^2
=
\sum_{i=1}^m ( {^t} \bm{a}_i , \bm{x} ) ^2 \\
\leq
\sum_{i=1}^m |{^t} \bm{a}_i |^2 | \bm{x} |^2 \quad ( \text{Cauchy-Schwartz の不等式} ) \\
=
\abs{A}^2 \abs{x}^2
\end{gather}
が一般に成立します.
これと三角不等式を用いて
\begin{gather}
\abs{\bm{k} ( \bm{h} )}
=
\abs{\bm{f} ( \bm{x} + \bm{h} ) - \bm{f} ( \bm{x} )}
=
\abs{A \bm{h} + | \bm{h} | \vep ( \bm{h} )}
\leq
\left ( | A | + | \bm{\vep} ( \bm{h} ) | \right) | \bm{h} |
\end{gather}
となります.
これから
\begin{gather}
\lim_{\bm{h}\to \bm{0}} \rho ( \bm{h} ) = \bm{0}
\end{gather}
となって証明終了です.  $\blacksquare$

\begin{thm}
 $f,g$ が開集合
 $\Omega \subset \mbr^n$ を定義域とする実数値関数とする.
 $f,g$ が 1 点 $\bm{a}$ で微分可能なとき, 積 $fg$ は $\bm{a}$ で微分可能であり,
 導関数 $D (fg)$ は次のように書ける.
 \begin{gather}
 D (fg) ( \bm{a} ) = f \cdot Dg + g \cdot Df
 \end{gather}
\end{thm}
(証明)
以下の証明を見れば分かるように, 定義域の次元 $n$ はまったく表に出てきません.
そこで一般の $n$ で証明を構成します.
 $f,g$ が $\bm{a}$ で微分可能なので,  $\vep,\delta$ を先程と同様,
 $\bm{h} \to \bm{0} \Rightarrow \vep ( \bm{h} ) , \delta ( \bm{h} ) \to 0$ となるように取れば
\begin{gather}
f ( \bm{a} + \bm{h}  )
=
f ( \bm{a} ) + A ( \bm{a} ) \bm{h} + | \bm{h} | \vep ( \bm{h} ) ,  \quad A \defeq Df ( \bm{a} ) , \\
g ( \bm{a} + \bm{h}  )
=
g ( \bm{a} ) + B ( \bm{a} ) \bm{h} + | \bm{h} | \delta ( \bm{h} ),  \quad B \defeq Dg ( \bm{a} )
\end{gather}
と書けます.

積 $fg$ について計算してみると
\begin{gather}
(fg) ( \bm{a} + \bm{h} )
=
f ( \bm{a} + \bm{h} ) \cdot g ( \bm{a} + \bm{h} ) \\
=
\left \{ f ( \bm{a} ) + A ( \bm{a} ) \bm{h} + | \bm{h} | \vep ( \bm{h} ) \right \}
\cdot \left \{ g ( \bm{a} ) + B ( \bm{a} ) \bm{h} + | \bm{h} | \delta ( \bm{h} ) \right \} \\
\begin{split}
=
f ( \bm{a} ) \cdot g ( \bm{a} )
+f ( \bm{a} ) \cdot B ( \bm{a} ) \bm{h}
+g ( \bm{a} ) \cdot A ( \bm{a} ) \bm{h} \\
+\left ( g ( \bm{a} ) + B ( \bm{a} ) \bm{h} + | \bm{h} | \delta ( \bm{h} ) \right) | \bm{h} | \vep ( \bm{h} ) \\
+\left ( f ( \bm{a} ) + A ( \bm{a} ) \bm{h} + | \bm{h} | \vep ( \bm{h} ) \right) | \bm{h} | \delta ( \bm{h} )
\end{split} \\
=
(fg) ( \bm{a} )
+\left (
fB + gA
\right )
(\bm{a}) \cdot \bm{h}
+O ( | \bm{h} |^2 ) .
\end{gather}
積 $fg$ が微分可能ならば, 定義から
\begin{gather}
(fg) ( \bm{a} + \bm{h} )
=
(fg) ( \bm{a} ) + C \bm{h} + O ( | \bm{h} |^2 )
\end{gather}
と書けます.
すぐ上の式と比べれば, 積の微分可能性と $C = fB + gA = f \cdot Dg + g \cdot Df$ となることが分かります.  $\blacksquare$
\section{多変数の Taylor の定理と微分}

多変数の実数値関数に関しても Taylor の定理が成立します.
1 変数のときと同じようにして線型化を中心に組み立てれば良いのですが,
1 変数と同じなのでそこの詳論は控えます.
まずは予備定理から証明します.

\begin{thm}\label{thm:2-7-7.1}
 $f$ を $I=\prod_{i=1}^{n} (a_i,b_i)\subset\bbR^n$ 上で $C^k$ 級実数値関数とする.
 $I$ の 2 点 $\bm{x},\bm{x}+\bm{z}$ を結ぶ線分 $L:g (t)=x+tz,t\in[0,1]$ が $I$ に含まれているとき,
 合成関数 $\varphi=f\circ g$ は $[0,1]$ 上で $C^k$ 級で,  $1\leq m \leq k$ のとき $\varphi$ の $m$ 階導関数は
\begin{align}
 \varphi^{(m)}(t)
 =
 \sum_{1\leq i_1,\dotsb ,i_m \leq n} \frac{\partial ^m f}{\partial x_{i_1} \dotsb \partial x_{i_m}} (\bm{x}+t\bm{z})
 z_{i_1}\dotsb z_{i_m} \label{eq:2-7-7.1}
\end{align}
で与えられる.
\end{thm}
(証明)
$g$ は $t$ の一次関数です. これは 2 階以降の導関数が $0$ になってしまいますが, これを微分可能な関数と考えれば
$g$ は $C^{\infty}$ の関数です. そこで $m=1$ のときは単純な合成関数の微分から
\begin{align}
\varphi '(t)
=
f'(\bm{x}+t\bm{z}) g'(t)
=
f'(\bm{x}+t\bm{z})\bm{z}
=
\sum_{i=1}^n \frac{ \partial f } {\partial x_i} ( \bm{x}+t\bm{z} ) z_i
\end{align}
が成立します. そこで $m$ についての帰納法で (\ref{eq:2-7-7.1}) が成立することを証明をします.
今 $m<k$ に対して (\ref{eq:2-7-7.1}) が成立すると仮定すれば,
(\ref{eq:2-7-7.1}) を $t$ について微分すれば,  $m+1$ に対する (\ref{eq:2-7-7.1}) が得られます.
実際 $f$ は $C^k$ 級で $m+1\leq k$ から,  $f$ の $m+1$ 階偏導値は, 前に示した定理から偏微分の順序によりません.
したがって $m=1$ の場合を用いて
\begin{align}
\varphi^{(m)}(t)
=
\sum_{1\leq i_1,\dotsb ,i_{m+1} \leq n}\frac{\partial ^{m+1} f} {\partial x_{i_1} \dotsb \partial x_{i_{m+1}}}
(\bm{x}+t\bm{z}) z_{i_1}\dotsb z_{i_{m+1}}
\end{align}
が得られます.  $\blacksquare$

ここで一旦便利な記法として\textgt{ $m$ 次微分} $(d^mf)_{\bm{x}}$ を導入しておきます.
(\ref{eq:2-7-7.1}) の右辺からそのまま
\begin{align}
    (d^mf)_{\bm{x}} (\bm{z})
    \defeq
    \varphi^{(m)}(t)
    =
    \sum_{1\leq i_1,\dotsb ,i_m \leq n}\frac{\partial ^m f} {\partial x_{i_1} \dotsb \partial x_{i_m}}(\bm{x}+t\bm{z})
            z_{i_1}\dotsb z_{i_m}
\end{align}
とします. これを $f$ の $\bm{x}$ における $m$ 次微分といいます.
特に $m=1$ のときの $d^1f$ を $df$ と書きます.

それでは Taylor の定理です.
\begin{thm}
(多変数の Taylor の定理)\index{ていらーのていり@Taylor の定理}
 $f$ を $\prod_{i=1}^n (a_i,b_i)$ 上で $C^k$ 級 $(k\geq 1)$ の実数値関数とする.
2 点 $\bm{x},\bm{x}+\bm{h}$ を結ぶ線分 $L$ が $I$ に含まれるとき,  $0<\theta<1$ なる実数 $\theta$ が存在して
    \begin{align}
        f (\bm{x}+\bm{h})
        =
        f (\bm{x}) + \sum_{m=1}^{k-1}\frac{1}{m!}(d^mf)_{\bm{x}}(\bm{h}) +
         \frac{1}{k!}(d^kf)_{\bm{x}+\theta \bm{h}}(\bm{h})
    \end{align}
が成立する.
\end{thm}
(証明) $\varphi (t)\defeq f (\bm{x}+t\bm{h})$ は $[0,1]$ で $C^k$ 級ですから, 1 変数関数についての
Taylor の定理から, ある実数 $\theta\in (0,1)$ が存在して
\begin{align}
    \varphi (1)
    =
    \sum_{m=0}^{k-1}\frac{1}{m!}\varphi^{(m)}(0) +\frac{1}{k!}\varphi^{(k)}(\theta)
\end{align}
となります. 前定理から $\varphi^{(m)}(0)=(d^mf)_{\bm{x}}(\bm{z}),\varphi^{(k)}(\theta)=(d^kf)_{\bm{x}+\theta\bm{h}}(\bm{h})$
ですから定理が成立します.  $\blacksquare$

ここで特に $m=1$ とした $1$ 次微分 (普通単に微分という)\index{びぶん@微分}の効能を見てみましょう.
我々の目的の 1 つは「安定点はあらゆる方向からの 1 階の微分が消える (微分係数が 0 になる) 点である」
という予想をきちんと確認することです.
先程見たように, 偏微分は標準基底に沿った方向微分であり, 「あらゆる方向」というものをどう定式化するかには多少の困難があります.
ここで, 標準基底を全て同じ角度だけ回転させたベクトルの組 $\{u_i\}$ はまた基底になります.
この基底に沿った方向微分を考えれば, 新たな方向微分が得られます.
これを繰り返せば, 原理的には「あらゆる方向からの微分」を考えることが出来ますが, 非常に面倒どころか
変化の方向は無限にあるので, 人間の手では追いつきません.
そこで線型代数で示した\textgt{(空間内の) 任意の回転は直交行列で表現出来る}という定理を使います.
 $\bm{x}=\,^t (x_1,x_2,x_3)$ を回転させたベクトルを $\bm{y}=\,^t (y_1,y_2,y_3)$ とすると
 $\bm{y}=U\bm{x}(\bm{x}=\,^t U\bm{y})$ となります. 成分で書くと,  $y_k=U_{k i}x_i (x_i=\,^t U_{i k}y_k)$ です.
さらに微分作用素の方も変換しないといけません.
高校でも学んできた 1 変数のときと同じで良いのですが,
多変数では $y_k=U_{k1}x_1+U_{k2}x_2+U_{k3}x_3$ となり,
これらを各変数で微分しないといけないことに注意して下さい.
これをふまえて計算すると以下のようになります.
\begin{align}
    \frac{\partial } {\partial x_i}
    =
    \sum_{k=1}^3 \frac{\partial y_k } {\partial x_i} \frac{\partial } {\partial y^k}
    =
    \sum_{k=1}^3 U_{k i} \frac{\partial } {\partial y^k}.
\end{align}
準備が整ったので微分を計算します.
また,  $f (\bm{x})=f (U^{-1}\bm{y})=g (y)$ ,  $\bm{z}$ も変換して $\bm{w}=U\bm{z}$ とすると
\begin{align}
    (df)_{\bm{x}}(\bm{z})
    &=
    \sum_{i=1}^3 \frac{\partial f } {\partial x_i }(\bm{x}) z_i
    =
    \sum_{i=1}^3 \sum_{k=1}^{3}     U_{k i} \frac{\partial } {\partial y_k}g (\bm{y}) z_i\\
    &=
    \sum_{i=1}^3 \sum_{k=1}^{3} \frac{\partial } {\partial y_k} g (\bm{y}) U_{k i} z_i
    =
    \sum_{i=1}^3 \sum_{k=1}^{3} \frac{\partial } {\partial y_k} g (\bm{y}) \,^t U_{i k} z_i\\
    &=
    \sum_{k=1}^{3} \frac{\partial g} {\partial y_k} (\bm{y}) w_k
\end{align}
となり, どのように回転させた基底に対する方向微分に対しても, 微分は形を変えません.
これは微分が基底の取り方に関係なく存在する量であることを示しています.
つまり, 方向に対する依存性がないということですから, これは「あらゆる方向への微分」に対応するものであるといえます.
\subsection{Taylor 展開の応用-波動方程式の導出}

流れとしてはこのまま本筋の極値問題へ行くべきですが, その前にもう 1 つの本筋である振動・波動論に対して
非常に重要な
\textgt{波動方程式}
の導出を行ないます.

物理的な状況としては, 両端が固定された (固定端の) 長さ $l$ , 質量 $m$ の弦を考えます.
そして一方の端 (左端とする) を座標の原点とし, もう一方の端へと $x$ 軸を取ります.
時刻 $t$ , 位置 $x$ での弦の振幅を $u (x,t)$ で表し,
また考察の便宜の為, 弦を $n$ 分割します ( $n$ 等分としても構いません). .
$n$ はあとで行なう近似が十分正確になる程度に大きく取り, 最後には $n \to \infty$ とします.
さらに作業上の都合から, 等分した各点に各弦の部分の全質量が集まっているものとし,
その各部分が適当に質量の無い (無視できる) 糸で結ばれているものとします..

このとき $i$ 番目の質点の運動方程式を考えます. 糸の張力は質点の左右で等しいとし,  $T$ とします.
また水平線と質点を結ぶ糸のなす角を左から $\theta_1,\theta_2$ とします.
$\mu$ を弦 (の質量) の線密度として,
\begin{align}
( \mu \varDelta x) \frac{\partial ^2 u} {\partial t ^2} (x_i , t )
=
T \sin \theta_2 - T \sin \theta_1
\end{align}
ここで $\theta$ が十分小さく,  $\sin \theta \simeq \tan \theta$ が成立するように $n$ を取ります.
ここで $\tan$ の幾何学的意味から,  $\tan \theta = \frac {\partial u} {\partial x}$ となります.
上の式に代入して Taylor 展開を用いると
\begin{gather}
\mu \varDelta x \frac{\partial ^2 u} {\partial t ^2} (x_i , t )
=
T \frac{\partial u} {\partial x}(x_i , t) - T \frac{\partial u} {\partial x}\left ( x_i - \varDelta x , t \right) \\
=
T \left [
\frac{\partial u} {\partial x}(x_i , t)
-\left \{
\frac{\partial u} {\partial x} ( x_i , t ) - \varDelta x \frac{\partial ^2 u} {\partial x^2} ( x_i , t )
+O \left ( \left ( \varDelta x \right) ^2 \right)
\right \}
\right ]\\
=
T \frac{l} {n} \frac{\partial ^2 u} {\partial  x ^2}(x_i , t ) + O \left ( \left ( \varDelta x \right) ^2 \right)\\
\Longrightarrow
\mu \frac{\partial ^2 u} {\partial t ^2} (x_i , t )
=
T \frac{\partial ^2 u} {\partial  x ^2}(x_i , t ) + \left ( \varDelta x \right)
\end{gather}
ここで $n \to \infty$ とし,  $x_i = x$ と書き直すと
\begin{align}
\frac{1} {v^2} \frac{\partial ^2 u} {\partial t ^2} (x , t )
=
\frac{\partial ^2 u} {\partial  x ^2}(x , t ),
\quad
v \defeq \sqrt \frac{T} {\mu}
\end{align}
上式を\textgt{(1 次元の) 波動方程式}\index{はどうほうていしき@波動方程式}といいます.
あとで使うこともあるでしょうから, 3 次元版も付記しておきましょう.
$\bm{\nabla} \defeq \partial _x \bm{e} _x + \partial _y \bm{e} _y + \partial _z \bm{e} _z$ とし,
$\bm{\nabla} \cdot \bm{\nabla} = \nabla ^2 = \partial _x ^2 + \partial _y ^2 +\partial _z ^2$ ,
$\square \defeq (1/v^2) \partial _t ^2 - \nabla ^2$
とすると,
\begin{align}
0
=
\frac{1} {v^2} \frac{\partial ^2 u} {\partial t ^2}
-\nabla ^2 u
=
\frac{1} {v^2} \frac{\partial ^2 u} {\partial t ^2}
-\frac{\partial ^2 u} {\partial  x ^2}
-\frac{\partial ^2 u} {\partial y ^2}
-\frac{\partial ^2 u} {\partial  z ^2}
=
\square u
\end{align}
波動方程式が本当に波動を表しているかを簡単な例で確認してみましょう.
高校で\textgt{単振動}は $u (x,t) = \sin (\omega t - k x)$ で表されると学んだはずです.
ここで $\omega \defeq 2 \pi f , k \defeq 2 \pi f/\lambda$ です.
\$$\omega$ \$ を\textgt{角振動数}\index{かくしんどうすう@角振動数},
\$$\lambda$ \$ を\textgt{波数}\index{はすう@波数}といいます.
これの 2 階の時間・空間微分を考えると $v\defeq\sqrt{\omega  /k}$ とすれば確かに波動方程式を満たします.
また波動方程式は\textgt{重ね合わせの原理}\index{かさねあわせのげんり@重ね合わせの原理}も満たします.
2 つの波 $u_1,u_2$ があるとしましょう. この 2 つを重ね合わせたものもまた波である, というのは $u \defeq u_1 + u_2$ が
波動方程式の解となるということです.  $u_1,u_2$ それぞれが波動方程式の解ですから,
$\square u_i = 0 ( i=1,2 )$ となります.
微分作用素 $\square$ は線型作用素ですから,  $\square u = \square u_1 + \square u_2 = 0 + 0 = 0$ となり,
重ね合わせた $u$ も確かに波動方程式を満たします.

少し脱線します. ここで Euler の公式
\$e$^{\text{ix}}$ = $\cos$ x +i $\sin$ x \$
から
$\sin x = \frac{1} {2} ( e^{ix} + e^{-ix} ),\cos x = \frac{1} {2i} ( e^{ix} - e^{-ix} )$
です.
微分の手間を考えると, 数学的には $\sin,\cos$ の代わりに $e^{ix}$ を考えた方が楽ですからそうしてみます.
この\textgt{複素表示}を用いると正弦波 (単振動) は
$\psi _{k , \omega } (x,t) = e^{i (kx - \omega t}$
と書けます.
そして重ね合わせの原理から, 波の重ね合わせはまた波ですから,
\textgt{波動方程式にしたがう波 $u$ は正弦波の重ね合わせで記述できる}(または非常に良く振る舞いが近似される) と仮定してみましょう.
重ね合わせの際には様々な波数・角振動数の正弦波を使うのがもっともらしいでしょう.
つまり \$k,$\omega$ \$ としては, 全実数を考えます.
全実数に対して重ね合わせるのだから, 積分を使えばよいでしょう. すなわち,
\begin{align}
u (x,t)
=
\int _{-\infty} ^{\infty} \int _{-\infty} ^{\infty} a (k , \omega ) e^{i (kx - \omega t} \, d k \, d\omega
\end{align}
と書けます.
ここで $a (k,\omega)$ は重ね合わせる際の荷重です.
ちなみにこれを $u$ の\textgt{Fourier 逆変換}\index{ふーりえぎゃくへんかん@Fourier 逆変換}といいます.
ついでにいうと, 上の表示では単発の (重ね合わせされていない) 正弦波そのものを表現しきれません.
この不都合を解消する為に 1 つの「関数」を導入します. 線型代数で学んだ Kronecker の $\delta$ を真似た (と思われる)
\textgt{Dirac の $\delta$ 関数}\index{でるたかんすう@ $\delta$ 関数}
$\delta (x)$ です. これは上の式の正当化をこめて, 次のように積分を用いて定義します.
\begin{align}
\int _{-\infty} ^{\infty} f (x') \delta (x - x' ) \, dx
=
f (x).
\end{align}
つまり,
$\delta (x - x')$
にある関数 $f$ をかけ全空間上を $x'$ で積分すると,  $f$ の $x$ での値がでてくるというものです.
これを用いて正弦波が復元できるか確認してみましょう.
$a (k, \omega) = \delta (k-k') \delta (\omega - \omega ' )$ として,
Fourier 逆変換の定義式で積分変数を $k\to k', \omega \to \omega '$ と変えれば,
\begin{align}
\int _{-\infty} ^{\infty} \int _{-\infty} ^{\infty}
\delta (k-k') \delta (\omega - \omega ' ) e^{i (k' x - \omega' t)} \, d k' \, d\omega '
=
e^{i (kx - \omega t)}
\end{align}
となり, 確かに単発の正弦波が復元できます.
少し話が飛びましたが, それでは Fourier 変換\index{ふーりえへんかん@Fourier 変換}は? というのは当然の疑問でしょう.
それは $a (k,\omega )$ のことです. これは $u$ を用いて以下のように書けます.
\begin{align}
a (k , \omega )
=
\int _{-\infty} ^{\infty}\int _{-\infty} ^{\infty} u (x,t) e^{-i (kx - \omega t)} \, dx \, dt
\end{align}
です. これを $\hat {u} (k,\omega ), \mathcal{F}[u] (k,\omega)$ などと書きます.
Fourier 逆変換は $\mathcal{F}^{-1}[u] (k,\omega)$ と書きます.

さらに少々線型代数を思い出してもらいましょう. 行列 $A$ に対して $A\bm{x}=\lambda \bm{x}$ をみたす $\lambda , \bm{x}$ を
固有値・固有ベクトルといいました.
正確には\textgt{変数分離}という手法を用いた後に分かることですが,  $e^{i (kx-\omega t)}$ は
線型作用素 $\square$ の固有ベクトルになります.
さらにスペクトル分解というのは, (正規) 行列を
固有ベクトルと平行な成分への射影子と固有値の積を用いて分解するものでした.
これを用いて微分作用素 (線型作用素!) $\square$ のスペクトル分解\index{すぺくとるぶんかい@スペクトル分解} を行なうと,
\begin{align}
\square
=
\int _{-\infty} ^{\infty}\int _{-\infty} ^{\infty}
\left (
\frac{1} {v^2} (-i\omega )^2 - (i k) ^2
\right)
e^{i (k x - \omega t)} \, d k \, d\omega
\end{align}
となります. ただし, これは作用素としての等式です.
ここでは線型代数が無限次元に拡張されていく様を見ておいてください.
\section{最大最小, 極値問題}

本章のメインとなる節です.
本節最後に安定点の定式化を行ないます.
まず極値の正確な定義をしておきます.
\begin{defn}
$\bbR^n$ の部分集合 $A$ で定義された\textgt{実数値}関数 $f$ を考える.
$\bm{a}\in A$
のある近傍 $U=U (\bm{a}; \vep)$ が $A$ に含まれ (すなわち $\bm{a}$ が $A$ の内点で) ,
$f (\bm{a})$ が $U$ における $f$ の最大値である, すなわち
任意の $\bm{x}\in U$ に対して $f (\bm{x}) \leq f (\bm{a})$ となるとき,
$f$ は $\bm{a}$ において\textgt{極大}\index{きょくだい@極大}であるという.
極小\index{きょくしょう@極小}についても同様.
また $f$ が $\bm{a}$ で極大であるだけなく
$\bm{a}$ 以外の任意の $\bm{x} \in U$ に対し $f (\bm{a}) > f ( \bm{x} )$ となるとき,
$f$ は $\bm{a}$ で\textgt{狭義の極大}\index{きょうぎのきょくだい@狭義の極大}であるという.
狭義の極小についても同様.

$f$ が $\bm{a}$ で極大または極小になるとき,  $f$ は $\bm{a}$ で\textgt{極値}\index{きょくち@極値}を取るといい,
$\bm{a}$ を $f$ の\textgt{極値点}\index{きょくちてん@極値点}という.
\end{defn}
1 変数のときの極値に関する結果は既知として, 多変数の極値に関して調べてみます.
まず 1 変数のときとほとんど変わらない極値に関する必要条件が得られます.

\begin{thm}
$\bbR^n$ の部分集合 $D$ の内点 $\bm{a}$ で関数 $f:D\to\bbR$ が微分可能であるとする.
$\bm{a}$ で $f$ が極値を取るならば次のことが成立する.
\begin{align}
\frac{\partial f} {\partial x_i} \, (\bm{a})
=
0
(1 \leq i \leq n),\\
f'(\bm{a}) = 0,
\quad
(df) _{\bm{a}}=\bm{0}.
\end{align}
\end{thm}
(証明)
本質が損なわれるわけでもなく, 理解がしやすくもなるので 2 変数関数 $f (x,y)$ で示します.
$y$ を $\bm{a}$ の座標 $a_2$ に固定して得られる関数 $f_1 (x) \defeq f (x,a_2)$ は $\bm{x}=\bm{a}$ で
極値を取るので,1 変数の場合の対応する定理から
\begin{align}
D f_1 (x)
=
\frac{\partial f} {\partial x} ( \bm{a} )
=
0
\end{align}
が成立します. また,  $(df)_{ \bm{a} } ( \bm{x} ) = Df (\bm{a}) \bm{x} = 0$ が
任意の $\bm{x} \in \bbR$ に対して成立するので $df_{ \bm{a} } = 0$ です.  $\blacksquare$

本章はじめに述べたように $Df (\bm{a})=O$ となる点を\textgt{停留値}\index{ていりゅうち@停留値}といいます.
上で示した極値に関する条件と安定点は極小点であることが必要という直観的考察から
\textgt{安定点では微分が消え}ます\index{びぶんがきえる@微分が消える}.
また 1 変数のときの類推から, 2 次の導関数の挙動を調べる必要があります.
このとき座標系 (基底) の選択によらない\textgt{2 次微分} $d^2 f$ を考えるというのは以前書いたとおりです.
ここで任意の $\bm{x} \in \bbR^n$ に 2 次微分 $d^2f$ を作用させると
\begin{align}
(d^2 f)_{ \bm{a} } ( \bm{x} )
=
\sum_{1 \leq i ,j \leq n} \frac{ \partial^2 f} {\partial x_i \partial x_j} ( \bm{a} ) x_i  x_j
\end{align}
となりますが, これは\textgt{2 次形式 (2 次同次式)}と呼ばれるものです.
そこで 2 次形式を正確に定義したのち, これを調べます.

\begin{defn}
$\bbR^n$ 上の\textgt{2 次形式}\index{にじけいしき@2 次形式}(quadratic form)
\begin{align}
Q ( \bm{x} )
=
\sum_{ i,j=1}^n \, b_{ij} x_i x_j , \quad b_{ij} = b_{j i} \in \bbR
\label{eq:8.11}
\end{align}
に対し対称行列 $B = ( b_{ ij } )$ をその係数行列という.
$Q ( \bm{x} ) = ( B\bm{x} , \bm{x} ) = \, ^t \bm{x} B \bm{x}$ である.
$Q$ に対し次のように定義する.
\begin{enumerate}
\item[1)] 全ての $\bm{0}$ でない $\bm{x} \in \bbR^n$ に対し,  $Q (\bm{x})>0$ ならば,  $Q$ は
\textgt{正値}\index{せいち@正値}であるという.
\item[2)] 全ての $\bm{0}$ でない $\bm{x} \in \bbR^n$ に対し,  $Q (\bm{x})<0$ ならば,  $Q$ は
\textgt{負値}\index{ふち@負値}であるという.
\item[3)] ある $\bm{x},\bm{y} \in \bbR^n$ に対し,  $Q (\bm{x}) > 0 > Q (\bm{y})$ となるならば,
$Q$ は\textgt{不定符号}\index{ふていふごう@不定符号}であるという.
\item[4)] $\det B \not = 0$ となるとき,  $Q$ は\textgt{正則}\index{せいそく@正則}という.
\end{enumerate}
\end{defn}

\begin{thm}
2 次形式 (\ref{eq:8.11}) に対して次の 5 つの条件は互いに同値である.
\begin{enumerate}
\item[1)] $\bm{x} = \bm{0}$ で $Q$ は狭義の最小値 $0$ を取る.
\item[2)] $\bm{x} = \bm{0}$ で $Q$ は狭義の極小値 $0$ を取る.
\item[3)] $Q$ は正値である.
\item[4)] 係数行列 $B = (b_{ij})$ の固有値は全て正である.
\item[5)] 係数行列 $B$ の全ての\textgt{主小行列式}\index{しゅしょうぎょうれつしき@主小行列式} $D_k$ は正である. すなわち
\begin{align}
D_k
=
\begin{vmatrix}
b_{11} & b_{12} & \dots & b_{1k} \\
b_{21} & b_{22} & \dots & b_{2k} \\
\hdotsfor{2} \\
a_{k1} & b_{k2} & \dots & b_{k k}
\end{vmatrix}
>
0 \quad (1 \leq k \leq n )
\end{align}
\end{enumerate}
\end{thm}
(証明)
$B$ が対称行列なので適当な直交行列 $U$ を用いて $Q$ を「対角化」できます.
$\bm{y} \defeq U\bm{x}$ ,
$B$ の固有値を $\lambda_i$ とし,
$U B {^t} U \defeq \Lambda = ( \lambda_i \delta_{ij} )$ とすると,
\begin{align}
Q ( \bm{x} )
=
{^t} \bm{x} B \bm{x}
=
{^t} ( U \bm{x} ) ( U B {^t} U ) ( U \bm{x} )
=
{^t} \bm{y} \Lambda \bm{y}
=
\sum_{i=1}^n \lambda_i y_i^2
=:
P ( \bm{y} ).
\end{align}
これから $P$ について考えていけば良いことになります.

$1)\Rightarrow 2)$
直観的には局所的な最小のことを極小というので, これは明らかでしょう.

$2)\Rightarrow 3)$
背理法で証明しましょう.
$P$ が正値でないとします. このとき固有値の少なくとも 1 つ, 例えば $\lambda_1$ が負になります.
何故かというと, 正値の条件は「\textgt{任意の} $\bm{y}$ に対して $P (\bm{y})>0$ となる」ことですが,
この否定は「\textgt{ある} $\bm{y}$ が存在して $P (\bm{y})<0$ となる」ことです.
全ての $\lambda_i$ が正であると,  $\bm{y}$ をどう取っても $P$ は負になれません.

このとき $\vep>0$ を任意に取ります. さらに $\bm{0}$ の近傍 $U (\bm{0};\vep)$ を考えます.
そして $\bm{y}_1 = ( \vep/2 , 0 , \dotsb , 0 )$ とすると,
\begin{align}
P ( \bm{y}_1 )
=
\lambda_1  \left ( \frac{\vep} {2} \right) ^2
<
0
\end{align}
となり,  $\bm{y}=\bm{0}$ で狭義極小値 $0$ を取ることに反します.

$3)\Rightarrow 4)$
こちらも背理法で示します.
ある固有値, 例えば $\lambda_1$ が負であるとします.
このとき例えば $\bm{y}_0=(1,0,\dotsb,0)$ を取ると $P (\bm{y}_0)<0$ となり,
$P$ , したがって $Q$ が正値であることに反します.

$4)\Leftrightarrow  5)$
実際に主小行列式を計算します.
このとき行列の積の行列式が行列式の積になること,
すなわち $\det (AB) = \det A \cdot \det B$ となることを用いると,
\begin{gather}
D_n
=
\det B
=
\det B ( \det U \det {^t}U )
=
\det ( U B {^t} U )
=
\det \Lambda \\
=
\begin{vmatrix}
\lambda_1 & 0 & \hdotsfor{1} & 0 \\
0 & \lambda_2 & \dots & 0 \\
\hdotsfor{4} \\
0 & \hdotsfor{2} & \lambda_n
\end{vmatrix}
=
(-1)^{2n} \lambda_n
\begin{vmatrix}
\lambda_1 & 0 & \hdotsfor{1} & 0 \\
0 & \lambda_2 & \dots & 0 \\
\hdotsfor{4} \\
0 & \hdotsfor{2} & \lambda_{n-1}
\end{vmatrix}
=
\lambda_n D_{n-1}
\end{gather}
これを繰り返していけば $D_n = \lambda_1 \dotsb \lambda_n >0$ となることが分かります.

$4)\Rightarrow 1)$
仮定から $P$ の全ての固有値 $\lambda_i$ は正です.
定義から任意の $\bm{0}$ でない $\bm{y}\in\bbR^n$ に対して $P ( \bm{y} ) > 0$ となります.
したがって $Q$ は $\bm{y}=\bm{0}$ で狭義最小値 $0$ を取ります.  $\blacksquare$

この定理を用いて,  $C^2$ 級関数 $f$ の停留点 $\bm{a}$ が極値を取る為の
1 つの十分条件が与えられます.

\begin{thm}
$\bbR^n$ の開集合 $U$ で定義された $C^2$ 級の実数値関数 $f$ が,
1 点 $\bm{a} \in U$ で $Df (\bm{a})=0$ を満たすとき次のことが成立する.
\begin{enumerate}
\item[1)] $\bbR^n$ 上の 2 次形式 $(d^2f)_{\bm{a}}$ が正値ならば,  $\bm{a}$ は $f$ の狭義の極小点である.
\item[2)] $(d^2f)_{\bm{a}}$ が負値ならば,  $\bm{a}$ は $f$ の狭義の極大点である.
\item[3)] $(d^2f)_{\bm{a}}$ が不定符号ならば,  $\bm{a}$ は $f$ の鞍点であり極値点ではない.
\end{enumerate}
\end{thm}
(証明)
$U$ が開集合ですから,  $\bm{a}$ のある近傍で $U ( \bm{a} ; \vep ) \in U$ となるものが存在します.
そこで $|\bm{h}|<\vep$ となる任意の $\bm{h}\in\bbR^n$ に対して
Taylor の定理と仮定 $Df (\bm{a})=0$ から
\begin{align}
f ( \bm{a} + \bm{h} ) - f ( \bm{a} )
=
\frac{1} {2} (d^2 f)_{ \bm{a} + \theta \bm{h} } ( \bm{h} ) ,
\quad
\theta \in ( 0,1 ).
\end{align}

\begin{enumerate}
\item の証明:
\end{enumerate}
$(d^2f)_{\bm{a}}$ が正値ならば, 前定理からその係数行列の主小行列式 $D_k (\bm{a})$ に対して
$D_k (\bm{a}) > 0 (1 \leq k \leq n)$ が成立します.
今 $f$ は $C^2$ 級なので, 連続な関数 $D_{ij} f ( \bm{x} )$ を成分とする行列式 $D_k (\bm{x})$ は連続となります.
そこで $\vep>0$ を十分小さく取ると
\begin{align}
D_k ( \bm{a} + \theta \bm{h} )
>
0 ( 1 \leq k \leq n )
\end{align}
が成立します.
そこで再び前定理を用いると,  $|\bm{h}|<\vep,0<\theta<1$ に対して
2 次形式 $(d^2f)_{\bm{a}+\theta\bm{h}}$ は正値となります.
そこで $|\bm{h}|<\vep$ となる任意の $\bm{h}\not=\bm{0}$ に対して
\begin{align}
f (\bm{a} + \bm{h} ) - f ( \bm{a} )
=
\frac{1} {2} ( d^2 f)_{ \bm{a} + \theta \bm{h} } ( \bm{h} )
>
0
\end{align}
となります. これは $\bm{a}$ が $f$ の狭義極小点であることを意味します.

\begin{enumerate}
\item の証明:
\end{enumerate}
このとき $(d^2 ( -f ) )_{ \bm{a} } = - ( d^2 f)_{ \bm{a} }$
は正値ですから, 1) から $-f$ は $\bm{a}$ で狭義極小となります.
したがって $f$ は $\bm{a}$ で狭義極大となります.

\begin{enumerate}
\item の証明:
\end{enumerate}
$( d^2 f)_{ \bm{a} }$ が不定符号ならば,
\begin{align}
( d^2 f)_{ \bm{a} } ( \bm{x} )
>
0
>
( d^2 f)_{ \bm{a} } ( \bm{y} )
\end{align}
となる $\bm{x},\bm{y}\in\bbR^n$ が存在します.
$\bm{x},\bm{y}$ を $c\bm{x},c\bm{y}$ で置き換えても上式が成立するので,
$|\bm{x}|<\vep,|\bm{y}|<\vep$ と仮定できます.
このとき実変数 $t \in ( -1 , 1 )$ の 2 つの関数
\begin{align}
g (t)
=
f ( \bm{a} + t \bm{x} )
, \quad
h (t)
=
f ( \bm{a} + t \bm{y} )
\end{align}
を考えると,  $g,h$ は共に $C^2$ 級で p \pageref{thm:2-7-7.1}, 定理 \ref{thm:2-7-7.1} から,
\begin{align}
D^k g ( \bm{0} )
=
( d^k f )_{\bm{a}} ( \bm{x} )
, \quad
D^k h ( \bm{0} )
=
( d^k f )_{\bm{a}} ( \bm{y} )
(k = 1,2 )
\end{align}
となります.
今仮定から $(df)_{\bm{a}}=0$ ですから,  $Dg (\bm{a})=D h (\bm{a})=0$ で,
$D^2g (0)>0>D^2h (0)$ です.
そこで $t=0$ は $g$ の狭義極小点で $h$ の狭義極大点となります.
すなわち $\bm{a}$ は $f$ の鞍点で,  $f$ は $\bm{x}$ 方向には $\bm{a}$ で狭義極小となり,
$\bm{y}$ 方向には $\bm{a}$ で狭義極大となります.
したがって $f$ は $\bm{a}$ で極大または極小になりません.  $\blacksquare$

\begin{rem}
この定理を固有値について述べなおすと,
\textgt{ $(d^2 f)_{\bm{a}}$ の係数行列の全ての固有値が正のとき $\bm{a}$ で狭義極小を取り,
全ての固有値が負のとき $\bm{a}$ で狭義極大を取る}ということです.
\label{rem:3.1}
\end{rem}

またこれらを用いて安定点の定式化を行ないます.
$N$ 質点系がしたがうポテンシャルを $U (\bm{r}) \defeq U ( \bm{r}_1,\dotsb,\bm{r}_N)$ とし,
$U$ が適当に性質が良いものである (例えば $C^{\infty}$ 級) とします.
$\bm{r}_0$ がつりあいの位置でそこからのずれを $\bm{y} = \bm{r} - \bm{r}_0$ とします.
ここで $U$ を $\bm{r}_0$ のまわりで Taylor 展開すると
\begin{align}
U ( \bm{r} )
&=
U ( \bm{r}_0 ) + \sum_{i=1}^{3N} \frac{\partial U} {\partial x_i} \bigg|_{\bm{r}_0} y_i
+\frac{1} {2} \sum_{i,j=1}^{3N} \frac{\partial^2 U} {\partial x_i \partial x_j}\bigg|_{\bm{r}_0} y_i y_j
O ( |\bm{x}|^3)\\
&=
U ( \bm{r}_0 ) + \frac{1} {2} \sum_{i,j=1}^{3N} \frac{\partial^2 U} {\partial x_i \partial x_j}\bigg|_{\bm{r}_0} y_i y_j
\end{align}
となります.
ここで $\bm{r}_1=(x_1,x_2,x_3),\bm{r}_2=(x_4,x_5,x_6),\dotsb,\bm{r}_N=(x_{3N-2},x_{3N-1},x_{3N})$ としました.
考えるのは平衡点まわりの\textgt{微小}振動なので,  $O ( |\bm{x}|^3) \approx 0$ とみなせます.
本章はじめの節での考察と\textgt{エネルギーが低い方がより安定である}という一般的な原理から,
系が安定である為には
\begin{align}
U ( \bm{r} )
>
U ( \bm{r}_0 )
\Longrightarrow \sum_{i,j=1}^{3N} V_{ij} y_i y_j > 0
\left ( V_{ij} = V_{j i} = D_{ij} U ( {\bm{r}_0}) \right)
\end{align}
でなければなりません.
すなわち安定性の条件\index{あんていせいのじょうけん@安定性の条件}は
 $\hat{U} = ( U_{ij})$ が\textgt{正値行列である}ということです.
この条件を用いて本章の主題である
\textgt{ポテンシャルの安定点近傍で質点系は微小振動を行なう}ことを示します.
これは一旦節を改めましょう.
\section{物理への適用}

本節では時間によらないポテンシャルの安定点近傍で質点系は微小振動を行なうことを示します.
まず $\bm{r}_i$ の質点の質量を $m_i$ とします.
各座標成分に対する運動方程式は,
\begin{align}
m_i \ddot{ y_i }
=
-\sum_{j=1}^{3N} U_{ij} y_j
\end{align}
となります. この式を $\sqrt{m_i}$ で割って整理すると,
\begin{align}
\sqrt{m_i} \ddot{ y_i }
=
-\sum_{j=1}^{3N} \frac{1} {\sqrt{m_i m_j}} U_{ij} \sqrt{m_j} y_j
\end{align}
なります. ここでさらに
$\tilde{y}_i \defeq \sqrt{m_i} y_i$ ,  $\tilde{U}_{ij} \defeq U_{ij}/\sqrt{ m_i m_j }$ と定義すると,
\begin{gather}
\ddot{ \tilde{y} }_i
=
-\sum_{j=1}^{3N} \tilde{ U }_{ij} \tilde{y}_j
\Longleftrightarrow
\tilde{ \bm{y} }
=
-\tilde{ \hat{U} } \tilde{ \bm{y} }
\end{gather}
と書けます.
今 $\tilde{ \hat{U} }$ は対称行列なので, 適当な直交行列 $V$ で対角行列 $\Lambda = ( \lambda_i \delta_{ij} )$ に対角化可能です.
また前節での注意 p \pageref{rem:3.1}, 注意 \ref{rem:3.1} から
正値行列 $\hat{U}$ の固有値 $\lambda_i$ は\textgt{全て正}であることから
\begin{align}
\lambda _i
=
\omega _i ^2, \quad
\omega > 0
\end{align}
としても良いことが分かります.
ここで $U$ が時間依存しないのでこれを対角化する $V$ も時間依存しません.
したがって $\dot{V}=O$ となり,  $\Omega \defeq ( \omega_i^2 \delta{ij} )$ としてこれを用いると運動方程式は
\begin{gather}
\frac{d^2} {dt^2} V \bm{y}
=
-V \hat{U} V^{-1} V \bm{y}
\Longleftrightarrow
\ddot{ \bm{z} }
=
-\Omega \bm{z}, \quad
\bm{z} \defeq V \bm{y}
\end{gather}
となります.
$\Omega$ が対角行列であることを用いて成分ごとに書けば
\begin{align}
\ddot{z}_i
=
-\omega_i ^2 z_i
\end{align}
となります.
これは簡単に解けて
\begin{align}
z_i
=
a_i e^{ i \omega_i t} + b_i e^{ i \omega_i t }
=
A_i \sin ( \omega_i t + \phi_i )
\end{align}
と書けます. これを逆に解いて
\begin{align}
\bm{y}
=
\diag \left ( \frac{1} { \sqrt{m_i} } \right) V^{-1} \bm{z}
\end{align}
が得られます.
ここで $\diag$ は括弧の中身を成分とする対角行列を表します.

以上から互いに相互作用を持つ $N$ 個の質点に対する微小振動の方程式が
$N$ 個の互いに独立な調和振動子\index{ちょうわしんどうし@調和振動子}の集合として記述できたことになります.
この振動を\textgt{基準振動}(normal mode)\index{きじゅんしんどう@基準振動}といいます.
基準振動によって系を記述する考え方は, 多自由度振動系の基本であり,
構造力学, 分子モデルなど多くの応用例があるほか, 場の量子論の基礎付けでも重要な役割を果たすようです.

これで本章の目的は果たしたのですが, 以後のことも考えて
積分についても議論することにします.
その前に微分方程式と絡めて動機づけをしておきます.
\section{微分と積分の掛け橋-微分方程式\label{sec:微分と積分の掛け橋}}

運動方程式 $m \ddot{ \bm{r} } = \bm{f}$ は 2 階の時間微分を含んでおり,
さらにその微分されて埋まっている関数が求めるべきものです.
こうしたものを\textgt{微分方程式}\index{びぶんほうていしき@微分方程式}と呼びます.
ここではこれを (近似的に) 解く方法を考えます.

本当に求めたいのは質点が力 $\bm{f}$ を受けながら描く運動の軌跡です.
しかしいきなり 2 階微分を解きほぐすのは大変です.
欲張らずにまずは速度 $\dot{ \bm{r} } = \bm{v}$ を求めてみましょう.
初期時刻を $t = t_i$ , 初期速度 $\bm{v} ( t_i ) \defeq \bm{v}_0$ として,
適当な時間 $t_f>0$ での質点の速度を求めることにします.
前の節で微分とは線型化であるということを見ました.
非常に短い時間間隔 $\varDelta t >0$ を取れば, 質点に働く力は
$\deltat$ の間 $\bm{f} ( \bm{r}_{ t_i } , \dot{ \bm{r} }_{t_i} )$ で
一定であるとみなせるでしょう.
ただし $\bm{r}_{t_i} \defeq \bm{r} (t_i) , \dot{ \bm{r} }_{t_i} \defeq \dot{ \bm{r} } ( \bm{r} ( t_i ) , t_i )$
としました.
すると線型化によって, 運動方程式は
\begin{gather}
\bm{v} ( t_i + \deltat )
\simeq
\bm{v}_0 + \frac{\deltat} {m} \bm{f} ( \bm{r}_{ t_i } , \dot{ \bm{r} }_{t_i} )
\end{gather}
と書けます.
速度のなす 3 次元空間で考えれば, 当然これはその空間の中の線分となります.
ここからさらに $\deltat$ 経ったときの速度 $\bm{v} (t_0 + 2 \deltat)$ は,
同様の線型化によって
\begin{gather}
\bm{v} ( t_i + 2 \deltat )
\simeq
\bm{v} ( t_i + \deltat ) + \frac{\deltat} {m} \bm{f} ( \bm{r}_{ t_i + \deltat } , \dot{ \bm{r} }_{t_i + \deltat} )\\
\simeq
\bm{v}_0 + \frac{\deltat} {m} \bm{f} ( \bm{r}_{ t_i } , \dot{ \bm{r} }_{t_i} )
+\frac{\deltat} {m} \bm{f} ( \bm{r}_{ t_i + \deltat } , \dot{ \bm{r} }_{t_i + \deltat} )
\end{gather}
と書けます.
先程と同じですが, こちらは折れ線になっています.
これを $n$ 回繰り返すと
\begin{gather}
\bm{v} ( t_0 + n \deltat )
\simeq
\bm{v}_0 + \sum_{k=0}^n \bm{f} ( \bm{r}_{ t_0 + k \deltat } , \dot{ \bm{r} }_{t_0 + k \deltat} )
\end{gather}
となります.
十分大きな $N$ を取れば,  $t_i + N \deltat \simeq t_f$ とできるでしょう.
したがって
\begin{gather}
\bm{v} ( t_f )
\simeq
\bm{v}_0 + \sum_{k=0}^N \bm{f} ( \bm{r}_{ t_0 + k \deltat } , \dot{ \bm{r} }_{t_0 + k \deltat} )
=:
\bm{v}_p ( t ; \deltat ; N )
\end{gather}
が得られます.
作り方からこれは求めるべき速度の\textgt{折れ線近似}のグラフを与えることが分かります.

近似というと程度が低いと思うかもしれません.
しかし例えばボールを投げたとき, 滞空時間が 10 秒であったとします.
空気抵抗などがないものとすれば, 当然ボールは放物線を描きます.
このとき $\deltat$ を $1/20000$ 秒,  $N=2 \times 10^5$ として上の折れ線近似を頑張ってやれば,
折れ線といえどもかなり正確に放物線様の軌道を描いてくれるでしょう.
同様のプロセスを踏んで $\bm{r}$ の (近似) 解が求められます.
つまり\textgt{原理的には}これできちんと近似解 $\bm{v}_p ( t ; \deltat ;N)$ が求められます.
また近似というならば精度を高めたいと思うのは当然の欲求でしょう.
そのためには $\deltat>0$ をさらに小さく, したがって $N$ もさらに大きくすれば良いと考えるのは普通でしょう.

このとき $\deltat \to 0 ( N \to \infty)$ という理想的な極限を考えます.
そうすると各 $\deltat$ での線分が短くなっていき,
次第に近似解の折れ線 $\bm{v}_p ( t ; \deltat ; N )$ が真の解曲線 $\bm{v}$ になっていくでしょう.
このとき上の式の和の中では $\deltat \to 0 , N \to \infty$ という極限を同時に取ることになります.
つまり
\begin{gather}
\bm{v}_p ( t ; \deltat ; N )
=
\bm{v}_0 + \sum_{k=0}^N \bm{f} ( \bm{r}_{ t_0 + k \deltat } , \dot{ \bm{r} }_{t_0 + k \deltat} )\\
\xrightarrow{\deltat \to 0 , N \to \infty}
\bm{v}
=
\bm{v}_0 + \lim_{ \deltat \to 0 , N \to \infty }
\sum_{k=0}^N \bm{f} ( \bm{r}_{ t_0 + k \deltat } , \dot{ \bm{r} }_{t_0 + k \deltat} )
\end{gather}
となります.
右辺で現れる和の極限が上手く収束するときがあります.
そこでこの和の極限を\textgt{積分}\index{せきぶん@積分}と名付けて以下のように書きます.
\begin{gather}
\int _{t_i} ^{t_f}
\bm{f} ( \bm{r} (\tau ) \, , \, \dot{ \bm{r} } \, ( \bm{r} (\tau) ) ) ) \, d \tau  \\
\defeq
\lim_{ \deltat \to 0 , N \to \infty }
\sum_{k=0}^N \bm{f} ( \bm{r}_{ t_0 + k \deltat } , \dot{ \bm{r} }_{t_0 + k \deltat} ).
\end{gather}
実際には収束の議論をするのは一苦労です.
そのあたりを以下で簡単に見る他,
実際に必要となる計算結果, 変数変換公式などを導出していきます.
\section{運動方程式と常微分方程式}

\subsection{常微分方程式}

何度か述べたように, 力学の基本法則である運動方程式は
数学的には\textgt{(常) 微分方程式}\index{びぶんほうていしき@微分方程式}というものになります.
運動方程式を考えれば分かるように,
求める解 (関数) の具体的な形は分からなくとも, その満たすべき関係式が分かっているときがあります.
その関係式から関数の具体的な形を求めることを,
一般に\textgt{(微分) 方程式を解く}\index{びぶんほうていしきをとく@微分方程式を解く}といいます.
解く際に許される演算は
\begin{enumerate}
\item[1)] 有限回の微分,
\item[2)] 有限回の与えられた関数との合成,
\end{enumerate}
のみです.
波動方程式を考えれば分かるように, 物理で現れる変数は一般に時間と空間の 4 変数があります.
多変数の微分方程式を\textgt{偏微分方程式}\index{へんびぶんほうていしき@偏微分方程式}といいますが,
ここでは時間のみを変数とする常微分方程式のみを考えます.

まず 1 つ注意をしておきます.
力として $\bm{f} = q ( \bm{E} + \bm{v} \times \bm{B} )$ という Lorentz 力を取ります.
関数の引数をきちんと示して, 質量 $m$ , 電荷 $q$ を持つ質点の運動方程式を書くと
\begin{gather}
m \ddot{ \bm{r} } (t)
=
q \left \{ \bm{E} ( \bm{r} (t) , t ) + \dot{ \bm{r} } (t) \times \bm{B} ( \bm{r} (t) , t )  \right \}
\end{gather}
という式になります.
求めるべき $\bm{r}$ が両辺に入っている上, 時間 $t$ の変化に対して一般にはひどく複雑な挙動を取るでしょう.
しかし積分の導入のところで示したように,  $\bm{E}$ や $\bm{B}$ が時間的にあまりにも複雑すぎる変化をしなければ,
非常に短い時間に区切って線型化して, その折れ線近似で近似解を構成できるでしょう.
ここから時間分割を小さくしていくことで厳密な解が「求められる」でしょう.

「求められる」と書きましたが, これは具体的に $\bm{f} = \bm{A} \sin \omega t$ などの数式で書けるとは限りません.
むしろ, このようにきちんと数式で解が表現出来ないほうが普通です.
しかし何といっても上で考えたようにすれば, 運動方程式には\textgt{解が存在する}だけでなく,
実験的な状況を考えれば同じ初期条件を与えれば同じ結果が出る, という意味で
\textgt{解が一意的}であろうと推測されます.
この解の存在と一意性は数学的に比較的緩い条件下で\textgt{厳密に示す}ことができます.
この章ではこの解の存在と一意性を示したのち, 具体的ないくつかの微分方程式の解法を述べることにします.
\subsection{初期値問題の解の存在と一意性}

\subsubsection{準備}

1 番初めに私達に課せられた課題がかなり重いものであることを改めて確認します.
前章で $N$ 質点系の安定点近傍での微小振動を示しました.
これから私達は $N$ 質点系でも成立するような形で定理を示さなければなりません.
さらに前節の Lorentz 力のところで見たように,
力としても求めるべき系の軌道 $\bm{r}$ や速度 $\dot{ \bm{r} }$ に依存します.
$k$ 番目の質点の質量を $m_k$ , 位置を $\bm{r}_k$ , 加わる力を $\bm{f}_k$ として, 扱うべき微分方程式は
\begin{gather}
m_1 \ddot{ \bm{r} }_1 = \bm{f}_1 ( \bm{r}_1, \dots , \bm{r}_N , \dot{ \bm{r} }_1 , \dots , \dot{ \bm{r} }_N , t)\\
\vdots \\
m_N \ddot{ \bm{r} }_N = \bm{f}_N ( \bm{r}_1, \dots , \bm{r}_N , \dot{ \bm{r} }_1 , \dots , \dot{ \bm{r} }_N , t )\\
\text{初期条件}:
\bm{r}_k (t_0) = \bm{r}_{k0}
, \quad
\dot{ \bm{r} }_k (t_0) = \bm{v}_k ( t_0 ) = \bm{v}_{k0}
( k = 1 , 2 , \dots , N )
\end{gather}
となります.
ここで力は加速度には依存しないものとしました.
ここでやや作為的ですが, 以下のように考えます.
まず $\bm{r}_i = {^t}( x_i , y_i , z_i ) \defeq {^t} ( x_{6i-5} , x_{6i-3} , x_{6i-1} )$ とします.
そして次のように定義します.
\begin{gather}
\bm{r}_1 =
\begin{pmatrix}
x_1 \\
x_2 \\
x_3 \\
\end{pmatrix}
, \quad
\dot{ \bm{r} }_1
=
\begin{pmatrix}
\dot{ x }_1 \\
\dot{ x }_2 \\
\dot{ x }_3 \\
\end{pmatrix}
\defeq
\begin{pmatrix}
x_{3N+1} \\
x_{3N+2} \\
x_{3N+3}\\
\end{pmatrix} , \\
\vdots \\
\bm{r}_N =
\begin{pmatrix}
x_{3N-2} \\
x_{3N-1} \\
x_{3N} \\
\end{pmatrix}
, \quad
\dot{ \bm{r} }_N
=
\begin{pmatrix}
\dot{ x }_{3N-2} \\
\dot{ x }_{3N-1} \\
\dot{ x }_{3N} \\
\end{pmatrix}
\defeq
\begin{pmatrix}
x_{6N-2} \\
x_{6N-1} \\
x_{6N} \\
\end{pmatrix} , \\
\bm{R}
\defeq
\begin{pmatrix}
x_1 \\
\vdots \\
x_{3N} \\
\dot{x}_1 \\
\vdots \\
\dot{x}_{3N}
\end{pmatrix}
=
\begin{pmatrix}
x_1 \\
\vdots \\
x_{3N} \\
x_{3N+1} \\
\vdots \\
x_{6N}
\end{pmatrix}
, \quad
\bm{f}_i
\defeq
\begin{pmatrix}
f_{3i-2} ( \bm{R} , t ) \\
f_{3i-1} ( \bm{R} , t ) \\
f_{3i} ( \bm{R} , t )
\end{pmatrix} , \\
\Longrightarrow
\dot{ \bm{R} }
=
\begin{pmatrix}
\dot{x}_1 \\
\vdots \\
\dot{x}_{3N} \\
\dot{x}_{3N+1} \\
\vdots \\
\dot{x}_{6N}
\end{pmatrix}
=
\begin{pmatrix}
x_{3N+1} \\
\vdots \\
x_{6N} \\
\ddot{x}_{1} \\
\vdots \\
\ddot{x}_{3N}
\end{pmatrix}
=
\begin{pmatrix}
x_{3N+1} \\
\vdots \\
x_{6N} \\
f_1 / m_1 \\
\vdots \\
f_{3N} / m_{3N}
\end{pmatrix}
\defeq
\bm{F} ( \bm{R} , t ) \\
\text{初期条件}:
\bm{R} ( t_0 )
=
\bm{R}_0
\end{gather}
今までは多数の式を統制する必要がありましたが, こうすることで
一本の式を制御すればよく, 見かけ上 1 変数のように扱えるようになり,
数学的な見通しが非常に良くなります.

正確には $D^n x = f ( x , Dx , \dots , D^{n-1}x , t)$ という形,
つまり最高階の微分について 1 価に解けているものです.
\}.

先程 $\bm{F}$ があまり複雑な変化をしなければ解の存在と一意性が示せると書きました.
どこまでの変化を許容できるか, ということで 1 つ定義をします.
\begin{defn}(\textgt{Lipschitz}(リプシッツ)\textgt{条件})\index{りぷしっつじょうけん@Lipschitz 条件}
関数 $\bm{F}$ は $D \defeq \bbR^n \times I$ を定義域とし, 値域が $\bbR^m$ であるとする.
$\bm{F}$ が Lipschitz 条件を満たすというのは,
ある正数 $L$ が存在して $D$ の任意の 2 点 $(\bbR_1 , t ) , ( \bbR_2 , t )$ に対して以下の式を満たすことをいう.
\begin{gather}
 \abs{\bm{F} \rbk{\bbR_1, t} - \bm{F} ( \bbR_2 , t )}
 \leq
 L | \bbR_1 - \bbR_2 | .
\end{gather}
\end{defn}
このとき $| \bbR_1 - \bbR_2 | < \vep =: \delta / L$ とすれば
$| \bm{F} ( \bbR_1 , t ) - \bm{F} ( \bbR_2 , t ) | < \vep$ ,
つまり $\bm{F}$ は $\bm{R}$ について連続となります.
ただし $x^2$ などはこの Lipschitz 条件を満たしませんから,
Lipschitz 条件はただの連続性よりは強い条件です.
\subsubsection{微分方程式の解の存在と一意性の証明 1}

以下では有界閉領域
\begin{gather}
 D \defeq \{ (\bm{R} , t ) \, ; \, | \bm{R} - \bm{R}_0 | \leq b , | t - t_0 | < a \, ( \, 0< a ,b < \infty \,) \}
\end{gather}
上で考えます.
連続関数は有界閉集合上で最大値, 最小値を取るので
\begin{gather}
 \max_{ ( \bbR , t ) \in D } | \bm{F} ( \bm{R} , t) | = M < \infty \label{eq:4-3}
\end{gather}
となります.

さて, 定理の statement を述べましょう.
\begin{thm}[微分方程式の解の存在と一意性 1]\label{th:微分方程式の解の一意性存在定理 1}
 $\bm{F} ( \bm{R} , t )$ を $D = \mbr^{N} \times I$ において Lipschitz 条件を満たす        連続関数とする.
 このとき $t_0 \in I$ ならば, 任意の初期値 $\bm{R}_0 \in \bbR^{N}$ に対して
 初期値問題
\begin{gather}
 \frac{d} {dt} \bbR (t)
 =
 \bm{F} ( \bm{R} , t ), \quad
 \bbR ( t_0 )
 =
 \bm{R}_0
\end{gather}
を
\begin{gather}
 \abs{t - t_0}
 \leq
 h, \quad
 h
 \defeq
 \min \left ( a, \frac{b} {M} \right) \label{eq:4-4}
\end{gather}
 で満たす一意的な解 $\bm{R}$ が存在する.
\end{thm}
(証明)
第 1 段:``折れ線" $\bbR_{\vep}$ の作り方.

有界閉領域 $D$ において連続なので, Heine の定理から $\bm{F}$ は $D$ において一様連続です.
すなわち任意の $\vep>0$ に対して $\kappa = \kappa ( \vep )$ を定めて
\begin{gather}
 (\bbR_1 , t_1) \in D , ( \bbR_2 , t_2 ) \in D
 \text{かつ}
 \abs{\bm{R}_1 - \bm{R}_2 | \leq \kappa , | t_1 - t_2 | \leq \kappa} \\
 \Longrightarrow
 \abs{\bm{F} ( \bm{R}_1 , t_1 ) - \bm{F} ( \bm{R}_2 , t_2 )}
 \leq \vep. \label{eq:4-5}
\end{gather}
とできます.
さらに
\begin{gather}
 \delta
 \defeq
 \min \left ( \kappa , \frac{\kappa} {M} , \frac{b} {M}  \right)
 >
 0 \label{eq:4-6}
\end{gather}
を取ります.
$0 < | t - t_0 | \leq h$ となる任意の $t$ に対して $0$ , または
正整数 $n = n ( \delta , t ) = n ( \delta (\vep) , t ) = n_{\vep} (t)$ を
\begin{gather}
 n \delta
 <
 \abs{t - t_0}
 \leq
 ( n + 1 ) \delta \label{eq:4-7}
\end{gather}
となるように定めて, \textgt{Cauchy の折れ線}\index{こーしーのおれせん@Cauchy の折れ線} $\bbR_{\vep} (t)$ を
\begin{gather}
 \begin{cases}
  \bbR_{\vep} (t)
  =
  \bbR_n + ( t - t_n ) \bm{F} ( \bm{R}_n , t_n ), \\
  \text{ただし} \\
  t_j
  \defeq
  t_0 + j \cdot \delta \frac{ t - t_0 } { | t - t_0 | } , \\
  \bm{R}_j
  \defeq
  \bm{R}_0 + \delta \frac{ t - t_0 } { | t - t_0 | } \bm{F} ( \bbR_{j-1} , t_{j-1} ) ( j = 1,2,\dots,n ) \\
  \text{また} \bm{R}_{\vep} (t_0) = \bm{R}_0 \label{eq:4-8}
 \end{cases}
\end{gather}
によって与えます.
この折れ線が作成可能なことをいうためには,
点 $( \bm{R}_j , t_j)$ が全て $D$ に属することをいわなければなりません.
そうでないと $\bm{F}(\bm{R}_j , t_j)$ が定義されないからです.
まず (\ref{eq:4-4}), \ref{eq:4-7}) によって
\begin{gather}
 \abs{t_j - t_0}
 \leq
 j \delta
 \leq
 n \delta
 <
 \abs{t - t_0}
 \leq
 h
 \leq
 a \quad ( j = 1, 2, \dots ,n).
\end{gather}
となります.
同じく\{(\ref{eq:4-6}), (\ref{eq:4-7})\}によって,
$| \bm{R}_1 - \bm{R}_0 | \leq \delta |\bm{F} ( \bm{R}_0 , t_0 ) | \leq \delta M \leq b$ となります.
したがって $\bbR_2, \bbR_3, \dots , \bbR_{j-1}$ が全て $|\bbR_k - \bbR_0| \leq b \, ( k= 1,2, \dots , j-1 )$ を
満たすとすると,  $( \bm{R}_k , t_k)\in D$ , したがって
$\bm{F}(\bm{R}_k, t_k) \, (k=1, 2, \dots, j-1)$ が定義されて, しかも
\begin{gather}
 \abs{\bm{R}_j - \bm{R}_0}
 \leq
 \sum_{k=1}^j | \bm{R}_k - \bm{R}_{k-1} |
 =
 \sum_{k=1}^j \delta | \bm{F} ( \bm{R}_{k-1} , t_{k-1} ) | \\
 \leq
 j \delta M
 \leq
 n \delta M
 <
 \abs{t - t_0}M
 \leq
 h M
 \leq
 b
\end{gather}
を満たします.
こうして $j$ に関する帰納法から点 $(\bm{R}_j , t_j ) \, ( j= 1,2,\dots,n )$ が全て $D$ に属することが分かりました.

第 2 段:折れ線 $\bm{R}_{\vep} (t)$ が``近似微分方程式"の解であることの証明.

折れ線 $\bbR_{\vep}(t)$ はその角である有限個の点 $x_1, x_2 ,\dots,x_n$ では
\begin{gather}
\frac{d \bm{R}_{\vep} ( t ) } {dt}
=
\bm{F} ( \bm{R}_n , t_n )
=
\bm{F} ( \bm{R}_{ n_{\vep} ( t ) } , t_{ n_{\vep} (t) } )
\end{gather}
を満たします.
一方\{(\ref{eq:4-6}), (\ref{eq:4-7}), (\ref{eq:4-8})\}から
\begin{gather}
\abs{t - t_{n_{\vep} (x)}}
\leq
\delta
\leq
\kappa
, \\
\abs{\bm{R}_{\vep} (t) - \bm{R}_{ n_{\vep} (t) }}
\leq
\delta | \bm{F} ( \bm{R}_{ n_{\vep} (t) } , t_{ n_{\vep} (t) } ) |
\leq
\delta M
\leq
\kappa
\end{gather}
となります.
さらに\{(\ref{eq:4-5})\}によって
$| \bm{F} ( \bm{R}_{\vep} (t) , t ) - \bm{F} ( \bm{R}_{ n_{\vep} ( t ) } , t_{ n_{\vep} (t) } ) | \leq \vep$
となります.
したがって折れ線 $\bm{R}_{\vep} (t)$ は有限個の角以外では
\begin{gather}
\left | \frac{ d \bm{R}_{\vep} ( t ) } {dt} - \bm{F} ( \bm{R}_{\vep} (t) , t )  \right|
\leq
\vep
\label{eq:4-9}
\end{gather}
を満たします.

第 3 段:2 つの折れ線 $\bm{R}_{\vep}(t),\bm{R}_{\vep '}(t)$ の比較.

$\vep ' >0$ に対する折れ線 $\bm{R}_{\vep '}(t)$ も有限個の角以外では
\begin{gather}
\left | \frac{ d \bm{R}_{\vep '} ( t ) } {dt} - \bm{F} ( \bm{R}_{\vep '} (t) , t )  \right|
\leq
\vep '
\label{eq:4-10}
\end{gather}
を満たします.
したがって Lipschitz 条件から有限個の角以外では
\begin{gather}
\left | \frac{d \bm{R}_{ \vep } (t) } {dt} - \frac{d \bm{R}_{ \vep '} (t) } {dt} ) \right|
\leq
L | \bm{R}_{\vep} (t) - \bm{R}_{\vep '} (t) | + \vep + \vep '
\label{eq:4-11}
\end{gather}
を満たします.
そして $\bm{R}_{\vep} (t) - \bm{R}_{\vep '} (t)$ は連続関数,
その上 $\bm{R}_{\vep} (t_0) - \bm{R}_{\vep} (t_0) = \bm{0}$ ですから,
\begin{gather}
\bm{R}_{\vep} (t) - \bm{R}_{\vep '} (t)
=
\int_{x_0}^x \left \{   \frac{d \bm{R}_{ \vep } (s) } {ds} - \frac{d \bm{R}_{ \vep '} (s) } {ds} \right \} \, ds
\end{gather}
であり, $U (t) \defeq | \bm{R}_{\vep} (t) - \bm{R}_{\vep '} (t) |$ とすると, (\ref{eq:4-11}) によって
\begin{gather}
 U (t)
 \leq
 \left| \int_{t_0}^t L U (s) \, ds \right|
 +( \vep + \vep ' ) \left| \int_{x_0}^x \, ds \right|
\label{eq:4-12}
\end{gather}
となります.
したがって $\max_{ | t - t_0 | \leq h } U (x) =: M'$ とすると (\ref{eq:4-12}) から
\begin{gather}
 U (t)
 \leq
 \abs{t - t_0}( LM' + \vep + \vep ' )
\end{gather}
となるので, これを (\ref{eq:4-12}) の右辺に代入して
\begin{gather}
 U (t)
 \leq
 \frac{ | t - t_0 |^2 } {2!} L ( LM' + \vep + \vep ' ) + ( \vep + \vep ' )| t - t_0 |.
\end{gather}
これをまた (\ref{eq:4-12}) の右辺に代入して
\begin{gather}
 U (t)
 \leq
 \frac{| t - t_0 |} {3!} L^2 ( LM' + \vep + \vep ' )
 +( \vep + \vep ' ) L \frac{| t - t_0 |} {2!}
 +( \vep + \vep ' ) | t - t_0 |
\end{gather}
となります.
以下同様に繰り返し, さらに $e^x$ の Taylor 展開も用いて
\begin{gather}
 U (t)
 \leq
 \frac{| t - t_0 |^n} {n!}L^{n-1} ( LM' + \vep + \vep ' )
 +( \vep + \vep ' ) \sum_{m=1}^{n-1} \frac{ | t - t_0 |^m L^{m-1} } {m!} \\
 \leq
 \frac{| t - t_0 |^n} {n!}L^{n-1} ( LM' + \vep + \vep ' )
 +( \vep + \vep ' ) \frac{1} {L} \left ( e^{ L | t - t_0 | } - 1 \right)
\end{gather}
となりますが, ここで $n\to\infty$ として
\begin{gather}
 \abs{\bm{R}_{\vep} (t) - \bm{R}_{\vep '} (t)}
 \leq
 \frac{\vep + \vep '} {L} \left ( e^{ L | t - t_0 | } -1 \right) \label{eq:4-13}
\end{gather}
が得られます.
次に行く前に上の極限の成立を示します. 証明すべきは $a>0$ に対して $a^n/n! \to 0 ( n \to \infty )$ です.
まずは $2a<k$ となる数 $k$ を 1 つ取ります.
$n>k$ に対して
\begin{gather}
 \frac{a}{n}
 <
 \frac{k}{2n}
 <
 \frac{1}{2}
\end{gather}
ですから,
\begin{gather}
 \frac{a^n} {n!}
 =
 \frac{a}{1} \frac{a}{2} \dots \frac{a}{k-1} \frac{a}{k} \frac{a}{k+1} \dots \frac{a}{n}
 <
 \frac{a^k}{k!} \cdot \left ( \frac{1}{2} \right) ^{n-k}
 =
 \frac{a^k}{k!} \frac{1}{2^k} \left ( \frac{1}{2} \right)^n
\end{gather}
となります.
$(1/2)^n \to 0 (n \to \infty)$ から $a^n/n! \to 0$ が分かります.

第 4 段:解の存在.

$\vep>0$ を与えた場合に少なくとも 1 つ折れ線 $\bm{R}_{\vep}(t)$ が定まりました.
少なくとも 1 つ, というのは例えば (\ref{eq:4-5}) における $\kappa = \kappa (\vep)$ の定め方が
一意的でないことによります.
しかし少なくとも 1 つ定まった $\bm{R}_{\vep}(t)$ は (\ref{eq:4-13}) を満足するので,
$\vep = 1/k (k \in \bbZ^+)$ とすれば,  $| t - t_0 | \leq h$ において一様に
\begin{gather}
\bm{R}(t)
\defeq
\lim_{n\to\infty} \bm{R}_{ 1/n } (t)
\label{eq:4-14}
\end{gather}
が存在します.
$\bm{a}_n (t) \defeq \bm{R}_{1/n}(t)$ とすれば全ての $n$ について $\bm{a}_n$ は連続関数となります.
(\ref{eq:4-13}) を $\bm{a}_n$ で書き直すと
\begin{gather}
\abs{\bm{a}_n (t) - \bm{a}_m (t)}
\leq
\frac{m + n} {Lmn} ( e^{ L | t - t_0 |} - 1 )
\label{eq:4-1.42}
\end{gather}
であり, これから $(a_n)_{n\in \bN}$ が Cauchy 列であることが分かります.
一様ノルムに対して連続関数の空間は Banach 空間になるので
収束先が連続関数として確かに存在します.

議論を進めましょう.
$\bm{R}(t)$ は各 $\bm{R}_{1/n}(t)$ と共に初期条件 $\bm{R}(t_0)=\bm{R}_0$ を満たし, かつ連続です.
$\bm{R}_{\vep}(t_0)=\bm{R}_0$ となる連続関数 $\bm{R}_{\vep}(t)$ を代入し, (\ref{eq:4-9}) から
\begin{gather}
\left| \bm{R}_{\vep}(t) - \bm{R}_0 - \int_{t_0}^t \bm{F} (\bm{R}_{\vep} (s) , s ) \, ds \right|
\leq
\vep | t - t_0 |
\leq
\vep h
\end{gather}
が得られます.
$\vep = 1/n$ として $n\to \infty$ とすると (\ref{eq:4-14}) から一様収束で
\begin{gather}
\bm{R}(t) - \bm{R}_0
=
\int_{t_0}^t \bm{F} ( \bm{R}(s) , s ) \, ds
\end{gather}
となります.
右辺括弧内が連続関数であり, 連続関数の合成はまた連続関数になるので,
$\bm{R}$ は微分可能でかつ
\begin{gather}
\frac{d \bm{R} (t)} {dt}
=
\bm{F} ( \bm{R}(t) , t )
\end{gather}
であり, こうして $\bm{R}(t_0) = \bm{R}_0$ となる解が少なくとも $1$ つ $| t - t_0 |\leq h$ において
存在することがわかりました.

第 5 段:解の一意性.

背理法で証明します.
$\bm{R}(t)$ の他に $\bm{P}(t_0) = \bm{R}_0$ となる解 $\bm{P}$ が
$|t-t_0| \leq h' \leq h$ において存在したとしましょう.
$\bm{P}$ を誤差 $\vep '=0$ の近似解と考えると
\begin{gather}
\left| \frac{d \bm{P} (t)} {dt} - \bm{F} ( \bm{P}(t) , t ) \right|
=
0
\end{gather}
と書けます.
(\ref{eq:4-13}) を得たときと同様にして
\begin{gather}
\abs{\bm{R}_{\vep} (t) - \bm{P}(t)}
\leq
\frac{\vep} {L} \left ( e^{L | t - t_0 |} - 1 \right)
\end{gather}
と書けます.
したがって $\vep = 1/n$ の $n$ を $\infty$ にすると $\bm{R}=\bm{P}$
となり, 証明終了です.  $\blacksquare$
\subsubsection{微分方程式の解の存在と一意性の証明 2 の準備-局所 Lipschitz 条件}

まず次の定理の証明からはじめます.
\begin{thm}
 $\bm{F}(\bm{R},t): \mbr^{m+1} \to \mbr^{l}$ が変数 $\bm{R}$ に対して
Lipschitz 条件を満たすならば,  $K$ を Lipschitz 定数,  $C$ をある定数として
\begin{gather}
\abs{\bm{F} ( \bm{R} ,t )}
\leq
L (| \bm{R} | + C ) .
\end{gather}
\end{thm}
(証明)
適当に $\bm{R}_0 \in \mbr^m$ を取ってきます.
このとき三角不等式を用いて
\begin{gather}
 \abs{\bm{F} ( \bm{R} , t)}
 \leq
 \abs{\bm{F} ( \bm{R} , t) - \bm{F} ( \bm{R}_0 , t)} + |\bm{F} ( \bm{R}_0 , t)| \\
 \leq
 L | \bm{R} - \bm{R}_0 | + |\bm{F} ( \bm{R}_0 , t)| \quad (\bm{F}\text{は Lipschitz 条件を満たす}) \\
 \leq
 L \left ( | \bm{R} | + | \bm{R}_0 | \right) + |\bm{F} ( \bm{R}_0 , t)|
 \leq
 L \left ( | \bm{R} | + C \right) . \blacksquare
\end{gather}
この定理によって, \textgt{Lipschitz 条件を満たす関数は高々一次の増大度である}ということが分かります.
$x^2$ が Lipschitz 条件を満たさないと前に書きましたが, それはこのことです.
今しがた示した定理は\textgt{非常に適用範囲が狭い}ということです.
つまり Lipschitz 条件から非常に嬉しい結果が出ましたが, 物理への適用という点から見て,
こんなものはハリボテのおもちゃです.
もっと緩い条件で定理が成立してくれないと物理としてはとても困ります.
多少制限が強くなりますが, 幸いにもこれよりも緩い条件で同じような結果が出せます.
その為にまず定義を 1 つ出します.
\begin{defn}(局所 Lipschitz 条件)
$\bm{G} : \Omega \to \mbr^n$ が $\Omega$ で $\bm{R}$ に対して
\textgt{局所 Lipschitz 条件}\index{きょくしょりぷしっつじょうけん@局所 Lipschitz 条件}を満たすというのは,
任意の $K \subset \Omega$ となる有界閉集合 $K$ に対して定数 $L_{K}>0$ が存在して,
任意の $(\bm{R}_1,t) , ( \bm{R}_2 ,t )$ に対して以下の式が成立することをいう.
\begin{gather}
\abs{\bm{G} ( \bm{R}_1 , t ) - \bm{G} ( \bm{R}_2 , t )}|
\leq
L_{K} | \bm{R}_1 - \bm{R}_2 |.
\end{gather}
\end{defn}
ある集合 $\Omega$ に $K$ が有界閉集合として含まれるということを $K \Subset \Omega$ と書くことにします.
すぐあとで示しますが, 局所 Lipschitz 条件を満たす為の 1 つの十分条件として
$\bm{G}$ が $C^1$ 級である, というものがあります.
(普通の) Lipschitz 条件を満たしても微分不可能な関数が存在するので,
$C^1$ 級というのはかなり厳しい条件ではないか, という人もいるかもしれませんが,
当面物理では不連続性の激しいものは扱いません.
むしろ $C^1$ 級というのは緩すぎるくらい緩い条件です.

一意性存在定理 2 の証明に入る前に予備定理を 2 つ証明しておきます.
\begin{thm}
$\bm{F}:\mbr^{m} \to \mbr^n$ が $C^1$ 級ならば, これは局所 Lipschitz 条件を満たす.
\end{thm}
(証明)
任意に $K \Subset \mbr^m$ を取ります.
ただしこのとき $K$ は\textgt{凸集合}\index{とつしゅうごう@凸集合}であるとします.
凸集合というのは, 任意の $\bm{x},\bm{y} \in K$ に対して $\bm{x}$ と $\bm{y}$ を結ぶ線分も $K$ に
含まれる集合です.
$\bm{F} = (F_1, \dots , F_n)$ , $\bm{R}=(x_1, \dots , x_m)$ とします.
$C^1$ 級の仮定から $\bm{F}$ の全ての偏導関数は連続です.
$K$ は有界閉集合 (コンパクト集合) であり, 有界閉集合上の連続関数は必ず最大・最小値を取ります.
そこで以下のように定義します.
\begin{gather}
L_K^k
\defeq
\max_{\bm{X} \in K , 1 \leq j \leq m} \left| \frac{\partial} {\partial x_j} F_k (\bm{X}) \right|
< + \infty  \quad (\text{有限値}) .
\end{gather}
三角不等式と平均値の定理から,
\begin{gather}
\abs{\bm{F} ( \bm{X} )  - \bm{F}}
\leq
\sum _{i=1}^n | F_i (\bm{X}) - F_i ( \bm{Y} ) | (\text{三角不等式}) \\
\sum _{i=1}^n \left| \sum_{j=1}^m \frac{\partial} {\partial x_j} F_i
( \bm{X} + \theta ( \bm{Y} -\bm{X} ) ) ( Y_j - X_j )  \right| , \,\, \theta \in (0,1) (\text{平均値の定理})\\
\leq
\sum _{i=1}^n \left| \sum_{j=1}^m L_K^i | Y_j - X_j \right| \times 1 \\
\leq
\sum _{i=1}^n L_K^i \sqrt{ \sum_{j=1}^m ( Y_j - X_j ) } \times \sqrt{ \sum_{j=1}^m \, 1^2 } (\text{Cauchy-Schwartz の不等式}) \\
\leq
\sqrt{m} \sum_{i=1}^n  L_K^i | \bm{X} - \bm{Y} | \\
\leq
L_K | \bm{X} - \bm{Y} | \quad \left ( L_K \defeq \sqrt{m} \sum_{i=1}^n  L_K^i \right)  \\
\Longleftrightarrow
\abs{\bm{F} ( \bm{X} )  - \bm{F}}
\leq
L_K | \bm{X} - \bm{Y} |
\end{gather}
が得られます.
最後の式は局所 Lipschitz 性を示す式です.  $\blacksquare$

次の予備定理の証明に入る前に
\textgt{カットオフ関数}(cut off function) として任意の正の実数 $r$ に対して $\chi_r: \mbr^n \to \mbr^n$ (カイと読む)
というものを次のように定義します.
\begin{gather}
\chi_r ( \bm{X} )
=
\begin{cases}
\bm{X} & |\bm{X}| < r \\
\frac{\bm{X}} { | \bm{X} | } r & | \bm{X} | \geq r
\end{cases}
\end{gather}
したがって任意の $\bm{X} \in \mbr^n$ に対して $| \chi_r ( \bm{X} ) | \leq r$ となります.
これから示すのは, この $\chi$ が Lipschitz 定数 $2$ の Lipschitz 連続関数であるということです.
\begin{thm}
\begin{align}
\abs{\chi _r (\bm{X}) - \chi _r (\bm{Y})}
\leq
2 | \bm{X} - \bm{Y} | .
\end{align}
\end{thm}
(証明)
3 通りに場合を分ければ十分です.
解析らしく, 延々不等式と格闘します.

\begin{enumerate}
\item $| \bm{X} | , | \bm{Y} | \leq r$ のとき.
\end{enumerate}

このときカットオフ関数は恒等写像となるので, 何もする必要はありません.

\begin{enumerate}
\item $| \bm{X} | \geq r , | \bm{Y} | \leq r$ のとき.
\end{enumerate}

まず三角不等式と $|\bm{Y}| \leq r$ から
\begin{gather}
\abs{\bm{X}} - r
\leq
\abs{\bm{X}} - \abs{\bm{Y}}
\leq
\abs{\bm{X} - \bm{Y}}
\end{gather}
となります.
愚直に三角不等式を用いて
\begin{gather}
\abs{\chi_r (\bm{X}) - \chi_r ( \bm{Y} )}
=
\left| \frac{ \bm{X} } { | \bm{X} | } r - \bm{Y} \right| \\
\leq
\left| \frac{ \bm{X} } { | \bm{X} | } r - \frac{ \bm{Y} } { | \bm{X} | } r \right|
+\left| \frac{ \bm{Y} } { | \bm{X} | } r - \bm{Y} \right|
=
\frac{r} { | \bm{X} | } | \bm{X} - \bm{Y} | + \frac{ | \bm{Y} | } { | \bm{X} | } | \bm{X} - r  | \\
\leq
\left ( \frac{r} { | \bm{X} | } + \frac{ | \bm{Y} | } { | \bm{X} | } \right) | \bm{X} - \bm{Y} |
\leq
2 | \bm{X} - \bm{Y} | .
\end{gather}

\begin{enumerate}
\item の証明: $|\bm{X}| , | \bm{Y} | \geq r$ のとき.
\end{enumerate}

\begin{gather}
\abs{\chi_r (\bm{X}) - \chi_r ( \bm{Y} )}
=
\left| \frac{ \bm{X} } { | \bm{X} | } r - \frac{ \bm{Y} } { | \bm{Y} | } r \right| \\
\leq
\left| \frac{ \bm{X} } { | \bm{X} | } r - \frac{ \bm{Y} } { | \bm{X} | } r \right|
+\left| \frac{ \bm{Y} } { | \bm{X} | } r - \frac{ \bm{Y} } { | \bm{Y} | } r \right| \\
=
\frac{r} { | \bm{X} | } | \bm{X} - \bm{Y} |
+r \left| \frac{ | \bm{X} | - | \bm{Y} | } { | \bm{X} | \cdot | \bm{Y} | } \right| | \bm{Y} | \\
=
\frac{r} { | \bm{X} | } | \bm{X} - \bm{Y} | + \frac{ r } { | \bm{X} | } | \bm{X} - \bm{Y} | \\
\leq
\frac{ 2r } { | \bm{X} | } | \bm{X} - \bm{Y} |
\leq
2 | \bm{X} - \bm{Y} | .\blacksquare
\end{gather}

それでは目標の定理の証明に入ります.
はじめに色々と定義が書いてありますが, あまり気にしないで構いません.
また, 定義域を狭めた所で成立する解のことを
\textgt{局所解}\index{きょくしょかい@局所解}といいます.
\begin{thm}[局所解の存在と一意性]
$I \defeq [t_0 , T)$ , $B ( \bm{R}_0 ; R ) \defeq \{ \bm{R} \in \mbr^m ; | \bm{R} - \bm{R}_0 | <R \} ( 0 < R \leq \infty)$ ,
$\Omega \defeq B ( \bm{R}_0 ; R) \times I = \Omega ( \bm{R}_0 ,T ,R)$ とする.
$\bm{F}$ が $\Omega$ で局所 Lipschitz 条件を満たすならば,
任意の $\bm{Y}_0 \in B ( \bm{X}_0 ;R )$ に対して
$T_0 = T_0 (\bm{Y}_0) \in (t_o ,T)$ が定まり,
次の微分方程式を一意的に満たす解 $\bbR$ が存在する.
\begin{gather}
\begin{cases}
\frac{d} {dt} \bbR (t) = \bm{F} ( \bm{R} (t) , t ), \quad t_0 < t \leq T_0 \\
\bbR (t_0) = \bbR_0 .
\end{cases}
\end{gather}
\label{th:解の一意性存在定理 2}
\end{thm}
(証明)
記号が煩雑になりますので, 読むときはゆっくり読んで下さい.
$| \bm{R}_0 | =: R_0 ( < R )$ とします.
まずは適当なコンパクト集合 (有界閉集合) を作りましょう.
上の不等式から $R_1, T_1$ が存在して
\begin{gather}
R_0 < R_1 < R
, \quad
t_0 < T_1 < T
\label{eq:4-1.72}
\end{gather}
と書けます.
これを用いて
\begin{gather}
K_1
\defeq
\cbk{\bm{X} \in \mbr^m ; | \bm{X} - \bm{R}_0 | \leq R_1}  \times \sqbk{x_0 , T_1}
\end{gather}
とすると, これは $\Omega$ のコンパクト集合 (有界閉集合) です.
カットオフ関数 $\chi_{R_1}$ を用いて
\begin{gather}
\tilde{\bm{F}} ( \bm{R} , t )
\defeq
\bm{F} ( \chi_{R_1} ( \bm{R} ) , t )
\end{gather}
として, 次の微分方程式を考えます.
\begin{gather}
( \tilde{E} )
\begin{cases}
\frac{d} {dt} \bm{R} (t)
=
\tilde{ \bm{F} } ( \bm{R} , t )
( = \bm{F} ( \chi_{R_1} ( \bm{R} ) , t ) ) \quad ( t_0 < t < T_1 )\\
\bm{R}  ( t_0 )
=
\bm{R}_0
\end{cases}
\end{gather}
ここで $\tilde{F}$ が $K_1$ で Lipschitz 条件を満たすことを示します.
カットオフ関数の定義から
\begin{gather}
\abs{\chi _{R_1} ( \bm{X} )} \leq R_1  , \quad
\abs{\chi _{R_1} ( \bm{Y} )} \leq R_1
\end{gather}
となります.
これによって
\begin{gather}
( \chi_{R_1} ( \bm{X} ) , t ) , ( \chi_{R_1} ( \bm{Y} , t ) \in K_1
\end{gather}
が分かります.
$\bm{F}$ の局所 Lipschitz 性から任意の $(\bm{X} , t ) , ( \bm{Y} , t )  \in K_1$ に対して
\begin{gather}
\abs{\tilde{ \bm{F} } ( \bm{X} , t ) - \tilde{ \bm{F} } ( \bm{Y} , t )}
=
\abs{\bm{F} ( \chi_{R_1} ( \bm{X} ) , t ) - \bm{F} ( \chi_{R_1} ( \bm{Y} ) , t )}\\
\leq
L_{K_1} | \chi_{R_1} ( \bm{X} ) - \chi_{R_1} ( \bm{Y} )  |
\leq
2 L_{K_1} | \bm{X} -  \bm{Y} |
\end{gather}
となります.
最後のところで前の定理を使いました.
微分方程式の解の一意性存在定理\ref{th:微分方程式の解の一意性存在定理 1}と,
$\tilde{ \bm{F} }$ の $K_1$ における Lipschitz 性から
$( \tilde{E} )$ の解 $\tilde{ \bm{R} }$ が一意的に存在することが分かりました.

最後に, この $\tilde{ \bm{R} }$ がある時刻のあいだで (定義域を小さく取った所で)
元の方程式を満たすことを示さなければなりません.
まず $\tilde { \bm{R} }$ が $[ t_0 , T_1 ]$ で連続であること,
はじめの不等式 (\ref{eq:4-1.72}) から
$\tilde{ \bm{R} } (t_0) = \bm{R}_0 , | \bm{R}_0 | = R_0 < R_1$
であることから
適当な時刻 $t_1 \in ( t_0 , T_1]$ が存在して, 任意の
$t \in [t_0 , t_1]$ に対して
$|\tilde{ \bm{R} }| \leq R_1$ と出来ることを証明しましょう.
これが示されれば, 時刻を $[t_0 , t_1]$ を制限した $\tilde{ \bm{R} }$ が元の方程式を満たすことが分かります.
それでは証明.

$\tilde{ \bm{R} }$ の連続性から $\vep = R_1 - R_0$ とすると,
これに対応して $\delta > 0$ が存在して
任意の $t \in [t_0 , t_0 + \delta]$ に対して
$| \tilde{ \bm{R} } (t) - \bm{R}_0 | < \vep$ となります.
三角不等式から
\begin{gather}
\abs{\tilde{ \bm{R} } (t)}
\leq
\abs{\tilde{ \bm{R} } (t) - \bm{R}_0 | + | \bm{R}_0}|
<
\vep + R_0
<
R_1
\end{gather}
となり,  $t_1 \defeq t_0 + \delta$ とすればめでたく証明完了です.

$t \in [ t_0 , t_1 ]$ としましょう.
このとき $| \tilde{ \bm{R} } | < R_1$ となるので,
$\chi _{R_1} ( \tilde{ \bm{R} } ) = \tilde{ \bm{R} }$ となります.
したがって
\begin{gather}
\tilde{ \bm{F} } ( \tilde{ \bm{R} }(t) , t)
=
\bm{F} ( \chi_{R_1} ( \tilde{ \bm{R} } (t) ) , t )
=
\bm{F} ( \tilde{\bm{R}}(t) , t )
\end{gather}
が分かるので,  $\tilde{\bm{R}}$ が元の方程式
\begin{gather}
\begin{cases}
\frac{d} {dt} \bbR (t) = \bm{F} ( \bm{R} (t) , t ), \quad t_0 < t \leq T_0 \\
\bbR (t_0) = \bR_0 .
\end{cases}
\end{gather}
を満たす, つまり定義域を制限した所で成立する
局所的な解であることが分かりました.  $\blacksquare$
\subsubsection{解の延長}

前小節で局所解の一意的な存在を証明できましたが,
上の証明では定義域 (時刻) を狭めた所まででしか一意的な存在を保証できません.
しかし場合によってはその定義域を拡張しなければ
(もっと先の時刻まで解の存在を保証しなければ) ならないときがあるかもしれません.
つまり解の延長ができるか否か, という問題にもけりをつけなければなりません.
まず解の延長を正確に定義します.
\begin{defn}(解の延長)
$\bm{R} = \bm{R}_1 (t)$ は $t_1$ を右端とする閉区間 $[t_0 , t_1]$ において,
$\bm{R} = \bm{R}_2 (t)$ は $t_1$ を左端とする左に閉じた区間 $[t_1 , t_2)$ において
$D_t \bm{R} (t) = \bm{F} ( \bm{R} (t) , t )$ の解であって, かつ
$\bm{R}_1 (t_1) = \bm{R}_2 (t_1)$ であるとする.
このとき解 $\bm{R}_1$ は $t_1$ を越えて
\textgt\{右に向かって $\bm{R}_2$ に延長できる\}\index{みぎにえんちょうできる@(微分方程式の解が) 右に延長できる}という.
同様にして $t_1$ を越えて左に延長できるということも定義できる.
\end{defn}
\textgt{解の最大存在時刻}\index{かいのさいだいそんざいじこく@解の最大存在時刻} $T_m$ を次の式で定義します.
\begin{gather}
T_m
\defeq
\sup \{ T_0 ; \text{微分方程式が}[t_0 , T_0 )\text{で解を持つ} \}
\end{gather}

\begin{thm}
$I \defeq [t_0 , T)$ , $B ( \bm{R}_0 ; R ) \defeq \{ \bm{R} \in \mbr^m ; | \bm{R} - \bm{R}_0 | <R \} ( 0 < R \leq \infty)$ ,
$\Omega \defeq B ( \bm{R}_0 ; R) \times I = \Omega ( \bm{R}_0 ,T ,R)$ とする.
局所解の一意性存在定理\ref{th:解の一意性存在定理 2}によって保証される解の延長可能性は
以下の 2 通りである.
\begin{enumerate}
\item[1)] $T_m < T , \lim_{t \to T_m} | \bm{R} (t) - \bm{R}_0 | = R$ ,
\item[2)] $T_m = T$ .
\end{enumerate}
\end{thm}
(証明)

\begin{enumerate}
\item の証明:
\end{enumerate}
背理法で証明します.
この解の上の点列 $( \bm{R}(t_n) , t_n ) , t_0 \leq t_n \leq T_m$ が $n\to\infty$ のとき
$\Omega$ の境界からの距離 $\eta$ が正であるような $\Omega$ の内点 $( \bm{R}' , T )$ に収束するものとします.
$n$ を十分大きく取れば, 点 $( \bm{R} ( t_n) , t_n )$ と $\Omega$ との距離が $\eta/2$ であるようにできます.
このとき $t_n$ で $\bm{R}(t_n)$ となるような $D\bm{R} = \bm{F}( \bm{R}(t) , t )$ の解が
$| t - t_n | \leq h' \defeq \min ( \eta / 2 , \eta / 2M )$ において一意的に存在します.
この $t$ の領域 $| t - t_n | \leq h'$ は $\lim_{n \to \infty} t_n = T_m$ によって,
$n$ が十分大きいときには点 $T_m$ を内点とします.
これは $\bm{R}(t_0)= \bm{R}_0$ がとなるもとの解 $\bm{R}$ が $T_m$ を超えてなお右に延長できることを示し,
$T_m$ の定義に反します.

\begin{enumerate}
\item の証明:
\end{enumerate}
先程の解 $\bm{R}$ は $| t - t_n | \leq h'$
において $D \bm{R} (t) = \bm{F} ( \bm{R}(t) , t )$ の解として
連続であり, しかも $| t - t_n | \leq h'$ が点 $T_m$ を内部に含むので,
仮定 $\lim_{n \to \infty} ( \bm{R}(t_n) , t_n  ) = ( \bm{R}' , T_m )$ から
\begin{gather}
\bm{R}(T_m)
=
\bm{R}'
\end{gather}
となり, 証明終了です.  $\blacksquare$
\subsubsection{解の初期値および解に対する連続依存性}

これまでは決まった初期値に対する解の存在と一意性について調べてきました.
実験的な状況を考えれば, カオス的な振る舞いでもない限り, 初期値が少し異なる場合
その解も少しだけ「異なる」ということが実現されていないと困ります.
これをある範囲内で示すことができます.
ここではもう少し一般化して示しますが,
その証明に入る前に予備定理を 1 つ証明します.
\begin{thm}[Gronwall]
$I = [a , b]$ ,  $x_0 \in I$ とする.
$g ,h : I \to \mbr$ とし,  $g$ については任意の $x \in I$ に対して $g (x) \geq 0$ となる連続関数とする.
このとき $a$ を定数として
\begin{gather}
h (x)
\leq
a + \int_{x_0}^x h (s) \, g (s) \, ds
\end{gather}
ならば
\begin{gather}
h (x)
\leq
a \int_{x_0}^x e^{ \int_{x_0}^x g ( s ) } \, ds .
\end{gather}
\end{thm}
(証明)
\begin{gather}
H (x)
\defeq
a + \int_{x_0}^x h (s) \, g (s) \, ds
\end{gather}
とすると条件の不等式を用いて
\begin{gather}
DH (x)
=
h (x) g (x)
\leq
H (x) g (x)
\Longleftrightarrow
DH (x) - H (x) g (x) \leq 0
\end{gather}
となります.
さらに
\begin{gather}
D \left ( H (x) e^{ - \int_{x_0}^x g ( s ) \, ds } \right)
=
e^{ -\int_{x_0}^x g ( s ) \, ds} \left\{ DH (x) - g (x) H (x)  \right\}
\leq
0
\end{gather}
となることから,
\begin{gather}
H (x) e^{ - \int_{x_0}^x g ( s ) \, ds }
\end{gather}
は単調減少になります.
したがって
\begin{gather}
H (x) e^{ - \int_{x_0}^x g ( s ) \, ds }
\leq
H (x_0) e^{ - \int_{x_0}^{x_0} g ( s ) \, ds }
=
H (x_0)
=
a
\end{gather}
であり, これから示すべき不等式が導かれます.  $\blacksquare$

\begin{thm}[解の初期値および解に対する連続依存性]
$\bm{F}^i (i=1,2)$ を Lipschitz 条件を満たす関数として
\begin{gather}
(E)_i
=
\begin{cases}
\frac{d} {dt} \bm{R}^i (t)
=
\bm{F}^i ( \bm{R}^i (t) , t) \\
\bm{R}^i (t_0)
=
\bm{R}_0^1
\end{cases}
(i = 1,2)
\end{gather}
とする.
このとき任意の $t \in I$ に対して
\begin{gather}
\abs{\bm{R}^1 (t) - \bm{R}^2 (t)}
\leq
\left (
\abs{\bm{R}^1_0 - \bm{R}^2_0}
+\frac{ 1 } {L} \sup_{t \in I , \bm{R} \in \mbr^m} | \bm{F}^1 (\bm{R},t)- \bm{F}^2 (\bm{R},t) |
\right)
e^{L| t - t_0 |}
\end{gather}
\end{thm}
(証明)
各微分方程式の差を取ると
\begin{gather}
\begin{split}
D \left\{ \bm{R}^1 (t) - \bm{R}^2 (t) \right\}
=
\bm{F}^1 (\bm{R}^1 (t) , t) - \bm{F}^2 ( \bm{R}^2 (t) , t )
\end{split}
\end{gather}
となります.
辺々積分して整理すると,
\begin{gather}
\bm{R}^1 (t) - \bm{R} ^2 (t)
=
\bm{R}^1_0 - \bm{R}^2_0 + \int_{t_0}^t \left\{ \bm{F}^1 (\bm{R}^1 (s) , s) - \bm{F}^2 ( \bm{R}^2 (s) , s ) \right\}  ds
\end{gather}
すぐ後で出て来るので先んじて $\beta$ の定義をしておきます.
\begin{gather}
\beta
\defeq
\sup_{t \in I , \bm{R} \in \mbr^m}| \bm{F}( \bm{R} , t ) - \bm{F} ( \bm{R} , t ) |.
\end{gather}
先程の積分した式の両辺の絶対値を取り, 三角不等式と Lipschitz 条件を用いた式
\begin{gather}
\abs{\bm{F}^1 (\bm{R}^1 (s) , s) - \bm{F}^2 ( \bm{R}^2 (s) , s )} \\
\leq
\abs{\bm{F}^1 (\bm{R}^1 (s) , s) - \bm{F}^1 ( \bm{R}^2 (s) , s )}
+| \bm{F}^2 (\bm{R}^1 (s) , s) - \bm{F}^2 ( \bm{R}^2 (s) , s ) | \\
\leq
L | \bm{R}^1 (s) - \bm{R}^2 (s) | + \beta
\end{gather}
を用いて,  $h (x) \defeq | \bm{R}^1 (x) - \bm{R}^2 (x) |, \alpha \defeq | \bm{R}^1_0 - \bm{R}^2_0 |$ とすれば
\begin{gather}
h (x)
\leq
\alpha + \int_{t_0}^t \{ L h (s) + \beta \} ds
=
\alpha + \int_{t_0}^t L \left \{  h (s) + \frac{\beta} {L} \right \} ds
\end{gather}
となります.
$H (x) \defeq h (x) + \beta / L$ とすれば,
\begin{gather}
H (x)
\leq
\left ( \alpha + \frac{\beta} {L} \right) + \int_{x_0}^x L H (s) ds
\end{gather}
であり, Gronwall の不等式を用いると
\begin{gather}
H (x)
\leq
\left ( \alpha + \frac{\beta} {L} \right) e^{ L| t - t_0 | }
\end{gather}
となります.
$h (x) \leq H (x)$ から
\begin{gather}
\abs{\bm{R}^1 (t) - \bm{R}^2 (t)}
\leq
\left ( \alpha + \frac{\beta} {L} \right) e^{ L| t - t_0 | } . \, \blacksquare
\end{gather}

この定理において $\bm{F}^1 = \bm{F}^2 ,\bm{R}^1_0 =\bm{R}^2_0$ とすれば,
全ての $t \in I$ に対して
\begin{gather}
\abs{\bm{R}^1 (t) - \bm{R}^2 (t)} \leq 0
\Longrightarrow
\bm{R}^1 (t)
=
\bm{R}^2 (t)
\end{gather}
となります.
つまり解の一意性の別証明が得られました.
\subsection{常微分方程式の解法の為の一般論}

具体的な微分方程式として 1 階と 2 階の常微分方程式をあとで扱います.
以下で主に使うものは単独の (連立でない) 方程式であり,
方程式系に対する扱いは少々煩雑にもなるので, 単独の方程式に対して議論を展開します.
とりあえずこんなものか, と思って眺めておいて下さい.
まずは定義から.
\begin{defn}
$n$ 階線型常微分方程式
\begin{gather}
\Lambda ( D ) x (t)
\defeq
D^n x (t) + p_{n-1} (t) D^{n-1} x (t) + \dotsb + p_{1}(t) D x (t) + p_{0}(t) x (t)
=
q (t)
\end{gather}
は $q = \theta$ (関数として $0$ , つまり恒等的に $0$ を返す関数) のとき\textgt{斉次方程式}\index{せいじほうていしき@斉次方程式}といい,
$q \not= \theta$ のとき\textgt{非斉次方程式}\index{ひせいじほうていしき@非斉次方程式}という.
\end{defn}
次に斉次方程式について
\textgt{重ね合わせの原理 (重畳原理)}\index{かさねあわせのげんり@重ね合わせの原理}\index{ちょうじょうげんり@重畳原理}を証明します.
\begin{thm}[重ね合わせの原理]
全ての係数関数 $p_i$ を連続関数とする $n$ 階の斉次の線型常微分方程式
\begin{gather}
\begin{split}
\Lambda ( D ) x (t)
\defeq
D^n x (t) + p_{n-1} (t) D^{n-1} x (t) + \dotsb \\
+p_{1} (t) D x (t) + p_{0} (t) x (t)
=
0
\label{eq:4-25.1}
\end{split}
\end{gather}
の解 $x_1 , \dots , x_m$ の線型結合
\begin{gather}
x (t)
=
\sum_{i=1}^m c_i x_i (t)
\label{eq:4-25.3}
\end{gather}
はまた (\ref{eq:4-25.1}) の解である.
\end{thm}
(証明)
すぐに終わります.
$x_1 , \dots , x_m$ がそれぞれ (\ref{eq:4-25.1}) の解なので,  $\Lambda (D) x_i = 0$ となります.
微分作用素の線型性を用いて
\begin{gather}
\Lambda (D) x
=
\Lambda (D) \left ( \sum_{i=1}^m c_i x_i \right)
=
\sum_{i=1}^m c_i \Lambda (D) x_i
=
\sum_{i=1}^m c_i 0
=
0 . \, \blacksquare
\end{gather}

次に解の線型独立性を定義します.
これは微分方程式の解のなす集合を考える際に重要なものです.
\begin{defn}
(\ref{eq:4-25.3}) の形に表せない解が存在するとき,
素の解は $x_1 , \dots , x_m$ に対して\textgt{線型独立}\index{せんけいどくりつ@線型独立}
であるという.
一般に $m$ 個の解の中のどの 1 つも残りの $(m-1)$ 個に対して線型独立であるときに,
これら $m$ 個の解は互いに線型独立であるという.
\end{defn}
次に線型独立性の判定法を紹介します.
\begin{thm}
$n$ 個の解 $x_1 (t) , \dots , x_n (t)$ が線型独立であるための必要十分条件は
\textgt{Wronski 行列式 (Wronskian)}(ロンスキアン)\index{ろんすきあん@ロンスキアン}
\begin{gather}
W ( x_1 (t) , x_2 (t) , \dots , x_n (t) )
\defeq
\begin{vmatrix}
x_1 (t) & x_2 (t) & \dots & x_n (t) \\
D x_1 (t) & D x_2 (t) & \dots & D x_n (t) \\
\hdotsfor{3} \\
D^{n-1} x_1 (t) & D^{n-1} x_2 (t) & \dots & D^{n-1} x_n (t) \\
\end{vmatrix}
\end{gather}
が定義域 $I$ 内で決して $0$ にならないことである.
\end{thm}
(証明) (必要性)
まず $W ( x_1 (t) , x_2 (t) , \dots , x_n (t) ) \not = 0$ となる $t_1 \in I$ が少なくとも一つ存在することを示しましょう.
背理法を使います.
もしそのような $t_1$ が存在しないとすると, 定理 (\ref{th:連立一次方程式}) から $c_i (i=1,\dots,n)$ に関する連立一次方程式
\begin{align}
&c_1 x_1 (t) + c_2 x_2 (t) + \dots + c_n x_n (t) = 0 \\
&c_1 D x_1 (t) + c_2 D x_2 (t) + \dots + c_n D x_n (t) = 0 \\
&\vdots \notag \\
&c_1 D^{n-1} x_1 (t) + c_2 D^{n-1} x_2 (t) + \dots + c_n D^{n-1} x_n (t) = 0
\end{align}
に対して $c_i \not= 0$ となる $i$ が存在する解の組 $\bm{c} \defeq {^t} (c_1 \,\, c_2 \,\, \dotsb \,\, c_n)$ が存在します.
$x (t) = c_1 x_1 (t) + \dots + c_n x_n (t)$ を考えると, これは $D^i x (t) = 0 ( i = 0, 1, \dots , n-1)$ を満たします.
$D^{n-1} x (t) = 0$ を積分すると $x (t) = d_0 + d_1 t + \dots + d_{n-2} t^{n-2}$ となりますが,
$d_i = 0 ( i = 0 ,1 , \dots , n-2)$ となり,  $x = \theta$ <恒等的に 0 を返す関数>となり,
$x_i (i= 1, 2, \dots ,n)$ の一次独立性に反します.

次に
\begin{gather}
D W ( x_1 (t) , x_2 (t) , \dots x_n (t) ) \\
=
\begin{vmatrix}
x_1 (t) & x_2 (t) & \dots & x_n (t) \\
D x_1 (t) & D x_2 (t) & \dots & D x_n (t) \\
\hdotsfor{3} \\
D^{n} x_1 (t) & D^{n} x_2 (t) & \dots & D^{n} x_n (t) \\
\end{vmatrix} \\
\end{gather}
となります.
\textgt{置換}による行列式の定義を採用したほうが楽なので, 一般の場合の証明は見送りますが,
そうかといって読者に任せる, というのも気が引けるので $n=2$ で確認してみます.
\begin{gather}
DW ( x_1 ,x_2)
=
D ( x_1 Dx_2 - x_2 D x_1   ) \\
=
Dx_1 Dx_2 + x_1 D^2 x_2 - Dx_2 D x_1 - x_2 D^2 x_1 \\
=
x_1 D^2 x_2 - x_2 D^2 x_1
=
\begin{vmatrix}
x_1 & x_2 \\
D^2 x_1 & D^2 x_2
\end{vmatrix} .
\end{gather}
話を元に戻しましょう.
$DW$ の第 $n$ 行は各 $x_i$ が (\ref{eq:4-25.1}) の解なので,
\begin{gather}
x_i (t)
=
-\sum_{k=1}^n p_k (t) D^k x_i (t)
\end{gather}
と書けることを用いて, 行列式の列に関する交代性から
\begin{gather}
DW ( x_1 (t) , x_2 (t) , \dots , x_n (t) )
=
-p_{n-1} (t) W ( x_1 (t) , x_2 (t) , \dots , x_n (t) )
\end{gather}
となります.
$n=2$ で確認してみましょう.
\begin{gather}
DW (x_1,x_2) \\
=
x_1 D^2 x_2 - x_2 D^2 x_1
=
-x_1 ( p_1 D x_2 + p_0 x_2 ) + x_2 ( p_1 D x_1 + p_0 x_1 ) \\
=
-p_1 ( x_1 D x_2 - x_2 p_1 D x_1 )
=
-p_1 W (x_1 ,x_2) .
\end{gather}
これは $W$ に関する 1 階の線型の斉次微分方程式となります.
$p_1$ は連続であるとしているので, ある 1 点 $t_0$ で $W (t_0)=0$ となるならば $W$ は恒等的に 0 になります.
しかし $t = t_1$ で $W (t_1)\not= 0$ なので,  $W$ は定義域内で $0$ となることはありません.

(十分性)
背理法で証明します.
定義域 $I$ 内で $W ( x_1 (t) , \dots ,x_n (t)) \not= 0$ かつ $y_1, \dots , y_n$ が線型独立でないと仮定します.
線型独立ではないので, 少なくとも 1 つは零でない定数 $c_i$ を用いて
\begin{gather}
c_1 x_1 (t) + \dots + c_n x_n (t) \equiv 0
\end{gather}
となります.
これを微分して
\begin{gather}
c_1 D^i x_1 (t) + \dots + c_n D^i x_n (t) \equiv 0
( i = 0, 1, \dots , n-1)
\end{gather}
となりますが,  $\hat{W}(t) \defeq ( D^{i-1} x_j (t) )$ とすると
$\hat{W}(t) \bm{c} = \bm{0}$ と行列でまとめて書けます.
Wronskian $W$ が $0$ でないので,  $\hat{W}$ には逆が存在して, それをかければ $\bm{c} = \bm{0}$ となりますが,
これは不合理です.  $\blacksquare$

ここで $n$ 階の斉次の線型常微分方程式において $n+1$ 個の解を持ってくると
これらは\textgt{線型独立ではない}ことが分かります.
見やすいので $n=1$ で書いてみます.
\begin{gather}
D x (t) = p (t) x (t)
\end{gather}
の 2 つの解を $x_1 , x_2$ としましょう.
前定理によって Wronskian を計算すると
\begin{gather}
W (x_1,x_2)
=
\begin{vmatrix}
x_1 & x_2 \\
Dx_1 & D x_2 \\
\end{vmatrix}
=
\begin{vmatrix}
x_1 & x_2 \\
p x_1 & p x_2 \\
\end{vmatrix}
=
p
\begin{vmatrix}
x_1 & x_2 \\
x_1 & x_2 \\
\end{vmatrix}
=
0
\end{gather}
つまり (互いに線型独立な) 解を持つとしたら, それは $n$ 個まで, ということが分かります.
さらに $n$ 個の解 $x_i (i=1,\dots,n)$ を $D^{i-1}x_i (t_1)=1 ,D^{j}x_i (t_1)=0 (j\not= i-1)$ となる
初期条件で求めれば, Wronskian が $1$ になるので,  $x_i$ は線型独立です.
したがって $n$ 階の斉次線型常微分方程式の解の集合は\textgt{ $n$ 次の線型空間}になります.
そこで次の定義をします.
\begin{defn}
(\ref{eq:4-25.1}) の $n$ 個の線型独立な解 $x_1, x_2 , \dots , x_n$ を
(\ref{eq:4-25.1}) の\textgt{基本解系}\index{きほんかいけい@(常微分方程式の) 基本解系}という.
\end{defn}

\begin{thm}
(\ref{eq:4-25.1}) の任意の解 $x$ は ({\ref{eq:4-25.1}}) の任意の基本解
$x_1 , x_2 , \dots , x_n$ の線型結合として一意的に表される.
\end{thm}
(証明)
$W (x_1 ,\dots ,x_n) \not= 0$ から定数 $c_i$ を
\begin{gather}
D^k x (t_1)
=
\sum_{i=1}^n c_i D^k x_i (t_1) ( k = 0, 1, \dots , n-1 )
\end{gather}
となるように定めることが出来ます.
$x_1 , x_2 , \dots , x_n$ の線型独立性から表現 $x (t) = \sum \, c_i x_i (t)$ の一意性が分かります.  $\blacksquare$

最後に非斉次方程式について議論します.
まず斉次方程式
\begin{gather}
\begin{split}
\Lambda (D) x (t)
\defeq
D^n x (t) + p_{n-1} (t) D^{n-1} x (t) + \dotsb \\
+p_{1}(t) D x (t) + p_{0}(t) x (t)
=
0
\end{split}
\label{eq:4-26.3}
\end{gather}
の解を\textgt{斉次解}\index{せいじかい@斉次解}, 非斉次方程式
\begin{gather}
D^n x (t) + p_{n-1} (t) D^{n-1} x (t) + \dotsb + p_{1}(t) D x (t) + p_{0}(t) x (t)
=
q (t)
\label{eq:4-26.1}
\end{gather}
の解を\textgt{特解 (特殊解)}\index{とくしゅかい@特殊解}と呼びます.
このもとで
\begin{thm}
(\ref{eq:4-26.1}) の任意の解はその任意の 1 つの特解と斉次方程式
(\ref{eq:4-26.3}) の一般解の和として表される.
\end{thm}
(証明)
(\ref{eq:4-26.1}) の 2 つの解を $x_1 , x_2$ としましょう.
ここで $z \defeq x_1 - x_2$ とすると
\begin{gather}
\Lambda z
=
\Lambda x_1 - \Lambda x_2
=q -q
=
0
\end{gather}
となります.
これは $z$ が斉次方程式 (\ref{eq:4-26.3}) の解であることを表します.
 $x_1 = z + x_2$ と書けますが, これが証明すべきことでした.  $\blacksquare$
\section{1 階線型方程式の解法}

物理的に重要な微分方程式の結果をいくつか紹介しました.
ここからは良く出てくる具体的な微分方程式の解法を紹介します.
解法を紹介する前に 1 つ確認しておきます.
解の存在と一意性をきちんと証明した以上,
\textgt{どんな手を使ってでも解を 1 つ見つけられればそれで終わり}です.
どれほど納得のいかない変な導出法であったとしても, です.
逆にいうならば, \textgt{変な導出法だが解が 1 つしかないのだから見つけた者勝ちだ}と
強弁をはるためにこれまで色々な飛び道具を用意してきた, ともいえます.

さて, 1 階の方程式で重要なのは電気回路についての方程式
\begin{gather}
\Lambda (D) j (t)
\defeq
L \frac{d j (t)} {dt} + R j (t)
=
v (t)
\end{gather}
でしょう.
ここで $L$ はコイルのインダクタンス,  $j$ は電流,
$R$ は抵抗,  $v$ は電源電圧です.

斉次解, 特解をそれぞれ $j_1,j_2$ とします.
つまり
\begin{gather}
\Lambda (D) j_1 (t) = 0 \\
\Lambda (D) j_2 (t) = v (t) .
\end{gather}
$j_1$ から求めます.
今解の一意性存在定理での $\bm{F}$ としたところが $-k j_1$ となっています.
これは高々一次の増大度の $C^1$ 級関数なので Lipschitz 条件を満たし, 解が一意的に存在します.
これは $D j_1 = - k j_1,k=R/L$ となる関数を求めれば良いのですが,  $e^{-kt}$ はこれを満たします.
したがって
\begin{gather}
j_1 (t)
=
c e^{- \frac{R} {L} t } .
\end{gather}
$c_1$ は初期条件から決める定数です.

次に特解を求めます.
これには\textgt{定数変化法}\index{ていすうへんかほう@定数変化法}と呼ばれる手法を用います.
これは先程の $ce^{-kt}$ で,  $c=c (t)$ としてみよう, というものです.
これを非斉次方程式に代入してみます.
\begin{gather}
v (t)
=
\Lambda (D) \left ( c (t) e^{-kt} \right)
=
L D \left ( c (t) e^{-kt} \right) + R c (t) e^{-kt} \\
=
L \left ( Dc (t) - k c (t) \right) e^{-kt}  + R c (t) e^{-kt}
=
L e^{-kt} D c (t)
\end{gather}
となり, これから
\begin{gather}
c (t)
=
\frac{1} {L} \int v (s) e^{ks} \, ds
\end{gather}
と求められます.
一般解は
\begin{gather}
j (t)
=
c e^{\frac{R} {L} t} + \frac{1} {L} \int v (s) e^{\frac{R} {L}(t-s)} \, ds
\end{gather}
となります.
\section{2 階線型方程式の解法}

2 階の線型方程式は振動の方程式です.
摩擦などの抵抗が速度に比例するものとしましょう.
比例定数を $\Gamma$ ,  $F$ を外力として運動方程式は
\begin{gather}
m D^2 x (t) + \Gamma D x (t) + k x (t) = F (t)
\end{gather}
となります.
ここで $f \defeq F/m , 2 \gamma \defeq \Gamma / m , k/m \defeq \omega^2 , \omega>0$ とすると
\begin{gather}
D^2 x (t) + 2 \gamma x (t) + \omega^2 x (t) = f (t)
\label{eq:4-振動の方程式}
\end{gather}
となります.
実際に解く際にはこれで考えると楽なことはおいおい分かるでしょう.
各種考察の前に抵抗, コンデンサ, コイルが全て入った回路の方程式を書いておきます.
高校では $i = \varDelta q / \varDelta t$ と学んだと思いますが,
この $\varDelta \to 0$ とした極限で $i = dq / dt = D q$ となります.
\begin{gather}
L D j (t) + R j (t) + \frac{1}{C} \int j (s) ds = v (t)
\end{gather}
これは一般に\textgt{微分積分方程式}\index{びぶんせきぶんほうていしき@微分積分方程式}と呼ばれるものですが,
$v$ を例えば $C^1$ 級であるとしておいて両辺を微分すると 2 階の常微分方程式になります.

それでは実際に (\ref{eq:4-振動の方程式}) を解いていきましょう.
まず解の存在と一意性を確かめます.
$y_0 (t) \defeq x (t) , y_1 (t) \defeq Dx (t) , \bm{Y}(t) \defeq {^t}( y_0 (t) \,\, y_1 (t) )$ としましょう.
このとき
\begin{gather}
D \bm{Y}(t)
=
\begin{pmatrix}
D y_0 (t) \\
D y_1 (t)
\end{pmatrix}
=
\begin{pmatrix}
y_1 (t) \\
-2 \gamma y_1 (t) - \omega ^2 y_0 (t)
\end{pmatrix}
=:
\bm{F}(\bm{Y}(t) ,t)
\end{gather}
となります.
示すべきは $\bm{F}$ の Lipschitz 性です.
2 行目から 3 行目への不等式は $( a + b )^2 \leq 2 ( a^2 + b^2 )$ を使っています.
\begin{gather}
\abs{\bm{F}(\bm{Y},t) - \bm{F}( \bm{Z}, t )} \\
=
\sqrt{ ( y_0 - z_0 )^2 + \left \{ -2\gamma ( y_1 - z_1 ) - \omega ^2 ( y_0 - z_1 ) \right \} ^2 } \\
\leq
\sqrt{ ( y_0 - z_0 )^2 +
2 \left[ \left \{ -2\gamma ( y_1 - z_1 ) \right \} ^2 + \left \{ - \omega ^2 ( y_0 - z_1 ) \right \} ^2 \right ] } \\
=
\sqrt{ ( 1 + 2 \omega ^4 ) ( y_0 - z_0 )^2 + 8 \gamma ^2 ( y_1 - z_1 ) ^2 } \\
\leq
\max \left ( \sqrt{ 1 + 2 \omega ^4 } , \sqrt{ 8 \gamma ^2 } \right) \sqrt{ ( y_0 - z_0 )^2 + ( y_1 - z_1 ) ^2 } \\
=
\max ( 1 + 2 \omega ^4 , 8 \gamma ^2 ) | \bm{Y} - \bm{Z} | . \, \blacksquare
\end{gather}

次に斉次解を求めます.
$\gamma = 0$ , つまり摩擦がない時の解は高校で学んだものと同じです.
以下に示す方法を使えば各自で容易に導出できるはずなので,
ここでは省略して,  $\gamma \not= 0$ の場合を扱っていきます.
かなりの荒技ですが, ここで\textgt{微分作用素 $\Lambda (D)$ を因数分解}します.
まず $x$ が $\Lambda (D)$ の固有関数 (ベクトル) であるとします.
このとき $D$ はただ数をかけるだけの\textgt{掛け算作用素}\index{かけざんさようそ@掛け算作用素}に変わるので,
固有関数を考える限りは普通の数と同じように扱ってよいでしょう.
これは (\ref{eq:4-振動の方程式}) の係数が実数であって, 関数ではないからできることです.
$d \defeq \gamma ^2 - \omega ^2$ として $D^2 + 2 \gamma D + \omega ^2$ を因数分解すると,
\begin{gather}
\left \{ D - ( - \gamma + \sqrt{d} ) \right \} \left \{ D - ( - \gamma - \sqrt{d} ) \right \}
\end{gather}
となります.
したがって (\ref{eq:4-振動の方程式}) は
\begin{align}
0
&=
\left \{ D - ( - \gamma + \sqrt{d} ) \right \} \left \{ D - ( - \gamma - \sqrt{d} ) \right \} x (t) \\
&=
\left \{ D - ( - \gamma - \sqrt{d} ) \right \} \left \{ D - ( - \gamma + \sqrt{d} ) \right \} x (t)
\end{align}
となります.
$\left \{ D - ( - \gamma - \sqrt{d} ) \right \} x (t)=0,
\left \{ D - ( - \gamma + \sqrt{d} ) \right \} x (t)$
の解をそれぞれ $x_1 , x_2$ とすると, これらは自動的に (\ref{eq:4-振動の方程式}) を満たします.
前節での計算結果から $c_i$ を (初期条件により定まる) 定数として
\begin{gather}
x_1 (t)
=
c_1 e^{ ( - \gamma - \sqrt{d} ) t}
, \quad
x_2 (t)
=
c_2 e^{ ( -\gamma + \sqrt{d} ) t}
\end{gather}
となります.
またこの Wronskian を計算すると
\begin{gather}
W (x_1 ,x_2)
=
\begin{vmatrix}
x_1 & x_2 \\
D x_1 & D x_2
\end{vmatrix}
=
c_1 c_2 e^{- \gamma t} \left \{ ( -\gamma + \sqrt{d} ) - ( - \gamma - \sqrt{d} ) \right \}  \\
=
2 c_1 c_2 \sqrt{d} e^{- \gamma t}
\not=
0 ( d \not= 0)
\end{gather}
となり,  $d \not= 0$ のとき $x_1,x_2$ は線型独立です.
$d=0$ のときはどうするかということが問題として浮上してきました.
このとき (\ref{eq:4-振動の方程式}) は
\begin{gather}
( D + \gamma ) ^2 x (t) =0
\end{gather}
となります.
つまり $x_1 (t) \defeq c_1 e^{- \gamma t}$ とすれば, これは上の方程式の解になっています.
もう 1 つ線型独立な解を見つける必要があります.
Laplace 変換を使うと何も考えずにすんなり出てきますが, 今はひとまず天下りに与えます.
$x_2 (t) \defeq c_2 t e^{- \gamma t}$ が求める答です.
実際
\begin{gather}
( D + \gamma ) ^2 x_2
=
c_2 ( D^2 + 2 \gamma D + \gamma ^2 ) t e^{- \gamma t} \\
=
c_2 e^{- \gamma t }\{ ( \gamma ^2 - 2 \gamma ) +  2 \gamma ( 1 - \gamma ) + \gamma ^2   \}
=
0
\end{gather}
となります.
Wronskian も
\begin{gather}
W (x_1, x_2)
=
\begin{vmatrix}
x_1 & x_2 \\
Dx_1 & Dx_2
\end{vmatrix}
=
\begin{vmatrix}
c_1 e^{ - \gamma t} & c_2 t e^{ - \gamma t} \\
-c_1 \gamma e^{ - \gamma t} & c_2 ( 1 - \gamma t ) e^{ - \gamma t}
\end{vmatrix} \\
=
c_1 c_2 e^{ - \gamma t} ( 2 - \gamma t )
\not=
0 (t\not = 2 / \gamma )
\end{gather}
となります.
したがっていずれにせよ斉次方程式の任意の解は $x_1,x_2$ の線型結合で書くことができることが分かります.
ここでずっと気になっていた読者もいることと思いますが,  $d$ はいわゆる判別式であって,
$d$ の正負が次の問題です.

数学は一旦忘れて物理を考えてみましょう.
いま (\ref{eq:4-振動の方程式}) がばねの振動を記述しているものとします.
ある程度ばねを伸ばして (縮ませて) から手を放したとしましょう.
摩擦力が十分小さいとき, はじめは大きく振動していても時間が経つごとに振幅が小さくなっていくはずです.
つまり\textgt{減衰振動}\index{げんすいしんどう@減衰振動}になるはずです.
逆に摩擦力が非常に大きいとき, ほとんど全く振動せずに振動が止まってしまうでしょう.

この状況が $d = \gamma ^2 - \omega ^2$ の正負と直接に関係します.
$d<0$ のときを考えます.
つまり $\gamma < \omega$ であり, 上でいうところの「摩擦係数が小さいとき」です.
このとき $\sqrt{d} = i \sqrt{-d} = i \sqrt{\omega ^2 - \gamma ^2}$ であり,
\begin{gather}
x_1 (t)
=
c_1 e^{- \gamma t } e^{ - i \sqrt{\omega ^2 - \gamma ^2} t}
, \quad
x_2 (t)
=
c_2 e^{- \gamma t } e^{ + i \sqrt{\omega ^2 - \gamma ^2} t }
\end{gather}
です.
時間と共に振幅 $c e^{- \gamma t}$ は減衰していき,
Euler の公式\index{おいらーのこうしき@Euler の公式} $e^{it}= \cos t + i \sin t$ から
きちんと振動項も入っていて,
減衰振動を記述していることが分かります.

次に $d>0$ を考えましょう.
このときは何もせずに
\begin{gather}
x_1 (t)
=
c_1 e^{ ( - \gamma - \sqrt{d} ) t}
, \quad
x_2 (t)
=
c_2 e^{ ( - \gamma + \sqrt{d} ) t }
\end{gather}
として良いことになります.
ここで場合によっては $x_2$ で $- \gamma + \sqrt{d} > 0$ となることがあり,
これは時間と共に振幅が無限に大きくなっていく, という非物理的 (非現実的) な解になってしまいます.
しかしこれはもともと Hooke の法則が振動の小さいところでしか成り立たない近似的な法則であり,
その近似の限界を超えてしまったところにまで法則の成立を仮定したために起こったことです.
実際には非線型項 $x^2 ,x^3 ,\dots$ などが出てきて, 振幅の発散は起こりません.
$x_1$ (と $d$ が十分小さいときの $x_2$ ) は\textgt{過減衰}と呼ばれます.

最後に $d=0$ ですが, これは振動と過減衰を分ける\textgt{臨界 (現象)}であり,
精査すると色々と面白いようですが, 踏み込むのはやめます.

非斉次方程式ですが, この解について一般論を述べるのはひどく大変です.
ここでは回路理論で最も自然だと思われる $f (t) = f \sin \omega_0 t$ について述べます.
これについても解の一意性存在と物理的な直観を頼りに議論しましょう.
今考えているのは外力による振動を加えた時のばねの伸び縮みです.
普通に考えて, ばねの振動と外力による振動は同じような振動になるでしょう.
つまり, 解を $x_0 (t) = A \sin \omega_0 t$ と仮定して良いでしょう.
しかしこれだと $Dx (t) = A \omega_0 \cos \omega_0 t$ となり, 計算がやや面倒になります.
そこで複素数の世界に潜って,  $f (t) = f e^{i \omega_0 t} , x_0 (t) = A e^{i \omega_0 t}$ とします.
すると微分の計算が簡単になる他,
$\mathrm{Re} \, x_0 (t) , \mathrm{Im} \, x_0 (t)$ とすることで,
それぞれ外力が $\cos ,\sin$ で与えられる場合に一度に対応できます.
実際に計算してみましょう.
\begin{gather}
f e^{ i \omega_0 t }
=
( D^2 + 2 \gamma D + \omega ^2 ) A e^{ i \omega_0 t}
=
A ( - \omega_0 ^2 + 2 i \gamma \omega_0 + \omega ^2 ) e^{i \omega_0 t} \\
\Longrightarrow
A
=
\frac{ f } { - \omega_0 ^2 + 2 i \gamma \omega_0 + \omega ^2 }
\end{gather}
したがって非斉次解は
\begin{gather}
x_0 (t)
=
\frac{ f } { - \omega_0 ^2 + 2 i \gamma \omega_0 + \omega ^2 } e^{i \omega_0 t}
\end{gather}
となります.
\chapter{{\bfseries\sffamily TODO} Maxwell equations and vector analysis}

\section{導入}

\section{微分作用素ナブラ}

\section{諸公式の導出とテンソル}

\section{Green の定理}

\section{Stokes の定理}

\section{Gauss の定理}

\section{微分形式とベクトル解析}

\part{Complex Analysis}

\chapter{Talk: Complex Analysis in One variable}

See, e.g., \cite{MitsuoSugiura2} for consultation.
In the following we assume $U \subset \bbC$ is a domain without further mention.
\section{Definition: complex differentiablity}

\begin{defn}
 Let $f \colon U \to \bbC$ be a function.
 A function $f$ is called \upbf{(complex-) differentiable} at
 $a \in U$ if there exists a constant $A \in \bbC$ such that
 \begin{align}
  f (z)
  =
  f (a) + A (z-a) + o (z-a).
 \end{align}
 A constant $A$ is written by $f'(a)$.
 A function $f$ is \upbf{holomorphic} if $f$ is differentiable at all points in $U$.
\end{defn}
Note that we do not assume continuity of a derivative for holomorphy.
\begin{rem}\textup{(What is different from differentiablity for functions in two real variables?)}
 Consider the following function $f (x, y)$ with two real variables,
\begin{align}
 f (x, y) =
 \begin{cases}
  0, &\quad x=y=0, \\
  \frac{xy}{x^2+y^2}, &\quad \mathrm{otherwise}.
 \end{cases}
\end{align}
This function $f$ is $C^{\infty}$ for $x$ or $y$ but $f$ is not \upbf{continuous} in two variables.
A deep result, \upbf{Hartogs' theorem}, exists for the theory in several complex variables.
See, e.g., \cite{ToshioNishino1}.
\end{rem}
\section{Cauchy-Riemann equation}

\begin{thm}[The Cauchy-Riemann equation]
 Let $f \colon U \to \bbC$ be holomorphic and denote $f = u + iv$, $u=u (x,y)$ and $v=v (x,y)$.
 Then we have $u_x = v_y$ and $u_y = - v_x$.
\end{thm}
\begin{proof}
 Calculate as below:
 \begin{align}
  f'(0)
  &=
  \lim_{x \to 0} \frac{f (x,0) - f (0,0)}{x} = u_x + iv_x \\
  &=
  \lim_{y \to 0} \frac{f (0,y) - f (0,0)}{iy} = \frac{1}{i} (u_y + iv_y).
 \end{align}
\end{proof}
\section{Complex line integral}

First we review a line integral in $\bbR^2$.
\begin{defn}\textup{(Line integral in $\bbR^2$)}
 Let $C \colon I=[a,b] \to \bbR^2$ be a piecewise $C^1$ curve and $\image C \subset U$ and
 $F \colon U \to \bbR^2$ be a continuous vector field.
 Then we define a \upbf{line integral} over $C$ of $F$ as
\begin{align}
 \int_{C} F \cdot dC
 =
 \int_{\image C} F (C) \cdot dC
 =
 \int_a^b F (C (t)) \cdot C'(t) dt.
\end{align}
\end{defn}
\begin{defn}\textup{(Complex line integral)}
 Assume $f \colon U \to \bbC$ is continuous and $C \subset U$ is a piecewise $C^1$ curve.
 Then we define a \upbf{complex line integral} as
\begin{align}
 \int_C f (z) dz
 \defeq
 \int_C (u dx - v dy) + i \int_C (u dy + v dx),
\end{align}
where we denote $f = u + iv$.
Furthermore we define another type of integral.
\begin{align}
 \int_C f (z) \abs{dz}
 \defeq
 \int_a^b f (z (t)) \abs{z'(t)} dt.
\end{align}
\end{defn}

We define two more concepts for assertion of the Cauchy's integral theorem.
\begin{defn}\textup{(Homolog 0 curve.)}
 Assume $C \subset U$ is a piecewise $C^1$ closed curve, i.e., $C \colon [0, 1] \to U$ satisfied $C (0) = C (1)$,
 and $a \in U$.
 Then a number $n (C,a)$, called a \upbf{winding number}, is defined by
\begin{align}
 n (C, a)
 \defeq
 \frac{1}{2 \pi i} \int_{C} \frac{1}{z-a} dz.
\end{align}
Furthermore a curve $C$ is called \upbf{homolog 0 for $U$} if $n (C, a) = 0$ for any $a \notin U$.
This is denoted by $C \sim 0$ in $U$.
\end{defn}
\begin{defn}\textup{(Simply connectedness.)}
 Assume $U \subset \bbC$.
 A domain $U$ is called \upbf{simply connected} if each piecewise $C^1$ closed curve $C$ is homolog 0 in $U$.
\end{defn}
Here we can state two forms of the Cauchy integral theorem.
\begin{thm}[Cauchy's integral theorem 1: for any $U$ but confined $C$]
 Assume a function $f$ on $U$ is holomorphic and a curve $C \subset U$ is a homolog 0 curve.
 Then we have $\int_C f (z) dz = 0$.
\end{thm}
\begin{thm}[Cauchy's integral theorem 2: for confined $U$ but any $C$]
 Assume a function $f$ on $U$ is holomorphic, a region $U$ is simply connected, and a curve $C \subset U$ is piecewise $C^1$.
 Then we have $\int_C f (z) dz = 0$.
\end{thm}
\begin{rem}
 The assumption of piecewise smoothness for curves in the Cauchy integral theorems is needed for application, e.g., the residue theorem.
\end{rem}
\begin{proof}
We prove the theorem in a easy form: we use the famous Green theorem in the vector calculus \cite{MitsuoSugiura2}.
Assume a function $f$ is in $C^1$ and we denote a region surrounded by $C$ as $B$.
Then we have, by Green' theorem,
\begin{align}
 \int_C f
 &=
 \int_C (u dx - v dy) + i \int_C (u dy + v dx) \\
 &=
 -\int_B (u_y + v_x) dx dy + i \int_B (u_x - v_y) dxdy \\
 &=
 0,
\end{align}
where we use the Cauchy-Riemann equation in the last equal sign.
\end{proof}

This theorem is wonderful in, at least, two points.
\begin{enumerate}
\item The value of $f$ is determined by line integrals.
We can take curves arbitrarily, so holomorphic functions cannot determine their values freely.
See also Cauchy's integral representation formula.
\item It defines an another function by line integrals, $F_{z_0} \defeq \int_{C} f$, where $C$ is a curve which connects two points $z_0$ and $z$ in $U$.
See Morela's theorem.
\end{enumerate}
\subsection{Appendix: Green's theorem}

We introduce a simple version.
Consider $C^1$ functions $\varphi$ and $\psi$ defined on a compact interval $I=[a, b]$ satisfying
\begin{align}
 \varphi (x) \leq \psi (x), \quad x \in I.
\end{align}
The region $U$ is defined by
\begin{align}
 U
 =
 \set{(x,y) \in \bbR^2}{a \leq x \leq b, \quad \varphi (x) \leq y \leq \psi (x)}.
\end{align}
By similar functions $f, g$ the region $U$ is also described by
\begin{align}
 U
 =
 \set{(x,y) \in \bbR^2}{\alpha \leq y \leq \beta, \quad f (y) \leq x \leq g (y)}.
\end{align}
\begin{thm}[Green's theorem]
 Assume a $C^1$ vector field $F = (u, v)$ is defined in $U$.
 Then it holds that
 \begin{align}
  \int_U \rbk{v_x - u_y} dx dy
  =
  \int_{\partial U} udx + vdy.
 \end{align}
\end{thm}
\begin{proof}
The fundamental theorem in calculus leads
\begin{align}
 -\int_U u_y dx dy
 &=
 -\int_a^b \rbk{\int_{\varphi (x)}^{\psi (x)} u_y dy} dx \\
 &=
 \int_a^b \cbk{u (x, \varphi (x)) - u (x, \psi (x))} dx
 =
 \int_{C_1 + C_2} u dx
 =
 \int_{\partial U} u dx,
\end{align}
where the curves $C_1$ and $C_2$ are assumed to be properly defined.
Similar computation for $v$ shows
\begin{align}
 \int_U v_x dx dy
 &=
 \int_{\alpha}^{\beta} \rbk{\int_{f (y)}^{g (y)} v_x dx} dy \\
 &=
 \int_{\alpha}^{\beta} \cbk{v (g (y), y) - u (f (y), y)} dy
 =
 \int_{\partial U} v dy.
\end{align}
Summing up the above two expressions leads the result.
\end{proof}
\section{Morela's theorem}

Morela's theorem is a converse of Cauchy's integral theorem:
i.e., differentiablity and integrability coincide for holomorphic functions.
For proof we need some preparations.
\begin{defn}
 A function $F \colon U \to C$ is a primitive function of $f$ in $U$ is $F' = f$.
\end{defn}
\begin{thm}
 Assume a function $f \colon U \to \bbC$ is continuous and $\int_C f (z) dz = 0$ for any piecewise $C^1$ closed curves.
 Then there exists a function $F$ on $U$ such that $F' = f$.
\end{thm}
\begin{proof}
Fix a point $z_0 \in U$ and let $z \in U$ be arbitrary.
Since $U$ is connected we have two piecewise $C^1$ curve $C_j$ which do not intersect.
A curve $C \defeq C_1 + (- C_2)$ is a closed piecewise $C^1$ curve.
Then, by assumption,
\begin{align}
 0
 =
 \int_C f (z) dz
 =
 \int_{C_1} f (z) dz - \int_{C_2} f (z) dz.
\end{align}
Hence we can define a function $F$ as
\begin{align}
 F (z)
 \defeq
 \int_{z_0}^{z} f (z) dz
 \defeq
 \int_{C_1} f (z) dz = \int_{C_2} f (z) dz.
\end{align}

Next we would like to show $F' = f$.
Since $f$ is continuous, for any $\epsilon > 0$, there exists a $\delta > 0$ such that $\abs{f (z+h) - f (z)} < \epsilon$ if $\abs{h} < \delta$.
Then we obtain
 \begin{align}
  \abs{\frac{F (z+h) - F (z)}{z} - f (z)}
  &=
  \abs{\frac{1}{h}\int_{z}^{z+h} \rbk{f (w) - f (z)} dw} \\
  &\leq
  \frac{1}{\abs{h}} \epsilon \abs{h} = \epsilon.
  \end{align}
\end{proof}

Then we obtain
\begin{thm}[Morela's theorem]
 Assume a function $f \colon U \to \bbC$ is continuous and $\int_C f = 0$ for any piecewise $C^1$ closed curve $C \subset U$.
 Then $f$ is holomorphic in $U$.
\end{thm}
\begin{proof}
By the above theorem we have a function $F$ such that $F' = f$.
The following Cauchy's integral representation formula and Taylor series expansion theorem show that $F$ and $f$ are holomorphic.
\end{proof}
\section{Cauchy's integral representation formula and Taylor series expansion}

\begin{thm}
 Let $f \colon U \to \bbC$ be holomorphic and $C \subset U$ be a homolog 0 curve.
 Then we have a following representation:
 \begin{align}
  n (C, a) f (a)
  =
  \frac{1}{2 \pi i} \int_C \frac{f (z)}{z - a} dz.
 \end{align}
\end{thm}
\begin{proof}
Let $a \in U \setminus C$ and put
\begin{align}
 \varphi (z)
 =
 \begin{cases}
  \frac{f (z) - f (a)}{z - a}, &\quad z \neq a, \\
  f'(a), &\quad z = a.
 \end{cases}
\end{align}
Since $\varphi$ is holomorphic in $U$ [fn:complex-analysis-one-variable-1]
we get, by Cauchy's integral theorem,

[fn:complex-analysis-one-variable-1]There are some gaps. See the proof of Theorem 2.4, Chapter 9 in \cite{MitsuoSugiura2}.


\begin{align}
 0
 =
 \frac{1}{2 \pi i} \int_C \varphi (z) dz
 =
 \frac{1}{2 \pi i} \int_C \frac{f (z)}{z-a} dz - \frac{f (a)}{2 \pi i} \int_C \frac{1}{z-a} dz.
\end{align}
\end{proof}
\begin{thm}[Taylor series expansion]
 Assume a function $f \colon U \to \bbC$ is holomorphic.
 Then a function $f$ is complex analytic and has a following expansion:
 \begin{align}
  f (z)
  =
  \sum_{n = 0}^{\infty} c_n (z-a)^n, \quad
  c_n \defeq \frac{1}{2 \pi i} \int_C \frac{f (z)}{\rbk{z - a}^{n+1}} dz.
 \end{align}
\end{thm}
\begin{proof}
 For sufficiently small $\abs{z-a}$, we have the following expansion:
 \begin{align}
  \frac{1}{w - z}
  &=
  \frac{1}{w - a - (z - a)} = \frac{1}{w - a} \frac{1}{1 - \frac{z - a}{w - a}} \\
  &=
  \frac{1}{w - a} \sum_{n=0}^{\infty} \rbk{\frac{z-a}{w - a}}^n.
 \end{align}
Due to Cauchy's integral representation formula and exchange of limits we have
\begin{align}
 f (z)
 =
 \sum_{n = 0}^{\infty} c_n (z-a)^n, \quad
 c_n \defeq \frac{1}{2 \pi i} \int_C \frac{f (z)}{\rbk{z - a}^{n+1}} dz.
\end{align}
\end{proof}

A function $f \colon \bbC \to \bbC$ is called \textbf{entire} if it is holomorphic in all $\bbC$.
\begin{thm}[Liouville's theorem]
 If an entire function $f$ is bounded $f$ is constant.
\end{thm}
\section{Simple application of fundamental theorems: convergence of holomorphic functions}

\begin{defn}\textup{(Uniform convergence in the wider sense.)}
 Let $f_n, f \colon U \to \bbC$ be functions.
 A sequence of functions $(f_n)$ converges to $f$ uniformly in the wider sense if,
 for any compact subset $K \subset U$ such that $\lim_{n \to \infty} \norm{f_n - f}_K = 0$, where
\begin{align}
 \norm{f}
 \defeq
 \sup_{z \in K} \abs{f (z)}.
\end{align}
We denote this convergence as $f_n \touw f$.
\end{defn}
\begin{thm}[Weierstrass. Theorem 3.5 in \cite{MitsuoSugiura2}]
 Assume functions $f_n \colon U \to \bbC$ are holomorphic, $f \colon U \to \bbC$ is defined by
 a uniform limit in the wider sense, i.e., $f_n \touw f$.
 1) For any piecewise $C^1$ curves we have the following equality,
    \begin{align}
     \int_C f (z) dz = \lim_{n \to \infty} \int_C f_n (z) dz.
    \end{align}
 2) The limit function $f$ is holomorphic.
 3) We have
    \begin{align}
     f'(z) = \lim_{n \to \infty} f_n' (z).
    \end{align}
\end{thm}
\begin{proof}
1)-2): Due to Cauchy's integral theorem, for any homolog 0 curve $C$, we obtain $\int_C f_n = 0$.
Since $C$ is compact and a sequence $(f_n)$ converges to $f$,
a sequence $(\norm{f - f_n}_C)_{n \in \bbN}$ converges to 0 and hence is bounded.
Then it holds that
\begin{align}
 \abs{\int_C f}
 &=
 \abs{\int_C f - \int_C f_n}
 \leq
 \int_C \abs{f - f_n} \abs{dz} \\
 &=
 \norm{f - f_n}_C \int_C \abs{dz} \to 0.
\end{align}

3): By Cauchy' integral representation theorem it holds that, for $a \in U \setminus C$,
\begin{align}
 f'(a)
 &=
 \frac{-1}{2 \pi i} \int_C \frac{f (z)}{(z-a)^2} dz, \\
 f_n'(a)
 &=
 \frac{-1}{2 \pi i} \int_C \frac{f_n (z)}{(z-a)^2} dz.
\end{align}
The remaining argument is the same as above.
\end{proof}


\begin{rem}\textup{(Points for the proof.)}
Assume functions $f_n \colon K \to \bbC$ are continuous on a compact set $K \subset \bbC$
and that a sequence $(f_n)$ converges to a function $f$ on $K$.
\begin{enumerate}
\item A new sequence $(\norm{f_n -f })_n$ converges to 0 and hence is bounded.
\item It holds that $\int_K f_n \to \int_K f$.
\end{enumerate}
\end{rem}
\section{Zero points for holomorphic functions and theorem of identity}

\begin{thm}[Zero points for holomorphic functions are isolated]
 Let a function $f \colon U \to \bbC$ be holomorphic.
 Then each zero point of $f$ is isolated.
\end{thm}
\begin{proof}
Suppose $z_0 \in U$ is a zero point of $f$, i.e., $f (z_0) = 0$, and its degree is $k$-th.
Let a point $z$ be sufficiently near $z_0$.
Then, by Cauchy's integral representation formula, we get
\begin{align}
 f (z)
 =
 \sum_{n=k}^{\infty} c_n (z - z_0)^n
 =
 (z - z_0)^k g (z), \quad g (z) \defeq \sum_{n=k}^{\infty} c_n (z-z_0)^{n-k}.
\end{align}
Since a function $g$ is continuous there exists a neighborhood $B \subset U$ of $z_0$ such that $g (w) \neq 0$ for all $w \in B$.
Hence $f (z) \neq 0$ for all $z \in B \setminus {z_0}$.
\end{proof}
\begin{thm}[Theorem of identity]
 Let functions $f, g \colon U \to \bbC$ be holomorphic and $C \subset U$ have a limit point in $U$.
 If $f = g$ on $C$ then $f=g$ in $U$.
\end{thm}
\begin{proof}
 Let $h = f - g$.
 Then $h = 0$ on $C$.
 Since zero points are isolated for holomorphic functions in one variable it holds that $h = 0$.
\end{proof}

\begin{thm}[Theorem of identity in several complex variables]
 Let $U \subset \bbC^n$ be an open set.
 Assume $f \colon U \to \bbC$ is holomorphic.
 If $f|_V = 0$ for an open subset $V \subset U$ then $f=0$.
\end{thm}
\begin{ex}\textup{(Conterexamples for Theorem of identity in several complex variables.)}
\begin{enumerate}
\item \textup{(Using the proof of isolated zero points.)} Consider a holomorphic functions $f$ in one variables and set $F (z_1, z_2) = z_1 f (z_2)$.
Then $F = 0$ on a complex line $z_1 = 0$ but this is not a zero function.
\item \textup{(Using algebraic geometry.)} Assume a polynomial $f$ is not zero and nonconstant.
Consider an algebraic variety $V (f) = \cbk{f=0}$.
Then $f$ is $0$ on a closed set $V (f)$ and $f \neq 0$.
\end{enumerate}
\end{ex}
\section{Theorem of residues}

\subsection{Laurent expansion}

Let $a \in U$ and $R > 0$.
We call the following $B_0 (a, R)$ an \textbf{exclusive neighborhood} of $a$:
\begin{align}
 B_0 (a, R)
 \defeq
 \set{z \in \bbC}{ 0 < \abs{z - a} < R}.
\end{align}
\begin{defn}\textup{(Singular points.)}
 Let $a \in U$ and $R > 0$.
 If a function $f \colon B_0 (a, R) \to \bbC$ is holomorphic and not holomorphic in $B (a, R)$,
 then a point $a$ is called an \upbf{isolated singular point}.
 I.e., a function $f$ is not defined at a point $a$, or $f$ is defined and not differentiable at $a$.
\end{defn}
\begin{thm}[Laurent expansion]
 If a function $f$ is holomorphic in $B_0 (a, R)$ for a point $a \in U$, then
 $f$ is represented as the following \upbf{Laurent series} in $B = B_0 (a, R)$.
 \begin{align}
  f (z)
  =
  \sum_{n= - \infty}^{\infty} c_n (z-a)^n,
 \end{align}
 where coefficients $c_n$ is defined by
 \begin{align}
  c_n
  \defeq
  \frac{1}{2 \pi i} \int_C \frac{f (z)}{(z - a)^{n+1}} dz \quad (\forall n \in \bbZ).
 \end{align}
 Here the above $C$ is a circle with a center $a \in U$ and a radius $r \in (0, R)$.
\end{thm}
\begin{proof}
Let $0 < R_2 < R_1 < R$, define an annulus $A (a; R_1, R_2) \defeq \set{z \in \bbC}{R_2 < \abs{z - a} < R_1}$,
and take a point $z \in A (a; R_1, R_2)$.
Take a positive number $\rho > 0$ such that $\overline{B (z, \rho)}$ is included by $A (a; R_1, R_2)$.
Let $C_i$ be circles with positive direction for $B (a, R_i)$ and $\Gamma$ is a boundary of $A (a; R_1, R_2)$.
Then we have
\begin{align}
 \int_{\Gamma} \frac{f (w)}{w - z} dw
 =
 \int_{C_1} \frac{f (w)}{w - z} dw - \int_{C_2} \frac{f (w)}{w - z} dw.
\end{align}
Since $\abs{(z - a) / (w - a)} < 1$ when $w \in C_1$ we obtain
\begin{align}
 \frac{1}{w - z} = \sum_{n=0}^{\infty} \frac{(z - a)^n}{(w - a)^{n+1}}.
\end{align}
This leads
\begin{align}
 \frac{1}{2 \pi i} \int_{C_1} \frac{f (w)}{w - z} dw
 =
 \sum_{n=0}^{\infty} c_n (z - a)^n, \quad
 c_n
 =
 \frac{1}{2 \pi i} \int_{C_1} \frac{f (w)}{(w - z)^{n+1}} dw.
\end{align}
Furthermore, due to holomorphy of $f$ in $B (z, \rho)$, Cauchy's integral representation formula leads
\begin{align}
 f (z)
 =
 \frac{1}{2 \pi i} \int_{\Gamma} \frac{f (w)}{w - z} dw
\end{align}

Since $\abs{(w - a) / (z - a)} < 1$ when $w \in C_2$ we obtain
\begin{align}
 \frac{1}{w - z} = - \sum_{n=1}^{\infty} \frac{(w - a)^{n-1}}{(z - a)^{n}}.
\end{align}
This leads
\begin{align}
 -\frac{1}{2 \pi i} \int_{C_2} \frac{f (w)}{w - z} dw
 =
 \sum_{n=1}^{\infty} c_{-n} (z - a)^{-n}, \quad
 c_{-n}
 =
 \frac{1}{2 \pi i} \int_{C_2} \frac{f (w)}{(w - z)^{-n+1}} dw.
\end{align}

Taking limits for $R_1$ and $R_2$ and arguments for changes of paths end the proof.
\end{proof}

\begin{defn}
 Assume $a \in U$ is an (isolated) singular point of a function $f$ and its Laurent expansion is
 \begin{align}
  f (z)
  =
  \sum_{n=-\infty}^{\infty} c_n (z-a)^n.
 \end{align}
 We classify a singular point $a$ as follows.
 1) A singular point $a$ is called a \upbf{removable singular point} if $c_{n} = 0$ for all $n \leq -1$.
 2) A singular point $a$ is called a \upbf{pole of $n$-th order} if there exists a negative integer $n \leq -1$ such that
    $c_{n} \neq 0$ and $a_m = 0$ for all $m < n$.
 3) A singular point $a$ is called a \upbf{essential singular point} if there exists infinitely many negative integer $n$ such that $c_n \neq 0$.
\end{defn}
We have several analyses and characterizations for singular points but we omit them.
\subsection{Theorem of residue}

\begin{defn}
 Let $a \in U$ and $R > 0$ and a function $f \colon B_0 (a, R) \to \bbC$ is holomorphic.
 The Laurent expansion of $f$ around $a$ is
 \begin{align}
  f (z)
  =
  \sum_{n= - \infty}^{\infty} a_n (z - a)^n.
 \end{align}
 Then the number $a_{-1}$ is called the \upbf{residue of $f$ at $a$} and denoted by
 \begin{align}
  a_{-1}
  =
  \res (f, a).
 \end{align}
\end{defn}
\begin{thm}[Theorem of residue]
 Assume a function $f$ is holomorphic in $U = B_0 (a, R)$ for $a \in U$ and $R > 0$.
 For any piecewise $C^1$ curves $C$ in $U$ it holds that
 \begin{align}
  \frac{1}{2 \pi i} \int_C f (z) dz
  =
  n (C, a) \res (f, a).
 \end{align}
\end{thm}
\begin{proof}
 Trivial.
\end{proof}
\subsection{Argument principle}

\begin{prop}
 Assume a function $f$ is holomorphic in $B_0 (a, R)$ for $a \in U$ and $R > 0$,
 and that $a$ is a $n$-th zero point or pole.
 Then $a \in U$ is a pole of first order for a function $g = f'/f$ and its residue at a is given by
 \begin{align}
  \res \rbk{\frac{f'}{f}, a}
  =
  \begin{cases}
   n, &\quad a \text{ is a zero point}, \\
   -n, &\quad a \text{ is a pole}.
  \end{cases}
 \end{align}
\end{prop}
\begin{proof}
We show this the case $a$ is a zero point.
Then we have an expression
\begin{align}
 f (z)
 =
 (z - a)^n f_1 (z)
\end{align}
for some holomorphic function $f_1$ with $f (a) \neq 0$.
Hence we obtain
\begin{align}
 \frac{f'(z)}{f (z)}
 =
 \frac{n}{z - a} + \frac{f_1'(z)}{f_1 (z)}
\end{align}
Since the second term in the RHS is holomorphic we obtain the result.
\end{proof}

This result is generalized to the famous Argument principle and Louche's theorem.
\begin{defn}\textup{(Riemann sphere.)}
 One point compactification space $\riemannsphere$ of the complex line $\bbC$ is called the \upbf{Riemann sphere}.
\end{defn}
\begin{defn}
 Let $U \in \riemannsphere$ a domain.
 A function $f \colon U \to \bbC$ is holomorphic without several poles is called \upbf{meromorphic} in $U$.
\end{defn}
\begin{thm}[Argument principle]
 Assume a function $f \colon U \to \bbC$ is meromorphic in $U$, the set of zero points of $f$ is $\cbk{a_1, \dots, a_n}$ with multiplicity,
 and the set of poles is $\cbk{b_1, \dots, b_p}$ with multiplicity.
 If $C$ is a homolog 0 curve in $U$ and walk through no zero points and no poles of $f$ then it holds that
 \begin{align}
  \frac{1}{2 \pi i} \int_C \frac{f'(z)}{f (z)} dz
  =
  \sum_{j=1}^n n (C, a_j) - \sum_{k=1}^p n (C, b_k).
 \end{align}
\end{thm}
\begin{proof}
 Use the theorem of residue.
\end{proof}
\begin{thm}[Louche]
 Assume a piecewise $C^1$ closed curve $C$ surround a region $U$ and that functions $f$ and $g$ are holomorphic in $U \bigcup C$.
 If $\abs{f (z) - g (z)} < \abs{f (z)}$ holds over $C$ then $f$ and $g$ have the same number of zero points in $U$ with multiplicity.
 \end{thm}
\section{Convergence theorems}

\begin{thm}[Hurwitz, \cite{LarsAhlfors1} P191]
 Assume functions $f_n \colon U \to \bbC$ are holomorphic and vanish nowhere
 and a function $f$ is defined by a uniform limit of a sequence $(f_n)$ in the wider sense.
 Then a function $f = 0$ or $f$ vanishes nowhere.
\end{thm}
\begin{proof}
 Assume $f \neq 0$.
 Zero points of $f$, if they exist, are isolated.
 For any $z \in U$ there exists a small radius $r>0$ such that $B (z, r) \subset U$ and $f (w) \neq 0$ for all $w \in B (z, r) \setminus \cbk{z}$.
 In particular $\abs{f (z)}$ attains its minimum on $C \defeq \partial B (z, r)$ and it is positive.
 Since sequences $(f_n)$ and $(f'_n)$ converge to $f$ respectively $f'$ we obtain
 \begin{align}
  \lim_{n \to \infty} \frac{1}{2 \pi i} \int_C \frac{f'_n (z)}{f_n (z)} dz
  =
  \frac{1}{2 \pi i} \int_C \frac{f' (z)}{f (z)} dz
 \end{align}
 By Argument principle the LHS of the above is $0$ for all $n$ and hence the LHS is $0$.
 Thus $f (z) \neq 0$.
 Since a point $z$ is taken arbitrarily this ends the proof.
\end{proof}

\begin{defn}
 Denote the abelian algebra of continuous functions on $U$ as
 \begin{align}
  C (U)
  \defeq
  \set{f \colon U \to \bbC}{f \text{ is continuous.}}
 \end{align}
 A set $H \subset C (U)$ is \upbf{normal family} if, for any subset $(f_n)_n \subset H$, there exists a sub-sequence $(f_{n_k})_k$
 and a (continuous) function $f$ such that $f_{n_k} \touw f$.
\end{defn}
\begin{thm}[Ascoli-Arzela]
 Let $U \subset \bbR^n$ and $H \subset C (U)$.
 A subset $H$ is a normal family if and only if the following two properties hold.
 1) $H$ is an equicontinuous family,
 2) $H$ is uniformly-bounded on any compact subset $K \subset U$.
\end{thm}
We denote an algebra of holomorphic functions on $U$ as $\calO (U)$.
\begin{thm}[Montel]
 Let $H \subset \calO (U)$ be a subset.
 Then the followings are equivalent.
 1) $H$ is a normal family.
 2) $H$ is uniformly-bounded on any compact subset $K \subset U$.
\end{thm}
\begin{thm}[Vitali. See \cite{MitsuoSugiura2} P.374]
 Let $E = {z_n}_{n \in \bbN} \subset U$, $z_n \to z \in U$, and a family $(f_n) \subset \calO (U)$ be uniformly-bounded in $U$.
 If sequences $(f_n (z))_n$ converge for all $z \in E$ then there exists a holomorphic function $f \in \calO (U)$ such that $f_n \touw f$.
\end{thm}
\section{Representation of holomorphic functions}

First we explain the setup of Mittag-Leffler's theorem.
Assume an arbitrary sequence $(a_n)_{n \in \bbN}$ satisfying
\begin{gather}
 \abs{a_0} \leq \abs{a_1} \leq \cdots \leq \abs{a_n} \leq \abs{a_{n+1}} \leq \cdots, \quad \lim_{n \to \infty} \abs{a_n} = \infty, \\
 a_n \neq a_m \quad (n \neq m),
\end{gather}
and that a sequence of polynomials $(P_n)_{n \in \bbN}$ in $(z - a_n)^{-1}$ have forms
\begin{align}
 P_n (z)
 =
 \sum_{k=1}^{m (n)} \frac{c_{n,k}}{(z - a_n)^k}.
\end{align}
Since $P_n$ is holomorphic in $\abs{z} < \abs{a_n}$ we have a Taylor expansion
\begin{align}
 P_n (z)
 =
 \sum_{k=0}^{\infty} b_{n,k} z^k, \quad \abs{z} < \abs{a_n}, \quad n \geq 1.
\end{align}
Choosing natural numbers $k (n)$ for each $n \in \bbN$ properly and set functions $(\varphi_n)_n$ as
\begin{align}
 \varphi_n (z)
 =
 \sum_{k=0}^{k (n)} b_{n, k} z^k.
\end{align}
Put $\varphi_0 = 0$.
\begin{thm}[Mittag-Leffler. Theorem 10.1 in \cite{MitsuoSugiura2}]
 We assume the above setup.
 Then the series
 \begin{align}
  g (z)
  \defeq
  \sum_{n=0}^{\infty} \rbk{P_n (z) - \varphi_n (z)}
 \end{align}
 converges uniformly in the wider sense on $\bbC \setminus \set{a_n}{n \in \bbN}$ for properly chosen $(k (n))$.
 Furthermore it satisfies the following properties.
 1) The function $g$ is meromorphic on $\bbC$.
 2) The set $A = \set{a_n}{n \in \bbN}$ is the set of poles of $g$ in $\bbC$.
 3) The principal parts of $g$ at each $a_n$ is $P_n$.
\end{thm}
\begin{proof}
Since a series $P_n$ converges in $B (0, \abs{a_n} / 2)$.
there exists a natural number $k (n)$ such that, letting $\varphi_n (z) = \sum_{k=0}^{k (n)} b_{n, k}z^k$, it follows that
\begin{align}
 \abs{P_n (z) - \varphi_n (z)}  < \frac{1}{2^n} \quad \rbk{z \in B (0, \frac{\abs{a_n}}{2})}.
\end{align}
For any $R>0$ there exists $N \in \bbN$ such that $\abs{a_n} > 2R$ for all $n > N$.
Since functions $(P_n)$ is holomorphic in $B (0,R)$ for $n > N$ it holds that
\begin{align}
 h (z)
 =
 \sum_{n = N + 1}^{\infty} \rbk{P_n (z) - \varphi_n (z)}
\end{align}
uniformly converges in $B (0, R)$ and hence the above function $h$ is holomorphic in $B (0, R)$.
Here the below function
\begin{align}
 g (z)
 =
 \sum_{n=0}^N \rbk{P_n (z) - \varphi_n (z)} + h (z)
\end{align}
is meromorphic in $B (0, R)$, poles are $\set{a_n}{0 \leq n \leq N}$,
and the principal part of the function $g$ are $P_n$ at $a_n$.

Since $R > 0$ is arbitrary the function $g$ is meromorphic in $\bbC$,
and the set of poles is $\set{a_n}{n \in \bbN}$,
and the principal part of $g$ is $P_n$ at $a_n$.
\end{proof}
\begin{rem}
 Mittag-Leffler's theorem in a several complex variables version is the famous Cousin first problem.
\end{rem}

\begin{thm}[Weierstrass. Theorem 5.5.4. in \cite{JunjiroNoguchi1}]
 Let $Z \subset U$ be a discrete set.
 Set numbers $\nu_{\zeta} \in \bbZ \setminus \cbk{0}$ for each $\zeta \in Z$.
 Then there exists a meromorphic function $f$ on $U$ such that, for each neighborhood of $\zeta$,
 the function $f$ can be represented as
 \begin{align}
  f (z)
  =
  (z - \zeta)^{\nu_{\zeta}} h (z), \quad h (\zeta) \neq 0,
 \end{align}
 by a holomorphic function $h$.
 The function $f$ is holomorphic in $U \setminus Z$ and has no zero points.
\end{thm}
\begin{rem}
 Weierstrass' theorem in a several complex variables version is the famous Cousin second problem.
\end{rem}
\section{Riemann's mapping theorem}

\begin{defn}
 Two regions $U_1$ and $U_2$ are \textup{\textbf{analytically homeomorphic}} if
 there exists an biholomorphic function $f \colon U_1 \to U_2$.
\end{defn}
\begin{thm}[Theorem 13.1 in \cite{MitsuoSugiura2}]
 The following three simply connected regions are not analytically homeomorphic each other.
 1) The Riemann sphere, $\riemannsphere$.
 2) The complex line, $\bbC$.
 3) The unit disc, $D = B (0, 1)$.
\end{thm}
\begin{proof}
Since the Riemann sphere is compact the image $f (\riemannsphere)$ by a continuous function is compact.
On the other hand $\bbC$ and $D$ is not compact and hence $f (\riemannsphere)$ is not
analytically homeomorphic to $\bbC$ of $D$.
If a homeomorphic function $f$ on $\bbC$ satisfies $f (\bbC) \subset D$ then,
since $f$ is a bounded entire function, Liouville's theorem asserts $f$ is a constant function,
i.e., $f (\bbC) \neq D$.
\end{proof}
\begin{thm}[Riemann's mapping theorem. Theorem 13.2 in \cite{MitsuoSugiura2}]
 If $U$ is a simply connected region in $\bbC$ and $U \neq \bbC$, then
 there exists a holomorphic and univalent function $f$ on $U$ such that it maps $U$ onto the unit disc $D$.
 Furthermore we set an additional condition
 \begin{align}
  f (a) = 0, \quad f'(a) > 0
 \end{align}
 for an arbitrary point $a \in U$.
 Under the above additional condition a function $f$ is unique and it is a analytically holomorphic map from $U$ to $D$.
\end{thm}
\section{Miscellaneous results}

We give examples of unexplained but important results.
\begin{enumerate}
\item Omitted proofs.
\item Theorem of mean: Corollary 2.4 in \cite{MitsuoSugiura2}.
\item Maximum principle: Theorem 3.9 in \cite{MitsuoSugiura2}).
\item Inverse mapping theorem.
\item Relations between holomorphic functions and harmonic functions.
\item Calculation of definite integrals using theorem of residue.
\item Interrelation for Fourier transform.
\item Theory of elliptic functions.
\item Theory of automorphic forms.
\item Algebraic function theory.
\item Theory of Riemann surface.
\end{enumerate}
\section{Appendix}

\subsection{Vector Analysis}

\subsection{Analytic continuation}

\chapter{Talk: Complex analysis for Ising model}

\chapter{Several complex variables}

Cousin's problems.
\part{Functional Analysis}

\chapter{Introductory study of function spaces}

I will tranlate this chapter.
\chapter{Introduction to Lebesgue integral}

\section{Why Lebesgue integral?}

\subsection{Area}

Theory of Lebesgue integral is one for integral, of course.
However integral is closely connected with a theory of area.
Consider finitely many disjoint plane sets $(A_n)$.
We denote an area of a (plane) set $A$ as $m (A)$.
Then an area of their union $\bigcup A_n$ is $\sum_n m (A_n)$.

Next consider a infinitely many disjoint plane sets $(A_n)$ and an area of their union.
In this case we may face a severe problem if we treat ``infinity" too roughly.
Suppose sets $A_y = \sqbk{0, 1} \times \cbk{y}$ for $y \in \sqbk{0, 1}$
and their union $\bigcup_{y \in \sqbk{0, 1}} A_y$.
An area $m (A_y)$ of each $A_y$ is 0 (later we will prove), but their union is $\bigcup_y A_y = \sqbk{0, 1} \times \sqbk{0, 1}$
An area is $m (\bigcup_y A_y) = 1$.
Thus it holds that
\begin{align}
 m \rbk{ \bigcup_y A_y}
 \neq
 \sum_y m (A_y).
\end{align}
Clearly uncountable operation leads contradiction.

One way to overcome this difficulty may be just ignoring of a union of infinitely many sets.
However, if we would like to define areas for general sets by fundamental sets such as rectangles,
we must consider a union of infinitely many rectangles.
It suffice to consider an area of circle.

How do we define an area for a (disjoint) union of infinitely many sets?
\subsection{Function space: approximation of functions}

In application it is important to consider approximation of functions,
e.g., application to analysis of differential equations.
Then we would like to set distances for functions since,
in computer simulation, we cannot use an exact solution but an approximated solution.
However what is the distance between functions?
\subsection{Distance by supremum norm}

We can use a distance defined by supremum norm, e.g.,
\begin{align}
 d_{\infty}(f, g)
 \defeq
 \norm{f - g}
 \defeq
 \sup_{x \in \Omega} \abs{f (x) - g (x)}.
\end{align}
This distance detects the maximum pointwise distance between functions.
This seem intuitive and natural, and is useful, in fact.

\vspace{1em}
\textbf{Distance by $L^2$ norm}

However here is another natural distance for functions, i.e., $L^2$ distance.
We are going to ``derive" this distance.
Consider vectors $f, g \in \bbC^n$.
Then we can define their inner product and distance.
\begin{align}
 \bkt{f}{g}
 &\defeq
 \sum_{x=1}^{n} \overline{f (x)} g (x), \\
 d_2 (f, g)
 &\defeq
 \norm{f - g}_2
 \defeq
 \sqrt{\bkt{f-g}{f-g}}
\end{align}
If the sum converges we can take a limit $n \to \infty$.
\begin{align}
 \bkt{f}{g}
 &\defeq
 \sum_{x=1}^{\infty} \overline{f (x)} g (x).
\end{align}
A distance $d_2$ is defined similarly.
Now we sum up values in increments of 1.
If this increments tends to 0 we obtain an integral:
\begin{align}
 \bkt{f}{g}
 &\defeq
 \int_0^{\infty} \overline{f (x)} g (x) dx.
\end{align}
Here an interval can be arbitrary.
This distance is called a $L^2$ distance.

This distance is also intuitive, natural and useful.
Furthermore this is a natural interpretation in physics, i.e., energy of function.
Consider a rope and a system of $N$ sub-ropes.
Then the energy of $N$ sub-ropes is
\begin{align}
 E
 =
 \sum_{k=1}^{N} \frac{1}{2} m v_k^2 + \sum_{k=1}^{N} k (x_{k-1} - x_{k})^2.
\end{align}
A division number $N$ is virtual, so we would like to take a limit $N \to \infty$.
\begin{align}
 E
 =
 \int_0^1 \rbk{\frac{1}{2} m \rbk{\frac{\partial u}{\partial t}}^2 + \frac{1}{2} k \rbk{\frac{\partial u}{\partial x}}^2} dx.
\end{align}
This is an (almost) $L^2$.
\subsection{Comparison of these two distances}

There are some difference in these two distances.
We want to see these ``sense of distances" are totally different.

First consider two functions $f,g \colon I = (0, N) \to \bbR$ such as
\begin{align}
 f (x)
 &=
 1, \quad
 g (x)
 =
 1 + \varepsilon,
\end{align}
where $\varepsilon > 0$.
Then we have
\begin{align}
 \norm{f - g}_{\infty}
 &=
 \varepsilon, \\
 \norm{f - g}_{2}
 &=
 \varepsilon \sqrt{N}.
\end{align}
Next consider two functions $h_n, h \colon [0, 1] \to \bbR$ such as
\begin{align}
 h_n (x)
 &=
 \begin{cases}
  n+1, \quad &x \in \left[0, \frac{1}{n^4} \right), \\
  1, \quad &x \in \sqbk{\frac{1}{n^4} 1},
 \end{cases} \\
 h (x)
 &= 1.
\end{align}
Then we obtain
\begin{align}
 \norm{h_n - h}_{\infty}
 &=
 n, \\
 \norm{h_n - h}_2
 &=
 \frac{1}{n}.
\end{align}
Hence these two distances have totally different metric structures.

There is one more problem: a sequence of functions $(h_n)$ seems to converge to $h$,
but true convergence destination is a function $h_{\infty}$ such that
\begin{align}
 h_{\infty}
 =
 \begin{cases}
  \infty, \quad &x = 0, \\
  1, \quad &\text{otherwise}.
 \end{cases}
\end{align}
Furthermore a function $h_{\infty}$ is not Riemann integrable.
Since a line has an area 0 (later we will prove) an area of the graph of $h_{\infty}$ must be finite, or 1.
Then how do we define an integral for functions which may have an infinite value?
\subsection{Limiting procedure}

In analysis our main task is to control various limits.
In ``functional" analysis we must control limits for functions.
Here limits, i.e., topologies are defined by integrals.
We must search a manageable integral theory.
We require the following points.
\begin{enumerate}
\item We can identify the above two functions $h$ and $h_{\infty}$.
\item We can manage limits and integral easily.
\item Our limit theorems are simple, easy to memorize, and analogous to the famous theorems in the theory of real numbers.
\end{enumerate}
\section{Definition and Properties of measure}

\subsection{Definition}

\begin{defn}[Finitely additive family]
 Suppose $X$ is a set and $\calF$ is a family of subsets $X$.
 Then the family $\calF$ is \upbf{finitely additive} if it satisfies the following three conditions.
 1) $\emptyset \in \calF$.
 2) A set $A^{c}$ is in $\calF$ if $A \in \calF$.
 3) $A \bigcup B \in \calF$ if $A$, $B \in \calF$.
\end{defn}
\begin{prop}
 For a finitely additive family $(X, \calF)$ it holds that
 1) $X \in \calF$,
 2) $\bigcup_{k=1}^n A_k$, $\bigcap_{k=1}^n A_k \in \calF$ if $A_k \in \calF$ for $k=1, \dots, n$.
\end{prop}
\begin{defn}[Finitely additive measure]
 Suppose $X$ is a set and $\calF$ is a finitely additive family of subsets $X$.
 Then a function $m \colon \calF \to \bbR$ is called a \upbf{finitely additive measure (on $\calF$)}
 if it satisfies the following three conditions.
 1) For any $A \in \calF$ we obtain $0 \leq m (A) \leq \infty$. In particular $m (\emptyset) = 0$.
 2) If $A$, $B \in \calF$ and $A \bigcap B = \emptyset$, then $m (A+B) = m (A) + m (B)$.
 3) $A \bigcup B \in \calF$ if $A$, $B \in \calF$.
\end{defn}
\begin{prop}
 Suppose $(X, \calF)$ is a finitely additive family and $m$ is a finitely additive measure.
 Then it follows that
 1) \upbf{(finite additivity)} if $A_1, \dots, A_n \in \calF$ and they are pairwise disjoint, then
    \begin{align}
     m \rbk{\bigcup_{j=1}^n A_j} = \sum_{j=1}^n m (A_j).
    \end{align}
 2) \upbf{(monotonicity)} if $A$, $B \in \calF$ and $A \subset B$, then $m (A) \leq m (B)$.
    In particular, if $m (B) < \infty$ then
    \begin{align}
     m (A \setminus B) = m (A) - m (B).
    \end{align}
 3) \upbf{(finite sub-additivity)} If $A_1, \dots A_n \in \calF$ then
    \begin{align}
     m \rbk{\bigcup_{j=1}^n A_j}
     =
     \sum_{j=1}^n m (A_j).
    \end{align}
\end{prop}
\begin{defn}[$\sigma$-additive family]
 Suppose $X$ is a set and $\calB$ is a family of subsets of $X$.
 The family $\calB$ is called a \upbf{completely additive (countably additive, or $\sigma$-additive) family, or $\sigma$-algebra}
 if the following three conditions hold.
 1) $\emptyset \in \calB$.
 2) A set $E^{c}$ is in $\calB$ if $E \in \calB$.
 3) $\bigcup_{n=1}^{\infty} A_n \in \calB$ if $A_n \in \calB$ for all $n$.
\end{defn}
\begin{defn}[Measure]
 Suppose $X$ is a set and $\calB$ is a $\sigma$-additive family of subsets $X$.
 Then a function $\mu \colon \calB \to \bbR$ is called a \upbf{measure (on $\calB$)}
 if it satisfies the following three conditions.
 1) \upbf{(non-negativity)} $0 \leq \mu (A) \leq \infty$, $\mu (\emptyset) = 0$.
 2) \upbf{(countable additivity)} If $A_n \in \calB$ $(n = 0, 1, 2, \dots)$ and $(A_n)$ is pairwise disjoint, then
    \begin{align}
     \mu \rbk{\bigcup_{n=1}^{\infty} A_n} = \sum_{n=1}^{\infty} m (A_n).
    \end{align}
 We call a pair $(X, \calB, \mu)$ a \upbf{measure space}.
\end{defn}
\subsection{Why countable?}

Assume a Lebesgue measure (ordinary area) $\mu$ is uncountable additive.
Suppose sets $A_y = \sqbk{0, 1} \times \cbk{y}$ for $y \in \sqbk{0, 1}$
and their union $\bigcup_{y \in \sqbk{0, 1}} A_y = \sqbk{0, 1} \times \sqbk{0, 1}$.
An area $\mu (A_y)$ of each $A_y$ is 0, but their union is $\sqbk{0, 1} \times \sqbk{0, 1}$.
An area is $\mu (\bigcup_y A_y) = 1$.
Thus it holds that
\begin{align}
 \mu \rbk{ \bigcup_y A_y}
 \neq
 \sum_y \mu (A_y).
\end{align}
Clearly uncountable operation leads contradiction.
\begin{prop}
 An area of a set $A = \sqbk{0, 1} \times \cbk{0}$ is $0$.
\end{prop}
\begin{proof}
Let $\varepsilon > 0$ and $b = \sqbk{0, 1} \times \sqbk{\varepsilon / 2, \varepsilon / 2}$.
Then $A \subset B$ and
\begin{align}
 0
 \leq
 \mu (A)
 \leq
 \mu (B)
 \leq
 \varepsilon.
\end{align}
\end{proof}
\subsection{Definition of Lebesgue measure}

\begin{defn}\upbf{(Careth\'eodory outer measure.)}
 If there is a set function $\Gamma \colon 2^X \to \bbR$ on $X$ and $\Gamma$ satisfies the following three conditions
\begin{enumerate}
\item \upbf{(non-negativity)} $0 \leq \Gamma (A) \leq \infty$, $\Gamma (\emptyset) = 0$,
\item \upbf{(monotonicity)} if $A \subset B$ then $\Gamma (A) \leq \Gamma (B)$,
\item \upbf{(sub-additivity)} $\Gamma (\bigcup_{n=1}^{\infty} A_n) \leq \sum_{n=1}^{\infty} \Gamma (A_n)$,
\end{enumerate}
then a set function $\Gamma$ is called Carath\'eodory's outer measure or, simply, outer measure.
\end{defn}
\begin{thm}[\cite{SeizoIto1} Theorem. 5.1]
 Let $\calF$ be a finitely additive family of $X$ and $m$ be a finitely additive measure on $\calF$.
 1) If we define a set function $\Gamma$ as
    \begin{align}
     \Gamma (A)
     \defeq
     \inf \sum_{n=1}^{\infty} m (E_n),
    \end{align}
    where $\inf$ is taken for all countable covering $A \subset \bigcup E_n$ $(E_n \in \calF)$,
    then $\Gamma$ is an outer measure.
 2) If $m$ is countably additive on $\calF$ then $\Gamma (E) = m (E)$ for $E \in \calF$.
\end{thm}
Let $- \infty \leq a_k < b_k \leq \infty$ and $R = \prod_{k=1}^{n} \rbk{a_k, b_k}$.
We call $R$ an open hyper-rectangle and a set defined by a finite union of (open) hyper-rectangles as hyper-rectangle mass.
Let $\calR^n$ be a family of (open) hyper-rectangles in $\bbRn$ and $\calF^n$ a family of hyper-rectangle masses.
For $R = \prod_{k=1}^{n} \rbk{a_k, b_k} \in \calR^n$ we define a (finitely) additive measure on $\calR^n$ as
\begin{align}
 m (R)
 \defeq
 \prod_{k=1}^n \rbk{b_k - a_k}.
\end{align}
Then we define the \upbf{Lebesgue outer measure} $\mu^*$ on $\calF^n$ as an outer measure from $m$.

Suppose $\Gamma$ is an outer measure on $X$.
If a set $E \subset X$ satisfies the condition
\begin{align}
 \Gamma (A)
 =
 \Gamma \rbk{A \cap E} + \Gamma \rbk{A \cap E^{c}},
 \quad \forall A \subset X,
\end{align}
then $E$ is called \upbf{$\Gamma$-measurable}.
\begin{thm}[\cite{SeizoIto1} Theorem. 6.1]
 If $\Gamma$ is an outer measure on $X$ then the family of $\Gamma$-measurable sets $\calM_{\Gamma}$ is
 a $\sigma$-algebra and $\Gamma$ is a measure on $\calM_{\Gamma}$.
\end{thm}
Consider the Lebesgue outer measure $\mu^*$.
A set belonging to $\calM_{\mu^*}$ is called a \textbf{Lebesgue measurable set}.
We denote $\mu$ for a measure $\mu^*$ on $\calM_{\mu^*}$ and call the \textbf{Lebesgue measure}.
\begin{thm}[\cite{SeizoIto1} Theorem. 6.3]
 Let $\calA_0$ be an arbitrary family of subsets of a set $X$.
 Then there is a smallest $\sigma$-algebra $\calB_0$ contains $\calA_0$.
 We denote this $\calB_0$ as $\calB (\calA_0)$.
\end{thm}
\begin{proof}
There is a $\sigma$-algebra containing $\calA_0$, e.g., the power set $2^X$.
If we consider all $\sigma$-algebra $\cbk{\calB}$ containing $\calA_0$ and
set $\calB_0 \defeq \bigcap_{\cbk{\calB}} \calB$,
then this $\calB_0$ is a $\sigma$-algebra and minimal.
\end{proof}

Let $\calO (\bbRn)$ be a set of open sets in $\bbRn$.
Then a $\sigma$-algebra $\calB^n = \calB (\calO (\bbRn))$ is called the \upbf{Borel family}
and its elements \upbf{Borel sets}.
In the following our main concern is a measure space $(\bbRn, \calB^n, \mu)$,
where $\mu$ is the Lebesgue measure.
However main arguments holds for general measure spaces.
\subsection{Null sets}

\begin{defn}
 Suppose $(X, \calB, \mu)$ is a measure space and $A \in \calB$.
 If $\mu (A) = 0$ then $A$ is called a \upbf{null set} (for $\mu$).
\end{defn}
For the Lebesgue measure $\mu$ a point $a \in \bbRn$ is a null set.
A countable set $A = \cbk{a_n}_n \in \bbRn$ is also null since
\begin{align}
 \mu (A)
 =
 \sum_{n=1}^{\infty} \mu \rbk{\cbk{a_n}}
 = 0.
\end{align}
Note that there is an uncountable Lebesgue null set in $\bbR$, e.g., the \textbf{Cantor set}.
For details see P.41 in $\cite{SeizoIto1}$.
\subsection{Almost everywhere}

Suppose $(X, \calB, \mu)$ is a measure space.
If there is a proposition P related to points in a set $E \in \calB$
and it holds on $E \setminus E_0$, where $E_0 \subset E$ is null,
then we say that the proposition P holds almost everywhere on $E$ for $\mu$.

For example, assume $X = E = \bbR$, $\mu$ is the Lebesgue measure, and $E_0 = \bbQ$.
Note that $\bbQ$ is null for $\mu$ since it is countable.
Then a function
\begin{align}
 f (x)
 =
 \begin{cases}
 1, \quad x \in \bbQ, \\
 0, \quad \text{otherwise},
 \end{cases}
\end{align}
is $0$ almost everywhere on $\bbR$ and we denote
\begin{align}
 f (x) = 0 \quad \text{a.e.}
\end{align}
\subsection{Examples of other measures or measure spaces}

\begin{ex}
 Let $\calB^n$ be the Borel $\sigma$-algebra and $\mu$ is the Lebesgue measure.
 We define a new measure $\nu$ as
 \begin{align}
  \nu (A)
  \defeq
  \int_A f (x) d \mu (x)
  =
  \int_A f (x) dx, \quad A \in \calB,
 \end{align}
 where a function $f \colon \bbRn \to \bbR_{\geq}$ is integrable.
\end{ex}
\begin{ex}
 Let $X = \bbN$, $\calB = 2^{\bbN}$, and $\mu$ be a counting measure, i.e., for $A = \cbk{n_k}_{k=1}^m$,
 \begin{align}
  \mu (A)
  \defeq
  \sum_{k=1}^m 1
  =
  \abs{A}.
 \end{align}
 Then, for a function $f \colon \bbN \to \bbC$, an integral is defined by
 \begin{align}
  \int_{\bbN} f (x) d \mu (x)
  =
  \sum_{n=1}^{\infty} f (n),
 \end{align}
 i.e., an integral is a series in this case.
 Hence a series theory must be contained in Lebesgue integration theory.
\end{ex}
\section{Properties of measure}

\begin{thm}[\cite{SeizoIto1} Theorem 6.2]
 Suppose $(X, \calB, \mu)$ is a measure space and $(A_n)_n \subset \calB$.
 If a sequence of sets $(A_n)$ is monotone increasing or monotone decreasing and $\mu (A_1) < \infty$, then
 \begin{align}
  \mu \rbk{\lim_{n \to \infty} A_n} = \lim_{n \to \infty} \mu (A_n).
 \end{align}
 In general
 1) \begin{align}
     \mu \rbk{\liminf_{n \to \infty} A_n} \leq  \liminf_{n \to \infty} \mu (A_n).
    \end{align}
 2) If $\mu \rbk{\bigcup A_n} < \infty$ then
    \begin{align}
     \limsup_{n \to \infty} \mu (A_n) \leq \mu \rbk{\limsup_{n \to \infty} A_n}.
    \end{align}
 3) If $\mu \rbk{\bigcup A_n} < \infty$ and $\lim_{n \to \infty} A_n$ exists then we obtain
    \begin{align}
     \mu \rbk{\lim_{n \to \infty} A_n} = \lim_{n \to \infty} \mu (A_n).
    \end{align}
\end{thm}
\begin{proof}
If $(A_n)$ is increasing we have $A_n = \bigcup_{k=1}^n \rbk{A_k \setminus A_{k-1}}$, where $A_0 \defeq \emptyset$.
Since $\lim A_n = \sum_{k=1}^{\infty} \rbk{A_k \setminus A_{k-1}}$ additivity shows that
\begin{align}
 \mu \rbk{\lim_{n \to \infty} A_n}
 =
 \sum_{k=1}^{\infty} \mu \rbk{A_k \setminus A_{k-1}}
 =
 \lim_{n \to \infty} \sum_{k=1}^n \mu (A_k \setminus A_{k-1})
 =
 \lim_{n \to \infty} \mu (A_n).
\end{align}
If $(A_n)$ is decreasing then a sequence $(A_1 - A_n)_n$ is increasing and $\lim_{n \to \infty} (A_1 - A_n) = A_1 - \lim_{n \to \infty}A_n$.
Hence the above and $\mu (A_1) < \infty$ shows that
\begin{align}
 \mu (A_1) - \mu \rbk{\lim_{n \to \infty} A_n}
 &=
 \mu \rbk{A_1 \setminus \lim_{n \to \infty} A_n} \\
 &=
 \lim_{n \to \infty} \mu \rbk{A_1 \setminus A_n}
 =
 \lim_{n \to \infty} \rbk{\mu (A_1) - \mu (A_n)}
 =
 \mu (A_1) - \lim_{n \to \infty} \mu (A_n).
\end{align}
For a general case set $B_n = \bigcap_{k=n}^{\infty} A_n$.
Then $(B_n)_n$ is monotone increasing and $\liminf_n{n \to \infty} B_n = \liminf_{n \to \infty} A_n$.
Hence it holds that
\begin{align}
 \mu \rbk{\liminf_{n \to \infty} A_n}
 =
 \mu \rbk{\liminf_{n \to \infty} B_n}
 \leq
 \liminf_{n \to \infty} \mu (A_n).
\end{align}
The remaining parts are derived from similar arguments.
\end{proof}
\section{Product measure and extension theorem}

\begin{defn}
 Suppose $(X, \calB_X, \mu_X)$ is a measure space.
 A measure space $X$ is \upbf{$\sigma$-finite} if there is a monotonically increasing sequence of sets $(X_k)$ belonging to $\calB_X$
 such that $\mu_X (X_k) < \infty$ $(k \in \bbN)$ and $\lim_{n \to \infty} X_n = X$.
\end{defn}
Suppose $(X, \calB_X, \mu_X)$ and $(Y, \calB_Y, \mu_Y)$ are $\sigma$-finite measure spaces.
We want to define a \textbf{product measure space} on $Z \defeq X \times Y$.

We call a set $C \in Z$ a \textbf{rectangle} if it has the form
\begin{align}
 C
 =
 A \times B, \quad A \in \calB_X, \quad B \in \calB_Y.
\end{align}
The family $\calF$ of rectangles in $C$ becomes a finitely additive family.
Then we call $\calB_Z \defeq \calB (\calF)$ a \textbf{product Borel family} or \textbf{product $\sigma$-algebra},
sometimes denoted by $\calB_Z = \calB_X \times \calB_Y$.

Next we define a measure $\mu$ on $\calB_Z$.
For a rectangle $C = A \times B$, $\mu_X (A)$, $\mu_Y (B) < \infty$ we define
\begin{align}
 \mu (C)
 \defeq
 \mu_X (A) \mu_Y (B).
\end{align}
We call $\mu$ a \textbf{product measure}.
\begin{thm}[Theorem 9.4 \cite{SeizoIto1}]
 The above $\mu$ is unique.
\end{thm}
For the proof we need the following
\begin{thm}[E. Hopf's extension theorem, Theorem 9.1 \cite{SeizoIto1}]
 Suppose $X$ is a set, $\calF$ is a finitely additive family, $\calB = \calB (\calF)$, and $m$ is a finitely additive measure on $\calF$.
 A finitely additive measure $m$ can be extended to a measure $\mu$ on $\calB$ if and only if $m$ is countably additive on $\calF$.
 If, furthermore, $X$ is $\sigma$-finite then the extension is unique.
\end{thm}
\section{Measurable functions}

Suppose $X$ is a set and $\calB$ is a $\sigma$-algebra on $X$.
Fix $E \in X$ and set a function $f \colon E \to \bbRbar$, where $\bbRbar \defeq \bbR \cup \cbk{\pm \infty}$
Define the following sets:
\begin{align}
 E \rbk{f > a}
 &\defeq
 \set{x \in E}{f (x) > a}, \\
 E \rbk{f \leq a}
 &\defeq
 \set{x \in E}{f (x) \leq a}, \\
 E \rbk{f = a}
 &\defeq
 \set{x \in E}{f (x) = a}, \\
 E \rbk{a < f \leq b}
 &\defeq
 \set{x \in E}{a < f (x) \leq b}, \quad \text{etc.}\\
\end{align}
A function $f$ on $E$ is \textbf{$\calB$-measurable} or \textbf{measurable} if
\begin{align}
 E \rbk{f > a} \in \calB \quad \forall a \in \bbR.
\end{align}
A function $f \colon E \to \bbRbar$ is called a \textbf{simple function} if,
for a finite pairwise disjoint decomposition $E = \bigsqcup_{k=1}^n E_k$, $f$ has a form
\begin{align}
 f (x)
 =
 \sum_{j=1}^n \alpha_j \chi_{E_j}(x),
\end{align}
where $\alpha_j \in \bbR$, $\alpha_j \neq \alpha_k$, and $\chi_{E}$ is a defining function of $E$.
\begin{thm}
 If a function $f \colon E \to \bbR_{\leq}$ is measurable,
 then there is a non-negative and  monotonically increasing sequence of simple functions $(f_n)$
 such that $\lim_{n \to \infty} f_n (x) = f (x)$ for all $x \in E$.
\end{thm}
\begin{proof}
Define $(f_n)$ as
\begin{align}
 f_n (x)
 =
 \begin{cases}
  \frac{k-1}{2^n}, \quad &x \in E\rbk{\frac{k-1}{2^n} \leq f < \frac{k}{2^n}} \quad (k = 1, 2, \dots, 2^n n), \\
  n, \quad &x \in E (f \geq n).
 \end{cases}
\end{align}
\end{proof}
\begin{thm}
 If $f$ and $g$ are measurable then sets $E (f > g)$, $E (f \leq g)$, and $E (f = g)$ are all measurable.
\end{thm}
\begin{proof}
The claims holds, e.g.,
\begin{align}
 E (f > g)
 =
 \bigcup_{q \in \bbQ} \rbk{E (f > q) \cup E (q > g)}
 \in
 \calB.
\end{align}
\end{proof}
\begin{thm}
 If $f$ is measurable then $\abs{f}^{\alpha}$ is also measurable for any $\alpha \in \bbR$.
 For the case $\alpha < 0$ we define $\abs{f (x)}^{\alpha} = \infty$ for the point $x$ where $f (x) = 0$.
\end{thm}
\begin{proof}
 We consider only the case $\alpha > 0$ here.
 Let $a \in \bbR$.
 If $a > 0$ then we have
 \begin{align}
  E \rbk{ \abs{f}^{\alpha} > a}
  =
  E \rbk{ \abs{f} > a^{1 / \alpha}}
  =
  E \rbk{ f > a^{1 / \alpha}} \bigcup E \rbk{ f < - a^{1 / \alpha}} \in \calB.
 \end{align}
 If $a \leq 0$ then it holds that
 \begin{align}
    E \rbk{ \abs{f}^{\alpha} > a}
    =
    E \in \calB.
 \end{align}
\end{proof}
\begin{thm}
 If $f$ and $g$ are measurable then, for any $\alpha, \beta \in \bbR$, a function $\alpha f + \beta g$ is measurable.
\end{thm}
\begin{proof}
It suffices to show the case $\alpha > 0$.
If $\beta = 0$ then, for any $a \in \bbR$,
\begin{align}
 E \rbk{\alpha f > a}
 =
 E \rbk{f > \frac{a}{\alpha}} \in \calB.
\end{align}
If $\beta \neq 0$ then ,for any $a \in \bbR$,
\begin{align}
 E \rbk{\alpha f + \beta > a}
 =
 E \rbk{f > \frac{a - \beta}{\alpha}} \in \calB.
\end{align}
Thus a function $\alpha f + \beta$ is measurable.
Hence it follows that, for $\beta \gtrless 0$
\begin{align}
 E \rbk{\alpha f + \beta g > a}
 =
 E \rbk{g \gtrless - \frac{\alpha}{\beta} f + \frac{a}{\beta}} \in \calB.
\end{align}
\end{proof}
\begin{thm}
 If $f$ and $g$ are measurable then the product $fg$ is also measurable.
\end{thm}
\begin{proof}
This is due to the fact
\begin{align}
 fg
 =
 \frac{1}{4} \rbk{(f + g)^2 - (f - g)^2}.
\end{align}
\end{proof}
\begin{thm}
 If all $f_n$ are measurable then the following functions are also measurable.
 \begin{align}
  g \defeq \sup_{n \in \bbN} f_n, \quad
  h \defeq \inf_{n \in \bbN} f_n, \quad
  \limsup_{n \to \infty} f_n, \quad
  \liminf_{n \to \infty} f_n.
 \end{align}
\end{thm}
\begin{proof}
The function $g$ is measurable since, for any $a \in \bbR$,
\begin{align}
 E (g > a)
 =
 \bigcup_{n=1}^{\infty} E (f_n > a) \in \calB.
\end{align}
The function $h$ is measurable since $h = - \sup_{n \in \bbN} (- f_n)$.
Setting $g_n = \sup{k \geq n} f_k$, $g_n$ is measurable and
$\inf_{n \in \bbN} g_n = \limsup_{n \to \infty} f_n$ is also measurable
since $g_n$ is measurable.
\end{proof}
Sum up:
\begin{thm}
 The set of measurable functions is a linear space and closed in pointwise limits.
\end{thm}
\section{Definition of Lebesgue integral and its properties}

Fix a measure space $(X, \calB, \mu)$ and $E \in \calB$.
\begin{defn}\textup{(Definition of integral for non-negative simple functions.)}
 If a simple function $f \colon E \to \bbR_{\leq}$ defined by
\begin{align}
 f
 =
 \sum_{j=0}^n \alpha_j \chi_{E_j}, \quad
 E
 =
 \bigsqcup_{j=0}^{n} E_j, \quad
 \alpha_0 = 0 < \alpha_j,
\end{align}
then we define and denote an integral of $f$ as
\begin{align}
 \int_E f (x) d\mu (x)
 \defeq
 \sum_{j=1}^n \alpha_j \mu \rbk{E_j}.
\end{align}
\end{defn}
\begin{thm}
 The above definition is well-defined.
\end{thm}
\begin{proof}
A simple function can be described by
\begin{align}
  f
  =
  \sum_{k=0}^m \beta_k \chi_{F_k}, \quad
  E
  =
  \bigsqcup_{k=0}^{m} F_k, \quad
  \beta_0 = 0 < \beta_k.
\end{align}
If there exists $j, k \geq 1$ such that $\mu (E_j \cap F_k) = \infty$ then
\begin{align}
 \sum_{j=1}^n \alpha_j \mu (E_j)
 =
 \sum_{k=1}^m \beta_k \mu (F_k)
 =
 \infty.
\end{align}
\end{proof}
\begin{lem}\textup{(Linearity of integrals.)}
\begin{enumerate}
\item If functions $f$ and $g$ are non-negative and simple then
\begin{align}
 \int_E (f+g) d \mu
 =
 \int_E f d \mu + \int_E g d \mu.
\end{align}
\item If a function $f$ is non-negative and simple and if $A \cup B \subset E$ then it holds that
\begin{align}
 \int_{A+B} f d\mu
 =
 \int_A f d \mu + \int_B f d \mu.
\end{align}
\end{enumerate}
\end{lem}
\begin{proof}
Proof for 1).
By assumption it follows that
\begin{align}
  f
  &=
  \sum_{j=0}^n \alpha_j \chi_{E_j}, \quad
  E
  =
  \bigsqcup_{j=0}^{n} E_j, \quad
  \alpha_0 = 0 < \alpha_j, \\
  g
  &=
  \sum_{k=0}^m \beta_k \chi_{F_k}, \quad
  E
  =
  \bigsqcup_{k=0}^{m} F_k, \quad
  \beta_0 = 0 < \beta_k.
\end{align}
A function $(f+g)$ is also simple and described by
\begin{align}
  f + g
  =
  \sum_{j,k} (\alpha_j + \beta_k) \chi_{E_j \cap F_k}.
\end{align}
If there exists a number $j \geq 1$ such that $\mu (E_j) = \infty$ then
the both hand sides are $\infty$ and the claim is shown.
If $\mu (E_j \cap F_K) < \infty$ for any $j,k$ then we have
\begin{align}
 \int_E (f+g) d\mu
 &=
 \sum_{j,k} \rbk{\alpha_j + \beta_k} \mu (F_j \cap G_k) \\
 &=
 \sum_{j=1}^n \alpha_j \sum_{k=0}^m \mu (F_j \cap G_k) + \sum_{k=1}^m \beta_k \sum_{j=0}^n \mu (F_j \cap G_k) \\
 &=
 \sum_{j=1}^n \alpha_j \mu (F_j) + \sum_{k=1}^m \beta_k \mu (G_k) \\
 &=
 \int_E f d\mu + \int_E g d\mu.
\end{align}

Proof for 2).
\begin{align}
 \int_{A+B} f d \mu
 &=
 \sum_{j=1}^n \alpha_j \mu \rbk{E_j \cap \rbk{A \sqcup B}} \\
 &=
 \sum_{j=1}^n \alpha_j \mu \rbk{E_j \cap A} + \sum_{j=1}^n \alpha_j \mu \rbk{E_j \cap B}
 =
 \int_A f d\mu + \int_B f d\mu.
\end{align}
\end{proof}
\begin{lem}\textup\{(Lemma 12.2 in \cite{SeizoIto1}.)\}
 Suppose functions $(f_n)$ and g are non-negative and simple, $g$ is finite, a sequence $(f_n)$ is monotonically increasing, and
 $\lim f_n (x) \geq g (x)$ for any $x \in E$ then it holds that
\begin{align}
 \lim_{n \to \infty} \int_E f_n d \mu
 \geq
 \int_E g d\mu.
\end{align}
\end{lem}
\begin{proof}
We may assume $g$ is positive on $E$.
Since $g$ can be described by
\begin{align}
 g
 =
 \sum_{j=m} \alpha_j \chi_{E_j}, \quad 0 \leq \alpha_j < \infty,
\end{align}
putting $\alpha = \min \cbk{\alpha_j}$ and $\beta = \max \cbk{\alpha_j}$ it holds that
\begin{align}
 0 < \alpha \leq g \leq \beta < \infty.
\end{align}
For $\varepsilon \in (0, \alpha)$ a function $g - \varepsilon > 0$ is simple.
If we set $F_n \defeq E (f_n > g - \varepsilon)$, then, since $(f_n)$ is monotonically increasing and $\lim_{n \to \infty} f_n \geq g$, it follows that
$(F_n)$ is monotonically increasing and
\begin{align}
 \lim_{n \to \infty} F_n = E, \quad
 \lim_{n \to \infty} \mu (F_n) = \mu (E).
\end{align}
If $\mu (E) < \infty$, since $\lim \mu (E \setminus F_n) = \mu (E) - \lim \mu (F_n) = 0$, for any $\varepsilon > 0$ there is $n_0$ such that
\begin{align}
 \mu \rbk{E \setminus F_n} < \varepsilon, \quad n \geq n_0.
\end{align}
Since it holds that
\begin{align}
 \int_E f_n d \mu
 &\geq \int_{F_n} f_n d \mu
 \geq
 \int_{F_n} (g - \varepsilon) d\mu
 =
 \int_{F_n} g d \mu - \varepsilon \mu (F_n) \\
 &\geq
 \int_E g d \mu - \int_{E \setminus F_n} g d \mu \varepsilon \mu (E) \\
 &\geq
 \int_E g d \mu - \beta \mu \rbk{E \setminus F_n} + \varepsilon \mu (E) \\
 &>
 \int_E g d \mu - \varepsilon \rbk{ \beta + \mu (E)},
\end{align}
we obtain
\begin{align}
 \lim_{n \to \infty} \int_E f_n d \mu
 \int_E g d\mu - \varepsilon \rbk{\beta + \mu (E)}.
\end{align}

For the case $\mu (E) = \infty$, we use a similar reasoning.
\end{proof}

\begin{lem}\textup\{(Lemma 12.3 in \cite{SeizoIto1}.)\}
 Suppose sequences of non-negative simple functions $(f_n)$ and $(g_n)$ are monotonically increasing in $n$
 and that $\lim_{n \to \infty} f_n = \lim_{n \to \infty} g_n$, then it follows that
\begin{align}
 \lim_{n \to \infty} \int_E f_n d \mu
 =
 \lim_{n \to \infty} \int_E g_n d \mu.
\end{align}
\end{lem}
\begin{proof}
By assumption we have
\begin{align}
 \lim_{n \to \infty} \int_E f_n d\mu
 \geq
 \int_E g_m d \mu.
\end{align}
Clearly the converge inequality holds.
\end{proof}

\begin{defn}
 There is a monotonically increasing sequence of simple functions $(f_n)$ such that $\lim_{n \to \infty} f_n = f$.
 Then  We define an integral for non-negative measurable function $f$ by
 \begin{align}
  \int_E f d \mu
  \defeq
  \lim_{n \to \infty} \int_E f_n d \mu.
 \end{align}
 This definition makes sense since the above limit does not depend on a choice of a sequence.

 For a general real-valued function $f$, we decompose $f$ as
 \begin{align}
  f_+ (x)
  \defeq
  \max \cbk{f (x), 0}, \quad
  f_- (x)
  \defeq
  \max \cbk{- f (x), 0}.
 \end{align}
 A function $f$ is \upbf{integrable} if $\int_E f_+ < \infty$ or $\int_E f_- < \infty$, and we define
 \begin{align}
  \int_E f d \mu
  \defeq
  \int_E f_+ d \mu - \int_E f_- d \mu.
 \end{align}
 If $f$ is complex-valued we decompose $f$ as $f = \Re f + i \Im f$ and define an integral
 \begin{align}
  \int_E f d\mu
  \defeq
  \int_E \Re f d \mu + i \int_E \Im f d \mu.
 \end{align}
\end{defn}
\begin{thm}[Theorem 12.1 in \cite{SeizoIto1}]
 If a function $f$ is integrable on $E$ then
 \begin{align}
  \abs{\int_E f d\mu}
  \leq
  \int_E \abs{f} d\mu.
 \end{align}
\end{thm}
\begin{thm}[Theorem 12.2 in \cite{SeizoIto1}]
 1) If $\mu (E) = 0$ then
    \begin{align}
     \int_E f d \mu = 0.
    \end{align}
 2) If $f$ is integrable on $E$ then
    \begin{align}
     \mu (E (f = \infty)) = \mu (E (f = - \infty)) = 0.
    \end{align}
\end{thm}
\begin{proof}
We show only 2).
Set $E_0 \defeq E (f = \infty)$.
Then, for $\alpha > 0$, we obtain
\begin{align}
 \int_E f_+ d \mu
 =
 \int_{E_0} f_+ d \mu + \int_{E \setminus E_0} f_+ d \mu
 \geq
 \int_{E_0} \alpha d \mu
 =
 \alpha \mu (E_0).
\end{align}
Since $\alpha$ is arbitrary $\mu (E_0) = 0$.
\end{proof}
\begin{thm}[Theorem 12.3 in \cite{SeizoIto1}]
 1) \textup{(Linearity of integral)} For integrable functions $f, g$ and any complex number $\alpha, \beta$ it holds that
    \begin{align}
     \int_E (\alpha f + \beta g) d \mu
     =
     \alpha \int_E f d\mu + \beta \int_E g d\mu.
    \end{align}
 2) If $f$ is integrable and $A \sqcup B \subset E$ then we have
    \begin{align}
     \int_{A \sqcup B} f d\mu
     =
     \int_A f d \mu + \int_B f d\mu.
    \end{align}
\end{thm}
\section{Famous theorems for exchanging orders of limits}

We fix a measure space $(X, \calB, \mu)$.
\begin{thm}[Theorem. 13.1 in \cite{SeizoIto1}]
 If functions $(f_n)$ is non-negative and $f = \sum_{n=1}^{\infty} f_n$ then
 \begin{align}
  \int_E f \dmu
  =
  \sum_{n=1}^{\infty} \int_E f_n \dmu.
 \end{align}
\end{thm}
\begin{thm}[Monotone convergence theorem, Beppo-Levi, Theorem. 13.2 in \cite{SeizoIto1}]
 If a sequence $(f_n)$ is non-negative and monotonically increasing and that $\lim_{n \to \infty} f_n = f$ it holds that
 \begin{align}
  \int_E f \dmu
  =
  \lim_{n \to \infty} \int_E f_n \dmu.
 \end{align}
\end{thm}
\begin{proof}
We may assume functions $(f_n)$ is finite on $E$.
Letting
\begin{align}
 g_1 = f_1, \quad
 g_n = f_n - f_{n-1} \quad (n \geq 2),
\end{align}
we obtain
\begin{align}
 f_n
 =
 \sum_{k=1}^n g_k, \quad
 f
 =
 \sum_{k=1}^{\infty} g_k, \quad
 g_k \geq 0.
\end{align}
Then it follows that
\begin{align}
 \int_E f \dmu
 =
 \sum_{k=1}^{\infty} \int_E g_k \dmu
 =
 \lim_{n \to \infty} \sum_{k=1}^n \int_E g_k \dmu
 =
 \lim_{n \to \infty} \int_E f_n \dmu.
\end{align}
\end{proof}
\begin{thm}[Absolute continuity, Theorem 13.4 in \cite{SeizoIto1}]
 Assume a function $f$ is integrable on $X$.
 Then, for any $\varepsilon > 0$, there is a $\delta > 0$ such that
 \begin{align}
  \mu \rbk{E} < \delta
  \Longrightarrow
  \abs{\int_E f \dmu} < \varepsilon.
 \end{align}
\end{thm}
\begin{thm}[Fatou's lemma, Theorem 13.5 in \cite{SeizoIto1}]
 If functions $(f_n)$ is non-negative then it holds that
 \begin{align}
  \int_E \liminf_{n \to \infty} f_n \dmu
  \leq
  \liminf_{n \to \infty} \int_E f_n \dmu.
 \end{align}
\end{thm}
\begin{thm}[Lebesgue's dominant convergence theorem, Theorem 13.6 in \cite{SeizoIto1}]
 If there is a function $\varphi$ on $E$ and that
 \begin{align}
  \abs{f_n} \leq \varphi \quad \rbk{n \in \bbN},
 \end{align}
 then it follows that
 \begin{align}
  \int_E \liminf_{n \to \infty} f_n \dmu
  &\leq
  \liminf_{n \to \infty} \int_E f_n \dmu, \\
  \limsup_{n \to \infty} \int_E f_n \dmu
  &\leq
  \int_E \limsup_{n \to \infty} f_n \dmu.
 \end{align}
 In particular, if there is $f = \lim_{n \to \infty} f_n$ then we have
 \begin{align}
  \lim_{n \to \infty} \int_E f_n \dmu
  =
  \int_E \lim_{n \to \infty} f_n \dmu.
 \end{align}
\end{thm}
\begin{thm}[Theorem 13.7 in \cite{SeizoIto1}]
 If a sequence of functions $(f_n)$ satisfies
 \begin{align}
  \sum_{n=1}^{\infty} \int_E \abs{f_n} \dmu
  \leq
  \infty,
 \end{align}
 then there is an a.e. finite function $\sum_{n=1}^{\infty} f_n$ such that
 \begin{align}
  \sum_{n=1}^{\infty} \int_E f_n \dmu
  =
  \int_E \sum_{n=1}^{\infty} f_n \dmu.
 \end{align}
\end{thm}
\begin{thm}[Theorem 14.2 in \cite{SeizoIto1}]
 If a function $f (x,t) = f \colon X \times \rbk{a, b} \to \bbC$ is integrable on $X$ for $x$ and differentiable for $t$
 and that there is a integrable function $\varphi$ such that $\abs{\frac{\partial f}{\partial t}} \leq \varphi$,
 then it holds that
 \begin{align}
  \frac{d}{dt} \int_X f (x, t) \dmu (x)
  =
  \int_X \frac{\partial f}{\partial t} (x, t) \dmu (x).
 \end{align}
\end{thm}
\section{Fubini's theorem}

\section{Function spaces $L^p$}

Riemann-Lebesgue.
Def of Sobolev using Fourier transform.
P83, Theorem 12.6.
P84, Theorem 12.7,
P85, Theorem 12.8.
\section{Riesz-Markov-Kakutani's theorem}

\section{Fourier Analysis}

\subsection{Hilbert space}

\subsection{Fourier series}

\subsection{Fourier transform}

\subsection{Functions of positive type: Bochner's theorem}

\section{Miscellaneous results}

\begin{enumerate}
\item Omitted proofs.
\item Examples and construction of measures. (\cite{SeizoIto1}, Section 4-6, Theorem 4.2.)
\item Details for outer measure. (\cite{SeizoIto1}, Section 5.)
\item Important (topological) properties of the Lebesgue measure. (\cite{SeizoIto1}, Section 7.)
\item Completion of a measure. (\cite{SeizoIto1}, Section 8.)
\item Borel measurability and Lebesgue measurability. (\cite{SeizoIto1}, Section 11.)
\item Radon-Nikodym's theorem. (\cite{SeizoIto1}, Section 18.)
\item Probability theory. (\cite{DavidWilliams1, TadahisaFunaki1})
\end{enumerate}
\chapter{Introduction to operator theory}

\section{Functional calculus}

\section{Normed field}

\chapter{Introduction to Hilbert Space Theory And Operator Theory}

\section{Introduction}

参考: \cite{KazuhikoAomoto1, AraiEzawa1, AraiEzawa2, AsaoArai4, HaimBrezis1, HaimBrezis2, HiaiYanagi1, KenichiKanaya1, NaokiKurasawa1, TomKoornwinder1, SeikiNishikawa1, NatsumeMoriyoshi1, NoborizakaOnishiYamamoto1, MakotoOkazaki1, KimYamamoto1, HiroshiTanaka1}.
\subsection{概要}

この間 Twitter で新入生が線型代数何ぞ的なこと言っていたのもあるので,
新入生向けに線型代数の世界を見せたい.
私が話せるのは解析学周辺しかないが, ないよりはましだろう.
Hilbert 空間と線型作用素を基本に話す.
線型代数へのモチベーションを高めることを目的に概論的な話で 4-5 回に分けて解説する.
主な参考書は \cite{HiaiYanagi1, AraiEzawa1, AraiEzawa2} とする.

やる予定の内容を書いておきたい.
基本的には抽象論をやる.
作用素論方面の話に行ってスペクトル定理まで進む.
作用素環でも大事になる.
非可換幾何への展開でまた $L^2$ など具体的な話との関係が返ってくる.
あと, $L^2$ のような話は具体的な話はもちろん大事だが, これはイントロで少し触れるだけにする.

まずイントロでする予定の話.
まず超大雑把に言って教養でやる線型代数らしい線型代数と,
微分方程式方面と関わる方面の話と, 関数解析または作用素論的な抽象論みたいな感じの話がある的な話をする.
\subsection{線型代数からの代数的展開}

加群への展開とか, Lie 群への展開とか数学として取り逃すところは色々出てくるが,
この辺は私の数学力的に手に負えないところが出てくるので色々ある, とだけ言って逃げる.
ただ表現論と Fourier と, みたいなところと量子力学とかは少し触れたい.
\subsection{標準的なコースで出てくる諸概念の重要性}

あと標準的なコースの重要性はきちんと言わないといけない.
行列式と固有値, 固有ベクトルあたりは何をネタにしよう.
物理の各所で出てくるが. 固体物理というか連成振動とかその辺か.
あと統計学での主成分分析とかそういう話か.
この辺, 具体例を仕入れる必要がある.

固有値, 固有ベクトルは量子力学とかその他物理でも色々展開があるという話はしよう.
物理の話ばかりしているのもどうかという気はするが, 応用はそれしか知らない無学な市民だった.

Google のページランクみたいな話もしよう.
確率との関係とかエルゴードとか言っておくと響く向きには響くだろう.
これ, 数値計算とも関係するかなりクールな話なので盛り込みたい.

とりあえず有限次元はこんなものか.
無限次元というか微分積分への接続として平衡点近傍の話をもってくる方がいいか.
あとは微分作用素と積分作用素の線型性は必ず触れる.
\subsection{線型代数と物理や工学への応用}

有限次元と言ったところで専門に近い所で見ても色々あるし困る.
とりあえずハバードだとか, 直接的に研究に結び付くくらいやばい, という話はしよう

あとは数値計算でも使う的な話は入れよう.
微積分との絡みで平衡点近傍の安定性とかそんな話もしよう.

脱線するが, 平衡点近傍の話, 多分力学系とかそういうところでも使う.
あまりきちんと勉強していないが, 山本義隆の解析力学にも解説あるし,
ゆきみさんいわく常微分方程式と解析力学にも解説あるらしい.

これは適当な線型化から系の性質を調べるとかいう話で, 微分積分や力学とも深い関係がある.
機械工学とかその辺でも確か出てくるはずとかそんな話をしたい.

考えてみれば, Hubbard や Google のページランクについては動画を作ったのだった.
\subsection{線型代数と量子力学}

Hilbert 空間の抽象論と作用素論的な展開と量子力学との関係的なアレはあとで詳しくやるから, 軽くこなす.
まずは有限次元の方か.
\subsection{線型代数と Hilbert 空間}

線型代数は (数学内部または少なくとも物理と物理に近い工学で) 役に立つという話はされるだろうが,
あまり具体的な話はされない (時間がない) だろうから, その辺の話から入る.
新入生向けなので, まず Hilbert 空間は何ぞというところを話す.
高校でもやった三角関数の積分が実は Hilbert 空間で意味を持つというところ,
微分積分と線型代数の交点というか親玉みたいな話としての関数解析で大事な空間という話をする.
また, 物理でそれなりに色々な数学が出てくるが, 線型代数という視点でクリアで統一的な理解ができるから大事という話をする.
微分作用素, 積分作用素の線型性とかも話す必要がある.
\subsection{微分方程式}

物理または工学上大事な数学的道具立てとして大事な微分方程式があるが,
初等的な方程式なら具体的に解ける.
「線型の微分方程式」という中で既に線型性が出ているので, そういうところで解析と線型代数の関わりみたいな話がしたい.
これを解く中で現われる直交多項式の話の「直交」も線型代数由来の話で, これが Hilbert 空間の話という感じで.
\cite{AraiEzawa1} の 1 章の演習問題にいくつか書いてあるので, 一応参考文献として挙げておこう.

今回, 個別の話をやっている余裕はなかろうが Legendre やら Bessel やら,
量子力学とか電磁気周りでの微分方程式を解くときにも出てくるという話も盛り込みたい
これは個別の関数の相手もそれはそれで大事なのだが, 理屈としては線型空間論で一括処理できるのだ,
という認識を持つことで数学的, 精神的な負担を減らすことを目的に, 必ず触れるようにしたい.

あとアレだ, モノによっては多重極展開とか応用上の意味があったりもするから,
単なる数学ではない部分もある的なアレ.
変分とか無限次元の微分とかいう話はすると楽しいかよくわからないが, ネタとして書いておこう.
\subsection{微分方程式を解くときに出てくる直交多項式}

第 1 回のイントロでは特に特殊関数周りの具体例を色々あげておきたいと思っている.
全体的な話として, まだ買っていないのだが \cite{KazuhikoAomoto1} がかなり気になっている.

とりあえず触れようと思っているのは, Legendre 多項式, Legendre 陪関数,
Hermite 多項式, Laguerre 多項式, Fourier 級数のあたりだ.
ちなみに今はじめて知ったのだが, Chebyshev 多項式は \cite{HiroshiTanaka1} によると, 計算機の中での応用があるらしい.
\subsubsection{Legendre 多項式, 球 Bessel 多項式}

Legendre や球 Bessel については \cite{NorikatsuMio1} が参考になるかと思う.
自分が知っている話, ということで物理への応用について話す予定で, 正にそういう話だ.
Laguerre は例えば \cite{KenichiKanaya1} を検討している.
上記多項式もそうだが, Hermite についても手元にある本含め, まだ資料をあさっている.

今すぐ参考文献を知りたい向きは, 基本的には偏微分方程式を解くところで使うので, その辺で探すといい.
「物理数学 Legendre 多項式」などで探せば色々出てくる.
\subsubsection{Fourier}

Fourier は熱方程式, 波動方程式, 電磁気学あたりで探すといいだろう,
数学の本ではあるが, 逆問題を通じた応用的な色彩が強い本として,
波動方程式への応用については \cite{NoborizakaOnishiYamamoto1} を,
熱方程式への応用については \cite{KimYamamoto1} を参考にすると楽しいだろう.

物理への応用に関してよい参考書は今探しているところだ.
波動の本でもいいが, 電磁気 (電磁波) からの話が個人的に気に入っているというか感覚が掴みやすかったので,
その辺で探すといい.
もちろん, 自分の専門に近いところ, 自分にとって分かりやすいところで探すのが一番いい.
いいのがあったら教えてほしい.

微分作用素の固有値展開からの Fourier という線もある.
Fourier は高校でやった三角の積分が直交関係を表す.
\subsection{変分}

多項式から話題を変えるが, 例えば変分というのがある.
変分原理として物理の各所で現われるが, 量子力学で基底エネルギーを出すのに使うこともある.
実係数の微分方程式への数学的応用ということでは \cite{HaimBrezis1} が定評がある.
もちろんかっちりとした数学の本だ.
Hilbert 空間を中心に議論されている.
最近演習問題も追加された英語版 \cite{HaimBrezis2} も出版されたので, 買うならそちらを買った方がいいかもしれない.
東大の微分方程式系の研究室での学部 4 年のセミナーでも使われることがあるようなので,
そのくらいきちんとした本だ.

また, 何度も紹介しているが, 解析力学というか幾何学での変分ということでは \cite{SeikiNishikawa1} が比較的分かりやすく, しかも面白い.
読んだことはないのだが, 物理での変分原理については \cite{MakotoOkazaki1} もある.
\subsection{作用素のスペクトル}

これまでの微分方程式の話とは大分変わるが, 作用素論につなげるので,
量子力学とスペクトルの話もしたいと思っている.
これについては \cite{HiaiYanagi1} はもちろんのこと, 数理物理としては新井先生の本 \cite{AraiEzawa1, AsaoArai4}がいい.

量子力学での変分に関する数学的に精密な話も書いてある.
他には, 作用素の関数やユニタリ表現に関する話も大事だ.
作用素の関数については先日ワヘイヘイオフで詳しい話を聞かせろ, という要望を受けたので,
別途早めにまとめようと思っている.
\subsection{Taylor 展開と作用素論}

また, Taylor 展開と作用素論ということで $e^{ipx}$ の話もしよう.
簡単に説明しておくとこんな感じ.
$f (x)$ を原点周りで Taylor 展開するとこうなる:
\begin{align}
 f (x)
 =
 \sum_{n=0}^{\infty} \left ( \frac{d}{dx} \right)^n f (0).
\end{align}
どうでもいいが, 量子力学っぽく $p = -i d/dx$ と書こう:
\begin{align}
 f (x)
 =
 \sum_{n=0}^{\infty} \frac{1}{n!} \left ( i p \right)^n f (0).
\end{align}
ここで指数関数の Taylor 展開は
\begin{align}
 e^x
 =
 \sum_{n=0}^{\infty} \frac{1}{n!} x^n
\end{align}
となる.
ここで Taylor 展開の $\sum_{n=0}^{\infty} \frac{1}{n!} \left ( i p \right)^n$ は
$x$ に $ip$ を代入したものと同じ形をしていることに注意して次のように書き換えてみる.
\begin{align}
 f (x)
 =
 \left ( e^{ipx}f \right) (0).
\end{align}
指数関数に微分作用素を叩き込むという荒技を披露したが, 作用素論を使ってこれが正当化できます, みたいなことも言いたい.
また, 作用素の指数関数 $e^{ipx}$ は Taylor 展開で定義してしまうと解析関数に対してしか定義できないが,
$x$ だけずらす作用素と思えば一般の関数に対して定義できる.
ここでユニタリ作用素とかそういう話になる.
あと $x$ だけずらす作用素 $e^{ipx}$ の無限小生成子としての運動量という所から,
解析力学と量子力学の関係がどうの, みたいな話もちょろっと触れたい.

以上大体イントロで話す予定のこと.
\subsection{2 回目の概論}

2 回目から実際にもう少し踏み込んだ話をしていく.
まずは Hilbert 空間自体の話をする.
\cite{HY} には Banach 空間の話もあるが, 時間的に多分カットだろう.
演習問題になっている定理にも少し触れたい.
完備性の話などもあるので, 証明もポイントをおさえて触れていきたい.
\subsection{3-4 回目の概論}

引き続き 2, 3 章を力づくでやっていく.
非有界作用素はゴツ過ぎて触れられないが, スペクトル定理は紹介する.
スペクトル定理は無限次元版の対角化だ.
スペクトル測度や解析関数カルキュラスとか出てきてやばいのだが,
むしろ色々な数学との関係を話す機会として採り上げたい.
Stone の定理と量子力学の話とかも一応入れる予定.
\subsection{参考文献の紹介}

参考文献をまとめておこう.
\cite{HiaiYanagi1, AraiEzawa1} の他, 1 つの展開としての作用素環方面, 特に (非可換) 幾何方面ということで,
数学会で PDF が公開されている \cite{NatsumeMoriyoshi1} も紹介しておく.
触れる予定はないが, 微分方程式関係と共に関数解析をやろうという感じの本も紹介だけはしておこう.
\cite{NoborizakaOnishiYamamoto1, KimYamamoto1, HaimBrezis1, HaimBrezis2} だ.
\cite{HaimBrezis2} は \cite{HaimBrezis1} のあと, 演習問題を追加して増補されたバージョンだ.
英語に慣れることも含め, こちらを読んだ方が楽しいだろう.
こういう具体的な方から学ぶのが好きな人は頑張ってアタックしてみてほしい.
また, こちらに興味があるという人は声をかけてほしい.
トークしろと言われると困る部分はあるが, 一緒に勉強しようというなら時間さえ合えば付き合いたい.
そしてプロデュースしたい.
\chapter{Introduction to fixed point theorem and its simple application}

\section{Introduction}

学部四年のセミナーで話した内容の一部です\footnote{From a yukimi's page, \url{http://yukimigo.com/math/}.
The original version is reprinted with the written consent of the author.}.
参考文献は\cite{HisayaMasuda1, HisayaMasuda2, ShizuoMiyajima2}.


\section{Contents}

\begin{defn}
 $f$ を集合 $\Omega$ から $\Omega$ への写像とする.
 $f (x)=x$ をみたす $x \in \Omega$ を $f$ の \textbf{不動点} という.
\end{defn}

たとえば
\begin{equation}
 x (t)
 =
 t + \frac{1}{2} \sin x (t) \quad (-1 \le t \le 1)
\end{equation}
をみたす $[-1, 1]$ 上の連続関数  $x (t)$  が存在するか, という問題は
\begin{equation}
 f (x) (t)
 =
 t + \frac{1}{2} \sin x (t) \quad  (-1 \le t \le 1)
\end{equation}
なる $f$ が不動点をもつか, という問題に帰着される.
そのためにもっとも簡単なのは $f$ が縮小写像の場合である.
\section{Banach's fixed point theorem}

\begin{thm}[Banach の不動点定理]
 $(X, d)$ を完備距離空間とする.
 $f \colon X \to X$ が縮小写像, つまりある $0 < k <1$ で
 \begin{equation}
  d (f (x), f (y))
  \le
  kd (x, y) \quad  (x, y \in X)
 \end{equation}
 となるとき, $f$ は $X$ にただ 1 つの不動点をもつ.
\end{thm}
\begin{proof}
仮定から
\begin{equation}
 d (f^n (x), f^n (y))
 \le
 kd \rbk{f^{n-1}(x), f^{n-1}(y)}
 \le
 \cdots
 \le
 k^nd (x, y)
\end{equation}
である.
$n, p \ge 0$ として三角不等式を使うと
\begin{align}\label{functional_analysis_fixed_point_theorem_and_its_simple_application_yukimi2}
 d (f^n (y), f^{n+p}(y))
 &\le d (f^n (y), f^{n+1}(y)) + \cdots
  +d (f^{n+p-1}(y), f^{n+p}(y))  \\
 &\le
 \rbk{k^n + \cdots + k^{n+p-1}} d (y, f (y))
\end{align}
$\sum_{n=1}^{\infty} k^n = \frac{k}{1-k} < \infty$ に注意すると,
$n, p \to \infty$ で (\ref{functional_analysis_fixed_point_theorem_and_its_simple_application_yukimi2}) の右辺が $0$ に収束するから,
$\cbk{f^n (y)}$ は Cauchy 列である.
$X$ が完備なのである $x \in X$ で $f^n (y) \to x$ となる.
\begin{align}
 d(x, f (x))
 &\le
 d (x, f^{n+1}(y)) + d (f^{n+1}(y), f (x))  \\
 &\le
 d (x, f^{n+1}(y)) + kd (f^n (y), x) \to 0 \quad \rbk{n \to \infty}
\end{align}
したがって $f (x) = x$ がわかる.
一意性も三角不等式と $f^n (x) = x$ で示せる.
\end{proof}

上の問題の場合, 完備距離空間として $[-1, 1]$ 上の連続関数の全体
$C ([-1, 1])$ をとれば, 任意の $x, y \in X$ について
\begin{align}
 f(y) (t) - f(x) (t)
 &=
 \frac{1}{2} \int_0^1 \frac{d}{ds} \sin \rbk{x (t) + s \rbk{y (t) - x (t)}} ds \\
 &=
 \frac{1}{2} \int_0^1 \cos \rbk{x (t) + s \rbk{y (t) - x (t)}} ds \rbk{y (t) - x (t)}
\end{align}
だから max をとれば $k = 1/2$ で $f$ が縮小写像となることがわかる.
\section{Brouwer' fixed point theorem}

$[-1, 1]$ から自分自身への連続関数は一般に縮小写像でないが, 中間値の定理から不動点をもつことはわかる.
実際, $g (x) \defeq x - f (x)$ とすると $g (-1) \le 0$,
$g (1) \ge 0$ だからどちらかが等号成立のときは対応する点が不動点となり,
$g (-1) < 0$,  $g (1) > 0$ ならば $g (x_0) = 0$ となる $x_0$ が区間 $(-1, 1)$ に存在するから, その点が不動点となる.
このことを有限次元空間に一般化したのが Brouwer の不動点定理である.
\begin{thm}[Brouwer の不動点定理]
 $\Omega$ を $\mathbb{R}^n$ の有界凸閉集合とする.
 $f \colon \Omega \to \Omega$ が連続写像であれば $f$ は $\Omega$ に不動点をもつ.
\end{thm}
これから代数学の基本定理などが証明される.
初等的な証明と写像度を使う証明があるが, どちらにしろたいへん.
\cite{HisayaMasuda2} 参照.
\section{Schauder's fixed point theorem}

Brouwer の不動点定理は一般に無限次元空間では成立しないが,
無限次元空間における不動点定理として Schauder の不動点定理がある.
\begin{lem}
 $X$ をノルム空間, $\Omega$ を $X$ の空でない凸集合,
 $K$ を $\Omega$ のコンパクト集合とする.
 このとき任意の $\varepsilon > 0$ に対して $K$ の元 $x_1, \dots , x_m$ を適当に選べば
 \begin{equation}
  \norm{Px - x}
  <
  \varepsilon \quad \rbk{x \in K}
 \end{equation}
 となる, $K$ から $\co K \defeq \co \rbk{x_1, \dots , x_m}$ への連続写像 $P$ がある.
 ここで $\co \rbk{x_1, \dots , x_m}$ は
 $x_1, \dots , x_m$ をふくむ最小の凸集合 (凸包) である.
 この $P$ を\textbf{Schauder 射影作用素}という.
\end{lem}
\begin{proof}
$K$ は全有界だからある $K$ の元 $x_1, \dots , x_m$ で
\begin{equation}\label{functional_analysis_fixed_point_theorem_and_its_simple_application_yukimi3}
 K
 \subset
 \bigcup_{j=1}^m B \rbk{x_j, \frac{\varepsilon}{2}}
\end{equation}
とできる.
ここで $B (x_j, \varepsilon / 2)$ は中心 $x_j$, 半径 $\varepsilon$ の開球.
さらに
\begin{equation}
 \mu_j(x)
 \defeq
 \max \cbk{1 - \frac{2}{\varepsilon} \norm{x - x_j}, 0}, \quad
 \mu (x)
 \defeq
 \sum_{j=1}^m \mu_j (x)
\end{equation}
とすると, 各 $x \in K$ に対して $\mu_j (x) > 0$ を満たす $j$ がひとつはある.
実際, そうでないとすると $\varepsilon / 2 \le \norm{x - x_j}$ となり,
(\ref{functional_analysis_fixed_point_theorem_and_its_simple_application_yukimi3}) に反する.
したがって $\mu (x) > 0$ である.
ノルムの連続性から $\mu_j (x)$ は $x$ について連続で,
$\lambda_j (x) \defeq \mu_j (x) / {\mu (x)}$ も $K$ 上連続である.
\begin{align}
 \co K
 =
 \set{\sum_{j=1}^m \lambda_j x_j}{\lambda_j \ge 0, \sum_{j=1}^m \lambda_j = 1}
\end{align}
だから,
\begin{equation}
 Px
 \defeq
 \sum_{j=1}^m \lambda_j (x) x_j \quad (x \in K)
\end{equation}
と定めると, $P$ は $K$ から $\co K$ への連続写像である.
\begin{equation}
 \norm{Px - x}
 \le
 \sum_{j=1}^m \lambda_j (x) \norm{x_j - x}
\end{equation}
だが,  $\norm{x_j - x} \ge \varepsilon / 2$ なら $\mu_j (x) = 0$ だから $\norm{x - x_j} < \varepsilon / 2$ についての和だけ考えればよく,
\begin{equation}
 \norm{Px - x}
 <
 \frac{\varepsilon}{2} \sum_{j=1}^m \lambda_j (x)
 =
 \frac{\varepsilon} {2}
 < \varepsilon
\end{equation}
である.
\end{proof}
\begin{thm}[Schauder の不動点定理]
 $X$ をノルム空間, $\Omega$ を空でない $X$ の凸集合とする.
 ある $\Omega$ のコンパクト集合 $K$ があって,  $f \colon \Omega \to K$ が連続写像ならば $f$ は $\Omega$ の中に不動点をもつ.
\end{thm}
\begin{proof}
$\Omega$ は凸集合で $K \subset \Omega$ と $\co K$ が $x_1, \dots , x_m$
をふくむ最小の凸集合であることから $\co K \subset \Omega$ である.
$\bbRn$ の有界凸閉集合
\begin{align}
 S
 \defeq
 \set{\sigma = (\sigma_1, \dots , \sigma_m) \in \bbRn}{\sum_{j=1}^m \sigma_j = 1, \sigma_j \ge 0}
\end{align}
から $\co K$ への連続写像を
\begin{equation}
 J \sigma
 \defeq
 \sum_{j=1}^m \sigma_j x_j
\end{equation}
で定めると, 補題の $\lambda_i$ で
\begin{equation}
 g (\sigma)
 \defeq
 \rbk{\lambda_1 (f (J\sigma)), \dots , \lambda_m (f (J\sigma))}
\end{equation}
は $\lambda_i$, $f$,  $J$ のすべてが連続だから $S$ から $S$ への連続写像となる.
したがって Brouwer の不動点定理から $g$ は不動点 $\sigma^\varepsilon$ を $S$ の中にもつ.
つまり,
\begin{equation}
 \lambda_j (f (J\sigma^\varepsilon))
 =
 \sigma_j^\varepsilon
\end{equation}
で, これは $\sigma^\varepsilon$ の $j$ 成分だ.
ここから
\begin{equation}
 P (f (J\sigma^{\varepsilon}))
 =
 \sum_{j=1}^m \lambda_j (f (J\sigma^{\varepsilon})) x_j
 =
 \sum_{j=1}^m \sigma_j^{\varepsilon} x_j
 =
 J\sigma^{\varepsilon}
\end{equation}
だから, $x_\varepsilon \defeq J \sigma^\varepsilon$ は $P(f(x))$ の不動点である.
さらに, $x_\varepsilon \in \co K \subset \Omega$ なので定理の仮定から
$f (x_\varepsilon) \in K$ である.
よって補題の $\norm{Px - x} < \varepsilon$ から
\begin{equation}
 \norm{x_{\varepsilon} - f (x_{\varepsilon})}
 =
 \norm{P (f (x_\varepsilon)) - f (x_\varepsilon)}
 <
 \varepsilon.
\end{equation}
$K$ はコンパクトだから $\{f (x_\varepsilon)\}$ から $\varepsilon \to 0$ のとき収束する部分列
$\cbk{f (x_{\varepsilon'})}$ がとれる.
$f (x_{\varepsilon'}) \to x_0$ とすれば, $K$ は閉だから $x_0 \in K$ であり,
\begin{align}
 \norm{x_{\varepsilon'} - x_0}
 &\le
 \norm{x_{\varepsilon'} - f (x_{\varepsilon'})}
  +\norm{f (x_{\varepsilon'}) - x_0}   \\
 &\le
 \varepsilon' + \norm{f(x_{\varepsilon'}) - x_0}
 \to 0, \quad \varepsilon' \to 0
\end{align}
となり $x_{\varepsilon'} \to x_0$ である.
$f$ は連続だから $f (x_{\varepsilon'}) \to f (x_0)$ である.
もともと $f (x_{\varepsilon'}) \to x_0$ だったから $f (x_0) = x_0$ であり, $x_0$ は $f$ の不動点である.
\end{proof}
\section{Application of Schauder's fixed point theorem}

Schauder の不動点定理を微分方程式に応用しよう.
\begin{thm}[Peano の存在定理]
常微分方程式の初期値問題
\begin{equation}
 \frac{dy}{dt}
 =
 g (y, t), \quad y(t_0) =y_0
\end{equation}
は $g$ が
\begin{align}
 D
 \defeq
 \set{(y, t)}{t_0 \le t \le t_0 + a, |y - y_0| \le b}
\end{align}
で連続のとき $I \defeq [t_0, t_0 + a']$ に解をもつ.
ここで
\begin{equation}
 M = \max_{(y, t) \in D} |y (t)|, \quad a' = \min \rbk{a, \frac{b}{M}}
\end{equation}
である.
\end{thm}
\begin{proof}
$I$ で定義された $\bbRn$ への連続写像の全体 $C (I, \mathbb{R}^n)$ は max ノルムで Banach 空間 $X$ になる.
\begin{equation}
 B
 \defeq
 B (y_0, b)
 =
 \set{y \in X}{\norm{y - y_0} \le b }
\end{equation}
は閉球だから明らかに $X$ の凸閉集合である.
$B$ 上の写像 $f$ を
\begin{equation}
 f(y) (t)
 \defeq
 y_0 + \int_{t_0}^t g (y (s), s) ds
\end{equation}
と定めると, $y \in B$ から $f$ は $I$ 上の連続関数として意味をもち,
\begin{align}
 \norm{f (y) - y_0}
 &\le
 \int_{t_0}^t \norm{g (y (s), s)} ds \\
 &\le
 M (t - t_0)
 \le
 Ma'
 \le
 M\frac{b}{M}
 =
 b
\end{align}
だから $f (y) \in B$ である.
さらに,
\begin{align}
 \norm{f (y)}
 &\le
 \norm{y_0} + \rbk{\int_{t_0}^t g (y (s),s) ds} \\
 &=
 \norm{y_0} + \norm{f (y) - y_0}
 \le
 \norm{y_0} + b
\end{align}
だから一様有界である.
また,
\begin{equation}
 \abs{f (y) (t) - f (y) (t')}
 \le
 \int_{t'}^t \abs{g (y (s), s)} ds
 \le
 M \abs{t - t'}
\end{equation}
だから $f$ は同程度連続である.
したがって, Ascoli-Arzel\`a の定理から $f (B)$ は相対コンパクトである.
Schauder の不動点定理の $K$ として $f (B)$ の閉包を取れて $f$ は $B$ の中に不動点 $y$ をもつ.
問題の常微分方程式は
\begin{equation}
 y (t)
 =
 y_0 + \int_{t_0}^t g (y (s), s) ds
\end{equation}
と同等だから, $y$ はその解でもある.
\end{proof}
\chapter{Introduction to Sobolev embedding theorems}

I will translate this.
\chapter{Introduction to Schr\"odinger equation}

I will translate.
\chapter{Functional Analysis}

I will translate this chapter from the Japanese version.
\chapter{Fourier Analysis}

動画から適当に切り出してくる.
\chapter{Principle of superposition and Fourier analysis}

\chapter{Talk: Inverse analysis for heat equation--mathematics, physics, engineering\label{inverse-problem-in-partial-diferrential-equations-for-diffusion-equation-for-tsudoi1}}

これは 2013-09-21 第 4 回関西すうがく徒のつどいでの講演,
【偏微分方程式の逆問題--拡散方程式の数学と物理と工学】で話した内容の原稿にあたる.
そのうち \cite{phasetr1} のように DVD 化もしたい.
\section{apply}

件名:第 4 回関西つどい講演希望
関西すうがく徒のつどい 事務局の方

第 4 回の関西つどいでの講演希望を提出します.

(第一希望)
\begin{enumerate}
\item twitter アカウント名 [*]: phasetr
\item 講演者のお名前 [*]: 市民 (相転移 P)
\item 講演者のメールアドレス: phasetr@gmail.com
\item 希望する発表形式 [*]: 60 分講演
\item 大分野 [*]: 応用数学
\item 小分野 [*]: 偏微分方程式, 逆問題, 産業数学
\item 講演タイトル [*]: 偏微分方程式の逆問題--拡散方程式の数学と物理と工学
\item 講演内容概要 [*]: 大雑把に言って入力から出力を求める問題を順問題といい,
出力から入力を推定する問題を逆問題という.
原発事故が起きて放射性物質が漏れ出したという場合を考えると, 2 号炉で事故が起きたときに
放射性物質がどう拡散していくかを考えるのが順問題で,
放射性物質の拡散具合からどの炉で事故が起きたかを推測するのが逆問題と思っていい.
レントゲンや非破壊検査も逆問題であり,
逆問題はとても身近な問題だが, とくに数学科で触れられることは少ないだろう.
講演ではこのような逆問題について初等的な話をしたい.
数学として突っ込んだ話よりも, 数学を使う上で何が難しいかといった話や
物理・工学的に考えてどうかという部分を考えたい.
例えばシミュレーションに関わる問題として, 解の存在や一意性, 安定性が現実的に決定的に大事になる.
またシミュレーションする上でまともな時間内で計算結果を出すことをも大事であって,
プログラミングや計算効率・収束速度についても真剣に検討する必要だ.
また拡散方程式自体, 本当に現象をきちんと表現しきれているのか, という問題もある.
こうした問題を議論する.
\item 講演の対象 [*]: 学部 2-3 年程度を対象にする.
予備知識としては拡散方程式と空間領域 $\mathbb{R}^1$ のときの基本解 (熱核) を知っていること,
拡散現象に関する (おそらく) 常識的な感覚を前提にする.
詳しいことを知っている必要は全くないが,
物理的な問題を考えるときに特殊相対論 (光速度一定の法則) なども出てくる.
\item 講演にプロジェクターを使用するか否か: 使わない.
\item その他, 要望など (もしあればお書きください): なし.
\end{enumerate}

(第二希望)
\begin{enumerate}
\item twitter アカウント名 [*]: phasetr
\item 講演者のお名前 [*]: 市民 (相転移 P)
\item 講演者のメールアドレス: phasetr@gmail.com
\item 希望する発表形式 [*]: 60 分講演
\item 大分野 [*]: 応用数学
\item 小分野 [*]: 線型代数, 確率論
\item 講演タイトル [*]: Google ページランクの数理
\item 講演内容概要 [*]: Google の検索ではその精度を上げるために 100 を越える要素を考えていることが知られている.
このうち, Google 自身が「ネット上の民主主義」として特に強調しているページランクについて議論する.
インターネット上の Web ページをノードと思い,
ネットワークをグラフとして抽象化して, 線型代数の問題に叩き落とす.
検索結果の即時性・計算機資源の有限性など現実的な制約も多いが,
数値計算に関する理論的なバックアップまで含め, 知識としては教養レベルで解決できる.
何から何まで教養レベルで簡単に解決すると思われても困るが,
線型代数が支配する領域の広さと高い攻撃力を実感してほしい.
最後に純数学的な問題として, 確率論から見ると離散時間の Markov 連鎖とエルゴード問題に関係していること,
理論物理では Hubbard モデルの強磁性相転移に関係していることを簡単に紹介したい.
\item 講演の対象 [*]: 対象は限定しない.
純粋な予備知識としては教養の線型代数で十分.
力量としてはその辺の数学科の学生を素手で粉砕できるレベルで線型代数が使えれば問題ない.
\item 講演にプロジェクターを使用するか否か: 使わない.
\item その他, 要望など (もしあればお書きください): なし.
\end{enumerate}
\section{abstract}

\subsection{概要}

大雑把に言って入力から出力を求める問題を順問題といい,
出力から入力を推定する問題を逆問題という.
つどいで物理・工学系の話題が少ないので, 自分の専門ではないが反応を取る目的も兼ね,
この方面に関して入門的な話をしたい.
今回は不幸なことに身近な問題になってしまった放射性物質の拡散問題を題材にする.
現実に即し過ぎるとあまりに難しいので, 状況は適当に扱いやすく変える.

順問題と逆問題という問題の設定法がある.
原発事故が起きて放射性物質が漏れ出したという場合を考えると,
例えば 2 号炉で事故が起きたときに放射性物質がどう拡散していくかという問題設定をするのが順問題で,
放射性物質の拡散具合からどの炉で事故が起きたかを推測するのが逆問題と思っていい.
レントゲンや非破壊検査も逆問題であり, 逆問題はとても身近な問題だが,
とくに数学科で触れられることは少ないだろう.
講演ではこのような逆問題について初等的な話をしたい.

数学として突っ込んだ話よりも, 数学を使う上で何が難しいかといった話や
物理・工学的に考えてどうかという部分を中心にする.
例えばシミュレーションに関わる問題として, 解の存在や一意性, 安定性が現実的に決定的に大事になる.
またシミュレーションする上でまともな時間内で計算結果を出すことをも大事であって,
プログラミングや計算効率・収束速度についても真剣に検討する必要がある.
また拡散方程式自体, 本当に現象をきちんと表現しきれているのか, という問題もある.
応用数学が死ぬ程つらいことを実感してもらえるよう,
こうした問題の中から適宜話題をピックアップして概観する.
\subsection{予定内容}

順番や内容の詳細は変わる可能性がある.
\begin{enumerate}
\item 工学的要求: 解の安定性など
\item $\mathbb{R}^1$ 上の拡散方程式の基本解の物理
\item 拡散の逆問題の物理的難しさ
\item 解の存在と正則性: 工学的現実と数学的困難
\item 数値計算との関係
\end{enumerate}
\subsection{講演の対象}

学部 2-3 年程度を対象にする.
予備知識としては拡散方程式と空間領域 $\mathbb{R}^1$ のときの基本解 (熱核) を知っていること,
拡散現象に関する常識的な感覚を前提にする.
詳しいことを知っている必要は全くないが,
物理的な問題を考えるときに特殊相対論 (光速度一定の法則) なども話題にする予定.
\subsection{予備知識}

数学的な詳細については \cite{Kotorin1, KimYamamoto1, NoborizakaOnishiYamamoto1} が参考になる.
\section{講演概要}

数学として突っ込んだ話よりも, 物理や工学で数学を使っていく上で何が難しいかといった話や,
物理・工学的に考えてどうかという部分を中心にする.
例えばシミュレーションに関わる問題として, 解の存在や一意性, 安定性が現実的に決定的に大事になる.
またシミュレーションする上でまともな時間内で計算結果を出すことをも大事であって,
プログラミングや計算効率・収束速度についても真剣に検討する必要がある.
また拡散方程式自体, 本当に現象をきちんと表現しきれているのか, という問題もある.
応用数学が死ぬ程つらいことを実感してもらえるよう,
こうした問題の中から適宜話題をピックアップして概観する.

話そうと思った内容は次の通り.
実際には下 2 つまではいかない: これが一番数学的な内容が強いのだが.
\begin{enumerate}
\item 目的.
\item 導入: 順問題と逆問題, 逆問題とは何か.
\item 具体的な問題の説明: 原発事故と放射性物質の拡散.
\item 拡散の逆問題の物理的難しさ.
\item 工学的要求: 解の安定性など.
\item モデルの正当性.
\item 解の存在と正則性: 工学的現実と数学的困難.
\item 数値計算との関係.
\end{enumerate}
\section{目的}

つどいで物理・工学系の話題が少ないため, どういうリアクションが返ってくるかまで含めて試験的にやってみたい.
物理の学部生が当たり前と思っているくらいのことで, どこまでが本当に当たり前として通じるかというところを知りたい.
少なくとも超弦関係では物理と数学の交流が活発になっているので,
そうした業界に足を踏み込もうという数学の人にとっては物理の人間の感覚を把握しておくと, 交流しやすくなるだろう.
必ずしも伝統的な数学の意識下にない話題でもあり, そうした数学に馴染めない人がこうした境界分野に活路を見出せるかもしれない.
また, つどいに来る人の中で数は少ないだろうが, 物理や工学など非数学の人が数学の人と交流するとき,
自分の常識について自覚的に話せるようになれば交流がスムーズにいくようになるだろう, ということもある.
\section{導入: 順問題と逆問題, 逆問題とは何か}

大雑把に言って入力から出力を求める問題を順問題といい,
出力から入力を推定する問題を逆問題という.
原因から結果を求めるのが順問題, 結果から原因を探るのが逆問題と言ってもいい.
原発事故が起きて放射性物質が漏れ出したという場合を考えると,
例えば 2 号炉で事故が起きたときに放射性物質がどう拡散していくかという問題設定をするのが順問題で,
放射性物質の拡散具合からどの炉で事故が起きたかを推測するのが逆問題と思っていい.

もう少し身近なところで言うと, 話をしていて相手の表情から地雷を踏んだことを知るのが逆問題と言っていい.
相手に言葉を投げたとき, 相手が嫌な顔をしたとする.
嫌な顔という結果から, 相手が不快な思いをしているという原因を突き止めた, という感じ.

物理的・工学的応用についていくつか具体的に見てみよう.
\subsection{順問題の例}

\begin{enumerate}
\item 初期条件を設定しておいて, その後どうなるかを考える問題.
\item 試験 (大学受験) で出てくる問題.
\end{enumerate}
\subsection{逆問題の例}

\begin{enumerate}
\item 有機化学の構造決定.
\item 化学コンビナートでの汚染源特定.
\item 現在の地表面の温度から太古の地球の温度を推定する. (熱的考古学. )
\item 死体の血液温度からの死亡時刻の推定. (熱伝導方程式, つまり拡散方程式で処理する. )
\item レントゲン.
\item 非破壊検査: X 線の回折像からその回折をうんだ内部構造を推定.
\item 地震での震源の決定: 放射線事故と合わせて適宜扱う.
\end{enumerate}
\section{具体的な問題の説明: 原発事故と放射性物質の拡散}

原発事故が起きて放射性物質が漏れ出したという場合を考える.
例えば 2 号炉で爆発事故が起きたときに放射性物質がどう拡散していくかという問題設定をするのが順問題.
一方, 放射性物質の拡散具合からどの炉で事故が起きたかを推測するのが逆問題と思っていい.

絵も描く.

拡散の問題は拡散方程式で記述できるということにされている.
ここでは偏微分方程式, 特に拡散方程式の解析という形で話を進めていく.
拡散方程式というのは次の偏微分方程式のこと.
\begin{align}
 \frac{\partial u}{\partial t}
 =
 \triangle u, \quad
 \triangle
 =
 \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2} + \frac{\partial^2}{\partial z^2}.
\end{align}
身近な現象となってしまった放射性物質の拡散だが,
そうかといって直観的に感じられる人もあまりいないだろう.
拡散方程式の振る舞いと調べるという意味では,
身近な拡散現象を考えればある程度類推ができるようになる.
これが物理や工学の問題を数学に落としこむご利益の 1 つでもある:
同じまたは似た方程式で記述されるならそこから類推がきき,
1 つの方程式を調べるだけで色々なことが一気に分かるようになる.
身近な現象として例えばコーヒーにミルクを静かに垂らした後の拡散を想定しよう.
水槽に汲んだ水の中にインクを垂らしたと思ってもいい.

話を分かりやすくするためにこれからも適宜具体例を出していくが,
それに合わせて方程式もいくつか使い分ける.
なるべく混乱が起きないように努力はする.
\section{拡散の逆問題の物理的難しさ}

先程書いた通り, イメージしやすくするためここではコーヒーにミルクを静かに垂らした後の拡散について考えたい.
水槽に汲んだ水の中にインクを垂らしたと思ってもいい.

この場合, どの炉が放射性漏れを起こしたか特定する問題は,
次のように言い換えられる: 「コーヒーにミルクを垂らしたあと, 1 時間放置した.
この 1 時間後の状況だけを見てどこにミルクを垂らしたかが推定できるか」.

ここで絵を描く.

家に帰ったら実際に実験してみてもらうといいが, 基本的に推定は不可能だ.
ミルクを垂らした直後では, コーヒーの黒色とミルクの白色はかなりよく分離されているが,
十分時間が経ったあとではコーヒーは一面茶色になっている.
一面茶色になったところからどこにミルクを垂らしたかを推定しろと言われてもつらい.

あとでモデルの正当性という話をする: これは現象を数学に, 今の場合は微分方程式に落とし込むということ.
モデル化するときに適当な近似が入ったりするので, 必ずしも立てた方程式が忠実に現象を再現しているかは調べてみないと分からない.
モデルが現実を反映していればいるほど, 数学的にも物理現象をよりよく反映するようになる.
つまりモデルが難しくなればなるほど,
ただでさえ線型の方程式が非線型になるなど単純に数学的に難しくなることが予想されるだけでなく,
元の物理現象自体の難しさを反映した数学的な困難が立ち現れてくる.
ここからシミュレーションをするときの難しさもついでに出てくる.
「モデルの正当性と状況に応じたモデル・仮定の設定」という問題はここでも強く関係する.
\section{工学的要求: 特に解の安定性}

実際に SPEEDI でのシミュレーションの話があったが, 工学的 (現実的) にはシミュレーション (数値計算) が大事になる.
ここでシミュレーションをするときに大事なことを考える.
次の 3 つの大事な概念がある.
\begin{enumerate}
\item 解の存在.
\item 解の一意性.
\item 解の安定性.
\end{enumerate}
順番に議論しよう.

考えやすくするため, ここでは順問題で考える.
問題設定をきちんとした上での話だが解の存在と一意性は決定的に重要だ.
存在は存在で大事な話だが, 一旦一意性に集中する \footnote{ものすごくうるさいことを言えば, 相対論的量子電気力学の存在に関して色々と面倒な話がある. ここでは議論しきれないので割愛するが.}.

問題をはっきりさせるため坂からボールを転がす問題を考える.
これは適切に実験すれば必ず同じ条件でボールを転がしたときに同じ転がり方をすると思える.
つまり現象そのものに一意性がある.
この現象を表していると思われている方程式に解の一意性がない場合,
それはモデル化に失敗していると言わざるをえない.
存在についても適切な設定のもとでモデル化の失敗を意味している可能性がある.

また一意性がなければ計算した結果が何を表しているか分からなくなる.
いくつかある解のうち現実に表れてくるのはどの解なのか, ということ.
どれが出てくるかまで予測できればいいのだが, それは解の一意性に対応していると思える.

もう 1 つ大事な概念として安定性がある.
安定性というのは「条件が少し変わったら対応する解も少しだけ変わる」という性質のことをいう.
坂でボールを転がすとき,
ボールの位置を少しずらして転がしはじめると坂を転がり落ちるときにも軌道のずれは少しだけ, という感じ.

参考: \href{http://ja.wikipedia.org/wiki/\%E5\%AE\%89\%E5\%AE\%9A\%E6\%80\%A7\%E7\%90\%86\%E8\%AB\%96}{Wikipedia の安定性の項目}.

これはシミュレーション上とても大事:
まず第一に観測データを元にシミュレーションを始めるわけだが,
観測データの精度の問題がある.
つまり真の値から必ずずれがあると想定しなければいけない.
少しのずれなら解も少しだけしか変わらない性質を持っていないと,
シミュレーションの意味がなくなってしまいかねない.

また, 数値計算自体にも丸め誤差などの問題がある.
数値計算法が安定かどうかにも数学的検証が必要だ.

当たり前の性質と思うかもしれないが, 高校生でも「反例」 (実験系) を作れる.

例を出す: 問題として会場に聞く.

一意性については本当はもっときちんと考えないといけない.
二股の角の直上からボールをゆっくり離したとしよう.
このとき, 実際に実験すると必ず左右どちらかに跳ね返るが, 虚心坦懐に実験するのなら左右どちらに跳ね返るかは予想できない.
この状況下でのシミュレーションにはどういう意味があるのか, むしろどう意味付けすればいいのか.
それ程自明な話ではないはずだ.
私自身よく分からないのでこれ以上突っ込めないが.
\section{モデルの正当性}

まず「拡散であるはずの現象が波動方程式で記述されていたらおかしい」といった問題があるが,
方程式を導出する過程はある程度正しそうなのに,
方程式の解を調べてみたら「非現実的な解が出てきた」ということもある.
このとき, 実は導出過程がおかしかったということもあるだろうし,
出てきた解を適切に解釈しなければいけないということもある.

いくつか具体的に考えてみよう.
\subsection{拡散方程式}

ここでは「非現実的な解とその適切な解釈」という線で検討する.
$\mathbb{R}^1$ 上の拡散方程式の基本解の物理を考えよう.

数学的には次の設定で考える.
\begin{align}
 u_t &     = u_{xx}, \\
 u (0, x) & = \delta (x).
\end{align}
$u = u (t,x)$ とし, $t$ が時間変数, $x$ が空間変数だ.
初期値 $u (0, x)$ は Dirac の $\delta$ とする \footnote{初期値が超関数の偏微分方程式, 物理学科では 1 年の段階で登場する.
ミルクを注ぐというときわざわざカップに満遍なく垂らしていくという人はいないだろう.
あるところに注ぐ形になるはずだ.
これを理想化して数学的な意味で一点に注いだということにすると,
初期値が Dirac の $\delta$ ということになる.
もちろん数学的にきちんとやると大変だが, 適当に処理する分にはそれほど大きな問題はない.
さらに余談だが私は学部 1 年のときに必修のセミナー形式の演習で,
この数学部分について調査し教官の前で発表するという苦行をやらされた.
数学というか (数学に著しく偏った) 数理物理との戦いはここから始まる.}.

この解は初期値まで含めて次のように書ける:
\begin{align}
 u (t, x) = \frac{1}{\sqrt{4 \pi t}} \exp \left[ - \frac{x^2}{4 t} \right].
\end{align}
杓子定規に考えるならこの解は (特殊) 相対論に反している.
特殊相対論的には粒子の速度が真空中の光速を越えることはできないが,
この解は原点に垂らしたミルクが一瞬で無限遠まで飛んでいっている.

こういう非現実的な解が出てきてしまうにも関わらず, 物理や工学で良く使われる理由は,
これを適切に解釈する方法があるからだ.
具体的には指数関数の数学的特徴を使う.
指数関数, 特に $e^{-x^2}$ は $\left| x \right|$ が少し大きくなっただけで急速に小さくなる.
現実問題として, あまりにも小さくなると最早 0 と区別がつかない.
つまり少し遠くなると現実的にはそこまで遠くに粒子は飛んでいっていないという解釈ができるようになる.
これはミルクを垂らした直後には垂らした周りの色しか変わらないという事実に対応する.

数学的・定性的には解が解析的ではいけないと言ってもいい.
幾何でよく出てくる「無限階微分可能だが解析的ではない関数」があるが,
これはある区間で 0 になってしまうことが原因となっている.
実際にはある区間 (一定以上遠方) で 0 になってほしいため, 正に解が解析的にはなってほしくないという状況だ.

このように一見非現実的な解であっても適切な解釈によって現実的に意味があるように解釈し直せる.
ただしこれは純粋な数学の範囲外で適切な判断が必要な問題であって,
この判断ができるようになるにはそれなりの訓練が必要になる.
こうした基本的な認識の齟齬が,
実は数学科とそれ以外の応用という点で相当大きなコミュニケーション障害の原因になっているのではないかと思っている.
\subsection{波動方程式}

問題として地震源特定を考える.
地震は振動であり要は波なので波動方程式を使う.

どうすれば地震源を特定できるか.
一旦震源が分かっているとして考えよう.
地震が起こってから適当な速度で波が伝わってくる.
面倒なので一旦媒質によって波が伝わる速度が変わらないとし,
さらに地球の湾曲も無視して平面的に考える.
するとある時間が経つと地震源から同心円上に振動が伝わっている.
この円上に観測地点があって, 振動を受け取る.

逆に, 観測地点から見た円を描く.
1 つの観測所からだけだと震源が円上どこにあるか分からないが,
2 つ観測所があれば, 円の交点 2 つにまで絞れる.
3 つ観測所があれば, 3 つの円が全て交わるのは (存在したとして) 1 つだけだから震源が特定できる.

ここで問題になるのは, まず 3 つの円が交わるかどうかというところだ.
数値計算の誤差などで, 本当に 1 点で交わるということは考えられないので「何となく交点っぽいところ」を計算で出す必要がある.
円を描いて人間の目で見れば明らかなことでも計算機にやらせるのは難しい.
適当な誤差を許す必要があるが, その誤差を大きく取りすぎると「震源」が複数出てしまう.
1 分 1 秒を争う状況で検知したらすぐに速報を出す必要があるため, 人間の目などは使っていられない.

速報性という意味でもう 1 つ問題がある.
計算を精密にするためにも方程式もある程度精密にしなければいけないが, 精密にし過ぎると今度は計算に時間がかかるようになる.
媒質の様子をもの凄く細かく見る方程式で計算してしまうと, 現象の記述は正確になるが, それに反比例して時間がかかる.

正確性と速度はトレードオフの関係にある.
今は速度の方が遥かに大事で, しかも場所はある程度いい加減でも問題ない.
そのためなるべくシンプルな方程式で処理する必要がある.

シミュレーションを考えないといけない状況だと, 使う方程式は必ずしも物理的に精密である必要はない.
目的を忘れてはいけない.
\section{解の存在と正則性: 工学的現実と数学的困難}

\cite{NoborizakaOnishiYamamoto1} 2.9 節, 特に (2.86) 式を参照.
数学色が強いが, その分準備がいるので今回は見送り.

$\norm{p}_{H^1 (0,1)}$ と Sobolev ノルムを使っているが,
そもそも放射性物質の拡散問題で空間方向のデータを得ることがとても難しい.
微分のデータはなおさら.
つまり空間方向の微分のデータまで見た情報を使って得られた定理を現実問題に適用できるか, という問題.
\section{数値計算との関係}

\cite{KimYamamoto1} 5 章参照.
\section{impressions}

\begin{enumerate}
\item 前提知識がなく聞きやすかった.
もっと数学的な内容に踏み込んでもらえたらよかった.
\item 数学でない他分野関連の話で, 私は数学科じゃないので参考になり面白かったです.
\item 内容がとても分かりやすかったです.
スピードもちょうどよく, 板書も見やすかったです.
\item 具体例が多く, わかりやすかった.
工学生が持つべき考えを少し知ることが出来たと思います.
\item 逆問題についてもっと聞きたかったです. 自分は工学の人間なのでとても共感できました.
\item 面白かった. 逆問題の話をもっと聞きたかったな.
\item PDE の応用がきけて有意義でした.
\item 物理や工学方面からのアプローチが知れてよかった.
分野ごとの常識, 問題意識の違いなどが面白かったです.
\item 自分はどちらかというと物理・工学側の人間なので, 逆に数学側の人の考え方を知ることが出来て良かった.
\item 物理の話を聞けるとは思っていなかったので興味深かった.
\item 数学の外の世界に触れられてよかったです.
\item 考え方みたいなものが多く面白かった. もう少し数学の話が欲しかった.
\item テクニカルでない「お話」もよいものだと思いました. 個人的にこういう動機づけみたいな話に最近興味があります.
\item PDE を専攻している身としては大変勉強になりました.
普段気にしていない工学・物理の意見が参考になりました.
\item 物理や工学のことを数学の方に話すにはかなり導入の部分から話していかなきゃならないなと思った.
自分が発表するときの指針がすごく得られた.
\item 物理の問題意識のようなものが少しわかって有意義だった.
具体例と話の組み立てがよかった.
\end{enumerate}
\chapter{Talk: Analysis for the Thomas-Fermi functional after Lieb-Loss \cite{LiebLoss1}}

\section{Introduction}

\subsection{Comparison for the two problems}

Here we talk about two problems, i.e.,
\begin{enumerate}
\item theory for the Schr\"odinger equation,
\item theory for Thomas-Fermi problem.
\end{enumerate}
The former is connected to
\begin{itemize}
\item Lebesgue integral and various inequalities,
\item linear algebra,
\item functional analysis,
\item the theory of distribution,
\item partial differential equations,
\end{itemize}
and so on.
On the other hand the latter is connected to
\begin{itemize}
\item Lebesgue integral and various inequalities,
\item functional analysis.
\end{itemize}
In the seminar on Feb. 14th, 2014  we talk about the latter because
the first talking plan is to explain the latter and the latter is a little bit easier
because the latter needs less knowledge.
\subsection{Variational problem and its mathematical background}

We give a lecture on a book \cite{LiebLoss1} and a paper \cite{LiebSimon1}.

Here we give two examples of solving optimization (variational) problems.
In general we consider optimization for a \textbf{functional} if we say `variational'.
The first comes from quantum mechanics and is the problem of determining the energy of an atom--primarily the lowest one.
The second is a classical type minimization problem--the Thomas-Fermi problem--that arises in chemistry.
In these two cases the difficult part is showing the existence of a minimizer, and hence of a solution
to a partial differential equation.
Needless to say, the following considerations (known as the \textbf{direct method in the calculus of variations})
for establishing a solution to a differential equation are not limited to these elementary examples,
but should be viewed as a general strategy to attack optimization problems.

Historically, and even today in many places, it is customary to dispense with the question of existence as a mere subtlety.
By simply assuming that a minimizer or maximizer exists, however, and then trying to derive
properties for it, one can be led to severe inconsistencies--as the following amusing example
taken from \cite{LaurenceYoung1} and attributed to Perron shows:
\begin{quote}
Let $N$ be the largest natural number.
Since $N^2 \geq N$ and $N$ is the largest natural number, $N^2 = N$ and hence $N=1$.
\end{quote}
What this example tells us is that even if the `variational equation', here $N^2 = N$, can be solved explicitly,
the resulting solution need not have anything to do with the problem we started out to solve.

Let us continue this overview with some general remarks about minimization of functions.
A general theorem in analysis says that a bounded continuous real function $f$ defined on a bounded and close set $K$
in $\bbR^n$ attains its minimum value.
To prove this, pick a sequence of points $x_j$ such that
\begin{align}
 f \rbk{x_j} \to \lambda
 \defeq
 \inf_{x \in K} f (x) \quad \text{as} \quad j \to \infty.
\end{align}
Since $K$ is compact there exists a sub-sequence, again denoted by $x_j$, and a point $x \in K$ such that $x_j \to x$ as $j \to \infty$.
Hence, since $f$ is continuous,
\begin{align}
 \lambda
 =
 \lim_{j \to \infty} f (x_j) = f (x),
\end{align}
and the minimum value is attained at $x$.

Instead of $\bbR^n$, consider now $L^2 \rbk{\Omega, \dmu}$ and let $\calF \rbk{\psi}$ be some (nonlinear) functional
defined on this space.
In many examples $\calF (\psi)$ is strongly continuous, i.e., $\calF (\psi_j) \to \calF \rbk{\psi}$ as $j \to \infty$
whenever $\norm{\psi_j - \psi}_2 \to 0$ as $j \to \infty$.
Suppose we wish to show that the infimum of $\calF (\psi)$ is attained on $K \defeq \set{\psi \in L^2 \rbk{\Omega, \dmu}}{\norm{\psi}_2 \leq 1}$.
This set is certainly closed and bounded, but for a bounded sequence $\psi_j \in K$
there need not be a strongly convergent sub-sequence (see Sect. 2.9 in \cite{LiebLoss1}).

The idea now is to relax the strength of convergence (topology).
Indeed, if we use the notion of weak convergence instead of strong convergence, then, by Theorem 2.18 in \cite{LiebLoss1},
every sequence in $K$ has a weakly convergent sub-sequence: see also Section \ref{Lieb-Loss_Analysis_chap11_36}.
In this way, the set of convergent sequences has been enlarged--but a new problem arises.
The functional $\calF (\psi)$ need not be weakly continuous--and it rarely is.
Thus, to summarize, the more sequences exist that have convergent sub-sequences the less likely it is that
$\calF (\psi)$ is continuous on these sequences.
The way out of this apparent dilemma is that in many examples the functional turns out to be \textbf{weakly lower semi-continuous}, i.e.,
\begin{align}
 \liminf_{j \to \infty} \calF \rbk{\psi_j} \geq \calF \rbk{\psi}
 \quad \text{if} \quad \psi_j \wto \psi.
\end{align}
Thus, if $\psi_j$ is a minimizing sequence, i.e., if
\begin{align}
 \calF \rbk{\psi_j} \to \inf \set{\calF \rbk{\psi}}{\psi \in K} = \lambda,
\end{align}
then there exists a sub-sequence $\psi_j$ such that $\psi_j \wto \psi$, and hence
\begin{align}
 \lambda
 =
 \lim_{j \to \infty} \calF \rbk{\psi_j} \geq \calF \rbk{\psi} \geq \lambda.
\end{align}
Therefore, $\calF \rbk{\psi} = \lambda$, and the goal is achieved!
\subsection{Schr\"odinger equation}

The \textbf{time independent Schr\"odinger equation} for a particle in $\bbR^n$, interacting with a force field $F (x) = - \nabla V (x)$, is
\begin{align}
 -\Delta \psi + V \psi = E \psi. \label{Lieb-Loss_Analysis_chap11_1}
\end{align}
The function $V \colon \bbR^n \to \bbR$ is called a potential\footnote{ただし三角の微分があってそこは高校 3 年理系相当だから世間的にはあまり馴染みもないだろうとも思っている.}.
The `wave function' $\psi$ is a complex-valued function in $L^2 (\bbR^n)$ subject to the \textbf{normalization condition}
\begin{align}
 \twonorm{\psi} = 1.
\end{align}
An $L^2$ solution to (\ref{Lieb-Loss_Analysis_chap11_1}) may or may not exist for any $E$; often does not.
The special real numbers $E$ for which such solutions exist are called \textbf{eigenvalues} and the solution,
$\psi$, is called an \textbf{eigen-function}.
These have, of course, its origin in linear algebra: $H \defeq - \Delta + V$ is a linear operator,
and $E$'s are its eigenvalues and $\psi$ is an eigen-function belonging to $E$.

Associated with (\ref{Lieb-Loss_Analysis_chap11_1}) is a variational problem.
Suppose $\psi$ is some nice function (i.e., in $\calD (\bbRn) \defeq \Ccinfty (\bbRn)$) and multiplied $\bar{\psi}$ to (\ref{Lieb-Loss_Analysis_chap11_1}):
\begin{align}
 -\bar{\psi} \Delta \psi + V \abs{\psi}^2 = E \abs{\psi}^2.
\end{align}
By integration by parts (Stokes' theorem), we get
\begin{align}
 \int \abs{\nabla \psi}^2 + \int V \abs{\psi}^2 = E \twonorm{\psi}^2.
\end{align}
Consider the following functional defined for a suitable class of functions in $\LtwoRn$ (to be specified later):
\begin{align}
 \calE \rbk{\psi}
 =
 T_{\psi} + V_{\psi}, \label{Lieb-Loss_Analysis_chap11_3}
\end{align}
with
\begin{align}
 T_{\psi}
 &=
 \int_{\bbR^n} \abs{\nabla \psi (x)}^2 dx, \\
 V_{\psi}
 &=
 \int_{\bbR^n} V (x) \abs{\psi (x)}^2 dx.
\end{align}

Physically $T_{\psi}$ is called the \textbf{kinetic energy} of $\psi$, $V_{\psi}$ is its \textbf{potential energy}
and $\calE (\psi)$ is the \textbf{total energy} of $\psi$.

The variational problem we shall consider is to minimize $\calE (\psi)$ subject to the constant $\twonorm{\psi} = 1$.
This relates to the fundamental physical inspection: \textit{nature favors the states having lower energy}.
Note that we change the problem to easier one, i.e., differential equation to integro-differential equation.
Integral equation is easier because we can use many inequalities.
Furthermore integral does conserve the order of functions, i.e.,
\begin{align}
 f \leq g
 \Longrightarrow
 \int f \leq \int g.
\end{align}
This property is essential in the following analysis.

As we shall show below, a minimizing function $\psi_0$, if one exists, will satisfy equation (\ref{Lieb-Loss_Analysis_chap11_1})
with $E = E_0$, where
\begin{align}
 E_0
 \defeq
 \inf \set{\calE \rbk{\psi}} {\int \abs{\psi}^2 = 1}.
\end{align}
Such a function $\psi_0$ will be called a \textbf{ground state}.
The number $E_0$ is called the \textbf{ground state energy}.

Thus the variational problem determines not only $\psi_0$ but also a corresponding eigenvalue $E_0$,
which is the smallest eigenvalue of (\ref{Lieb-Loss_Analysis_chap11_1}).

Our route to finding a solution to (\ref{Lieb-Loss_Analysis_chap11_1}) takes us to the main problem.
\begin{enumerate}
\item Show, under suitable assumptions on $V$, that a minimizer exists.
\begin{enumerate}
\item Note that there are examples where a minimizer does \textbf{not} exist, e.g., take $V = 0$.
\end{enumerate}
\item Show that the minimizers satisfy (\ref{Lieb-Loss_Analysis_chap11_1}) in the sense of distributions.
\item Show that, under suitable additional assumptions on $V$, the distributional
solutions of (\ref{Lieb-Loss_Analysis_chap11_1}) are sufficiently regular to yield classical solutions.
\item Show that (non-) uniqueness of the minimizer.
\begin{enumerate}
\item Here uniqueness means that it is unique apart from an overall phase, i.e., $\psi_0 \to e^{i \theta} \psi_0$.
\end{enumerate}
\end{enumerate}
Considering distributional solutions is usual procedure in mathematics.
If we want to solve algebraic equations we first consider solutions in $\bbC$ for existence.
Then we consider properties of solutions.
Considering distributional solutions amounts to considering in $\bbC$.
\subsection{Connection to other mathematical branches}

\subsubsection{Mathematics for quantum mechanics}

\begin{enumerate}
\item Time dependent Schr\"odinger equation

A time dependent Schr\"odinger equation is
\begin{align}
 i \frac{\partial}{\partial t} \phi = H \psi,
\end{align}
where $H$ is a Hamiltonian, i.e., self-adjoint operator.
There are many PDE analysis including scattering theory, etc.
\item Operator theory

In operator theoretic language, our main task in this seminar is a proof that
\begin{enumerate}
\item the \textbf{Hamiltonian} $H = - \Delta + V$ is bounded below,
\item the infimum of the spectrum $\sigma (H)$ of $H$ is in the point spectrum (the set of eigenvalues).
\end{enumerate}
Note that, in operator theory, the ground state does not appear explicitly.
Remember the theory of eigenvalues and eigenvectors in linear algebra:
eigenvectors are defined after the definition of eigenvalues.

Main concern of operator theory is, of course, the properties of operators, not the properties of functions.
Hence operator theoretic point of view is different from real analytic one.

This originates in the physics of quantum mechanics:
in quantum mechanics the spectrum of an operator is the set of measured values, i.e.,
the spectrum of an operator has direct physical meaning.
Since my main concern is physics my main mathematical tool is operator theory or operator algebras.

Today's analysis is one for an operator by real analytic methods.
\item Probability

We can use probability theory for operator analysis.
Usually we can only see properties before or after action of an operator.
However, using probability, we can see some property `in course of action'.
For example, by heat semi-group technique and Feynman-Kac formula, we get a formula for ground state energy,
\textbf{functional integral representation},
\begin{align}
 E_0
 =
 -\lim_{t \to \infty} \frac{1}{t} \log \int_{W} \overline{\psi \rbk{\phi (0)}} \psi \rbk{\phi (t)} e^{- \int_0^t V (\phi (s)) ds} d\mu_0,
\end{align}
where
\begin{gather}
 W
 \defeq
 \bbRn \times M, \quad
 M
 \defeq
 \rbk{\bbRn}^{[0, \infty)}, \\
 \phi (t) \colon \bbRn \times M \to \bbRn; \quad
 \phi (t) (x, \omega) \defeq x + \omega (t), \quad (x, \omega) \in W \quad \forall t \geq 0.
\end{gather}
Or we can express the heat semi-group action by path integral.
For the Nelson model we obtain
\begin{align}
 \bkt{F}{e^{- t H_N} G}
 =
 \int_{\bbRd} dx \rmE^{x}
 \sqbk{e^{- \int_0^t V (B_s) ds} \bkt{I_0 \overline{F (B_0)}}{e^{\phi_{\mathrm{E}} \rbk{\int_0^t \delta_s \otimes \varphi (\cdot - B_s) ds}}}{I_t G (B_t)}}
\end{align}
See \cite{LorincziHiroshimaBetz1}, \cite{AsaoArai5}, \cite{SimonBarry2} for details.
\item Algebraic analysis

I do not know this area well.
A Keyword is the exact WKB analysis.
See, for example, \cite{KawaiTakei1}.
\item Nonstandard analysis

I do not know also this area well.
See, for example, \cite{TohruNakamura1}.
This book explains, e.g., Feynman's path integral.
Nonstandard analysis relates to the domain of mathematical logic:
quantum physics connects mathematical logic to other mathematical branches!
\item Number theory: non-commutative harmonic oscillator

I do not know also this area well.
See, for example, \cite{AlbertoParmeggiani1, MasatoWakayama1}.

We define an non-commutative harmonic oscillator.
Consider a Hilbert space $L^2 \cbk{\bbR} \otimes \bbC$ and
a differential operator of matrix type $Q = Q_{\alpha, \beta}$:
\begin{align}
 Q
 \defeq
 \begin{bmatrix}
  \alpha & 0 \\
  0      & \beta
 \end{bmatrix}
 \rbk{- \frac{1}{2} \frac{d^2}{dx^2} + \frac{1}{2} x^2} +
 \begin{bmatrix}
  0 & -1 \\
  1 & 0
 \end{bmatrix}
 \rbk{x \frac{d}{dx} + \frac{1}{2}},
\end{align}
where $\alpha, \beta > 0$, $\alpha \beta > 1$.
Then the operator $Q$ is of strictly positive operator and has only discrete spectrum.
For investigating the spectral structure we define the following Dirichlet series (spectral zeta).
\begin{align}
 \zeta_{Q} (s)
 \defeq
 \sum_{n=1}^{\infty} \lambda_{n}^{-s}.
\end{align}
This series absolutely converges in $\Re \rbk{s} > 1$ and
is analytically continued to all $\bbC$ as a meromorphic function.
In particular, if $\alpha = \beta = \sqrt{2}$ then we have
\begin{align}
 \zeta_{Q} (s)
 =
 2 \rbk{2^s - 1} \zeta (s),
\end{align}
i.e., this spectral zeta is Riemann's zeta.

This relates to many other mathematical branches, e.g.,
a differential equation of Picard-Fuchs type  for a universal family of a elliptic curve,
theory of automorphic forms and functions,
Heun's differential equation and its connection problem.
Furthermore Taniguchi shows some interesting property using stochastic analysis.
For details see \cite{AlbertoParmeggiani1}.
\item In connection to topology: Aharonov-Bohm effect

We may consider Schr\"odinger operators on topologically defected regions,
especially, non-simply connected regions.
Topological properties on the domain give some effects on the properties of the operator.
In this respect Aharonov-Bohm effect is very famous and important in physics or gauge theory.
See, e.g., chapter 3 in \cite{AsaoArai4} and its references.
\end{enumerate}
\subsubsection{Geometric variational problem}

A variational method is a basic tool in many physical branches.
Analytical mechanics and its relation to (differential) geometry is famous.
Variational argument for energy of a curve introduces connection,
covariant derivative, parallel displacement, geodesic, curvature and so on.
We can generalize the theory of energy for curves to the one for energy for maps between (Riemann/K\"ahler) manifolds,
i.e., theory of harmonic maps.
Geometric variational problem also relates to Morse theory.
See \cite{SeikiNishikawa1}.
See also the isoperimetric problem.
\subsubsection{Nonlinear analysis}

In the analysis for the Thomas-Fermi theory we face nonlinear analysis.
In physics there are many nonlinear partial differential equations
and we have many analysis for these equations.
In geometry we have many interesting nonlinear functionals and nonlinear partial differential equations,
such as the Yamabe equation or the Monge-Amp\`ere equation.
See \cite{ThierryAubin1}.
\subsubsection{Index theorem}

In Aharonov-Bohm effect the topology of spaces affects operators on it.
E.g., if a Riemannian manifold is compact the spectrum of Laplacian becomes discrete\footnote{数学ではよくある.}.

Conversely properties of some operators determines some interesting properties in topology.
A Laplacian on a Riemannian manifold, especially its spectrum, has many topological information.
This type of problems offers the region, spectral geometry \cite{MarkKac2}.

In this course one of the most interesting thing is the celebrated index theorem by Atiyah and Singer.
The Atiyah – Singer index theorem, proved by Michael Atiyah and Isadore Singer (1963),
states that for an elliptic differential operator on a compact manifold,
the analytical index (related to the dimension of the space of solutions) is equal to
the topological index (defined in terms of some topological data).
It includes many other theorems,
such as the Riemann–Roch theorem, as special cases, and has applications in theoretical physics.

Path integral (functional integral) has a deep connection to this problem.
We have a (formal?) proof for index theorem using path integral.
\subsubsection{Stochastic optimization}

Stochastic optimization is the process of maximizing or minimizing
the value of a mathematical or statistical function when one or more of the input parameters is subject to randomness.
The word stochastic means involving chance or probability.
This is applied to, e.g., machine learning.
This is used to improve a user's dictionary in converting "kanji-kana".
\subsubsection{Other optimization problem}

In real world we encounter many optimization problems.
In general engineering solves optimization problems in real constraints.
\subsubsection{Singular analysis}

The Coulomb potential has a singular point at $x = 0$ and a solution has a singularity at $x = 0$.
That is, singularity of a potential affects a singularity of a solution.

Both physics and mathematics have many singular problems,
such as resolution of singularity in algebraic geometry,
the residue theorem in complex analysis,
existence of black holes in general relativity, definition of phase transition, and so on.
\section{Mathematical preliminaries}

In this section we assume $\Omega \subset \bbRn$ is an open set.
\subsection{The important difference in integration and differentiation}

In analysis integration is very important because it saves an order of functions:
we define $f \leq g$ by
\begin{align}
 f (x) \leq g (x) \quad \forall x.
\end{align}
Then it follows that
\begin{align}
 f \leq g
 \Rightarrow
 \int f \leq \int g.
\end{align}
Furthermore, if $f$ and $g$ is continuous, $f \leq g$, and there is $x$ such that $f (x) < g (x)$, then we get
\begin{align}
 \int f < \int g.
\end{align}
This is called the strong monotonicity of integration.

Can you make counterexamples for differentiation?
\subsection{Important spaces}

In this seminar we mainly consider $L^p$ spaces and Sobolev spaces $H^k$ on $\bbRn$.
\subsubsection{$L^p$ spaces}

Here we consider only Lebesgue or Borel measurable functions.
For details see \cite{SeizoIto1} or \cite{LiebLoss1}.

For $p \in [1, \infty)$, $L^p$ spaces is defined by
\begin{align}
 L^p \rbk{\Omega}
 \defeq
 \set{f}{\int_{\Omega} \abs{f (x)}^p dx < \infty}.
\end{align}
For $p = \infty$
\begin{align}
 L^p
 =
 \set{f}{\esssup \abs{f} < \infty}.
\end{align}

We introduce the topology on $L^p$ by the norms:
\begin{align}
 \norm{f}_p
 =
 \begin{cases}
  \rbk{\int_{\Omega} \abs{f (x)}^p dx}^{1/p}, & 1 \leq p < \infty, \\
  \esssup \abs{f}, & p = \infty.
 \end{cases}
\end{align}
Then, by the Minkowski inequality, $L^p$ spaces are linear for $p \in [1, \infty)$.
$L^{\infty}$ is also linear.
In fact $L^p$ spaces are complete for $p \in \sqbk{1, \infty}$.
For details see \cite{SeizoIto1} or \cite{LiebLoss1}.

Moreover, for $p=2$, we can introduce the inner product:
\begin{align}
 \bkt{f}{g}
 \defeq
 \int_{\Omega} \overline{f (x)} g (x) dx.
\end{align}
For this inner product the space $L^2$ becomes a Hilbert space.
\subsubsection{$L^p+L^q$ spaces}

Let $p$, $q \in \sqbk{1, \infty}$.
Then a function $f$ is in $L^p + L^q$ if $f$ can be decomposed as
\begin{align}
 f = f_1 + f_2, \quad
 f_1 \in L^p, \quad f_2 \in L^q.
\end{align}
This decomposition is simple but ingenious.

\begin{ex}
 Let $V = - \frac{1}{\abs{x}}$ in $\bbRthree$ and
 \begin{align}
  V = V_1 + V_2, \quad
  V_1
  \defeq
  -\chi_{\abs{x} \leq 1} V, \quad
  V_2;
  \defeq
  -\chi_{\abs{x} \> 1} V, \quad.
 \end{align}
 Then we have
 \begin{align}
  V_1 \in L^{5/2}, \quad
  V_2 \in L^{4} \bigcap L^{\infty}.
 \end{align}
\end{ex}
\subsubsection{the $\Loneloc$ space}

The space $\Loneloc \rbk{\Omega}$ is defined by
\begin{align}
 \Loneloc \rbk{\Omega}
 \defeq
 \set{f}{\forall A \subset \Omega, \, A \, \text{is compact}, \, \norm{\chi_A f}_1 < \infty},
\end{align}
where a function $\chi_A$ is an indicator function for $A \subset \Omega$.
This space is useful when considering the theory of distributions.
\subsubsection{Sobolev spaces $H^k$}

A Sobolev space $H^1 (\bbRn)$ is defined by
\begin{align}
 H^1 \rbk{\bbRn}
 \defeq
 \set{\psi \in \LtwoRn}{\int_{\bbRn} \rbk{\abs{\nabla \psi (x)}^2 + \abs{\psi (x)}^2} dx < \infty},
\end{align}
where $\nabla \psi$ is in the distributional sense.
We have another definition of a Sobolev space $H^1 (\bbRn)$ using Fourier transform,
\begin{align}
 H^1 \rbk{\bbRn}
 \defeq
 \set{\psi \in \LtwoRn}{\int_{\bbRn} \rbk{\abs{k \hat{\psi} (k)}^2 + \abs{\hat{\psi} (k)}^2} d k < \infty}.
\end{align}
\subsection{Convolution}

\subsubsection{Definition}

Here we consider $\Omega = \bbRd$.
For suitable functions $f$ and $g$ we can define a some type of product, called the convolution, by
\begin{align}
 (f * g) (x)
 \defeq
 \int_{\bbRd} f (y) g (x - y) dy.
\end{align}
For this product the space $L^1 (\bbRd)$ becomes a Banach algebra.
There exists a useful inequality, Young's inequality: see Theorem \ref{Lieb-Loss_Analysis_chap11_37}.
\subsubsection{Convolutions of functions in dual $L^p$ spaces are continuous}

\begin{lem}\textup\{(Lemma 2.20. \cite{LiebLoss1})\}\label{Lieb-Loss_Analysis_chap11_41}
 Let $f \in L^p \rbk{\bbRn}$ and $g \in L^q (\bbRn)$ with $p$, $q > 1$ dual indices, i.e.,
\begin{align}
 \frac{1}{p} + \frac{1}{q} = 1.
\end{align}
Then the convolution $f*g$ is a continuous function on $\bbRn$ that tends to zero at infinity in the strong sense that,
for any $\varepsilon > 0$ there is $\calR_{\varepsilon}$ such that
\begin{align}
 \sup_{\abs{x} > \calR_{\varepsilon}} \abs{(f*g) (x)} < \varepsilon.
\end{align}
\end{lem}
\subsection{Various inequalities}

\subsubsection{H\"older's inequality}

\begin{thm}[Theorem 2.3 \cite{LiebLoss1}]
 Let $p$ and $q$ be dual indices, i.e., $1/p + 1/q = 1$ with $1 \leq p \leq \infty$.
 Let $\Omega \subset \bbRn$ be open, $f \in L^p (\Omega)$ and $f \in L^q \rbk{\Omega}$.
 Then $fg \in L^1 (\Omega)$ and
 \begin{align}
  \abs{\int_{\Omega} fg dx}
  \leq
  \norm{f}_p \norm{g}_q.
 \end{align}
\end{thm}
This means that
\begin{align}
 L^p \rbk{\Omega} \subset L^q \rbk{\Omega}', \quad p \in [1, \infty],
\end{align}
where, for a linear space $L$, $L'$ is a dual space.
In fact we can prove
\begin{align}
 L^q \rbk{\Omega} = \rbk{L^p \rbk{\Omega}}', \quad
 L^p \rbk{\Omega} = \rbk{L^q \rbk{\Omega}}' = \rbk{L^p \rbk{\Omega}}'', \quad
 p \in (1, \infty),
\end{align}
i.e., $L^p$ spaces are \textbf{reflexive} for $p \in (1, \infty)$.

It is well-known $L^{\infty}$ is not reflexive.
See, e.g., \cite{HaimBrezis1, HaimBrezis2}.
\subsubsection{Young's inequality}

\begin{thm}[Theorem 4.2 \cite{LiebLoss1}]\label{Lieb-Loss_Analysis_chap11_37}
 Let $\Omega = \bbRn$.
\begin{enumerate}
\item Assume that
\begin{align}
 1 + \frac{1}{r} = \frac{1}{p} + \frac{1}{q}, \quad 1 \leq p, q, r \leq \infty.
\end{align}
Then, for any $f \in L^p (\bbRn)$, $g \in L^q (\bbRn)$, it holds that
\begin{align}
 \norm{f * g}_r
 \leq
 \norm{f}_p \norm{g_q}.
\end{align}
\item Assume that
\begin{align}
  \frac{1}{p} + \frac{1}{q} + \frac{1}{r} = 2, \quad 1 \leq p, q, r \leq \infty.
\end{align}
Then, for any $f \in L^p (\bbRn)$, $g \in L^q (\bbRn)$, and $h \in L^r \rbk{\bbRn}$ it holds that
\begin{align}
 \abs{\int_{\bbRn} f (x) \rbk{g * h} (x) dx}
 \leq
 \norm{f}_p \norm{g}_q \norm{h}_r.
\end{align}
\end{enumerate}
\end{thm}
\subsubsection{Sobolev's inequality}

A function $f \colon \bbRn \to \bbC$ is in $D^1 (\bbRn)$ if it is in $\Loneloc (\bbRn)$, if its distributional derivative $\nabla f \in \LtwoRn$,
and if $f$ vanishes at infinity, i.e.,
\begin{align}
 \abs{\set{x}{\abs{f (x)} > a}} < \infty, \quad \forall a > 0.
\end{align}
\begin{thm}[Sobolev's inequality for $n \geq 3$, Section 8.3 in \cite{LiebLoss1}]\label{Lieb-Loss_Analysis_chap11_4}
 For $n \geq 3$ let $f \in D^1 (\bbRn)$.
 Then $f \in L^q (\bbRn)$ with $q = 2n/ (n-2)$ and the following inequality holds:
\begin{align}
 S_n \norm{f}_{q}^2
 \leq
 \twonorm{\nabla f}^2,
\end{align}
where
\begin{align}
 S_n
 =
 \frac{n (n-2)}{4} \abs{\bbS^2}^{2/n}
 =
 \frac{n (n-2)}{4} 2^{2/n} \pi^{1 + 1/n} \Gamma \rbk{\frac{n+1}{2}}^{-2/n}.
\end{align}
\end{thm}
\subsection{Topologies \label{Lieb-Loss_Analysis_chap11_36}}

\subsubsection{Strong topology and weak topology in Hilbert spaces}

Here we explain only Hilbert spaces since it suffices in this seminar.

Suppose $\calH$ is a (separable) Hilbert space, i.e., $\calH$ has a complete inner product space.
The space $\calH$ has a natural topology, called the \textbf{strong topology}, defined by its norm.
We may consider other topology for $\calH$, called the \textbf{weak topology}.
It is defined by the convergence for sequences.
The strong topology is defined by convergence in norm, i.e.,
\begin{align}
 \slim_{j \to \infty} \psi_j = \psi
 \Longleftrightarrow
 \norm{\psi_j - \psi} \to 0 \text{ as } j \to \infty.
\end{align}
The weak topology is defined by some convergence using inner product, i.e.,
\begin{align}
 \wlim_{j \to \infty} \psi_j = \psi
 \Longleftrightarrow
 \bkt{\psi_j - \psi}{\phi} \to 0 \text{ as } j \to \infty \quad \forall \phi \in \calH.
\end{align}
\begin{prop}
 If $\psi_j \sto \psi$ then $\psi_j \wto \psi$.
\end{prop}
\begin{proof}
By Cauchy-Schwarz.
\end{proof}
\begin{rem}
 Suppose a functional $F \colon \calH \to \bbC$ is strongly continuous.
 However $F$ is not necessarily weakly continuous.
\end{rem}

\subsubsection{Example of weakly convergent sequence}

Before introducing concrete examples, we state a general example.
\begin{thm}[Inequality of Bessel, Sec. 2.21 \cite{LiebLoss1}]
 If $\psi_j$ is orthonormal system, then we have, for any $\phi \in \calH$,
 \begin{align}
  \sum_{j = 1}^{\infty} \abs{\bkt{\psi_j}{\phi}}^2
  \leq
  \norm{\phi}^2.
 \end{align}
\end{thm}
Suppose a sequence $(\psi_j)$ is orthonormal.
Then the Bessel inequality states that $(\psi_j)$ converges weakly to 0.
However $(\psi_j)$ does not converges strongly because $\norm{\psi_j - \psi_k} = \sqrt{2}$ if $j \neq k$.

A concrete example is as follows.
A function $\psi_j$ is defined by $\psi_j = \chi_{A_j}$, where $A_j = (j-1, j]$ and $\chi_A$ is a indicator function for a set $A$.
Then a sequence $(\psi_j)$ is orthonormal and $\psi_j \wto 0$.
This $(\psi_j)$ also converges to $0$ pointwise but $(\psi_j)$ does not converge strongly.
The weak topology fills in this discrepancy.
\subsubsection{Why we use the pointwise convergence instead of weak convergence?}

A function space has many interesting and important convergence, e.g., pointwise convergence and uniform convergence.
The weak topology is natural if we consider its linear space structure.
A (normed) linear space always has its dual space\footnote{これがまた分かりづらい. \ref{Hinashiro_math_party_1_probability_14} 節でこれをすっきりさせる.} and the weak topology uses a dual space in its definition.
Furthermore the importance of the weak topology is also due to the theorem \ref{Lieb-Loss_Analysis_chap11_2}.


\subsection{Theorems in Lebesgue integral and functional analysis}

\subsubsection{Dominated convergence}

\begin{thm}[Theorem 1.8. \cite{LiebLoss1}]\label{Lieb-Loss_Analysis_chap11_6}
 Assume functions $(f_j)$ and $f$ are measurable and $f_j \to f$ pointwise.
 If a function $g \in L^1 (\Omega)$ exists and $\abs{f_j} \leq g$ then $\abs{f} \leq g$ and
\begin{align}
 \lim_{j \to \infty} \int_{\Omega} f_j (x) dx
 =
 \int_{\Omega} f (x) dx.
\end{align}
\end{thm}
\subsubsection{Differentiability of norms, Gateaux derivative}

\begin{thm}[Theorem 2.6. \cite{LiebLoss1}]\label{Lieb-Loss_Analysis_chap11_26}
 Suppose $f$ and $g$ are functions in $L^p (\Omega)$ with $p \in \rbk{1, \infty}$.
 The function defined on $\bbR$ by
\begin{align}
 N (t)
 \defeq
 \int_{\Omega} \abs{f (x) + t g (x)}^{p} dx
\end{align}
is differentiable and its derivative at $t = 0$ is given by
\begin{align}
 \frac{d}{dt} N (t) \Big |_{t=0}
 =
 p \int_{\Omega} \abs{f (x)}^{p-2} \Re \rbk{\overline{f (x)} g (x)} dx.
\end{align}
\end{thm}
\subsubsection{Uniform boundedness principle}

\begin{thm}[Theorem 2.12. \cite{LiebLoss1}]\label{Lieb-Loss_Analysis_chap11_2}
 Let $f_j \in L^p (\Omega)$ with the property
\begin{align}
 \set{L (f_j)}{j \in \bbN} < \infty \quad \forall L \in L^p \rbk{\Omega}^*.
\end{align}
Then the sequence of norms $(\norm{f_j}_p)$ is bounded.
\end{thm}
\subsubsection{Banach-Alaoglu theorem}

\begin{thm}[Theorem 2.18. \cite{LiebLoss1}]\label{Lieb-Loss_Analysis_chap11_8}
\begin{enumerate}
\item Strongly Bounded and strongly closed sets of a Hilbert space $\calH$ are weakly compact.
\item Strongly Bounded and strongly closed sets of each $L^p \rbk{\Omega}$ space are weakly compact.
\end{enumerate}
\end{thm}
\begin{rem}
 This theorem implies that a \upbf{strong} bounded sequence in $L^p (\Omega)$ has a \upbf{weakly} convergent sub-sequence!
 Note also that this is the extremely important property for the analysis on $\bbR$.
\end{rem}
\subsubsection{Derivative of the absolute value}

\begin{thm}[Theorem 6.17. \cite{LiebLoss1}]\label{Lieb-Loss_Analysis_chap11_11}
 Let $f$ be in $W^{1,p} (\Omega)$.
 Then the function $\abs{f}$, defined by $\abs{f}(x) \defeq \abs{f (x)}$, is in $W^{1,p} (\Omega)$ with $\nabla \abs{f}$ being the function
\begin{align}
 \rbk{\nabla \abs{f}}(x)
 =
 \begin{cases}
  \frac{1}{\abs{f}(x)} \rbk{R (x) \nabla R (x) + I (x) \nabla I (x)}, &f (x) \neq 0, \\
  0 & f (x) = 0,
 \end{cases}
\end{align}
here $R (x)$ and $I (x)$ denote the real and imaginary parts of $f$.
In particular, if $f$ is real-valued,
\begin{align}
 \rbk{\nabla \abs{f}}(x)
 =
 \begin{cases}
  \nabla f (x) & f (x) > 0, \\
  -\nabla f (x) & f (x) < 0, \\
  0 & f (x) = 0.
 \end{cases}
\end{align}
Thus
\begin{enumerate}
\item $\abs{\nabla \abs{f}} \leq \abs{\nabla f}$ a.e. if $f$ is complex-valued,
\item $\abs{\nabla \abs{f}} = \abs{\nabla f}$ a.e. if $f$ is real-valued.
\end{enumerate}
\end{thm}
\subsubsection{Convexity inequality for gradients}

\begin{thm}[Theorem 7.8. \cite{LiebLoss1}]\label{Lieb-Loss_Analysis_chap11_12}
 Let $f, g$ be real-valued functions in $H^1 (\bbRn)$.
 Then
\begin{align}
 \int_{\bbRn} \abs{\nabla \sqrt{f^2 + g^2}}^2 (x) dx
 \leq
 \int_{\bbRn} \rbk{ \abs{\nabla f (x)}^2 + \abs{\nabla g (x)}^2 } dx.
\end{align}
If, moreover, $g (x) > 0$, then equality holds if and only if there exists a constant $c$ such that
\begin{align}
 f (x) = c g (x) \quad \mathrm{a.e.}
\end{align}
\end{thm}
\begin{rem}
 For complex-valued $F$ the above inequality becomes
 \begin{align}
  \int_{\bbRn} \abs{\nabla \abs{F} (x)}^2 dx
  \leq
  \int_{\bbRn} \abs{\nabla F (x)}^2 dx.
 \end{align}
\end{rem}
\subsubsection{Fundamental theorem of variational method, du Bois-Reymond's lemma}

\begin{thm}
 Let $f \in \Loneloc$. If, for any $\phi \in \Ccinfty (\Omega)$, it holds that
 \begin{align}
  \int_{\Omega} f (x) \phi (x) dx = 0,
 \end{align}
 then we must have $f = 0$.
\end{thm}
\subsection{Potential theory}

We use this theory in Section \ref{Lieb-Loss_Analysis_chap11_39}.
See the chapter 9 in \cite{LiebLoss1} for details.
\subsubsection{Positivity properties of the Coulomb energy}

We define a sesquilinear form $D$ as
\begin{align}
 D (f, g)
 \defeq
 \frac{1}{2} \int_{\bbRn} \int_{\bbRn} \frac{f (x) g (x)}{\abs{x - y}} dx dy.
\end{align}
Then we have the
\begin{thm}[Theorem 9.8. \cite{LiebLoss1}]\label{Lieb-Loss_Analysis_chap11_40}
 If $f \colon \bbRn \to \bbC$ satisfies $D ( \abs{f}, \abs{f}) < \infty$, then
\begin{align}
 D (f, f) \geq 0.
\end{align}
If $g$ satisfies the same property as $f$, then we have Schwartz' inequality for $D$, i.e.,
\begin{align}
 \abs{D (f, g)}^2
 \leq
 D (f, f,) D (g, g).
\end{align}
Furthermore $f \mapsto D (f, f)$ is strictly convex.
\end{thm}
In \cite{LiebLoss1} more properties for the Coulomb potential are explained.
\section{Thomas-Fermi theory}

\subsection{Thomas-Fermi problem}

\subsubsection{Outline}

We turn now to our second example of a variational problem--the Thomas-Fermi (TF) problem.
See \cite{LiebSimon1} for details and further developments.
It goes back to the idea of L. H. Thomas and E. Fermi in 1926 that a large atom,
with many electrons, can be approximately modeled by a simple \textbf{nonlinear} problem for a
`charge density' $\rho (x)$.
We do not derive the energy functional.
See a textbook.

Here we state the mathematical problem.
The potential function $Z / \abs{x}$ that appears in the following can easily be replaced by
\begin{align}
 V (x)
 \defeq
 \sum_{j=1}^{K} \frac{Z_j}{\abs{x - R_j}}
\end{align}
with $Z_j > 0$ and $R_j \in \bbRthree$, but we refrain from doing so in the interest of simplicity.

In \cite{LiebLoss1} the authors leave many steps as an exercise for the reader.
If you want details you should read the original papers, e.g., \cite{LiebSimon1}.

TF theory is defined by an energy function $\calE$ on a certain class of \textbf{non-negative} functions $\rho$ on $\bbRthree$:
\begin{align}
 \calE \rbk{\rho}
 \defeq
 \frac{3}{5} \int_{\bbRthree} \rho (x)^{5/3} dx - \int_{\bbRthree} \frac{Z}{\abs{x}} \rho (x) dx + D \rbk{\rho, \rho}, \label{Lieb-Loss_Analysis_chap11_17}
\end{align}
where $Z > 0$ is a fixed parameter (the charge of the atom's nucleus) and
\begin{align}
 D (\rho, \rho)
 \defeq
 \frac{1}{2} \int_{\bbRthree} \int_{\bbRthree} \rho (x) \rho (y) \frac{1}{\abs{x - y}} dx dy
 =
 \frac{1}{2} \int_{\bbRthree} \rho (x) \rbk{\rho * \frac{1}{\abs{x}}}(x) dx
\end{align}
is the Coulomb energy of a charge density\footnote{指数関数 $2^n$ が前にかかっているのに発散せずに $x$ という有限確定値に収束するのはちょっとした驚きだ.}.
The class of admissible functions is
\begin{align}
 \calC
 =
 \set{\rho}{\rho \geq 0, \rho \in L^1 \rbk{\bbRthree} \bigcap L^{5/3} \rbk{\bbRthree}}.
\end{align}

Our problem is to minimize $\calE (\rho)$ under the condition $\int \rho = N$,
where $N$ is any fixed positive number (identified as the `number' of electrons in the atom).
The case $N=Z$ is special an is called the \textbf{neutral case}.
We define two subsets of $\calC$:
\begin{align}
 \calCN
 \defeq
 \calC \bigcap \set{\rho}{\int_{\bbRthree} \rho = N}
 \subset
 \calCleqN
 \defeq
 \calC \bigcap \set{\rho}{\int_{\bbRthree} \rho \leq N}.
\end{align}
Corresponding to these two sets are two energies: The `constrained' energy
\begin{align}
 E (N)
 \defeq
 \inf \set{\calE \rbk{\rho}}{\rho \in \calCN},
\end{align}
and the `unconstrained' energy
\begin{align}
 E_{\leq}(N)
 \defeq
 \inf \set{\calE \rbk{\rho}}{\rho \in \calCleqN}. \label{Lieb-Loss_Analysis_chap11_18}
\end{align}
Obviously it holds that
\begin{align}
 E_{\leq} (N)
 \leq
 E (N).
\end{align}

The reason for introducing the unconstrained problem will become clear later.
A minimizer will not exist for the constrained problem when $N > Z$:
atoms cannot be negatively charged in TF theory.
But a minimizer will always exist for the unconstrained problem.
It is often advantageous, in variational problems, to relax a problem in order to get at a minimizer;
in fact, we already used this device in the study of the Schr\"odinger equation\footnote{正確にはその内の一番簡単な例.}.
When a minimizer for the constrained problem does exist it will later be seen to be the $\rho$ that is
a minimizer for the unconstrained problem.


\subsubsection{Existence of an unconstrained Thomas-Fermi minimizer}

The main theorem in this section is as follows.
\begin{thm}[Theorem 11.12. \cite{LiebLoss1}]\label{Lieb-Loss_Analysis_chap11_33}
 For each $N > 0$ there is a unique minimizing $\rhoNinfty$ for the unconstrained TF problem (\ref{Lieb-Loss_Analysis_chap11_18}), i.e.,
\begin{align}
 \calE \rbk{\rhoNinfty}
 =
 E_{\leq} (N).
\end{align}
The constrained energy $E (N)$ and the unconstrained energy $E_{\leq} (N)$ are equal.
Moreover $E (N)$ is a convex and non-increasing function of $N$.
\end{thm}
The proof is divided into several steps.
\begin{lem}\textup\{(Theorem II.2. (c) \cite{LiebSimon1})\}\label{Lieb-Loss_Analysis_chap11_19}
 The expression \textup\{(\ref{Lieb-Loss_Analysis_chap11_17})\} is well-defined and finite when $\rho \in \calC$.
 The functional $\calE \rbk{\rho}$ is bounded from below on each $\calC_{\leq N}$.
\end{lem}
\begin{proof}
Write
\begin{align}
 V (x)
 =
 -\frac{1}{\abs{x}}
 =
 V_1 + V_2, \quad V_1 \in L^{5/2}, \quad V_2 \in L^{\infty},
\end{align}
e.g.,
\begin{align}
 V_1 = \chi_{\abs{x} \leq 1} V, \quad
 V_2 = \chi_{\abs{x} > 1} V.
\end{align}
Then, by H\"older's inequality we obtain
\begin{align}
 \int \abs{\rho V} dx
 \leq
 \norm{V_1}_{5/2} \, \norm{\rho}_{5/3} + \norm{V_2}_{\infty} \, \norm{\rho}_1,
\end{align}
and Young's inequality shows that
\begin{align}
 D (\rho, \rho)
 =
 \frac{1}{2} \int \rbk{\rho * \frac{1}{\abs{x}}} \rho dx
 \leq
 \frac{1}{2} \norm{\rho}_1 \rbk{\norm{V_1}_{5/2} \norm{\rho}_{5/3} + \norm{V_2}_{\infty} \norm{\rho}_1},
\end{align}
positive definiteness of $1/\abs{x}$ (Theorem \ref{Lieb-Loss_Analysis_chap11_40}) implies
\begin{align}
 D (\rho, \rho)
 \geq 0,
\end{align}
and, of course,
\begin{align}
 \int \rho^{5/3} dx
 =
 \norm{\rho}_{5/3}^{5/3}.
\end{align}
Summing up we get
\begin{align}
 \EleqN
 \geq
 \frac{3}{5} \norm{\rho}_{5/3}^{5/3} - c_1 \norm{\rho}_{5/3} - c_2 \quad \text{on each } \calC_{\leq N}, \label{Lieb-Loss_Analysis_chap11_21}
\end{align}
where the number $c_1$ is $N$ independent ($\norm{V_1}_{5/2}$) and $c_2$ is $N$ dependent ($ZN \norm{V_2}_{\infty}$).
Since $x^{5/3} - c x$ is bounded from below on $[0, \infty)$, the desired properties hold.
\end{proof}

Let $(\rho_j)$ be a minimizing sequence for $\calE (\rho)$.
\begin{lem}\textup\{(Theorem II.2. (d) \cite{LiebSimon1})\}\label{Lieb-Loss_Analysis_chap11_20}
 The sequence of numbers $(\norm{\rho_j}_{5/3})$ is also bounded.
\end{lem}
\begin{proof}
The inequality (\ref{Lieb-Loss_Analysis_chap11_21}) and the fact that $\set{x}{0 \leq x, \, x^{5/3} - cx \leq d}$ is bounded for each fixed $c$, $d$.
\end{proof}

Therefore, by passing to a sub-sequence we can assume that $\rho_j \wto \rhoNinfty$ in $L^{5/3} (\bbRthree)$ for some $\rhoNinfty \in L^{5/3} (\bbRn)$.
Here we use the Banach-Alaoglu theorem, Theorem \ref{Lieb-Loss_Analysis_chap11_8}.

\begin{lem}\textup\{(Theorem II.13. \cite{LiebSimon1})\}\label{Lieb-Loss_Analysis_chap11_24}
 The functional $\calE (\rho)$ is lower semi-continuous on each $\calC_{\leq N}$ in the weak $L^{5/3} (\bbRthree)$ topology, i.e.,
 if $\rho_j \wto \rhoNinfty$ in weak $L^{5/3}$ with $\sup_j \norm{\rho_j}_1 < \infty$, $\rho \in L^1$, and $\rho_j$, $\rhoNinfty \geq 0$,
 then
\begin{align}
 \calE (\rhoNinfty)
 \leq
 \liminf \calE (\rho_j). \label{Lieb-Loss_Analysis_chap11_22}
\end{align}
Moreover, if $\calE (\rhoNinfty) = \lim \calE (\rho_j)$, then $\norm{\rho_j - \rhoNinfty}_{5/3} \to 0$ and
each term in $\calE (\rho_j)$ converges to the corresponding term in $\calE (\rhoNinfty)$.
\end{lem}
\begin{proof}
By passing to a sub-sequence, we can suppose that $\lim \calE (\rho_j)$ exists and we may as well suppose the limit is finite
since (\ref{Lieb-Loss_Analysis_chap11_22}) is trivial otherwise.
Then by Lemma \ref{Lieb-Loss_Analysis_chap11_20} it follows that $\sup_j \norm{\rho_j}_{5/3} < \infty$.

First claim for (\ref{Lieb-Loss_Analysis_chap11_22}):
\begin{align}
 \norm{\rhoNinfty}_{5/3}
 \leq
 \liminf \norm{\rho_j}_{5/3}.
\end{align}
This is due to the lower semi-continuity of norms.
For explicit proof, noting that $\rhoNinfty^{2/3} \in L^{5/2}$, the definition of weak convergence and H\"older's inequality leads
\begin{align}
 \int \rhoNinfty^{5/3} dx
 =
 \limjtoinfty \int \rho_j \rhoNinfty^{2/3} dx
 \leq
 \norm{\rhoNinfty}_{5/3}^{2/3} \liminf \norm{\rho_j}_{5/3}.
\end{align}

Second claim for (\ref{Lieb-Loss_Analysis_chap11_22}):
\begin{align}
 \lim \int \rho_j V
 =
 \int \rhoNinfty V.
\end{align}
Write $V = V_1 + V_2$ with $V_1 \in L^{5/2}$ and $V_2 \in L^p$ ($5/2 < p < \infty$).
H\"older's inequality shows that
\begin{align}
 \int V_1 \rho_j \to \int V_1 \rhoNinfty.
\end{align}
The following Lemma \ref{Lieb-Loss_Analysis_chap11_23} implies $\rho_j \wto \rhoNinfty$ in weak $L^q$ ($1 < q \leq 5/3$) sense.
Hence it holds that
\begin{align}
 \int V_2 \rho_j \to \int V_2 \rhoNinfty.
\end{align}

Third claim for (\ref{Lieb-Loss_Analysis_chap11_22}):
\begin{align}
 D (\rhoNinfty, \rhoNinfty)
 \leq
 \liminf D \rbk{\rho_j, \rho_j}.
\end{align}
We use positive definiteness of $\abs{x}^{-1}$, Theorem \ref{Lieb-Loss_Analysis_chap11_40} and the resulting Schwartz inequality.
Since $\rho \in L^1$ and $\abs{x}^{-1} \in L^{5/2} + L^4$, Young's inequality shows that $\rho * \abs{x}^{-1} \in L^{5/2} + L^4$.
Since the Lemma \ref{Lieb-Loss_Analysis_chap11_23} leads that $\rho_j \wto \rhoNinfty$ both in $L^{5/3}$ and $L^{4/3}$,
we obtain
\begin{align}
 D (\rhoNinfty, \rho_j)
 &=
 \int \rbk{\rhoNinfty * \frac{1}{\abs{x}}} \rho_j dx \\
 &\to
 \int \rbk{\rhoNinfty * \frac{1}{\abs{x}}} \rhoNinfty dx
 =
 D (\rhoNinfty, \rhoNinfty).
\end{align}
Therefore
\begin{align}
 D \rbk{\rhoNinfty, \rhoNinfty}
 &=
 \limjtoinfty D \rbk{\rhoNinfty, \rho_j} \\
 &\leq
 \liminf \rbk{D\rbk{\rhoNinfty, \rhoNinfty}^{1/2} D \rbk{\rho_j, \rho_j}^{1/2}},
\end{align}
where we use Schwartz' inequality in the final step.

The above three estimates imply that if $\calE (\rhoNinfty) = \lim \calE (\rho_j)$, then each term of $\calE (\rhoNinfty)$
converges and in particular $\lim \norm{\rho_j}_{5/3} = \norm{\rhoNinfty}_{5/3}$.
Since $L^{5/3}$ is uniformly convex, convergence of norms and weak convergence implies norm convergence.
\end{proof}

Here we show the Lemma used in the above Lemma.
\begin{lem}\label{Lieb-Loss_Analysis_chap11_23}
 If a sequence of functions $(f_j) \subset L^{1} \bigcap L^{5/3}$ weakly converges to $f$ in $L^{5/3}$ and is bounded in $L^{5/3}$,
 then there exists a sub-sequence $(f_{j_k})$ such that
\begin{align}
 f_{j_k} \wto f \quad \mathrm{in} \quad L^q,
\end{align}
where $q \in (1, 5/3]$.
\end{lem}
\begin{proof}
We assume $q \in (1, 5/3)$.
Set a number $\alpha$ as follows:
\begin{align}
 \frac{1}{q}
 =
 \alpha + (1 - \alpha) \frac{3}{5}, \quad \text{i.e.,} \quad
 \alpha
 =
 \frac{5}{2} \rbk{\frac{1}{q} - \frac{3}{5}} \in \rbk{0, 1}.
\end{align}
Note that
\begin{align}
 q \alpha < 1, \quad q (1 - \alpha) \frac{3}{5} < 1,
\end{align}
and that
\begin{align}
 \abs{f_j}^{q}
 =
 \abs{f_j}^{q \alpha} \abs{f_j}^{q (1 - \alpha)}, \quad
 \abs{f_j}^{q \alpha} \in L^{\frac{1}{q \alpha}}, \quad
 \abs{f_j}^{q (1 - \alpha)} \in L^{\frac{5}{3} \frac{1}{(1 - \alpha) q}}.
\end{align}
Then H\"older's inequality implies that
\begin{align}
 \int \abs{f_j}^q
 &\leq
 \int \abs{f_j}^{q \alpha} \abs{f_j}^{q (1 - \alpha)} \\
 &\leq
 \rbk{\int \abs{f_j}}^{q \alpha} \rbk{\int \abs{f_j}^{5/3}}^{\frac{3}{5} (1 - \alpha) q}
 =
 \norm{f_j}_{1}^{q \alpha} \norm{f_j}_{5/3}^{(1 - \alpha) q}.
\end{align}
Hence we obtain
\begin{align}
 \norm{f_j}_{q}
 \leq
 \norm{f_j}_{1}^{\alpha} \norm{f_j}_{5/3}^{1 - \alpha}
 \leq
 \rbk{\sup \norm{f_j}_{1}}^{\alpha} \rbk{\sup \norm{f_j}_{5/3}}^{1 - \alpha}.
\end{align}
The Banach-Alaoglu theorem \ref{Lieb-Loss_Analysis_chap11_8} implies our assertion.
\end{proof}

We return to the main path.
From The Lemma \ref{Lieb-Loss_Analysis_chap11_24}, the function $\rhoNinfty$ is a minimizer because we can deduce now
\begin{align}
 \EleqN
 =
 \limjtoinfty \calE (\rho_j)
 \geq
 \calE (\rhoNinfty)
 \geq
 \EleqN.
\end{align}

Next we show the
\begin{lem}\label{Lieb-Loss_Analysis_chap11_38}
 The above $\rhoNinfty$ is unique.
\end{lem}
To do this we need the following
\begin{lem}\textup\{(Theorem II.6. \cite{LiebSimon1}.)\}\label{Lieb-Loss_Analysis_chap11_25}
 The functional $\calE (\rho)$ is s strictly convex functional of $\rho$ on the convex set $\calC_{\leq N}$.
 Furthermore $\EleqN$ is non-increasing.
\end{lem}
\begin{proof}
Write
\begin{align}
 \calE (\rho)
 =
 K (\rho) - A (\rho) + R (\rho)
\end{align}
corresponding to the three terms in the definition (\ref{Lieb-Loss_Analysis_chap11_21}) of $\calE (\rho)$.
The functional $A (\rho)$ is linear and $K (\rho)$ is strictly convex
since $f (x) = x^{5/3}$ is strictly convex on $[0, \infty)$.
Finally $R (\rho)$ is strictly convex since $\abs{x}^{-1}$ is strictly positive definite by Theorem \ref{Lieb-Loss_Analysis_chap11_40}.
\end{proof}

\begin{proof}
We start the proof for Lemma \ref{Lieb-Loss_Analysis_chap11_41}.
Assume there were two different minimizers $\rho^1$ and $\rho^2$ in $\calC_{\leq N}$.
Then $\rho = (\rho^1 + \rho^2) / 2$, which is also in $\calC_{\leq N}$, has strictly lower energy than $\EleqN$,
which is a contradiction.
This reasoning also shows that $\EleqN$ is a convex function.
It is a simple consequence of its definition that $\EleqN$ is non-increasing.
This is the end of the proof for Lemma \ref{Lieb-Loss_Analysis_chap11_38}.
\end{proof}

By definition we have
\begin{align}
 \EleqN
 \leq
 E (N).
\end{align}
\begin{lem}
 It holds that
 \begin{align}
  \EleqN = E (N),
 \end{align}
 i.e, we can show that
 \begin{align}
  E (N) \leq \EleqN.
 \end{align}
\end{lem}
\begin{proof}
We can suppose that $\int \rhoNinfty = M < N$, for otherwise the desired conclusion is immediate.
Take any non-negative function $g \in L^{5/3} \bigcap L^{1}$ with
\begin{align}
 \int g = N - M
\end{align}
and consider, for each $\lambda > 0$, the function
\begin{align}
 \rho_{\lambda} (x)
 \defeq
 \rhoNinfty (x) + \lambda^3 g (\lambda x).
\end{align}
As $\lambda \to 0$, $\rho_{\lambda} \sto \rhoNinfty$ in every $L^p$ with $p \in (1, 5/3]$.
Therefore we have $\calE (\rho_{\lambda}) \to \calE (\rhoNinfty)$.
On the other hand it holds that $\calE (\rho_{\lambda}) \geq E (N)$,
and hence $E (N) \leq \EleqN$.
Here we use the fact that our domain is the whole of $\bbRthree$.
\end{proof}

Note that we travel around (infinitely) many $L^p$ spaces and use many useful and important properties for them!.
\subsubsection{Thomas-Fermi equation}

\begin{thm}[Theorem 11.13 \cite{LiebLoss1}, Theorem II.10. \cite{LiebSimon1}]\label{Lieb-Loss_Analysis_chap11_34}
 The minimizer of the unconstrained problem, $\rhoNinfty$, is not the zero function and
 it satisfies the following equation, in which $\mu \geq 0$ is some constant that depends on $N$:
\begin{align}
 \rhoNinfty (x)^{2/3}
 &=
 \frac{Z}{\abs{x}} - \rbk{\frac{1}{\abs{x}} * \rhoNinfty} (x) - \mu & \mathrm{if} \,\, \rhoNinfty (x) > 0, \label{Lieb-Loss_Analysis_chap11_31} \\
 0
 &\geq
 \frac{Z}{\abs{x}} - \rbk{\frac{1}{\abs{x}} * \rhoNinfty} (x) - \mu & \mathrm{if} \,\, \rhoNinfty (x) = 0. \label{Lieb-Loss_Analysis_chap11_29}
\end{align}
\end{thm}
\begin{rem}
 An equivalent way to write the above is
 \begin{align}
  \rhoNinfty (x)^{2/3}
  =
  \sqbk{\frac{Z}{\abs{x}} - \rbk{\frac{1}{\abs{x}} * \rhoNinfty} (x) - \mu}_{+}. \label{Lieb-Loss_Analysis_chap11_32}
 \end{align}
\end{rem}
\begin{proof}
Clearly $\EleqN$ is strictly negative because we can easily construct some small $\rho$ for which $\calE (\rho) < 0$.
This implies that $\rhoNinfty \neq 0$ as a function.

For any real-valued function $g \in L^{5/3} \bigcap L^1$ and all $t \in [0, 1]$ consider the family of functions
\begin{align}
 \rho_t (x)
 \defeq
 \rhoNinfty (x) + t \rbk{ g (x) - \frac{\int g}{\int \rhoNinfty} \rhoNinfty (x)},
\end{align}
which are defined since $\rhoNinfty \neq 0$.
Clearly $\int \rho_t = \int \rhoNinfty$ and it is easy to check that $\rho_t \geq 0$ for all $t \in \sqbk{0, 1}$
provided that $g$ satisfies the two conditions:
\begin{align}
 g (x) \geq - \frac{\rhoNinfty}{2}, \quad
 -\int g \geq - \frac{1}{2} \int \rhoNinfty.
\end{align}
Define the function
\begin{align}
 F (t)
 \defeq
 \calE \rbk{\rho_t},
\end{align}
which certainly has the property that
\begin{align}
 \EleqN
 \leq
 F (t),
 \quad \forall t \in \sqbk{0, 1}. \label{Lieb-Loss_Analysis_chap11_27}
\end{align}
We check the differentiability of $F$:
1) the $\int \rho^{5/3}$ term is differentiable by Theorem \ref{Lieb-Loss_Analysis_chap11_26} (Gateaux derivative),
2) the second and third term in the expression (\ref{Lieb-Loss_Analysis_chap11_17}) are trivially differentiable
   since they are polynomials in $t$.
Since $F (0) = \EleqN$ and $F$ must be non-decreasing at $t=0$, it follows that
\begin{align}
 F'(0)
 \geq 0.
\end{align}
Define the function
\begin{align}
 W (x)
 \defeq
 \rhoNinfty^{2/3}(x) - \frac{Z}{\abs{x}} + \rbk{\frac{1}{\abs{x}} * \rhoNinfty} (x)
\end{align}
and set
\begin{align}
 \mu
 \defeq
 -\frac{\int \rhoNinfty (x) W (x) dx}{\int \rhoNinfty (x) dx}. \label{Lieb-Loss_Analysis_chap11_30}
\end{align}
Since
\begin{align}
 \frac{d}{dt} \int \rho_t (x)^{5/3} dx \Big |_{t = 0}
 &=
 \frac{5}{3} \int \rhoNinfty (x)^{2/3} \rbk{g (x) - \frac{\int g}{\int \rhoNinfty} \rhoNinfty (x)} dx, \\
 \frac{d}{dt} \int \frac{1}{\abs{x}} \rho_t (x) dx \Big |_{t = 0}
 &=
 \int \frac{1}{\abs{x}} \rbk{g (x) - \frac{\int g}{\int \rhoNinfty} \rhoNinfty (x)} dx, \\
 \frac{d}{dt} D \rbk{\rho_t, \rho_t} \Big |_{t = 0}
 &=
 \int \rbk{\rhoNinfty * \frac{1}{\abs{x}}} (x) \rbk{g (x) - \frac{\int g}{\int \rhoNinfty} \rhoNinfty (x)} dx,
\end{align}
it holds that
\begin{align}
 0 \leq
 \frac{d}{dt} F (t) \Big |_{t = 0}
 &=
 \int W (x) \rbk{g (x) - \frac{\int g}{\int \rhoNinfty} \rhoNinfty (x)} dx \\
 &=
 \int W (x) g (x) dx + \int g (x) dx \int \frac{- W (x) \rhoNinfty (x)}{\int \rhoNinfty} dx \\
 &=
 \int g (x) \rbk{W (x) + \mu} dx \label{Lieb-Loss_Analysis_chap11_28}
\end{align}
for all functions $g$ with the properties stated above.

In particular (\ref{Lieb-Loss_Analysis_chap11_28}) holds for all non-negative functions $g$ with
\begin{align}
 \int g \leq \frac{1}{2} \int \rhoNinfty,
\end{align}
and hence (\ref{Lieb-Loss_Analysis_chap11_28}) holds for all non-negative functions in $L^{5/3} \bigcap L^{1}$.
From this it follows that $W (x) + \mu \geq 0$ a.e., which yields (\ref{Lieb-Loss_Analysis_chap11_29}).
From (\ref{Lieb-Loss_Analysis_chap11_30}) we see that $- \mu$ is the average of $W$ with respect to the measure $\rhoNinfty (x) dx$,
and hence the condition $W (x) + \mu \geq 0$ forces us to conclude that
\begin{align}
 W (x) + \mu = 0 \quad \forall x \in \set{x}{\rhoNinfty (x) > 0};
\end{align}
this proves (\ref{Lieb-Loss_Analysis_chap11_31}).

The last task is to prove that $\mu \geq 0$.
If $\mu < 0$ then (\ref{Lieb-Loss_Analysis_chap11_31}) implies that for $\abs{x} > - \mu / Z$, $\rhoNinfty (x)^{2/3}$ equals
an $L^6$-function plus a constant function, i.e., $- \mu$.
It $\rhoNinfty$ had this property it could not be in $L^1$.
\end{proof}

The Thomas-Fermi equation (\ref{Lieb-Loss_Analysis_chap11_32}) reveals many interesting properties of $\rhoNinfty$
and we refer the reader to \cite{LiebSimon1} for this theory.
\subsubsection{The Thomas-Fermi minimizer \label{Lieb-Loss_Analysis_chap11_39}}

\begin{thm}[Theorem 11.14. \cite{LiebLoss1}]
 As before the function $\rhoNinfty$ be the minimizer for the unconstrained problem.
 Then it holds that
 \begin{align}
  \int_{\bbRthree} \rhoNinfty (x) dx
  &=
  N \quad \mathrm{if} \quad 0 < N \leq Z, \\
  \rhoNinfty
  &=
  \rho_{Z, \infty} \quad \mathrm{if} \quad N \geq Z.
 \end{align}
 In particular the former implies that $\rhoNinfty$ is the minimizer for the constrained problem when $N \leq Z$.
 If $N > Z$, there is no minimizer for the constrained problem.

 The number $\mu$ in \textup{(\ref{Lieb-Loss_Analysis_chap11_32})} is $0$ if and only if $N \geq Z$ and in this case
 $\rhoNinfty (x) = \rho_{Z, \infty} > 0$ for all $x \in \bbRthree$.

 The \upbf{Thomas-Fermi potential} $\Phi_N$ defined by
 \begin{align}
  \Phi_N (x)
  \defeq
  \frac{Z}{\abs{x}} - \rbk{\frac{1}{\abs{x}} * \rhoNinfty} (x)
 \end{align}
 satisfies $\Phi_N (x) > 0$ for all $x \in \bbRthree$.
 Hence, when $\mu = 0$, corresponding to $N = Z$, the TF equation becomes
 \begin{align}
  \rho_{Z, \infty} (x)^{2/3}
  =
  \Phi_Z (x). \label{Lieb-Loss_Analysis_chap11_35}
 \end{align}
\end{thm}
\begin{proof}
We shall start by proving that there is a minimizer for the constrained problem if and only if $\int \rhoNinfty = N$,
in which case the minimizer is then obviously $\rhoNinfty$.
If $\int \rhoNinfty = N$, then $\rhoNinfty$ is a minimizer for $E (N)$.
If the $E (N)$ problem has a minimizer (call it $\rho^N$), then $\int \rho^N = N$ and,
by the monotonicity statement in Lemma \ref{Lieb-Loss_Analysis_chap11_38}, $\rho^N$ is a minimizer for the unconstrained problem.
Since this minimizer is unique $\rho^N = \rhoNinfty$.

Now suppose that there is some $M > 0$ for which $M > \int \rho_{M, \infty} =: N_c$
(we shall soon see that $N_c = Z$).
By uniqueness, we have that $E (M) = E (N_c)$.
Then two statements are true:
1) $\int \rhoNinfty = N_c$ and $\rhoNinfty = \rho_{N_c, \infty}$ for all $N \geq N_c$, and
2) $\int \rhoNinfty = N$ for all $N \leq N_c$.
To prove the former suppose that $N \geq N_c$.
We shall show that $E (N) = E (N_c)$ (recall that $E (N) = \EleqN$),
and hence that $\rhoNinfty = \rho_{N_c, \infty}$ by uniqueness.
Clearly $E (N) \leq E (N_c)$.
If $E (N) < E (N_c)$ and if $N<M$, we have a contradiction with the monotonicity of the function $E$.
If $E (N) < E (N_c)$ and if $N > M$, we have a contradiction with the convexity of the function $E$.
Thus $E (N) = E (N_c)$ and the former statement is proved.
The latter statement follows from the former,
for suppose that $\int \rhoNinfty =: P < N$.
Then the conclusion of the former holds with $N_c$ replaced by $P$ and $M$ replaced by $N$.
Thus, by the former, $\int \rho_{Q, \infty} = P$ for all $Q \geq P$.
By choosing
\begin{align}
 Q = N_c \geq N \geq P,
\end{align}
we find that $N_c = \int \rho_{N_c} = P$, which is a contradiction.

We have to show that $N_c = Z$ and this will be done in conjunction with showing the non-negativity of the TF potential.

Let
\begin{align}
 A
 =
 \set{x \in \bbRthree}{\Phi_N (x) < 0}.
\end{align}
By Lemma \ref{Lieb-Loss_Analysis_chap11_38},
$\Phi_N$ is continuous away from $x=0$ and vanishes uniformly as $\abs{x} \to \infty$.
Hence $A$ is an open set.
In some small neighborhood of $x=0$, $\Phi_N (x)$ is clearly positive, so $0 \notin A$.
From the TF equation with $\mu \geq 0$,
we see that $\rhoNinfty (x) = 0$ for $x \in A$.
But
\begin{align}
 \Delta \Phi_N = 4 \pi \rhoNinfty = 0 \quad \text{in}  \quad A,
\end{align}
and Theorem 9.3 in \cite{LiebLoss1} tells us that $\Phi_N$ is harmonic in $A$.
Since $\Phi_N$ is continuous, $\Phi_N$ vanishes on the boundary of $A$.
Since $\Phi_N$ also vanishes uniformly at $\infty$, the strong maximum principle, Theorem 9.4 in \cite{LiebLoss1},
states that $\Phi_N = 0$ for $x \in A$.
Thus $A$ is empty, as claimed.
We omit the proof that $\Phi_N$ is strictly positive as an exercise.

Let $N > Z$ and consider the unconstrained optimizer $\rhoNinfty$.
We claim that $\int \rhoNinfty \leq Z$.
By the fact that $\rhoNinfty$ is a radial function we get from equation 9.7 (5) \cite{LiebLoss1} (Newton's theorem),
that
\begin{align}
 \rbk{\frac{1}{\abs{x}} * \rhoNinfty} (x)
 =
 \frac{1}{\abs{x}} \int_{\abs{y} \leq \abs{x}} \rhoNinfty (y) dy
  +\int_{\abs{y} > \abs{x}} \frac{1}{\abs{y}} \rhoNinfty (y) dy.
\end{align}
From this and the definition of $\Phi_N$ it follows easily that $\lim_{\abs{x} \to \infty} \abs{x} \Phi_N (x) = Z - \int \rhoNinfty$.
Hence $\int \rhoNinfty \leq Z$, for otherwise it would contradict the positivity of $\Phi_N$.
Thus, for $N > Z$ the constrained TF problem does not have a minimizer and we conclude that $N_c \leq Z$.

Because $E (N_c)$ is the absolute minimum of $\calE (\rho)$ on $\calC$,
and because $\rho_{N_c, \infty}$ is the absolute minimizer, a proof analogous to that of Theorem \ref{Lieb-Loss_Analysis_chap11_33}
(indeed, an even simpler proof), shows that this $\rho_{N_c, \infty}$ satisfies the TF equation with $\mu = 0$.
Since $\Phi_N$ is non-negative, this is the equation (\ref{Lieb-Loss_Analysis_chap11_35}) with $\rho_{Z, \infty}$ replaced by $\rho_{N_c, \infty}$.
We have seen that $\Phi_N (x)$ behaves like $(Z - N_c)/ \abs{x}$ for large $\abs{x}$.
If $N_c < Z$, then, from (\ref{Lieb-Loss_Analysis_chap11_35}), $\rho_{N_c, \infty} \notin L^{5/3}$, which is a contradiction.
\end{proof}
\chapter{Talk: Analysis for the Friedrichs model: perturbation theory for embedded eigenvalues}

手書きのメモしかないので, そのうち \TeX{} におこす.
\chapter{Brief introduction to theory of distribution}

I will translate.
\chapter{Short summary for theory of Hilbert spaces}

\section{Introduction}

院試勉強のときに暗記用に作った原稿です.\footnote{From a yukimi's page, \url{http://yukimigo.com/math/}.
The original version is reprinted with the written consent of the author.}
なのであんまり読めるものじゃない感ありますが, 証明の参照用に.


\section{内積空間}

\begin{defn}[内積空間]
$H$ を線型空間とする.
以下を満たす $\bkt{x}{y}_{H} \colon H \times H \to \bbC$ を
$H$ の\textbf{内積}(inner product) といい,
内積が定義されている線型空間 $H$ を\textbf{内積空間}という.

以下 $x, y \in H$, $\alpha, \beta \in \bbC$ とする.
1) \textup{Linearity:}
  \begin{align}
   \bkt{x}{\alpha y_1 + \beta y_2} = \alpha \bkt{x}{y_1} + \beta \bkt{x}{y_2}.
  \end{align}
2) \textup{Symmetry:}
  \begin{align}
   \bkt{x}{y} = \overline{\bkt{y}{x}}.
  \end{align}
3) \textup{Positive definiteness:}
  \begin{align}
   \bkt{x}{x} \geq 0, \quad
   \bkt{x}{x} = 0 \Longleftrightarrow x = 0.
  \end{align}
\end{defn}

\begin{thm}[Schwarz's inequality]\label{functional_analysis_hilbert_space_yukimi_Schwarz}
 $H$ を内積空間とする.
 任意の $x, y \in H$ に対して
\begin{align}
 \abs{\bkt{x}{y}}
 \leq
 \norm{x} \, \norm{y}.
\end{align}
\end{thm}
\begin{proof}
$y \neq 0$ とする.
$\alpha \defeq - \bkt{y}{x} / \abs{y}^2$ とすると,
$0 \leq \norm{x + \alpha y} = \abs{x}^2 - \abs{\bkt{x}{y}}^2 / \norm{y}^2$ からしたがう.
\end{proof}

\begin{defn}
 可算集合 $\cbk{x_n}_{n} \subset H$ が $\bkt{x_n}{x_m} = \delta_{n,m} $ を満たすとき \upbf{ONS (Orthonormal system)} という.
 集合 $\ell^2$ を次のように定義する.
 \begin{align}
  \ell^2
  \defeq
  \set{a = \rbk{a_1, a_2, \dots}}{\sum_{n=1}^{\infty} \abs{a_n}^2 < \infty}.
 \end{align}
 ここで
 \begin{align}
  (a+b)^2
  \leq
  2^2 \rbk{\max (a,b)}^2
  \leq
  2^2 (a^2 + b^2)
 \end{align}
 だから $\ell^2$ は線型空間となり,
 内積を次のように定義することで内積空間となる.
 \begin{align}
  \bkt{a}{b}_{\ell^2}
  \defeq
  \sum_{n = 1}^\infty \overline{a_{n}}b_{n}
 \end{align}
\end{defn}
\begin{ex}
 $\ell^2$ で $e_{n} \defeq \cbk{\delta_{n,j}}_{j = 1}^\infty$ の集合 $\cbk{e_{n}}_{n=1}^\infty$ は ONS.
\end{ex}
\begin{ex}\label{functional_analysis_hilbert_space_yukimi_ons}
 任意の $H$ の ONS $\cbk{x_{n}}_{n}^N$ と $\alpha_{n} \in \bbC$ に対して
 $\abs{\sum_{n = 1}^N \alpha_{n} x_{n}}^2 = \sum_{n = 1}^N \abs{\alpha_{n}}^2$ となる.
\end{ex}

\begin{thm}[Bessel's inequality]\label{functional_analysis_hilbert_space_yukimi_Bessel}
 $\cbk{x_{n}}_{n = 1}^N$ を $H$ の ONS とするとき,
 すべての $x \in H$ に対して, $\sum_{n=1}^N \abs{\bkt{x_n}{x}}^2 \leq \norm{x}^2$ がなりたつ.
\end{thm}
\begin{proof}
$y = \sum_{n=1}^N \bkt{x_n}{x} x_{n}$ とおくと,
$x_{n}$ が ONS と例\ref{functional_analysis_hilbert_space_yukimi_ons}から
$\norm{y}^2 = \sum_{n=1}^N \abs{\bkt{x_n}{x}}^2$ となって,
\begin{align}
 \bkt{y}{x}
 =
 \bkt{\sum_{n=1}^N \bkt{x_n}{x} x_n}{x}
 =
 \sum_{n=1}^N \overline{\bkt{x_n}{x}} \bkt{x_n}{x}
 =
 \sum_{n=1}^N \abs{\bkt{x_n}{x}}^2
\end{align}
となるから,
\begin{align}
 \bkt{y}{x - y}
 =
 \bkt{y}{x} - \norm{y}^2
 =
 \sum_{n=1}^N \abs{\bkt{x_n}{x}}^2 - \sum_{n=1}^N \abs{\bkt{x_n}{x}}^2
 = 0.
\end{align}
つまり $y$ と $x-y$ は直交している.
$x = y + (x-y)$ を二乗して
\begin{align}
 \norm{x}^2
 =
 \norm{y}^2 + \norm{x - y}^2
 \geq
 \norm{y}^2
 =
 \abs{\bkt{x_n}{x}}^2
\end{align}
となり証明できた.
\end{proof}

\begin{cor}
 $\cbk{x_n}_{n=1}^\infty$ を $H$ の ONS とするとき,
 すべての $x \in H$ に対して $\sum_{n=1}^\infty \abs{\bkt{x_n}{x}}^2$ は収束し,
 \begin{align}
  \sum_{n = 1}^\infty \abs{\bkt{x_n}{x}}|^2
  \leq
  \abs{x}^2
 \end{align}
 がなりたつ.
 とくに $\lim_{n \to \infty} \bkt{x_n}{x} = 0$.
\end{cor}
\begin{proof}
$a_{N} \defeq \sum_{n=1}^N \abs{\bkt{x_n}{x}}^2$ とおけば,
$\cbk{a_N}_{N=1}^\infty$ は正項級数だから単調非減少で, Bessel's inequality から有界なので収束する.
\end{proof}

\begin{ex}
 任意の $a = \cbk{a_{n}}_{n}^\infty \in \ell^2$ に対して $a^{(N)} \in \ell^2$ を
 \begin{align}
  \rbk{a^{(N)}}_{n}
  \defeq
  \begin{cases}
   a_{n} & \text { $1\leq n\leq N$ のとき} \\
   0     & \text { $n\geq N+1$ のとき}
  \end{cases}
 \end{align}
 とおくと, $a_{n} \in \ell^2 $ だから
 \begin{align}
  \norm{a^{(N)} - a}^2
  =
  \sum_{n = N + 1}^\infty \abs{a_{n}}^2
  \longrightarrow 0, \quad N \longrightarrow \infty
 \end{align}
 となる.
\end{ex}

\begin{defn}
任意の $n$ 個の線型独立なベクトルがあるとき, その空間は\textbf{無限次元}という.
\end{defn}
\begin{ex}
 $\ell^2$ は無限次元空間である.
 じっさい, $ e_{n} \defeq \cbk{\delta_{n,j}}_{j=1}^\infty$ とおくと,
 任意の $n \in \bbN$ に対して $e_{1}, \dots, e_{n}$ は線型独立である.
\end{ex}

\begin{defn}
 完備な内積空間を \upbf{Hilbert 空間}という.
\end{defn}
\begin{thm}
 $\ell^2$ は複素 Hilbert 空間である.
\end{thm}
\begin{proof}
$\cbk{a (n)}$ を $\ell^2$ の Cauchy 列とする.
$a(n) \defeq \cbk{a (n)_{j}}$ とすれば,
\begin{equation}
 \sum_{j=1}^k \abs{a (n)_{j}\ - a (m)_{j}}^2
 \leq
 \norm{a (n) - a (m)}^2
 \longrightarrow 0 \label{functional_analysis_hilbert_space_yukimi_1}
\end{equation}
となるから $\cbk{a (n)_{j}}_{n}^\infty$ は $\bbC$ の Cauchy 列で,
$\bbC$ の完備性より $a_{j} \in \bbC$ があって $a (n)_{j} \longrightarrow a_{j}$ となる.
$a \defeq \cbk{a_{j}}_{j}^\infty$ とおく.
(\ref{functional_analysis_hilbert_space_yukimi_1}) から任意の $\varepsilon > 0$ に対してある番号 $N$ があって
$m, n \geq N$ で $\norm{a (n) - a (m)}^2 < \varepsilon^2$ とできるから,
$m \longrightarrow \infty$ として $\lim_{k \to \infty}$ とすると, $n \geq N$ について
\begin{equation}
 \sum_{j=1}^\infty \abs{a (n)_{j} - a_{j}}^2
 \leq
 \varepsilon^2 \label{functional_analysis_hilbert_space_yukimi_2}
\end{equation}
よって,
\begin{align}
 \abs{a_{j}}^2
 \leq
 2 \rbk{\abs{a_j - a(n)_j}^2 + \abs{a(n)_{j}}^2}
\end{align}
より
\begin{align}
 \sum_{j=1}^\infty \abs{a_{j}}^2
 \leq
 2 \rbk{\sum_{j=1}^\infty \abs{a_{j} -a (n)_{j}}^2 + \sum_{j=1}^\infty \abs{a (n)_{j}}^2}
 \leq
 2 \rbk{\varepsilon^2 + \sum_{j=1}^\infty \abs{a (n)_{j}}^2}
 <
 \infty
\end{align}
だから $a \in \ell^2$.
(\ref{functional_analysis_hilbert_space_yukimi_2}) から
$\norm{a(n) - a}^2 \leq \varepsilon^2$
なので $a(n) \longrightarrow a \in \ell^2$.
よって $\ell^2$ は完備である.
\end{proof}

今後 $H$ は Hilbert 空間をあらわすことにする.
\begin{lem}\label{functional_analysis_hilbert_space_yukimi_5}
 $D \subset H$ を部分集合とすると, $D^{\perp}$ は閉部分空間である.
\end{lem}
\begin{proof}
$\cbk{x_n}_n \subset D^{\perp}$, $x_n \to x \in H$ とする.
内積の連続性から $y \in D$ に対して $\bkt{x_n}{y} \to \bkt{x}{y}$ となる.
$x_{n} \in D^{\perp}$ から $\bkt{x_n}{y} = 0$ となり, $\bkt{x}{y} = 0$.
よって $x \in D^{\perp}$ となる.
\end{proof}
\section{直交性}

\begin{thm}[射影定理]
 $L \subset H$ を閉部分空間とするとき, 任意の $x \in H$ は
 \begin{align}
  x
  =
  y + z \quad (y \in L, z \in L^{\perp})
 \end{align}
 と一意的に分解できる.
 $y$ を $x$ の $L$ 上への射影という.
 各 $x \in H$ に $y$ を対応させる写像を $P_{L}$ とかく.
 つまり $y = P_{L}x$.
\end{thm}
\begin{proof}
\textbf{一意性:}
$x = y + z = y' + z' (y, y'\in L, z, z'\in L^{\perp})$ とすると,
$y - y' = z - z'$ で左辺は $L$, 右辺は $L^{\perp}$ の元だから,
$\norm{y - y'}^2 = \bkt{z' - z}{y - y'} = 0$ だから $y = y' $, $z = z'$ となって一意であることがわかった.

\textbf{分解可能性:}
$\delta \defeq \inf \set{\norm{x - \xi}}{\xi \in L}$ とおくと,
下限の性質から, ある $\xi_{n} \in L$ があって
\begin{equation}
 \norm{x - \xi_n}
 \longrightarrow
 \delta \label{functional_analysis_hilbert_space_yukimi_3}
\end{equation}
とできる.
中線定理
\begin{align}
 \norm{x + y}^2 + \norm{x - y}^2
 =
 2 \rbk{\norm{x}^2 + \norm{y}^2}
\end{align}
を使って,
\begin{equation}
 \norm{\rbk{x - \xi_n} + \rbk{x - \xi_m}}^2 + \norm{\rbk{x - \xi_n} - \rbk{x - \xi_m}}^2
 =
 2 \norm{x - \xi_n}^2 + 2 \norm{x - \xi_m}^2 \label{functional_analysis_hilbert_space_yukimi_4}
\end{equation}
となる.
$L$ が部分空間だから, $\rbk{\xi_{n} + \xi_{m}} / 2 \in L$ となって,
\begin{align}
 \delta^2
 \leq
 \norm{x - \rbk{\xi_{n} + \xi_{m}/2}}^2.
\end{align}
(\ref{functional_analysis_hilbert_space_yukimi_4}) から
\begin{align}
 0
 &\leq
 \norm{\xi_n \xi_m}^2
 &=
 2 \norm{x - \xi_n}^2 + 2 \norm{x - \xi_m}^2 - 4 \norm{x - \frac{\rbk{\xi_n + \xi_m}}{2}}^2
 \leq
 2 \norm{x - \xi_n} + 2 \norm{x - \xi_m}^2 - \delta^2
\end{align}
となる.
(\ref{functional_analysis_hilbert_space_yukimi_3}) に注意して
$n, m \to \infty$ とすると,
右辺 $\to 4 \delta^2 - 4\delta^2 = 0$ となるから,
$\cbk{\xi_{n}}$ は $H$ の Cauchy 列.
よってある $y \in H$ で $\xi_{n} \to y$ とできる.
いま $L$ が閉と $\xi_{n} \in L$ から $y \in L$ である.
よってノルムの連続性により $\norm{x - \xi_{n}} \to \norm{x - y}$ となるから,
(\ref{functional_analysis_hilbert_space_yukimi_3}) より
\begin{align}
 \delta
 =
 \norm{x - y}
\end{align}
がわかった.

$z \defeq x - y$ とおいてこれが $L$ と直交していることをみる.
\begin{align}
 \phi(t)
 \defeq
 \norm{z - \gamma t \xi}^2, \quad
 \gamma \defeq \bkt{\xi}{z}, \quad
 t\in \mathbb{R}
\end{align}
とおくと, $L$ が部分空間であることから $y + \gamma t\xi \in L$ なので,
\begin{align}
 \delta^2
 =
 \phi (0)
 \leq
 \phi (t)
 =
 \norm{z}^2 - 2 \abs{\gamma}^2 t + \abs{\gamma}^2 t^2 \norm{\xi}^2
\end{align}
と計算できる.
$\gamma \neq 0$ ならば十分小さい $t < 1 / \norm{\xi}^2$ で
$\phi (t) < \phi (0) = \delta^2$ となって $\delta$ の定義に反するから, $\gamma = 0$ となる.
よって,
\begin{align}
 \gamma
 =
 \bkt{\xi}{z}
 =
 \bkt{\xi}{x - y}
 =
 0 \quad \rbk{\xi \in L}
\end{align}
となって, 定理が証明された.
\end{proof}
\begin{prop}
 $M \subset H$ が部分空間ならば $(M^{\perp})^{\perp} = \overline{M}$.
\end{prop}
\begin{proof}
定義と $M^{\perp}$ が閉 (Lemma \ref{functional_analysis_hilbert_space_yukimi_5}) より
$M \subset (M^\perp)^\perp$ なので $\overline{M} \subset (M^\perp)^\perp$.
$x \in (M^\perp)^\perp$ とすると, 射影定理から
\begin{equation}
 x
 =
 x_{\overline{M}} + x_{(\overline{M})^\perp}, \quad
 x_{\overline{M}}\in \overline{M}, \quad
 x_{(\overline{M})^\perp} \in (\overline{M})^\perp \label{functional_analysis_hilbert_space_yukimi_6}
\end{equation}
と一意的にかける.
$(\overline{M})^\perp = M^\perp$ をみよう.
$M \subset \overline{M}$ より $(\overline{M})^\perp \subset M^\perp$ はよい.
$y \in M^\perp$ とすると, 閉包の定義から任意の $z \in \overline{M}$ に対してある
$z_{n} \in M$ で $z_{n} \to z$ とできる.
ここで $\bkt{y}{z_n} \to \bkt{y}{z}$ と $\bkt{y}{z_n} = 0$ から $\bkt{y}{z} = 0$ となるから,
$y \in (\overline{M})^\perp$ となって, $(\overline{M})^\perp = M^\perp$ がわかった.
よって $(\overline{M})^\perp = M^\perp$.

いま示したことから $\bkt{x}{x_{\overline{M}^{\perp}}} = 0$ がしたがい, これと (\ref{functional_analysis_hilbert_space_yukimi_6})
をじっとみていると $\bkt{x}{x_{\overline{M}}^{\perp}} = \norm{x_{\overline{M}^{\perp}}}$ となって,
もういっかい (\ref{functional_analysis_hilbert_space_yukimi_6}) にもどって
$x = x_{\overline{M}}$ がわかったから, $x \in \overline{M}$ となって証明がおわった.
\end{proof}
\section{ONS, CONS}

\begin{lem}\label{functional_analysis_hilbert_space_yukimi_7}
 $\cbk{x_{n}}_{n}$ を $H$ の ONS とする.
 $\sum_{n = 1}^\infty \abs{\alpha_{n}}^2 < \infty$ を満たす任意の
 $\alpha = \cbk{\alpha_{n}} \subset \bbC^{\infty}$ に対して,
 $x (\alpha) \defeq \sum_{n = 1}^\infty \alpha_{n}x_{n}$ は収束し,
 $\norm{x \rbk{\alpha}}^2 = \sum_{n=1}^\infty \abs{\alpha_{n}}^2$ がなりたつ.
\end{lem}
\begin{proof}
$y_{N} = \sum_{n=1}^N \alpha_{n} x_{n}$ とおく.
$N > M$ で
\begin{align}
 \norm{y_N - y_M}^2
 =
 \sum_{n = M+1}^N \abs{\alpha_n}^2
 \to 0, \quad N, M \to \infty
\end{align}
となるから $\cbk{y_N}_N$ は $H$ の Cauchy 列.
よって完備性から収束するのでそれを $\sum_{n=1}^\infty \alpha_n x_n$ とかくと,
\begin{align}
 \norm{x \rbk{\alpha}}^2
 =
 \lim_{N \to \infty} \norm{y_N}^2
 =
 \lim_{N \to \infty} \sum_{n=1}^N \abs{\alpha_{n}}^2
\end{align}
となる.
\end{proof}

\begin{defn}
 $H$ の ONS $\cbk{x_{n}}_n$ がすべての $x \in H$ に対して $x = \sum_{n = 1}^\infty \bkt{{x_n}}{x} x_n$ を満たすとき,
 これを \upbf{CONS}という.
\end{defn}
\begin{rem}
 $\dim H = n < \infty$ ならば基底 $\cbk{x_{j}}_{j=1}^n$ があって,
 任意の $x \in H$ は $x = \sum_{j = 1}^n \alpha_j x_j$ と一意的にかける.
 Gram-Schmidt を適用すればいいので $\cbk{x_{j}}_{j=1}^n$ は ONS としてよい.
 このとき
 \begin{align}
  \bkt{x_j}{x}
  =
  \sum_{k=1}^n \bkt{x_j}{\alpha_k x_k}
  =
  \alpha_k
 \end{align}
 となるので
 \begin{align}
  x
  =
  \sum_{j = 1}^n \bkt{x_j}{x} x_j
 \end{align}
 となる.
\end{rem}

\begin{thm}\label{functional_analysis_hilbert_space_yukimi_8}
 $\cbk{x_n}$ を $H$ の ONS とするとき, つぎの条件は互いに等しい.
\begin{enumerate}
\item $\cbk{x_n}$ が CONS.
つまり任意の $x \in H$ は $x = \sum_{n=1}^\infty \bkt{x_n}{x} x_n$ とかける.
\item すべての $x, y \in H$ に対して
\begin{align}
 \sum_{n=1}^\infty \bkt{x}{x_n} \bkt{x_n}{y} \label{functional_analysis_hilbert_space_yukimi_9}
\end{align}
\item (\upbf{Parseval の等式}) すべての $x \in H$ に対して
\begin{align}
 \norm{x}^2
 =
 \sum_{n = 1}^\infty \abs{\bkt{x_n}{x}}^2
\end{align}
がなりたつ.
\item すべての $n \geq 1$ に対して $\bkt{x}{x_n} = 0$ ならば $x = 0$.
\end{enumerate}
\end{thm}
\begin{proof}
(1) $\Rightarrow$ (2):
内積をとって,
\begin{align}
 \bkt{x}{y}
 =
 \sum \bkt{\sum \bkt{x_n}{x} x_n}{y}
 =
 \sum \bkt{x}{x_n} \bkt{x_n}{y}
\end{align}
となる.
Cauchy-Schwarz と Bessel によって,
\begin{align}
 \sum_{n=1}^N \abs{\bkt{x}{x_n} \bkt{x_n}{y}}
 \leq
 \rbk{\sum_{n=1}^N \abs{\bkt{x}{x_n}}^2}^{1/2}
  \rbk{\sum_{n=1}^N \abs{\bkt{x_n}{y}}^2}^{1/2}
 \leq
 \norm{x} \, \norm{y}
\end{align}
となるから絶対収束する.

(2) $\Rightarrow$ (3):
$x = y$ とすればよい.

(3) $\Rightarrow$ (4):
$\bkt{x}{x_n} = 0$ とすれば Parseval から $\norm{x}^2 = 0$ でこれは $x = 0$ を意味する.

(4) $\Rightarrow$ (1):
$\tilde{x} \defeq \sum_{m = 1}^\infty \bkt{x_m}{x} x_m$ とおく.
このとき, 任意の $n \geq 1$ に対して
\begin{align}
 \bkt{x - \tilde{x}}{x_n}
 =
 \bkt{x}{x_n} - \bkt{\tilde{x}}{x_n}
 =
 \bkt{x}{x_n} - \sum_{m=1}^{\infty} \bkt{x}{x_m} \bkt{x_m}{x_n}
 =
 \bkt{x}{x_n} - \bkt{x}{x_n}
 = 0.
\end{align}
よって仮定より $x = \tilde{x}$.
\end{proof}

\begin{lem}
 部分集合 $D \subset H$ に対して $(\overline{D})^\perp = D^\perp$.
\end{lem}
\begin{proof}
$D \subset \overline{D}$ と定義から $(\overline{D})^\perp \subset D^\perp$ はよい.
$x \in D^\perp$ とすると, 任意の $y \in \overline{D}$ に対して $y$ に収束するような $D$ の点列 $\cbk{y_n}$ がとれる.
内積の連続性により $\bkt{x}{y} = 0$ がわかるから,
$x \in (\overline{D})^\perp$ となり, 逆もいえた.
\end{proof}

\begin{prop}
 1) 部分集合 $D \subset H$ が稠密 $\Longleftrightarrow D^\perp = \cbk{0}$.
 2) 部分集合 $D \subset H$ が稠密で, 任意の $x \in D$ に対して $x_{1}, x_{2} \in H$ が
    $\bkt{x}{x_1} = \bkt{x}{x_2}$ ならば $x_{1} = x_{2}$.
\end{prop}
\begin{proof}
(1) [$\Longrightarrow$]
$x \in D^\perp$ とするとき, $D$ の稠密性から $x$ に収束するような $x_{n} \in D$ がとれるので,
内積の連続性から $\bkt{x}{x_n} \to \bkt{x}{x}$.
一方, $\bkt{x}{x_n} = 0$ より $\bkt{x}{x} = 0$ だから $x = 0$ .

[$\Longleftarrow$]
$M \defeq \overline{D}$ が閉部分空間なので射影定理から任意の $x \in H$ は
\begin{align}
 x
 =
 x_{M} + x_{M^\perp}
\end{align}
とかける.
前の補題と仮定によって
\begin{align}
 M^\perp
 = \rbk{\overline{D}}^\perp
 =
 D^\perp
 =
 \cbk{0}
\end{align}
であるから, $x_{M^\perp} = 0$.
よって $x = x_{M} \in M = H$ で $D$ は稠密.

(2) 条件は $x_1 - x_2 \in D^\perp$ をいっている.
(1) から $D^\perp = \cbk{0}$ なので $x_1 = x_2$.
\end{proof}

\begin{ex}
 $\cbk{e_n}_n$ は $\ell^2$ の完全系になる.
\end{ex}
\begin{proof}
ONS になることはみた.
任意の $a = \cbk{a_{n}}_n \in \ell^2$ に対して $\bkt{e_n}{a} = a_n$ となるので,
\begin{align}
 \sum_{n=1}^\infty \abs{\bkt{e_n}{a}}|^2
 =
 \norm{a}^2
\end{align}
となるから Parseval からわかる.
\end{proof}

\begin{defn}
 $\mathcal{L}(D)$ で $D$ のすべてのベクトルによって生成される部分空間を表す.
 つまり
 \begin{align}
  \calL \rbk{D}
  \defeq
  \set{\sum_{j=1}^N \alpha_j x_j}{\alpha_j \in \bbC, \quad x_j \in D, \quad j = 1, \dots, N, \quad N \in \bbN}.
 \end{align}
 ある $H$ の高々可算部分集合 $D$ があって, $\calL (D)$ が $H$ で稠密のとき $H$ は\upbf{可分}であるという.
\end{defn}

\begin{prop}\label{functional_analysis_hilbert_space_yukimi_10}
 $H$ の ONS $\cbk{x_n}_n$ が CONS $\Longleftrightarrow \calL(\cbk{x_n}_n)$ が $H$ で稠密.
\end{prop}
\begin{proof}
($\Longrightarrow$)
定理\ref{functional_analysis_hilbert_space_yukimi_9}の (4) から,
$(\cbk{x_n}_n)^\perp = \cbk{0}$ である.
よって前の命題から稠密.

($\Longleftarrow$)
前の命題から $(\calL \cbk{x_n}_n)^\perp = \cbk{0}$ となり,
定理 \ref{functional_analysis_hilbert_space_yukimi_9}の (4) がなりたつ.
よって $\cbk{x_n}_n$ は CONS.
\end{proof}
\section{可分性と具体例}

\begin{prop}
 $\ell^2$ は可分.
\end{prop}
\begin{proof}
次の集合は可算で $\ell^2$ のなかで稠密になる.
\begin{align}
 \set{x = \rbk{\xi_1, \xi_2, \dots}}{\sum_{j=1}^{\infty} \abs{\xi_j}^2 < \infty, \quad \xi_j \in \bbQ}.
\end{align}
\end{proof}

\begin{thm}
 可分な Hilbert 空間は CONS をもつ.
\end{thm}
\begin{proof}
$H$ を可分な Hilbert 空間として, $D \defeq \cbk{x_n}_n$ を $H$ の可算部分集合で
$\calL (D)$ が $H$ で稠密なものとする.
各 $x_1, \dots, x_n$ は線型独立とは限らないので, つぎの操作をする.
$x_1 = 0$ ならのぞき, そうでなければのぞかない.
$n > 1$ では $x_n$ が $x_1, \dots, x_{n-1}$ の生成する部分空間にふくまれていればのぞき, そうでなければのぞかない.
この作業でのこったものをその順番で $x_{1}', x_{2}', \dots$ とするとき,
任意の $n$ で $x_{1}', \cdots, x_{n}'$ はつくりかたから線型独立で,
$\calL(D) = \cbk{x_{n}'}_{n}$ となる.
$\cbk{x_n'}_n$ に Gram-Schmidt を適用して得られる ONS を $\cbk{y_n}_n$ とすれば
$\calL(\cbk{y_n}_n) = \calL (D)$.
よって仮定から $\calL (\cbk{y_n}_n)$ は $H$ で稠密なので,
Proposition \ref{functional_analysis_hilbert_space_yukimi_10}から $\cbk{y_n}_n$ は CONS となる.
\end{proof}

\begin{thm}
 $L^2 (\bbRd)$ は可分.
\end{thm}
\begin{proof}
$d$ 個の組 $n = (n_{1}, \dots, n_{d}) \in \bbN^d$ に対して
$I_{n} \defeq [-n_{1}, n_{1}] \times \cdots \times[-n_{d}, n_{d}]$
として, $I_{n}$ の定義関数を $\chi_{n}$ とする.
正整数の組を $m \defeq  (m_1, \dots, m_d)$, $p_m (x) \defeq x_1^{m_1} \cdots x_d^{m_d}$ とおき,
\begin{align}
 D
 \defeq
 \set{\chi_n p_m}{n, m \in \bbN^d}
\end{align}
とする.
$\chi_{n}$ が $I_{n}$ の定義関数なので $D \subset L^2 (\bbRd)$ であり, $D$ は可算個の元からなる.
任意の $f \in C_{\mathrm{c}}(\bbRd)$ に対して $\supp f \subset I_{n}$ なる $n$ があって,
Weierstrass の多項式近似から任意の $\varepsilon$ に対してある多項式 $P$ が存在して
$\norm{p - f}_{\infty} < \varepsilon$ となる.
したがって
\begin{align}
 \norm{\chi_n P -f}_{2}
 =
 \rbk{\int_{I_n} \abs{P - f}^2 dx}^{1/2}
 \leq
 \varepsilon \sqrt{\abs{I_n}}.
\end{align}
よって $\calL (D)\subset C_{\mathrm{c}}(\bbRd)$ は稠密で,
$C_{\mathrm{c}}$ が $L^2 (\bbRd)$ で稠密だから, $\calL (D)$ は $L^2 (\bbRd)$ で稠密.
\end{proof}
\section{作用素論}

\begin{prop}
 線型作用素 $A$ が単射である必要十分条件は $\ker A = \cbk{0}$ である.
\end{prop}
\begin{proof}
線型代数.
\end{proof}

\begin{thm}[Riesz の表現定理]\label{functional_analysis_hilbert_space_yukimi_11}
 任意の $F \in H^*$ に対して一意的に $y \in H$ があって, $F(x) = \bkt{y}{x}$, $(x \in H)$ とかける.
 さらに $\norm{F} = \norm{y}$ がなりたつ.
\end{thm}
\begin{proof}
まず $\ker F$ が $H$ の閉部分空間であることを示す.
$x_n \in ker F$, $x_{n} \to x$ とすると,
$F$ が連続なので $F (x_n) \to F (x)$.
$x_n \in \ker F$ なので $F (x_n) = 0$.
$F(x) = 0$ となるから $x \in \ker F$ となる.

$\ker F = H$ であれば $F(x) = 0 = \bkt{0}{x}$ だから $y = 0$ とすればよい.
$\ker F \neq H$ とする.
$H$ は射影定理によって $H = \ker F \oplus (\ker F)^\perp$ とかける.
任意に $0$ でない $y_0 \in (\ker F)^\perp$ をとると, 任意の $x \in H$ に対して
$F(y_0) x - F (x) y_0 \in \ker F$ だから
\begin{align}
 \bkt{y_0}{F \rbk{y_0} x - F(x) y_0}
 =
 0
\end{align}
から
\begin{align}
 \bkt{y_0}{F(y_0) x} - F(x) \norm{y_0}^2
 =
 0
\end{align}
を $\norm{y_0}^2$ でわると,
\begin{align}
 F(x)
 =
 \frac{F(y_0) \bkt{y_0}{x}}{\norm{y_0}^2}
 =
 \bkt{\frac{\overline{F(y_0)}}{\norm{y_0}^2} y_0}{x}
 =
 \bkt{y}{x}, \quad
 y
 \defeq
 \frac{\overline{F(y_0)}}{\norm{y_0}^2} y_0
\end{align}
となる.

\textbf{一意性}:
$F (x) = \bkt{y}{x} = \bkt{y'}{x}$ とする.
$\bkt{y - y'}{x} = 0$, $x \in H$.
$x \defeq y - y'$ とすると $\norm{y - y'}^2 = 0$ となる.

$\norm{F} = \norm{y}$:
Schwarz の不等式から
\begin{align}
 \abs{F(x)}
 =
 \abs{\bkt{y}{x}}
 \leq
 \norm{y} \, \norm{x}
\end{align}
となり $\norm{F} \leq \norm{y}$.
$x = y / \norm{y}$ とすると
\begin{align}
 \norm{y} = \frac{F(y)}{\norm{y}}
 \leq
 \sup_{y \neq 0} \frac{\abs{F(y)}}{\norm{y}}
\end{align}
となるから,  $\norm{y} \leq \norm{F}$ で $\norm{F} = \norm{y}$.
\end{proof}

Riesz の表現定理によって任意の $f \in H^*$ に対して $y \in H$ が一意的に定まるから
$H^*$ と $H$ を同一視できる.
たとえば $L^2 (0, 1)^* = L^2 (0, 1)$.

また, 共役空間を考えずに内積だけ考えればよい.
じっさいに $X$ と $Y$ を Banach 空間として $X$ から $Y$ への稠密に定義された線型作用素 $T$ については,
ある $f \in X^*$ で $g (Tx) = f (x)$ となる $g \in Y^*$ の全体を定義域として
$Y^*$ から $X^*$ への作用素を $T^*g = f$ と定義できるが,
$X$, $Y$ が Hilbert 空間のときは Riesz の表現定理から
$f (x) = \bkt{x}{\xi}$, $g (y) = \bkt{y}{\eta}$ なる $\xi \in X$,
$\eta \in Y$ が一意的に存在し,
$\bkt{x}{\xi} = \bkt{Tx}{\eta}$,
$x \in \dom (T)$ となるからわかりやすく
$\bkt{x}{T^* \eta} = \bkt{Tx}{\eta}$, $\eta \in \dom T^*$ とかける.

\begin{defn}
ノルム空間 $X$ に対して $\tau (x) (f) \defeq f (x)$, $(f\in X^*)$ によって定められた等長写像
$\tau \colon X \to X^{**}$ は $X$ の $X^{**}$ への標準的埋め込みといわれ,
これによって $X \subset X^{**}$ とみなせる.
$X = X^{**} (\tau (X) = X^{**}$ のとき $X$ は反射的という.
\end{defn}
\begin{thm}
 Hilbert 空間は Banach 空間として反射的.
\end{thm}
\begin{proof}
標準的埋め込み $\tau \colon H \to H^{**}$ が全射になることを示せばよい.
$H^*$ が内積空間となることを示す.
任意の $x \in H$ に対して線型汎関数 $y \in H \mapsto \bkt{x}{y}$ は有界なのでこれを
$\iota (x) \in H^*$ で表す.
$f, g \in H^*$ に対して, $\bkt{g}{f}_{H^*} \defeq \bkt{\iota^{-1}(f)}{\iota^{-1}(g)}$ とする.
\begin{align}
 \iota (x + y)
 =
 \iota (x) + \iota (y), \quad
 \iota (\lambda x)
 =
 \overline{\lambda} \iota (x)
\end{align}
だから $\bkt{f}{g}_{H^*}$ は $H^*$ 上の内積となる.
\begin{align}
 \norm{f}^2
 =
 \norm{\iota^{-1}(f)}^2
 =
 \bkt{\iota^{-1}(f)}{\iota^{-1}(f)}
 =
 \norm{f}{f}_{H^*}
\end{align}
となり, 内積から定まるノルムは $H^*$ の共役空間としてのノルムと一致する.
$H^*$ は $\bkt{g}{f}_{H^*}$ によって完備内積空間 (Hilbert 空間) となる.

任意に $\phi \in H^{**}$ をとると, $H^*$ に Riesz の表現定理を適用して
$H^*$ の元 $f$ で任意の $g \in H^*$ に対して $\phi (g) = \bkt{f}{g}_{H^*}$ となるベクトルがとれる.
$x \defeq \iota^{-1}(g)$, $y \defeq \iota^{-1}(f)$ とおけば,
\begin{align}
 \bkt{g}{f}_{H^*}
 =
 \bkt{x}{y} \iota^{-1}(x)
 =
 g(x)
 =
 \tau (x) (g)
\end{align}
とかける.
よって $\phi (g) = \tau (x) (g)$ ($g \in H^*$) なので $\phi = \tau (x)$ となるから $\tau$ は全射.
\end{proof}

\begin{defn}
 $\dom T \subset \dom T^*, Tx = T^*x$ を満たす Hilbert 空間 $H$ 上の線型作用素 $T$ を対称作用素という.
 $T$ が $\dom T = \dom T^*, Tx = T^*x$ を満たすとき $T$ を自己共役作用素という.
 また, $H$, $K$ が Hilbert 空間で線型作用素 $U \colon H \to K$ が次の条件を満たすとき. $U$ をユニタリ作用素という.
 1) \textup{(定義域)}
   \begin{align}
    \dom U = H.
   \end{align}
 2) \textup{(全射性)}
   \begin{align}
    \ran U
    =
    K.
   \end{align}
 3) \textup{(内積保存性)}
   \begin{align}
    \bkt{Ux}{Uy}_{K}
    =
    \bkt{x}{y}_{H}, \quad x, y \in H.
   \end{align}
\end{defn}

\begin{prop}
 ユニタリ作用素は単射.
\end{prop}
\begin{proof}
内積を保存するので任意の $x \in H$ に対して
\begin{align}
 \norm{Ux}_K
 =
 \norm{x}_H
\end{align}
なるから $Ux = 0$ なら $x = 0$.
\end{proof}
この命題から $U$ は有界で $\norm{U} = 1$ となる.

\begin{thm}\label{functional_analysis_hilbert_space_yukimi_12}
 $H$, $K$ を可分な Hilbert 空間, $\cbk{x_n}_{n=1}^N$, $\cbk{y_n}_{n=1}^N$ を $H$, $K$ の CONS とする.
 このとき $\abs{N} = \aleph_0$ であればすべての自然数 $n$ に対して $Ux_n = y_n$ となるユニタリ作用素 $U$ が一意的に存在する.
\end{thm}
\begin{proof}
$N = \infty$ とする.
任意の $x \in H$ は $x = \sum_{n=1}^\infty \bkt{x_n}{x} x_n$ とかける.
Parseval の等式から $\sum_{n=1}^\infty \abs{\bkt{x_n}{x}}^2 < \infty$ だから,
Lemma \ref{functional_analysis_hilbert_space_yukimi_7}によって $\sum_{n=1}^\infty \bkt{x_n}{x} y_n$ は $K$ で収束する.
$U \colon H \to K$ を
\begin{align}
 Ux
 \defeq
 \sum_{n=1}^\infty \bkt{x_n}{x} y_n
\end{align}
と定義するとこれは線型で
\begin{align}
 \bkt{Ux}{Uy}
 =
 \bkt{\sum_{n=1}^{\infty} \bkt{x_n}{x} y_n}{\sum_{m=1}^{\infty} \bkt{x_m}{x} y_m}
 =
 \sum_{n=1}^{\infty} \bkt{x}{x_n} \bkt{x_n}{y}
 =
 \bkt{x}{\sum_{n=1}^{\infty} \bkt{x_n}{y} x_n}
 =
 \bkt{x}{y}
\end{align}
となるから内積を保存する.
任意の $y \in K$ を $y = \sum_{n=1}^{\infty} \bkt{y_n}{y} y_n$ とかくと, これは収束しているから,
\begin{align}
 x
 \defeq
 \sum_{m=1}^{\infty} \bkt{y_m}{y} x_m
\end{align}
とすると
\begin{align}
 U x
 =
 \sum_{n=1}^{\infty} \bkt{x_n}{x} y_n
 =
 \sum_{n=1}^{\infty} \bkt{x_n}{\sum_{m=1}^{\infty} \bkt{y_m}{y} x_m} y_n
 =
 \sum_{n=1}^{\infty} \bkt{y_n}{y} y_n
 =
 y.
\end{align}
ここで $y$ は任意だから $U$ は全射でしたがってユニタリ.

\textbf{一意性}
$U'x_n = y_n$ とすると, すべての $x \in H$ に対して
\begin{align}
 U'x
 =
 \sum_{n=1}^{\infty} \bkt{x_n}{x} U' x_n
 =
 \sum_{n=1}^{\infty} \bkt{x_n}{y} y_n
 =
 \sum_{n=1}^{\infty} \bkt{x_n}{x} Ux_n
 =
 Ux
\end{align}
だから $U = U'$.
\end{proof}

線型作用素 $A$ と $D \subset \dom (A)$ に対して $AD \defeq \set{Ax}{x \in D}$ とする.
\begin{thm}
 $H$, $K$ を Hilbert 空間, $U \colon H \to K$ をユニタリ作用素とすると次がなりたつ.
 1) $U^{-1} \colon K \to H$ はユニタリ.
 2) $D \subset H$ が稠密ならば $U D \subset K$ も稠密になる.
 3) 任意の $H$ の CONS $\cbk{x_n}_n^\infty$ に対して $\cbk{Yx_n}$ は $K$ の CONS.
\end{thm}
\begin{proof}
(1) $\eta$, $\chi \in H$ に対して
\begin{align}
 \bkt{U^{-1} \eta}{U^{-1} \chi}_H
 =
 \bkt{U U^{-1} \eta}{U U^{-1} \chi}_K
 =
 \bkt{\eta}{\chi}_K.
\end{align}

(2) $y \in (UD)^\perp$ とする.
任意の $x \in D$ に対して $\bkt{y}{Ux} = 0$ で $U$ が全単射なので一意的に $y = U\eta$ を満たす $\eta \in H$ がある.
よって
\begin{align}
 0
 =
 \bkt{U \eta}{Ux}
 =
 \bkt{\eta}{x}
\end{align}
で $D$ が稠密なので $\eta = 0$.
よって $y = 0$ から $(UD)^\perp = \cbk{0}$ で $UD$ は K で稠密.

(3) $\cbk{x_n}_n^\infty$ が CONS だから命題 \ref{functional_analysis_hilbert_space_yukimi_10} から
$\calL (\cbk{x_n}_n^\infty)$ が $H$ で稠密になる.
よって (2) から $\calL (\cbk{Ux_n}_n)$ が $K$ で稠密になり,
ふたたび命題 \ref{functional_analysis_hilbert_space_yukimi_10} によって $\cbk{Ux_n}_n$ は CONS.
\end{proof}

\begin{defn}
 ある $H$ から $K$ への Unitary 作用素があるとき, $H$ と $K$ は同型という.
\end{defn}
\begin{thm}
 $H$ を可分な Hilbert 空間とし, $\cbk{x_n}_n^\infty$ を $H$ の CONS とする.
 このとき
 \begin{align}
  x \to \cbk{\bkt{x_n}{x}}_n \in \ell^2
 \end{align}
 によって $H$ と $l^2$ は同型となる.
\end{thm}
\begin{proof}
$e_n = \cbk{\delta_{n,j}}_j$ の集合 $\cbk{e_n}$ は前にみたように $\ell^2$ の CONS だから,
定理 \ref{functional_analysis_hilbert_space_yukimi_12} によって $Ux_n = e_n$ となるユニタリ作用素 $U \colon H \to l^2$ がある.
任意の $x\in H$ は $x = \sum \bkt{x_n}{x} x_n$ とかけるので,
\begin{align}
 Ux
 =
 \sum_{n=1}^{\infty} \bkt{x_n}{x} e_n
 =
 \rbk{\bkt{x_1}{x}, \bkt{x_2}{x}, \dots} \in \ell2
\end{align}
\end{proof}

\begin{rem}
 可分な無限次元 Hilbert 空間は同型を除けば $\ell^2$ しかない!
\end{rem}

元ネタは新井・江沢\cite{AraiEzawa1, AraiEzawa2}です.
それに証明をてきとうに増田\cite{HisayaMasuda1}の方向に書きかえながらつくったという感じでしょうか.
\chapter{Mathematical foundations for quantum mechanics}

動画から適当に切り出してくる.
\chapter{Mathematical foundations for quantum statistical mechanics}

動画から適当に切り出してくる.
\chapter{Mathematical problems in quantum mechanics, quantum field theory, and quantum statistical mechanics}

Togetter (Twitter) からの転載.

元の質問は次の通り.
\begin{quote}
摂動論を勉強した頃, 摂動を加える前後で固有関数の様相が大きく変わらないのかが疑問でモヤモヤしていたのですが,
これも難しい問題だったのですね.
別の話題かつ大雑把な質問でアレなのですが, いま「この辺」の他にはどんなトピックがホットなのですか.
\end{quote}

本当に最近の動向は良く分かりませんし,
私の専門は場の理論・量子統計なので量子力学方面は微妙ですが, 何にせよこのあたりで知っているのをいくつか.
まず観測・量子情報関係が色々あります.
早稲田だと中里・安倍研が正にここでしょう.
数学というか数理物理だと理科大の大矢先生や電通大の長谷川さんあたりがやっています.
具体的な問題はあまり詳しくないですがこの辺も作用素不等式の研究といった数学色が強い話題も色々あるので.

新井先生の『量子現象の数理』\cite{AsaoArai4}にも書いてありますが,
アハラノフ-ボーム効果もまだ死んでいません.
比較的最近, 数学会の解析学賞の話題になる程度には色々面倒な話があります.
3 次元でのアハラノフ-ボームは物理的には本道ですが, 数学的には多分未開です.

物理でも当然大事な話ですが, 散乱理論もまだまだ数学的には未開の部分がたくさんあります.
筑波の磯崎先生の数学会賞にもなっている話は量子力学ですが,
相対論的場の理論でも Dybalski さんなどの話 \cite{WojciechDybalski1} があります.
こちらは量子力学以上に手付かず.

またもや新井先生の本に書いてありますが, 超対称性量子力学もまだまだ発展途上でしょう.
特にこれは幾何との絡みがあるようなので, 研究者がたくさんいるはずです.
あとアンダーソン局在も数学の人が熱心に取り組んでいる話題です

「この辺の話題」といった丁度その部分ですが, 場の理論だと,
発散の困難関係を処理しないと何も前に進まない状況で, いまだにそこではまっているところです.
同じく摂動の問題で, 励起状態は準安定になってほしいというのが以前言った所ですが,
発散の困難の場合は基底状態の摂動でいろいろあります.

基底状態は基底状態のまま, 基底エネルギーは固有値でいてほしいのですが,
これが固有値でなくなる (固有状態がどこかに行ってしまう) というのが発散の困難です.
ちょうど量子力学の $\delta$ 関数のガウシアンによる近似で,
$t>0$ のときはまともな関数なのに極限を取ると超関数になってしまうのと同じ問題です.

その前の基底状態・平衡状態の存在証明 (発散の困難の回避) で手間取っているためほとんど進んでいませんが,
物性理論への応用が私のやりたい部分です.
電子-フォノン相互作用系での強磁性やフォノンの BEC など, 相転移関係で基本的な部分をはっきりさせたいというところ.

励起状態関係の話やレーザーの話と数学的に近い部分・重なる部分があるのですが,
平衡への回帰という非平衡統計の問題も議論されています.
このあたりは早稲田の田崎先生が $C^*$ を使う手法で研究されていましたが, 数年前に亡くなってしまいました.

場の理論というより統計ですが, 数学として扱っているモデル・手法がかなり重なる,
または全く同じだったりするので, 研究者も多少重なりがあります.
かなり数学よりになりますが, 流体力学極限という確率論の話も使いつつ非平衡関係のことをしている Spohn という人もいます.

量子力学方面に戻りますが, 物理でも最近話題になっている (らしい) circuit QED も数学ベースでの研究があります.
廣川先生や廣島先生がやっています.
れは一次元調和振動子の摂動みたいなものなのでモデル自体は非常にシンプルですが, 最近ホットな話題と聞いています.
あまり物理っぽい話を紹介できなくて申し訳ないのですが,
学部に毛が生えた程度, または本当に学部の物理水準でも既に数学としては色々問題があります.
解決済みですが, 量子統計だと平衡状態が物理で書かれる $\Trace e^{- \beta H}$ という形では存在しないという問題もあったのでした.
\chapter{Fundamental problems of perturbation theory in quantum mechanics as an approximation}

Twitter での次の発言に対する応答をまとめた.
\begin{quote}
ちなみに物理してると「収束するかの難しい問題はおいといて」的な文言と共に作用素の級数が出てくることとかありますね.
\end{quote}

やや別件ですが, 作用素級数とか収束以前に摂動が原理的にまずいということがあります.
$H = - \Delta + \alpha V$ で $\alpha$ が小さいときに摂動展開する,
という状況でエネルギー (固有値) の振る舞いが大きな問題になります.
$V_1 = x^2$, \$V$_{\text{2}}$=-r$^{\text{-1}}$\$としましょう.
もちろん調和振動子と水素原子に対応するハミルトニアンです.
固有値 (スペクトル), 固有関数ともに厳密解が分かっているわけですが,
いくら $\alpha$ が小さかろうと, 測定値であるエネルギーに対応する固有値の振る舞いがこの 2 つで決定的に違います.
もっというなら $\alpha = 0$ のときとも全く違います.
調和振動子などは連続スペクトルが全て消えてしまうという凄まじさ.

基底エネルギーのずれくらいならそこそこ値が合うはずですが,
元々のスペクトル自体が激変しているので, あまり適当なことをすると問題になりえます.
応用上も大事なレーザーでも問題があります.
ラムシフトが起きますが, 物理的に言って励起状態は準安定状態に遷移して欲しいわけで,
数学的には「摂動前の固有値に対応するものは固有値でなくなる」という現象が起きて欲しい.
ただし摂動論だと「摂動前の固有値は摂動では少しずれた値の固有値になる」と思って計算するので, ここでも原理的な問題が起きます.
学部 3 年の量子力学でやったと思いますが, 実際にはここで手で虚軸方向へのずれを入れることで回避します.
この間「数学的に細かいことは気にするな.
もはや数学徒としては研究レベルの問題だから」と書きましたが,
今本当にこの辺の数理物理の研究が進行中です.
\chapter{Direct integral and its physics}

これは Togetter に【微分ヤクザPによる直積分講座】というのでまとまっている.
いったん, やりとりをそのまま書いておく.
\begin{quote}
\#0は素イデアル
0t$_{\text{uda}}$ 2012-01-08 00:27:35

整域でない環に思いを馳せた.
alg$_{\text{d}}$ 2012-01-08 00:35:50

@alg$_{\text{d}}$ 非可換環
phasetr 2012-01-08 14:13:42

@phase$_{\text{tr}}$ 両側イデアルでない右イデアル
alg$_{\text{d}}$ 2012-01-08 14:22:52

@alg$_{\text{d}}$ 左閉イデアルなら大量生産できます
phasetr 2012-01-08 14:27:33

@phase$_{\text{tr}}$ 「大量」とは具体的にはどのくらいでしょうか.
alg$_{\text{d}}$ 2012-01-08 14:28:34

@alg$_{\text{d}}$ 非可算無限程度なら. 作用素環で大事な GNS 構成定理というのがありますが,
これは作用素環上の有界線型汎関数の kernel みたいなのからヒルベルト空間などを作る定理です.
この kernel みたいなのが大雑把に線型汎関数の分だけあります.
phasetr 2012-01-08 14:30:46

@phase$_{\text{tr}}$ そんなにたくさん作って, 一体何を企んでるんですか.
alg$_{\text{d}}$ 2012-01-08 14:32:27

@alg$_{\text{d}}$ 最近ヒッグスなどで自発的対称性の破れというのが取り沙汰されていますが,
ここでは非可算無限個 (例えば $U (1)$ くらい) の線型汎関数を重ね合わせて線型汎関数を 1 つ作ったりします.
物理の実用上どうしても必要です.
phasetr 2012-01-08 14:37:14

@phase$_{\text{tr}}$ 自発的対称性の破れってそういうの使うんですか. よく分かりませんが凄いです.
alg$_{\text{d}}$ 2012-01-08 14:40:16

@alg$_{\text{d}}$ 直和の代わりに直積分とか使いますが, 気持ちの上では大したことはしません.
めんどいのはテクニカルな部分だけだと見ています.
phasetr 2012-01-08 14:42:28

@phase$_{\text{tr}}$ 直積分 wwwwwwwwwwww フヒヒ wwwwwwww
alg$_{\text{d}}$ 2012-01-08 14:43:40

直積分ってなんぞ www 恐ろしい語感に衝撃を受けた.
alg$_{\text{d}}$ 2012-01-08 14:45:17

【 Direct integral 】
\url{http://t.co/sTQT3B6T}
alg$_{\text{d}}$ 2012-01-08 14:45:38

インテグラルの上に$\oplus$ が付いていて笑劇を受けている.
alg$_{\text{d}}$ 2012-01-08 14:50:04

@alg$_{\text{d}}$ von Neumann が導入したというように書いてありますが,
実際に von Neumann 環の分類では環を直積分分解して簡単な所に還元します.
特に中心が自明な環 (歴史的に因子, factor と呼ぶ) に落とし込むので factor の解析が大事です.
物理でもこれが出ます.
phasetr 2012-01-08 14:55:04

ちなみに今やっている所でも定ファイバー直積分を日常的に使っている.
非相対論的 QED (量子電気力学の方だ) で使うヒルベルト空間自体が直積分で書かれている (書ける) ので, 大体全部直積分になる.
phasetr 2012-01-08 14:58:56

直積分とは何か知らない僕に花束を
life$_{\text{wont}}$$_{\text{wait}}$ 2012-01-08 15:01:42

@life$_{\text{wont}}$$_{\text{wait}}$ 強磁性を考えます.
理論的には磁化の方向はどこを向いていても構わないので $SO (3)$ だけの自由度があります.
$SO (3)$ の分だけ基底状態がありますが, これの重ね合わせもまた基底状態になります.
重ね合わせを数学的に書くと直積分になるというだけです.
phasetr 2012-01-08 15:08:54

@phase$_{\text{tr}}$ 無限次元空間の基底の線型結合とかですか?
life$_{\text{wont}}$$_{\text{wait}}$ 2012-01-08 15:12:41

@life$_{\text{wont}}$$_{\text{wait}}$ 規格化したいので正確には凸結合ですし,
ベクトルだけでなく, 汎関数, 空間, 演算子全て直積分で書くことになりますが大体そんな感じです

phasetr 2012-01-08 15:16:57
@phase$_{\text{tr}}$ 空間も…了解ありがとうございます. やはりルベーグ積分必須な感じですか?

life$_{\text{wont}}$$_{\text{wait}}$ 2012-01-08 15:20:27
@life$_{\text{wont}}$$_{\text{wait}}$ 数学的にきちんとやりたいならもちろん必要ですが, そんなものはどうでもいいでしょう.
対称性の群が連続群だから連続にして, それで積分になったというだけです.
うるさいことを言う人には「数学やりたければ数学科に行け」と言っておいてください.
phasetr 2012-01-08 15:23:00

「数学やりたければ数学科に行け」これは名言だ
faogr 2012-01-08 15:23:37
\end{quote}
\part{Probability and Statistics}

\chapter{Talk: Law of large number and central limit theorem in coin tossing}

\section{参考文献}

話は \cite{MarkKac1} を元に組んでいる.
確率論それ自体については \cite{TadahisaFunaki1} が参考になる.
\section{数学的準備}

\subsection{加法定理・倍角の公式 \label{Hinashiro_math_party_1_probability_17}}

きちんとした証明は面倒なので, Euler の公式 $e^{ix} = \cos x + i \sin x$ を使う簡単な導出だけしておこう.
\begin{align}
 e^{2 i x}
 &=
 \cos 2x + i \sin 2x \\
 &=
 \rbk{e^{ix}}^2
 =
 \rbk{ \cos^2 x - \sin^2 x} + i \rbk{2 \cos x \sin x}.
\end{align}
あとは実部と虚部を比較する.
\subsection{指数関数の微分積分}

まず微分.
\begin{align}
 \frac{d}{dx} e^{ax} = a e^{ax}.
\end{align}
これで (不) 定積分もできる.
\begin{align}
 \int_0^1 e^{ax} dx = \frac{1}{a} \rbk{e - 1}.
\end{align}
あとで使う計算もやっておこう.
\begin{align}
 \int_0^1 e^{ix (1 - 2t)} dt
 =
 \int_{-1}^{1} e^{ixs} \frac{ds}{2}
 =
 \frac{\sin x}{x}.
\end{align}
\subsection{Rademacher 関数}

定義は式 (\ref{Hinashiro_math_party_1_probability_4}) だ.
周期 1 の周期関数として考えると関数 $r_k (t)$ は
\begin{align}
 r_k (t) = r_1 (2^{k-1} t) \label{Hinashiro_math_party_1_probability_11}
\end{align}
と書ける.
この周期性は実際の計算のときに役に立つ.
\subsection{Rademacher 関数の積分公式 \label{Hinashiro_math_party_1_probability_16}}

Rademacher 関数 (\ref{Hinashiro_math_party_1_probability_4}) に関する積分公式を導出しておく.
\begin{thm}
 \begin{align}
  \int_0^1 e^{iy r_k (t)} dt
  =
  \cos y.
 \end{align}
\end{thm}
\begin{proof}
(\ref{Hinashiro_math_party_1_probability_11}) を使って計算していく.
\begin{align}
 \int_0^1 e^{i y r_k (t)} dt
 &=
 \int_{0}^{1} e^{i y r_k (2^{k-1}t)} dt \\
 &=
 \int_{0}^{2^{k-1}} e^{i y r_1 (s)} \frac{ds}{2^{k-1}} \\
 &=
 \sum_{l=1}^{2^{k-1}} \int_{l-1}^{l} e^{i y r_1 (s)} \frac{ds}{2^{k-1}} \\
 &=
 \sum_{l=1}^{2^{k-1}} \frac{1}{2^{k-1}} \int_{0}^{1} e^{i y r_1 (s)} ds \\
 &=
 \int_{0}^{1} e^{i y r_1 (s)} ds \\
 &=
 \int_{0}^{1/2} e^{iy} ds + \int_{1/2}^{1} e^{-iy} ds \\
 &=
 \frac{1}{2} \rbk{e^{iy} + e^{-iy}}
 =
 \cos y.
\end{align}
\end{proof}
\subsection{Rademacher 関数の積分公式 2 \label{Hinashiro_math_party_1_probability_10}}

あとで使うので, \cite{MarkKac1} P.11 の演習問題 3. を解く.
\begin{prop}
 $s \geq 1$, $k_1 < k_2 < \cdots < k_s$ に対して
 \begin{align}
  \int_0^1 \prod_{l=1}^s r_{k_l} (t) dt = 0.
 \end{align}
 が成り立つ.
\end{prop}
Hilbert 空間論 (関数の直交性) も想起させるなかなか含蓄の深い関係式だ.
もちろん, 正確には確率論でより深く大事な概念, 独立性を表わしている.
\begin{proof}
$s = 1$ のときは自明だ.
$s = 2$ のときは式 (\ref{Hinashiro_math_party_1_probability_11}) を使うと
\begin{align}
 \int_0^1 r_{k_1} (t) r_{k_2} (t) dt
 =
 \int_0^1 r_1 \rbk{2^{k_1 - 1}t} r_1 \rbk{2^{k_2 - 1} t} dt
\end{align}
となる.
正と負が適当に互い違いになるだけで同じ回数出てくるので, 効果が打ち消しあって積分は 0 になる.
一般の $s$ でも同じことを議論すればいい.
\end{proof}
\subsection{Lebesgue 積分の定理}

\begin{thm}\label{Hinashiro_math_party_1_probability_18}
 関数列 $(f_n)$ の各関数は非負で可積分だとする.
\begin{align}
 \sum_{n=1}^{\infty} \int_0^1 f_n (t) dt < \infty,
\end{align}
つまり上記の積分の和が収束するなら関数項級数
\begin{align}
 \sum_{n=1}^{\infty} f_n
\end{align}
はほとんどいたる所で収束する.
\end{thm}
\section{導入}

今回のひなしろ数学会では確率論, 特に大数の法則と中心極限定理について議論しよう.
まず大数の法則と中心極限定理の説明が必要だ.

大数の法則の説明を Wikipedia から引いてみよう.
\begin{quote}
ある試行において事象が起きる確率 (数学的確率, 理論的確率などともいう) が $p$ であり,
その試行は, 繰り返し行ったとしてもある回の試行が他の回の試行に影響を及ぼすことがない (独立試行) ものとする.
このような前提条件の下で, その事象が起きる比率が試行回数を増やすにつれて近づく値 (統計的確率あるいは経験的確率) は $p$ である.
つまり, 各回の試行において各事象の起こる確率というものが,
試行回数を重ねることで, 各事象の出現回数によって捉えられるというのが大数の法則の主張するところである.
\end{quote}
「確率」という言葉を 2 つの意味で使っているのでかなり面倒な話をしているが,
ひとまずあとできちんと書く数学的な内容からいうと次のような感じになる.
\begin{enumerate}
\item (変な細工がない) 硬貨を投げるとき, 表と裏が出るのは平均的には $1/2$ ずつになる:
表が出るのを $+1$, 裏が出るのを $-1$ と考えると, 平均 (期待値) が $0$ になる.
\item (変な細工がない) 骰子を投げるとき, 出る目の平均 (期待値) は $\rbk{1+2+3+4+5+6}/6 = 3.5$ になる.
\end{enumerate}
色々微妙なところはあるが, これらを一般的にきちんと証明しようとして頑張った数学的成果を大数の法則と呼んでいる.

応用上も色々な話がある.
まずは平均にどんな情報・意味があるかを考えてみよう.
よくニュースなり何なりで平均の数値が出てくる.
しかし, 必ずしも平均に意味があるとは限らない.
次のような状況を考えよう.
\begin{quote}
3 年 1 組の生徒, 40 人に数学のテストを受けさせたところ,
簡単だが授業をきちんと聞いていないと出来ない問題を出題した.
きちんと勉強している生徒 20 人は 100 点を取れたが, クラスのもう半分の 20 名は 0 点だった.
\end{quote}
このとき平均点はもちろん $50$ 点だが, この $50$ という数値に何の意味があるだろうか.

次のような状況を考えてもいい.
\begin{quote}
ある国の国民の 1 年の所得を調べた.
富が偏在していて, 人口の 1 \#  は各人 100 億円の所得があるものの,
他の 99 \#  の所得は 1 万円以下だった.
\end{quote}
こんな歪な状況で平均に何の意味があるだろうか.
意味が全くないとは言わない.
ただ, 平均だけを見ていても仕方がないことはいくらでもあるということだ.

話はそれるが, そういうときに真っ先に見るべきは実際のデータとそのグラフだ.
グラフを見るだけでも色々なことが分かる.
これは統計学, 特に記述統計学の基本中の基本で, 色々なところでグラフが出てくる理由でもある.
数値だけでなくグラフを見ることが大事なのだ.

ちなみに, グラフを徹底利用して統計学の応用に決定的な影響を与えた人物として Florence Nightingale がいる.
看護師としてばかり有名なところがあるが, 実際には医療統計学と統計学の普及に大きな影響を与えた不朽の業績がある.

それはそれとして.
平均が持つ意味, 平均からのずれ, そしてそれを表す量も調べなければいけないことが分かってもらえたとして,
これらの問題について考えていこう.
先程「平均には意味があるかは微妙なところだ」と書いた.
しかし, 当然のことだが, 平均がきちんと意味を持つときもある.
そういう場合に「どのくらい頑張ると平均に辿り着けるか」という問題が出てくる.
例えば物理の実験では (理論から予測される) 適当な真の値がある.
特に理論の検証というタイプの実験・測定では当然その値を得ようと実験をする.
しかし誤差など色々な問題があるため本来の値からは少しずれてふらついた値が実験値として出てくる.
このふらつきをおさえた値を実験値から計算するにはどのくらい実験すればいいか, といった問題を是非解きたい.
1-2 回やっただけではふらつきが多過ぎたときにその影響をおさえきれないし,
実験の試料が高かったり, 施設利用費が高いとそう何度も実験できないという現実的な問題もある.
この辺をどうにかしたいということだ.
これが次の中心極限定理の内容にあたる.

難しすぎるので今日は話さないし勉強不足もあってそもそも話せないが,
分散または偏差という大事な量があってそれについて大偏差原理という命題がある.
そちらはそちらで応用上大事だ.
統計力学とも深い関わりがあるようで勉強したい.

大偏差原理はそれとして, 今度は中心極限定理だ.
ひとまず Wikipedia から説明を引いてみよう.
\begin{quote}
大数の法則によると, ある母集団から無作為抽出された標本平均はサンプルのサイズを大きくすると真の平均に近づく.
これに対し中心極限定理は標本平均と真の平均との誤差を論ずるものである.
多くの場合, 母集団の分布がどんな分布であっても, その誤差はサンプルのサイズを大きくしたとき近似的に正規分布に従う.
\end{quote}
要は何回くらい実験すればまともな値と思えるようになるか, そのレートを教えてくれるのが中心極限定理だ.
正規分布などは一旦無視する.

今日はこうした応用上の目的 (確率論というより統計学?) を背景にした確率論の数学を議論する.
高校の確率論とはかなり毛色が違うし, 大学の普通のコースともかなり違う.
参考文献 \cite{MarkKac1} を元に, ちょっと変わった確率論入門コースを走ってみる.
メインテーマはひたすらにコイン投げだ.
それでは始めよう.
\section{硬貨投げの数理と独立性}

\subsection{Vi\`ete の公式 \label{Hinashiro_math_party_1_probability_15}}

まずは Vi\`ete の公式を出してみよう.
次の式を Vi\`ete の公式という.
\begin{align}
 \frac{2}{\pi}
 =
 \prod_{k=1}^{\infty} \cos \frac{\pi}{2^{k+1}}
 =
 \frac{\sqrt{2}}{2} \cdot \frac{\sqrt{2 + \sqrt{2}}}{2} \cdot \frac{\sqrt{2 + \sqrt{2 + \sqrt{2}}}}{2} \cdot \cdots.
\end{align}
どうやって発見したのか, どうやって導いたのか・証明を思い付いのかが謎だし,
比較的簡単に計算できる $\cos \pi/2^k$ が出てくるのも不思議で,
さらには $\cos \pi / 2^k$ をきちんと頑張って計算してみたというところも尊い,
色々な感慨をかきたてるとても不思議な式だ.

まず計算自体は簡単な, しかし不思議な次の式から始める.
\ref{Hinashiro_math_party_1_probability_17} で導出した倍角の公式を繰り返し使うのだ.
\begin{align}
 \sin x
 &=
 2 \sin \frac{x}{2} \cos \frac{x}{2} \\
 &=
 2^2 \sin \frac{x}{4} \cos \frac{x}{4} \cos \frac{x}{2} \\
 &=
 2^3 \sin \frac{x}{8} \cos \frac{x}{8} \cos \frac{x}{4} \cos \frac{x}{2} \\
 &=
 2^n \sin \frac{x}{2^n} \prod_{k=1}^n \cos \frac{x}{2^k}. \label{Hinashiro_math_party_1_probability_1}
\end{align}
割り算がしたいのでいったん $x \neq 0$ (正確には $x \neq 2n \pi$, $n \in \bbZ$) とする.
ここで $\sin$ の原点での微分係数から
\begin{align}
 1
 =
 \lim_{n \to \infty} \frac{\sin \frac{x}{2^n}}{\frac{x}{2^{n}}}
 =
 \frac{1}{x} \lim_{n \to \infty} 2^n \sin \frac{x}{2^n}
\end{align}
となるから
\begin{align}
 \lim_{n \to \infty} 2^n \sin \frac{x}{2^n}
 =
 x \label{Hinashiro_math_party_1_probability_2}
\end{align}
が導ける.
最終結論のこの式自体は $x=0$ でも成り立つことに注意しよう \footnotemark[38]{}.

再び $x \neq 0$ を仮定しよう \footnote{ハイパーどうでもいいが「再びマタタビ楕円型」という天啓を得たことを記録しておく.}.
式 (\ref{Hinashiro_math_party_1_probability_1}) と (\ref{Hinashiro_math_party_1_probability_2}) から
\begin{align}
 \frac{\sin x}{x}
 =
 \prod_{k=1}^{\infty} \cos \frac{x}{2^{k}} \label{Hinashiro_math_party_1_probability_3}
\end{align}
が出る.
ここで何をどう思ったか $x = \frac{\pi}{2}$ を代入してみると次のようになる.
\begin{align}
 \frac{2}{\pi}
 =
 \prod_{k=1}^{\infty} \cos \frac{\pi}{2^{k+1}}
 =
 \frac{\sqrt{2}}{2} \cdot \frac{\sqrt{2 + \sqrt{2}}}{2} \cdot \frac{\sqrt{2 + \sqrt{2 + \sqrt{2}}}}{2} \cdot \cdots.
\end{align}
これが示したかった Vi\`ete の公式だ.


\subsection{Rademacher 関数}

これまではまさに高校の数学だった \footnotemark[35]{}.
本番はここからだ.
式 (\ref{Hinashiro_math_party_1_probability_3}) を別の観点から眺めてみようという体で,
唐突に次の無茶苦茶な理論展開を見せる.

実数 $t \in \sqbk{0, 1}$ を取り, これを \textbf{2 進展開}しよう.
$\varepsilon_k \in \cbk{0, 1}$ とすると実数 $t \in \sqbk{0, 1}$ は
\begin{align}
 t
 =
 \frac{\varepsilon_1}{2} + \frac{\varepsilon_2}{2^2} + \cdots
\end{align}
と書ける.
もちろん上の式で 2 が 10 のときがいつもの 10 進法での展開だ.
展開を一意に決めるため $0.1111 \dots = 1$ のようないつもの処方箋を出しておく.

各桁の $\varepsilon_i$ は $t$ の関数だから 2 進展開をきちんと書くと
\begin{align}
 t
 =
 \frac{\varepsilon_1 (t)}{2} + \frac{\varepsilon_2 (t)}{2^2} + \cdots
 =
 \sum_{k=1}^{\infty} \frac{\varepsilon_k (t)}{2^k}
\end{align}
となる.

関数 $\varepsilon_k (t)$ の図を描いてみよう.
見ているだけでも特徴的で結構楽しい.
数学的には次の Rademacher 関数が便利なのでこれを使っていく.
今後の主役でもある.
\begin{align}
 r_k (t)
 \defeq
 1 - 2 \varepsilon_k (t), \quad k \in \bbZ_+. \label{Hinashiro_math_party_1_probability_4}
\end{align}
これを使って 2 進展開を書き直そう.
\begin{align}
 1 - 2 t
 =
 \sum_{k=1}^{\infty} \frac{r_k (t)}{2^k}. \label{Hinashiro_math_party_1_probability_19}
\end{align}
\ref{Hinashiro_math_party_1_probability_16} 節の結果と式 (\ref{Hinashiro_math_party_1_probability_3}) を使うと
\begin{align}
 \frac{\sin x}{x}
 &=
 \int_{0}^1 e^{ix (1 - 2t)} dt
 =
 \int_{0}^1 \exp \rbk{ix \sum_{k=1}^{\infty} \frac{r_k (t)}{2^k}} dt \\
 &=
 \prod_{k=1}^{\infty} \cos \frac{x}{2^{k}}
 =
 \prod_{k=1}^{\infty} \int_0^1 \exp \rbk{i x \frac{r_k (t)}{2^k}} dt \label{Hinashiro_math_party_1_probability_5}
\end{align}
が分かる.
つまり
\begin{align}
 \int_{0}^1 \exp \rbk{ix \sum_{k=1}^{\infty} \frac{r_k (t)}{2^k}} dt
 =
 \prod_{k=1}^{\infty} \int_0^1 \exp \rbk{i x \frac{r_k (t)}{2^k}} dt.
\end{align}
一般に極限と極限の順序交換ができないことには注意しておこう \footnote{次の例をよく使っている.
\begin{align}
 \lim_{m \to \infty} \limntoinfty \frac{n}{n+m} &= 1, \\
 \limntoinfty \lim_{m \to \infty} \frac{n}{n+m} &= 0.
\end{align}}.
そう思うと上式は積分と無限積が交換できることを言っていることになる!
印象的にいうなら「積の積分が積分の積になる」のだ.


\subsection{どういうことなの?}

式 (\ref{Hinashiro_math_party_1_probability_5}) は偶然だろうか.
本質が見えるようになるまでは偶然というほかない.
ここで式 (\ref{Hinashiro_math_party_1_probability_3}) を別の方法で導いてみよう.

唐突だが次の関数を考える \footnotemark[36]{}.
いったん少し面倒な方法で取り組んでみよう.
\ref{Hinashiro_math_party_1_probability_14} 節で整理するので少しのあいだ我慢してほしい.
\begin{align}
 \sum_{k=1}^{n} c_k r_k (t).
\end{align}
これは区間
\begin{align}
 \rbk{\frac{s}{2^n}, \frac{s+1}{2^n}}, \quad s=0,1, \dots, 2^n -1
\end{align}
上でそれぞれ一定の値を取る階段関数だ.
その一定の値は
\begin{align}
 \pm c_1 \pm c_2 \pm \cdots \pm c_n
\end{align}
になる.
したがって次の式が成り立つ.
\begin{align}
 \int_0^1 \exp \sqbk{i \sum_{k=1}^{n} c_k r_k (t)} dt
 =
 \frac{1}{2^n} \sum_{\pm} \exp \sqbk{ i \sum_{k=1}^n \pm c_k}.
\end{align}
ここで右辺の和は全ての $\pm 1$ の組み合わせで取る \footnotemark[37]{}.
したがって
\begin{align}
 \frac{1}{2^n} \sum_{\pm} \exp \sqbk{ i \sum_{k=1}^n \pm c_k}
 =
 \prod_{k=1}^{n} \frac{e^{ic_k} + e^{-ic_k}}{2}
 =
 \prod_{k=1}^{n} \cos c_k
\end{align}
だから, \ref{Hinashiro_math_party_1_probability_16} の結果を使って
\begin{align}
 \int_0^1 \exp \sqbk{i \sum_{k-1}^n c_k r_k (t)} dt
 =
 \prod_{k=1}^n \cos c_k
 =
 \prod_{k=1}^n \int_0^1 e^{i c_k r_k (t)} dt \label{Hinashiro_math_party_1_probability_6}
\end{align}
が分かる.
$c_k = x / 2^k$ とすると,
\begin{align}
 \int_0^1 \exp \sqbk{ix \sum_{k=1}^n \frac{r_k (t)}{2^k}} dt
 =
 \prod_{k=1}^n \cos \frac{x}{2^k}
\end{align}
となる.
(\ref{Hinashiro_math_party_1_probability_19}) の収束
\begin{align}
 \lim_{n \to \infty} \sum_{k=0}^n \frac{r_k (t)}{2^k}
 =
 1 - 2 t
\end{align}
は区間 $\rbk{0,1}$ で\textbf{一様} \footnote{大学の数学科でしか使わない概念なので気にしなくていい. あとで自分が困らないように数学的にきちんと書いておいただけだから.} だから,
積分と極限の順序の交換ができて次の式が導ける.
\begin{align}
 \frac{\sin x}{x}
 &=
 \int_0^1 e^{ix (1 - 2t)} dt
 =
 \lim_{n \to \infty} \int_0^1 \exp \sqbk{ix \sum_{k=1}^n \frac{r_k (t)}{2^k}} dt
 =
 \lim_{n \to \infty} \prod_{k=1}^n \cos \frac{x}{2^k}
 =
 \prod_{k=1}^{\infty} \cos \frac{x}{2^k}.
\end{align}
これで (\ref{Hinashiro_math_party_1_probability_3}) の別証明ができた.

\ref{Hinashiro_math_party_1_probability_15} 節での導出よりは長いし初等的でもないが, 2 進展開との関係を示唆する不思議な証明といえる.
これは一体何だろうか.
ここからは 2 進展開と上の証明について深く考えていこう.
\subsection{2 進展開の確率論ことはじめ \label{Hinashiro_math_party_1_probability_14}}

次の条件を満たす実数 $t$ はいくつあるだろうか.
正確にいうなら次の条件を満たす $t$ の集合は何だろうか:
\begin{align}
 r_1 (t) = 1,
 \quad r_2 (t) = -1,
 \quad r_3 (t) = -1.
\end{align}
グラフを書くとこの集合は端点を除いて区間 $\rbk{3/8, 4/8}$ になる.
区間の長さ (今後\textbf{測度}と呼ぶ) は当然 $1/8$ で, さらに
\begin{align}
 \frac{1}{8}
 =
 \frac{1}{2} \cdot \frac{1}{2} \cdot \frac{1}{2}
\end{align}
とも書ける.
これを測度 (区間の長さ) の記号を使って面倒くさく書くとこうなる.
\begin{align}
 \mu \rbk{r_1 (t) = 1, \, r_2 (t) = -1, \, r_3 (t) = -1}
 =
 \mu \rbk{r_1 (t)=1} \cdot \mu \rbk{r_2 (t)=-1} \cdot \mu \rbk{r_3 (t)=-1}.
\end{align}
ここで $\mu (A)$ は集合 (区間) $A$ の長さを表わす.

これは次のように一般化できる: $\delta_k = \pm 1$ とすると,
\begin{align}
 \mu \rbk{r_1 (t) = \delta_1, \cdots, r_n (t) = \delta_n}
 =
 \prod_{k=1}^{n} \mu \rbk{r_k (t)=\delta_k}. \label{Hinashiro_math_party_1_probability_7}
\end{align}
何も言わなければわざわざ
\begin{align}
 \rbk{\frac{1}{2}}^n
 =
 \frac{1}{2} \cdot \frac{1}{2} \cdots \frac{1}{2}
\end{align}
を難しく書いているだけで何がしたいのか全く分からないし, 馬鹿ではないかと思うだろう.
しかしこれが関数 $r_k$, ひいては 2 進展開に深く関わっていることが分かる.

ここまで来ると式 (\ref{Hinashiro_math_party_1_probability_6}) は次のように機械的に計算できる.
\begin{align}
 \int_0^1 \exp \sqbk{i \sum_{k=1}^n c_k r_k (t)} dt
 &=
 \sum_{\delta_1,\dots,\delta_n} \exp \sqbk{i \sum_{k=1}^{n} c_k \delta_k} \mu \rbk{r_1 (t) = \delta_1, \cdots, r_n (t) = \delta_n} \\
 &=
 \sum_{\delta_1,\dots,\delta_n} \prod_{k=1}^n e^{i c_k \delta_k} \prod_{k=1}^n \mu \rbk{r_k (t) = \delta_k} \\
 &=
 \sum_{\delta_1,\dots,\delta_n} \prod_{k=1}^n e^{i c_k \delta_k} \mu \rbk{r_k (t) = \delta_k} \\
 &=
 \prod_{k=1}^n \sum_{\delta_k = \pm 1} e^{i c_k \delta_k} \mu \rbk{r_k (t) = \delta_k} \\
 &=
 \prod_{k=1}^n \int_0^1 e^{i c_k r_k (t)} dt.
\end{align}
前の議論だと組み合わせ的に面倒な話が必要で, 少なくとも私には難しい \footnote{センターレベルの組み合わせ・確率論ですら私には難しい.}.


\subsection{独立性ことはじめ \label{Hinashiro_math_party_1_probability_13}}

硬貨投げを考えるとき, 普通は次の条件を仮定している.
\begin{enumerate}
\item 硬貨投げは「公平」である: 表か裏かが出る確率に偏りはなく, 両方とも確率 $1/2$ である.
\item 硬貨投げの結果は他の回の結果とは関係ない: それぞれの事象は\textbf{独立}である.
\end{enumerate}
独立を数学的に書くと次のようになる \footnote{正確にはこう定義する.}.
\begin{quote}
事象 $A_1, \dots A_n$ が独立であることの定義は次式が成り立つことと定める.
\begin{align}
 P (A_1 \cap A_2 \cap \dots \cap A_n)
 =
 P (A_1) P (A_2) \cdots P (A_n).
\end{align}
ここで $P (A)$ は事象 $A$ が起きる確率を表わす.
\end{quote}

表と裏が適当な回数ずつ出るときの確率は明らかに
\begin{align}
 \frac{1}{2} \cdot \frac{1}{2} \cdots \frac{1}{2}
 =
 \frac{1}{2^n}
\end{align}
になる.
これまで計算してきた $r_k$ に関する計算結果と同じなので,
計算の便法として高校以来やってきた組み合わせ的な計算を $r_k$ に関する計算で置き換えることができるかもしれない.
そこで次の「辞書」を作って翻訳できるか試してみよう.
\begin{center}
\begin{tabular}{ll}
表 & $+1$\\
裏 & $-1$\\
$k$ 回目の結果 & $r_k (t)$\\
事象の確率 & 事象と対応する $t$ の集合の測度\\
\end{tabular}
\end{center}
辞書の使い方を見るために次の問題を考えてみる.
\begin{quote}
公平な硬貨投げを $n$ 回繰り返すときにちょうど $l$ 回表が出る確率を求めよ.
\end{quote}
辞書を使うと次のように翻訳できる.
\begin{quote}
$r_1$ から $r_n$ のうち, ちょうど $l$ 個が $+1$ になる $t$ の集合の測度を求めよ.
\end{quote}
こうすると, 面倒な組み合わせの議論が積分 (測度) の問題として考えられるようになる.
組み合わせは色々チェックが大変なので, 個人的には精神的な負担が減り苦しみから解放された気になる \footnote{センターの組み合わせや確率論すらろくに解けない方の市民だった.

実際に確率を計算してみよう.
組み合わせ的に考えたときの結果
\begin{align}
 \frac{1}{2^n}
 \begin{pmatrix}
  n \\
  l
 \end{pmatrix}
\end{align}
が再現できるだろうか.
もちろんできなければ困る.

まず求める値が
\begin{align}
 \mu \rbk{\sum_{k=1}^{n} r_k (t) = 2l - n}
\end{align}
と書けることに注意しよう.
整数 $m$ に対して
\begin{align}
 \frac{1}{2 \pi} \int_0^{2 \pi} e^{imx} dx
 =
 \begin{cases}
  1, & m=0, \\
  0, & m \neq 0
 \end{cases}
\end{align}
となるから
\begin{align}
 \phi (t)
 \defeq
 \frac{1}{2 \pi} \int_0^{2 \pi} \exp \sqbk{ix \rbk{\sum_{k=1}^{n} r_k (t) - \rbk{2l-n}}} dx
 =
 \begin{cases}
  1, &  \sum_{k=1}^{n} r_k (t) = 2l - n, \\
  0, &  \sum_{k=1}^{n} r_k (t) \neq 2l - n.
 \end{cases}
\end{align}
したがって
\begin{align}
 \mu \rbk{\sum_{k=1}^n r_k (t) = 2 l - n}
 &=
 \int_0^1 \phi (t) dt \\
 &=
 \int_0^1 \frac{1}{2 \pi} \int_0^{2 \pi} \exp \sqbk{ix \rbk{\sum_{k=1}^{n} r_k (t) - \rbk{2l-n}}} dx dt \\
 &=
 \frac{1}{2 \pi} \int_0^{2 \pi} e^{-i (2l -n) x} \rbk{\int_0^1 \sqbk{ix \sum_{k=1}^{n} r_k (t)} dt} dx
\end{align}
式 (\ref{Hinashiro_math_party_1_probability_6}) で $c_k = x$ とすれば
\begin{align}
 \mu \rbk{\sum_{k=1}^n r_k (t) = 2 l - n}
 =
 \frac{1}{2 \pi} \int_0^{2 \pi} e^{-i (2l -n) x} \cos^n x \, dx
\end{align}
となる.
ここで
\begin{align}
 \cos^n x
 =
 \rbk{\frac{e^{ix} + e^{-ix}}{2}}^n
 =
 \frac{1}{2^n} \sum_{k=0}^n
 \begin{pmatrix}
  n \\
  k
 \end{pmatrix}
 e^{i (n - 2k) x}
\end{align}
に注意すると,
\begin{align}
 \frac{1}{2 \pi} \int_0^{2 \pi} e^{-i (2l -n) x} \cos^n x \, dx
 &=
 \frac{1}{2 \pi} \int_0^{2 \pi} e^{-i (2l -n) x}
  \frac{1}{2^n} \sum_{k=0}^n
  \begin{pmatrix}
   n \\
   k
  \end{pmatrix}
  e^{i (n - 2k) x} dx \\
 &=
 \frac{1}{2^n} \sum_{k=0}^n
  \begin{pmatrix}
   n \\
   k
  \end{pmatrix}
  \frac{1}{2 \pi}
  \int_0^{2 \pi} e^{2 i (k - l) x} dx \\
 &=
 \frac{1}{2^n} \sum_{k=0}^n
  \begin{pmatrix}
   n \\
   k
  \end{pmatrix}
  \delta_{k,l}
\end{align}
となる.

まとめると次のようになることが分かった.
\begin{align}
 \frac{1}{2 \pi} \int_0^{2 \pi} e^{-i (2l -n) x} \cos^n x \, dx
 =
 \frac{1}{2^n}
 \begin{pmatrix}
  n \\
  l
 \end{pmatrix} \label{Hinashiro_math_party_1_probability_9}
\end{align}

2 項係数が指数関数の 2 項展開から出てくるところが証明のポイントで,
組み合わせ的な議論がこれと積分計算に落ちていることが見て取れる.
計算ではさらっと流してしまっているので,
Rademacher 関数の独立性, (\ref{Hinashiro_math_party_1_probability_7}) が本質的に効いていることを注意し直しておきたい.}.
\section{大数の法則}

前節では Vi\`ete の公式の初等的な証明からはじめ, 硬貨投げにどう落とし込むか,
さらには確率論, 特に独立性がどう効いてくるのかを見た.

この節では主題の 1 つ, 大数の法則について考えてみよう.
弱法則と強法則の 2 種類がある.
ここで「強弱」は論理的な強弱を表わしている.
\subsection{大数の弱法則}

また硬貨投げを考えよう.
「公平」な硬貨を 1 枚投げたとき, 表が出れば 1 円もらえ, 裏が出れば 1 円払う ($-1$ 円もらう) ことにする \footnote{Rademacher 関数を適当に変換すれば他の金額設定もできないことはないはずだが, 独立性などがうまくいくのか確認していない.}.
$n$ 回硬貨を投げたあと, いくらくらい儲かっているか (損しているか) を予測したい.
このとき, 硬貨投げという運の要素が絡んでいるため, 正確な値ももちろん出せず,
どのくらいの確率でどのくらい儲かるか, ということを予測することしかできないことに改めて注意しよう.

\ref{Hinashiro_math_party_1_probability_13} 節の辞書を使うと儲け自体は次のように書ける.
\begin{align}
 \sum_{k=1}^n r_k (t).
\end{align}
問題は $n$ 回硬貨投げをしたあとに想定額 $A_n$ を越えられるかどうかだろう.
要はいくら儲けたいという目標があって, それに到達できるかだ.
辞書を使うと儲けの見込み額は次の値 (集合の測度, 区間の長さ) を求める問題に帰着する:
\begin{align}
 \mu \rbk{\sum_{k=1}^n r_k (t) > A_n}. \label{Hinashiro_math_party_1_probability_20}
\end{align}

ここからは数学的な結果の解釈が絡んできて難しい.
次のように考えて議論を組み立てよう.
\begin{quote}
$A_n$ が十分に大きいとき, (\ref{Hinashiro_math_party_1_probability_20}) は小さいはずだ.
\end{quote}
もう少し噛み砕くと「公平な硬貨投げで大儲けすることは難しいだろう」という予想を立てたと言ってもいい.
$A_n$ の取り方も結構面倒だが, $\varepsilon > 0$ として $A_n = \varepsilon n$ と取ることにする.
その上で次の式を証明しよう.
\begin{align}
 \limntoinfty \mu \rbk{\abs{\sum_{k=1}^n r_k (t)} > \varepsilon n} = 0. \label{Hinashiro_math_party_1_probability_8}
\end{align}
いきなり絶対値が入ったが, あまり気にしないでほしい.
「公平な硬貨投げなので, 大きな得がないなら大きな損もないはずだ」 (ローリスクローリターン) という気持を表わしている \footnote{これが成り立つような状況しか考えに入れていないといってもいい.
実際に「大きな得はないが大損の可能性はある」状況はあるから.}.

式 (\ref{Hinashiro_math_party_1_probability_9}) を使うことはできる.
実際次のように書ける.
\begin{align}
 \mu \rbk{\abs{\sum_{k=1}^n r_k (t)} > \varepsilon n}
 =
 \sum_{\abs{2l - n} > \varepsilon n} \mu \rbk{\sum_{k=1}^n r_k (t) = 2l - n}
 =
 \sum_{\abs{2l - n} > \varepsilon n} \frac{1}{2^n}
 \begin{pmatrix}
  n \\
  l
 \end{pmatrix}.
\end{align}
このルートだと問題は次の式を示すことに帰着する.
\begin{align}
 \limntoinfty \sum_{\abs{2l - n} > \varepsilon n} \frac{1}{2^n}
 \begin{pmatrix}
  n \\
  l
 \end{pmatrix}
 = 0. \label{Hinashiro_math_party_1_probability_12}
\end{align}

Stirling の公式を使って示すこともできるが面倒だ.
Chebyshev による簡明かつ重要な結果を使った証明だけ紹介しておこう.
次のように変形していく.
\begin{align}
 \int_0^1 \rbk{\sum_{k=1}^n r_k (t)}^2 dt
 \geq
 \int_{\abs{\sum_{k=1}^n r_k (t)} > \varepsilon n} \rbk{\sum_{k=1}^n r_k (t)}^2 dt
 >
 \varepsilon^2 n^2 \mu \rbk{\abs{\sum_{k=1}^n r_k (t)} > \varepsilon n}.
\end{align}

\ref{Hinashiro_math_party_1_probability_10} 節を参考に計算すると
\begin{align}
 \int_0^1 \rbk{\sum_{k=1}^n r_k (t)}^2 dt = n
\end{align}
となるから,
\begin{align}
 \mu \rbk{\abs{\sum_{k=1}^n r_k (t)} > \varepsilon n}
 <
 \frac{1}{\varepsilon^2 n}
\end{align}
が分かる.
これで簡単に (\ref{Hinashiro_math_party_1_probability_8}) が証明できた.

Chebyshev の不等式だけでなく, Rademacher 関数の独立性, つまり \ref{Hinashiro_math_party_1_probability_11} の結果も本質的に効いている.
実は式 (\ref{Hinashiro_math_party_1_probability_8}) が\textbf{大数の弱法則}だ \footnotemark[39]{}.
弱法則ではまだまだほしい内容に足りない.
「儲けが際限なく大きくなる確率が 0 に収束する」くらいの微妙なことしか言っていないからだ.
平均がばっちり 0 に行くことを証明したい.
これは次節で議論する大数の強法則として数学的に定式化されている.


\subsection{大数の強法則}

Borel は次の定理を示した.
\begin{thm}[Borel]
 ほとんど全ての $t \in \sqbk{0, 1}$ に対して
 \begin{align}
  \limntoinfty \frac{r_1 (t) + r_2 (t) + \cdots + r_n (t)}{n} = 0
 \end{align}
 が成り立つ.
\end{thm}
Rademacher 関数 $r_k (t)$ での「硬貨投げ」では期待値 (平均) $0$ であることに注意してほしい.
これはまさに, 算術平均がその「期待値」に収束することを言っている.

それと, 定理の言明の中で $\sum$ を使っていないのは「何となく全部和で書いた方が気分が出る感じがする」という程度の理由で特に意味はない.
また「ほとんど全て」という魔術的な言葉は測度論の専門用語だ.
かなり難しいが測度論・確率論には本質的な言葉でもある.
ここでは無視しよう: いったん全部の $t$ で成り立つと思ってもらって構わない.
\begin{proof}
証明は読むだけなら簡単だ.
自分でそんなものをすんなり思いつくか? と言われたらつらいところはある.
\begin{align}
 f_n (t)
 =
 \rbk{\frac{1}{n} \sum_{k=1}^n r_k (t)}^4
\end{align}
として $\int_0^1 f_n (t) dt$ を考える.
4 乗をかつぎ出すというのが楽に進める上でとても大事なポイントになっている.

和を展開して \ref{Hinashiro_math_party_1_probability_10} 節の結果を使うと
\begin{align}
 \int_0^1 f_n (t) dt
 =
 \frac{n + \frac{4!}{2! 2!}
  \begin{pmatrix}
   n \\
   2
  \end{pmatrix}} {n^4}
\end{align}
となる.
分子は全ての $r_k$ が偶数個だけしか表われないときだけ抜き出した項の数だ.
\ref{Hinashiro_math_party_1_probability_10} 節の結果から奇数次が出てくる場合の積分は消えてしまう.

分子は高々 2 次で分母が 4 次だから $\sum_{n=1}^{\infty} \int_0^1 f_n < \infty$ になる.
したがって定理 \ref{Hinashiro_math_party_1_probability_18} から
\begin{align}
 \sum_{n=1}^{\infty} f_n
\end{align}
はほとんどいたる所収束する.
収束する級数を構成する数列は極限で 0 になるという一般的な定理があるから,
\begin{align}
 \limntoinfty  \rbk{\frac{r_1 (t) + r_2 (t) + \cdots + r_n (t)}{n}}^4 = 0
\end{align}
になる.
つまり
\begin{align}
 \limntoinfty \frac{r_1 (t) + r_2 (t) + \cdots + r_n (t)}{n} = 0
\end{align}
となる.
\end{proof}

ここで
\begin{align}
 r_k (t) = 1 - 2 \varepsilon_k (t)
\end{align}
だったから実は
\begin{align}
 \limntoinfty \frac{\varepsilon_1 (t) + \varepsilon_2 (t) + \cdots + \varepsilon_n (t)}{n} = \frac{1}{2}
\end{align}
でもある.
これは次のようにまとめられる.
\begin{thm}
 ほとんど全ての実数 $t$ に対してその $2$ 進展開に $0$ と $1$ は漸近的に同じ個数だけ表われる.
\end{thm}
確率論的にいうと次のようになる.
\begin{quote}
繰り返し公平に硬貨を投げる.
各回の試行が独立ならば確率 1 (ほとんどいたる所の $t$ にあたる表現) で表・裏が出る頻度 (相対度数) は極限で $1/2$ になる.
\end{quote}
これが「 (試行が独立なら) 表と裏が出る確率は同じ」という言明の数学的精密化であって,
\ref{Hinashiro_math_party_1_probability_13} 節の辞書の正当性も主張している.

この話は正規数という解析数論の話題にも繋がっていく.
魔界の住人のような結果もある.
興味がある向きは \cite{MarkKac1} 2.2 節を読み, さらに解析数論にもアタックしてみてほしい.
\section{中心極限定理}

\subsection{正規分布}

まずは定義を書く.
平均 $\mu$, 分散 $\sigma^2$ の正規分布というのは次の確率密度関数を持つ分布のことだ.
\begin{align}
 N (\mu, \sigma)
 =
 \frac{1}{\sqrt{2 \pi \sigma^2}} \exp \sqbk{- \frac{(x - \mu)^2}{2 \sigma^2}}.
\end{align}
適当な仮定, 特に独立性がある場合, 試行の確率分布が試行を無限回繰り返す極限で正規分布に漸近していくという言明が中心極限定理なのだった.
\subsection{中心極限定理の正確な言明: Rademacher 関数版}

まず中心極限定理 (の Rademacher 関数版) を数学的に正確に書いておこう.
\begin{thm}
 Rademacher 関数に関して次の式が成り立つ.
 \begin{align}
  \limntoinfty \mu \rbk{\omega_1 < \frac{r_1 (t) + \cdots + r_n (t)}{\sqrt{n}} < \omega_2}
  =
  \frac{1}{\sqrt{2 \pi}} \int_{\omega_1}^{\omega_2} e^{- y^2 / 2} dy.
 \end{align}
 上式右辺が正に平均 $0$, 分散 $1$ の正規分布だ.
\end{thm}
これは Stirling の公式と組み合わせ的な議論からも導ける.
しかしもっと確率論的にクリアな形で導出したい.
\subsection{Markov の方法とその厳密化}

\begin{proof}
実数 $\omega_1 < \omega_2$ を固定しておき,
\begin{align}
 g (x)
 =
 \xi_{A} (x), \quad A = \set{x}{\omega_1 < x < \omega_2}
\end{align}
とする.
さらに補助関数を定義しよう.
式で書くと面倒だが図を描くとすぐ分かる.
$0 < \varepsilon$, $2 \varepsilon < \omega_2 - \omega_1$ として
\begin{align}
 g_{\varepsilon}^{+}(x)
 &=
 \begin{cases}
  \frac{x - \rbk{\omega_1 - \varepsilon}}{\varepsilon}, & x \in \sqbk{\omega_1 - \varepsilon, \omega_1}, \\
  1, & x \in \sqbk{\omega_1, \omega_2}, \\
  -\frac{x - \rbk{\omega_2 + \varepsilon}}{\varepsilon}, & x \in \sqbk{\omega_2, \omega_2 + \varepsilon}, \\
  0, & \text{otherwise},
 \end{cases} \\
 g_{\varepsilon}^{-}(x)
 &=
 \begin{cases}
  \frac{x - \omega_1}{\varepsilon}, & x \in \sqbk{\omega_1, \omega_1 + \varepsilon} \\
  1, & x \in \sqbk{\omega_1 + \varepsilon, \omega_2 - \varepsilon}, \\
  -\frac{x - \omega_2}{\varepsilon}, & x \in \sqbk{\omega_2 - \varepsilon, \omega_2}, \\
  0 & \text{otherwise}.
 \end{cases}
\end{align}
こうすると
\begin{align}
 g_{\varepsilon}^{-} (x) \leq g (x) \leq g_{\varepsilon}^{+}(x)
\end{align}
であり,
\begin{align}
 \int_0^1 g_{\varepsilon}^{-} \rbk{\frac{\sum_{k=1}^{n} r_k (t)}{\sqrt{n}}} dt
 \leq
 \mu \rbk{\omega_1 < \frac{\sum_{k=1}^{n} r_k (t)}{\sqrt{n}} < \omega_2}
 \leq
 \int_0^1 g_{\varepsilon}^{+} \rbk{\frac{\sum_{k=1}^{n} r_k (t)}{\sqrt{n}}} dt.
\end{align}
ところで $\xi$ の関数 ($\gvarepsilonplus$, $\gvarepsilonminus$ の逆 Fourier 変換)
\begin{align}
 G_{\varepsilon}^{-} (\xi)
 \defeq
 \int_{\bbR} \gvarepsilonminus (y) e^{iy \xi} dy, \quad
 G_{\varepsilon}^{+} (\xi)
 \defeq
 \int_{\bbR} \gvarepsilonplus (y) e^{iy \xi} dy, \quad
\end{align}
は絶対可積分になる.
Fubini の定理が使えるから,
\begin{align}
 \limntoinfty \int_0^1 \gvarepsilonminus \rbk{\frac{\sum_{k=1}^{n} r_k (t)}{\sqrt{n}}} dt
 &=
 \frac{1}{2 \pi} \int_{\bbR} e^{- \xi^2 / 2} \int_{\bbR} \gvarepsilonminus (y) e^{i \xi y} dy d\xi \\
 &=
 \frac{1}{\sqrt{2 \pi}} \int_{\bbR} \gvarepsilonminus (y) e^{- y^2 / 2} dy.
\end{align}
関数 $\gvarepsilonplus$ に対しても同じことが言えるので
\begin{align}
 \frac{1}{\sqrt{2 \pi}} \int_{\bbR} \gvarepsilonminus (y) e^{- y^2 / 2} dy
 &\leq
 \liminfntoinfty \mu \rbk{\omega_1 < \frac{\sum_{k=1}^{n} r_k (t)}{\sqrt{n}} < \omega_2} \\
 &\leq
 \limsupntoinfty \mu \rbk{\omega_1 < \frac{\sum_{k=1}^{n} r_k (t)}{\sqrt{n}} < \omega_2} \\
 &\leq
 \frac{1}{\sqrt{2 \pi}} \int_{\bbR} \gvarepsilonplus (y) e^{- y^2 / 2} dy
\end{align}
が任意の $\varepsilon > 0$ に対して成立する.
したがって
\begin{align}
 \limntoinfty \mu \rbk{\omega_1 < \frac{\sum_{k=1}^{n} r_k (t)}{\sqrt{n}} < \omega_2}
 &=
 \frac{1}{\sqrt{2 \pi}} \int_{\bbR} g (y) e^{- y^2 / 2} dy \\
 &=
 \frac{1}{\sqrt{2 \pi}} \int_{\omega_1}^{\omega_2} e^{- y^2 / 2} dy
\end{align}
が成り立つ.
\end{proof}

この証明を精査すると確率論的には分布関数という大事な概念に導かれる.
その他のトピックへの展開も面白い.
興味がある向きは是非 \cite{MarkKac1} の 3 章を読んでほしい.
\chapter{Talk: Gaussian super-process and its application to Quantum Field Theory: Sasakure Seminar}

\section{Introduction}

Today we consider Gaussian super-processes and its application to quantum field theory.
We talk about construction of a probability space on the space of real tempered distributions,
$\realtempereddist (\mathbb{R}^3)$ using a Gaussian super-process.
We are going to construct it from the Sobolev space $H^{-1/2} (\mathbb{R}^3)$.

Almost all of you may not know how large the space $L^2 (\realtempereddist (\mathbb{R}^3))$.
So we state a theorem on it.
It relates to quantum field theory.

We set some notations.
The function $\omega \colon \mathbb{R}^3 \to \mathbb{R}_{\geq}$ is $\omega (k) \defeq \sqrt{k^2 + m^2}$, $m > 0$,
and the real Hilbert space $H^{-1/2} (\mathbb{R}^3)$ is defined by
\begin{align}
 H^{-1/2} (\mathbb{R}^3)
 \defeq
 \set{f \in \realtempereddist (\mathbb{R}^3)}{\omega^{-1/2} \hat{f} \in L^2 (\mathbb{R}^3)}.
\end{align}
For any (separable) Hilbert space $\calK$ we set a new Hilbert space, called a (boson) Fock space \cite{AsaoArai1, AsaoArai2}, by
\begin{align}
 \calFb (\calK)
 \defeq
 \bigoplus_{n=0}^{\infty} \bigotimes_{\mathrm{s}}^n \calK,
\end{align}
where $\oplus$ means a direct sum, $\otimes_{\mathrm{s}}$ means a symmetric tensor product,
and  $\otimes_{\mathrm{s}}^0 \calK \defeq \mathbb{C}$.

Then we can state a
\begin{thm}[\cite{AraiEzawa3}, Theorem 4.4.1]
 We have a unitary equivalence $\calFb (L^2 (\mathbb{R}^3)) = L^2 (\realtempereddist (\mathbb{R}^3), d \mu)$,
 where $d \mu$ is a probability measure.
\end{thm}
\begin{thm}
 A $L^2$ space $L^2 (\realtempereddist (\mathbb{R}^3), d \mu)$ can be constructed from a Gaussian super-process indexed by $H^{-1/2} (\mathbb{R}^3)$.
\end{thm}

Note that Prof. Obata in University of Tohoku uses the above Fock space in his study of quantum probability \cite{AccardiObata1}.
\subsection{Application to quantum field theory \cite{AsaoArai1, AsaoArai2}}

The above Fock space $\calFb$ is used in quantum field theory.
We use the space $L^2 (\mathbb{R}^3)$ for one particle \textbf{quantum mechanics},
use the space $L^2 (\mathbb{R}^{3*2})$ for two particle quantum mechanics,
and use the space $L^2 (\mathbb{R}^{3n})$ for $n$ particle quantum mechanics.

Since particles are created or annihilated in quantum field theory, i.e.,
a particle number is not a constant in quantum field theory,
we must use the space for the space with variable particle number.
For this, our space must include all sub-spaces for $n$ particle spaces,
and hence our particle space is the (boson) Fock space.

\vspace{1em}

\textbf{One more feeling for the need of tempered distributions}

We use a Brownian motion for quantum mechanics, i.e.,
integration theory on the set of continuous functions $C (\bbR^3)$.
Roughly speaking the set of tempered distributions $\realtempereddist$ is a dual space for a space $C (\bbR^3)$,
i.e., $\realtempereddist$ is on $C (\bbR^3)$.
Quantum field theory is one on quantum mechanics.
So our space must be constructed as integration theory on the space over $C (\bbR^3)$, the space $\realtempereddist$.

\vspace{1em}

\textbf{Usage of L\'evy process}

We use L\'evy processes for probabilistic representations of quantum mechanical systems.
See \cite{LorincziHiroshimaBetz1} for details.
\subsection{Application to geometry \cite{AsaoArai1} chap. 6}

Let $\calH$ and $\calK$ be separable Hilbert spaces
and define a \textbf{Fermion Fock space} by
\begin{align}
 \calFf (\calK)
 \defeq
 \bigoplus_{n=0}^{\infty} \bigotimes_{\mathrm{as}}^n \calK,
\end{align}
where $\bigotimes_{\mathrm{as}}^n$ means an anti-symmetric tensor product.
We define the Hilbert space $\calF (\calH, \calK)$ by
\begin{align}
 \calF \defeq \calF (\calH, \calK) \defeq \calFb (\calH) \bigotimes \calFf (\calK).
\end{align}
This space relates to super-symmetric quantum field theory.

We can define a coboundary operator, a cochain complex,
and $p$-th Laplace-Beltrami operator on $\calF$.
We can define $p$-th cohomology groups
and prove a de Rham-Hodge-Kodaira decomposition.
Furthermore we can define an infinite dimensional Dirac operator.

For finite dimensional Dirac operators celebrated index theory has developed.
Its relation to super-symmetric quantum mechanics has been also studied.
There exists some studies for infinite dimensional Dirac operators
and its functional integral (path integral) representations
for their indices.
This suggests a geometric study, in particular, topological invariants for infinite dimensional spaces.
\subsection{Application to analytic number theory \cite{AsaoArai17}}

We can derive the Dirichlet series and other arithmetic functions including the famous Riemann $\zeta$,
using quantum statistical partition functions.
This relates to the Hilbert-Polya conjecture.
Super-symmetric quantum theory and duality are encoded into many relations of functional equations of arithmetic functions.
\section{Gaussian super-process and its construction}

\subsection{Basics for probability}

First we introduce some probabilistic notions.

Let $(M, \Sigma, \mu)$ be a probability space, i.e.,
$\Sigma$ is a $\sigma$-algebra on a space $M$ and $\mu$ is a probability measure on $\Sigma$.
A real-valued measurable function on a measurable space $(M, \Sigma)$ is called a \textbf{random variable}.
For a random variable $f$ we define a \textbf{expectation} for $\mu$ by
\begin{align}
 \E{f} \defeq \int_M f \, d \mu.
\end{align}

A set of random variables of finite number $\cbk{f_1, \dots, f_n}$ is called \textbf{Gaussian}
if its characteristic function has the following form:
\begin{align}
 C_{f_1, \dots, f_n} (t_1, \dots, t_n)
 \defeq
 \E{\exp \sqbk{i \sum_{i=1}^n t_i f_i}}
 =
 \exp \sqbk{- \frac{1}{2} \sum_{i,j}^{n} a_{i,j} t_i t_j}, \quad t_i \in \bbR,
\end{align}
where $A \defeq \cbk{a_{i,j}}$ is a real positive definite matrix.

In the following we denote Gaussian random variables as GRV.
One of GRVs' fundamental property is
\begin{prop}
 For a GRV $\cbk{f_1, \dots, f_m}$ we have
 \begin{align}
  \E{f_1 \cdots f_{2n}}
  &=
  \sum \E{f_{i_1} f_{j_1}}  \cdots \E{f_{i_n} f_{j_n}}, \\
  \E{f_1 \cdots f_{2n-1}}
  &= 0.
 \end{align}
\end{prop}
\begin{rem}
 A quasi-free state amounts to a representation of GRV in operator algebra.
\end{rem}

\vspace{1em}

\textbf{Wick product}

Let $f_1, \dots, f_n$ be mutually different random variables.
We define their \textbf{Wick products} $\wick{f_1^{n_1} \cdots f_k^{n_k}}$ recursively as follows:
\begin{align}
 \wick{f_1^{0} \cdots f_k^{0}}
 &= 1, \\
 \frac{\partial}{\partial f_i} \wick{f_1^{n_1} \cdots f_k^{n_k}}
 &=
 \begin{cases}
  n_i \wick{f_1^{n_1} \dots f_i^{n_i - 1} \dots f_k^{n_k}} \quad (n_i \geq 1), \\
  0 \quad (n_i = 0),
 \end{cases} \\
 \E{ \wick{f_1^{n_1} \cdots f_k^{n_k}} }
 &= 0 \quad (n_1 + \cdots + n_k \neq 0).
\end{align}
We define an operator $\partial / \partial f_i$ is defined by
\begin{align}
 \frac{\partial}{\partial f_i} f_1^{n_1} \cdots f_k^{n_k}
 &=
 \begin{cases}
  n_i  f_1^{n_1} \dots f_i^{n_i - 1} \dots f_k^{n_k} \quad (n_i \geq 1), \\
  0 \quad (n_i = 0),
 \end{cases}
\end{align}
and extend it by linearity for $\cbk{f_i}$ polynomials.

\begin{prop}
 For a GRV f we get
 \begin{align}
  \wick{f^n}
  =
  \sum_{k=0}^{\sqbk{n/2}} \frac{n!}{k! (n-2k)!} f^{n - 2k} \rbk{- \frac{1}{2} \E{f^2}}^k.
 \end{align}
\end{prop}
\begin{prop}
 Let $f$ be a GRV.
 Then, for any $\alpha \in \bbC$,
 \begin{align}
  \wick{e^{\alpha f}}
  \defeq
  \sum_{n=0}^{\infty} \frac{\wick{f^n}}{n!} \alpha^n
 \end{align}
 is defined by a.e. absolute convergence and it holds that
 \begin{align}
  \wick{e^{\alpha f}}
  =
  e^{- \frac{\alpha^2}{2} \E{f^2}} e^{\alpha f}.
 \end{align}
 The RHS of the above converges in $L^p (M, d \mu)$ for all $p \in [1, \infty)$.
\end{prop}
\subsection{Gaussian super-processes}

\begin{defn}
 Suppose $(M, \Sigma, \mu)$ is a probability space, $H$ is a real Hilbert space,
 and $\phi \colon H \ni f \to \phi (f)$ is a map from $H$ to random variables on $M$.
 The map $\phi$ is a \textbf{Gaussian super-process with index} $H$ if $\phi$ satisfies
 the following four conditions:
 1) (linearity) we have, for all $f, g \in H$ and $\alpha, \beta \in \bbR$,
  \begin{align}
   \phi (\alpha f + \beta g) = \alpha \phi (f) + \beta \phi (g), \quad \mathrm{a.e.}
  \end{align}
 2) $\set{\phi (f)}{f \in H}$ is full, i.e., $\Sigma$ is the smallest $\sigma$-algebra where enables $\cbk{\phi (f)}$ measurable.
 3) each $\phi (f), f \in H$ is a GRV, i.e.,
  \begin{align}
   \E{e^{it \phi (f)}} = \exp \sqbk{- \frac{1}{2} t^2 \E{\phi (f)^2}}, \quad t \in \bbR.
  \end{align}
 4) We have
  \begin{align}
   \E{\phi (f) \phi (g)} = \frac{1}{2} \bkt{\phi (f)}{\phi (g)}, \quad f, g \in H,
  \end{align}
  where $\bkt{f}{g}$ is an inner product for $H$.
\end{defn}
A probability space which realizes a Gaussian super-process with index $H$ clearly depends on the space $H$.
Hence, in general, we denote a measure space $Q_{H}$, a probability measure $\mu_{H}$, and a super-process $\phi_{H}(f)$.
If there is no confusion we simply denote them $Q$, $\mu$, and $\phi (f)$.

In the following we consider its fundamental structures, uniqueness, existence.
\subsubsection{Fundamental structures}

\begin{lem}
 Suppose $\cbk{f_{\alpha}}_{\alpha \in I}$ is a set of random variables on a probability space $(M, \Sigma, \mu)$ with index $I$ and set
 \begin{align}
  \calA
  \defeq
  \set{F (f_{\alpha_1}, \dots, f_{\alpha_n})}{F \in \calS (\bbR^n), \alpha_i \in I, n \geq 1}.
 \end{align}
 A set $\cbk{f_{\alpha}}$ is full if and only if $\calA$ is dense in $L^2 (M, d \mu)$.
\end{lem}
\begin{proof}
 We show only that fullness implies density.
 Denote $H = L^2 (M, d \mu)$.
 We consider the following action of $F \in \calA$ over $\Psi \in H$, i.e.,
 \begin{align}
  (F \Psi) (m) \defeq F (m) \Psi (m), \quad m \in M.
 \end{align}
 The set $\calA$ becomes a non-unital abelian *-sub-algebra of the operator algebra of all bounded operators on $H$.
 Then the strong operator topological closure $\calA_S$ is an abelian von Neumann algebra.
 In fact $\calA_S = L^{\infty} (M)$.
 (You may need a proof:
 Since $L^{\infty}$ is a von Neumann algebra, this is made of projections.
 Projections in it is defining functions for measurable sets of $M$.
 Thus we must approximate them by rapidly decreasing functions.)

 Next we define $\tilde{\calA_S} = \calA_S 1$, where $1 \in H$ is a constant function.
 Clearly $\tilde{\calA_S} \subset \overline{\calA}$ and $\tilde{\calA_S} = L^{\infty}(M)$.
 This proves $\overline{\calA} = H$.
\end{proof}

\begin{thm}
 Let $\phi$ be a Gaussian super-process indexed by a real Hilbert space $H$.
 We define closed sub-spaces $\Gamma_n (H)$, $n \geq 0$, of $L^2 (Q, d \mu)$ as follows:
 \begin{align}
  \Gamma_0 (H)
  &\defeq \bbC, \\
  \Gamma_n (H)
  &\defeq
  \overline{\set{\colon \phi (f_1) \cdots \phi (f_n) \colon}{f_j \in H, j = 1, \cdots, n}}.
 \end{align}
 Then we have
 \begin{align}
  L^2 (Q, d \mu)
  =
  \bigoplus_{n=0}^{\infty} \Gamma_n (H).
 \end{align}
\end{thm}
In the proof we use the following interesting orthogonal properties.
\begin{lem}
 Suppose $\cbk{f_1, \dots, f_n, g_1, \dots, g_m}$ is a GRV.
 Then we obtain
 \begin{align}
  \E{\colon f_1 \cdots f_n \colon \, \colon g_1 \cdots g_m \colon}
  =
  \begin{cases}
   \sum_{\sigma \in \mathfrak{S}_n} \E{f_1 g_{\sigma \rbk{1}}} \cdots \E{f_n g_{\sigma \rbk{n}}} &\quad (n=m), \\
   0 &\quad (n \neq m).
  \end{cases}
 \end{align}
\end{lem}
\begin{rem}
 The above spaces $\Gamma_n (H)$ are `$n$-particle sub-spaces'.
\end{rem}
\subsubsection{Uniqueness}

\begin{thm}
 Suppose $\phi_1$ and $\phi_2$ are Gaussian super-processes for $H$ and their probability spaces are $(Q_i, d \mu_i)$, $i=1,2$.
 Then there exists a unitary operator $U \colon L^2 (Q_1) \to L^2 (Q_2)$ satisfies
 \begin{align}
  U1 &= 1, \\
  U \phi_1 (f) U^{-1} &= \phi_2 (f), \quad f \in H.
 \end{align}
\end{thm}
\subsubsection{Existence of a Gaussian super-process for any separable $H$}

\begin{proof}
 Let $H$ be a separable real Hilbert space and $\cbk{e_n}_{n=1}^{\infty}$ is a CONS.
 Set $\dot{\bbR}$ be the one-point compactification
  \begin{align}
   \dot{\bbR} \defeq \bbR \bigcup \cbk{\infty}
  \end{align}
 and $\bbR^{(n)}$ is a copy of $\dot{\bbR}$.
 Then
 \begin{align}
  Q
  \defeq
  \prod_{n=1}^{\infty} \bbR^{(n)}
 \end{align}
 is a compact Hausdorff space by Tychonoff's theorem.
 We denote $C (Q)$ is an abelian $C^*$-algebra of continuous functions on $Q$
 and $C_{\mathrm{fin}} (Q)$ is a vector subspace of $C (Q)$ whose functions depends on finite variables.
 We set a functional $l$ for $F \in C_{\mathrm{fin}} (Q)$ by
 \begin{align}
  l (F)
  \defeq
  \frac{1}{\pi^{n/2}} \int_{\bbRn} F (x_1, \dots, x_n) \exp \sqbk{- \sum_{i=1}^{n} x_i^2} dx_1 \cdots dx_n.
 \end{align}
 The functional $l$ is a continuous linear functional on $C_{\mathrm{fin}} (Q)$.
 By the way $C_{\mathrm{fin}} (Q)$ is dense in $C (Q)$ thanks to celebrating Stone-Weierstrass' theorem.
 Hence the functional $l$ can be uniquely extended to a functional on $C (Q)$; we denote it $l$ too.
 Since $F \geq 0$ leads $l (F) \geq 0$ the functional $l$ is positive.
 Riesz-Markov-Kakutani theorem shows the unique existence of the probability measure $\mu$ on $Q$ such that
 \begin{align}
  l (F)
  =
  \int_Q F \, d \mu.
 \end{align}

 We define a real valued function $\phi (e_n)$ on $Q$, for each $e_n$, by
 \begin{align}
  \phi (e_n) (q) \defeq x_n, \quad q = \cbk{x_k}_{k=1}^{\infty} \in Q.
 \end{align}
 Functions $\cbk{\phi (e_n)}$ are random variables on $Q$ and clearly $\phi (e_n) \in L^2 (Q, d \mu)$.
 Hence $\cbk{\phi (e_n)}_{n=1}^{\infty}$ is full.
 Expand $f \in H$ by $\cbk{e_n}$:
 \begin{align}
  f = \sum_{n=1}^{\infty} \alpha_n e_n.
 \end{align}
 Set functions
 \begin{align}
  \phi_n (f)
  \defeq
  \sum_{k=1}^{n} \alpha_k \phi (e_k).
 \end{align}
 The sequence $\cbk{\phi_n (f)}$ converges in $L^2 (Q)$ because, for $n > m$, we have
 \begin{align}
  \norm{\phi_n (f) - \phi_m (f)}^2
  =
  \frac{1}{2} \sum_{k = m+1}^{n} \alpha_k^2
  \to 0.
 \end{align}
 Denote the above limit function $\phi (f)$.

 We can show
 \begin{align}
  \E{\phi (f) \phi (g)} = \frac{1}{2} \bkt{f}{g}_{H}.
 \end{align}
 Since $\phi (f)$ is a GRV and the correspondence $f \to \phi (f)$ is linear,
 the constructed $\phi (\cdot)$ is a Gaussian super-process indexed by $H$.
\end{proof}
\section{Concrete realization of the set $Q$}

Finally we consider a useful realization of $Q$ because we would like to describe $Q$ concretely for concrete $H$.
The reason why we want to use $\realtempereddist$ is a representation theory:
a Minkowski space $\calM^4$ and the Lorenz group actions are extended to a function space on it,
and their actions are extended to the space of distributions.
Their actions are closely related to relativistic causality, light cone analysis, and so on.

Let $\realrapiddecrease (\bbRnu)$ be the subset of real valued rapid decreasing functions $\calS (\bbRnu)$.
For a Borel set $B$ of $\bbR^n$ and functions $f_1, \dots, f_n \in \realrapiddecrease (\bbRnu)$,
a subset in $\realtempereddist (\bbRnu)$
\begin{align}
 \set{ T \in \realtempereddist (\bbRnu)}{\rbk{T (f_1), \dots, T (f_n)} \in B}
\end{align}
is called a \textbf{cylinder set}.
In the following the $\sigma$-algebra of $\realtempereddist (\bbRnu)$ is the minimal $\sigma$-algebra
generated by the above cylinder sets.

\begin{thm}[Minlos, Theorem 3.2.12 in \cite{AraiEzawa3}, Theorem D.20 in \cite{AsaoArai5}]
 Let $C$ be a functional on $\realrapiddecrease (\bbRnu)$.
 Then the existence of a probability measure on $\realtempereddist (\bbRnu)$ satisfying
 \begin{align}
  C (f)
  =
  \int_{\realtempereddist (\bbRnu)} e^{i T (f)} \, d \mu (T), \quad f \in \realrapiddecrease (\bbRnu)
 \end{align}
 is equivalent to the following three conditions:
 1) $C (0) = 1$;
 2) a map $f \to C (f)$ is continuous in the strong topology of $\realrapiddecrease (\bbRnu)$;
 3) $C$ is of positive type, i.e., for each $f_i \in \realrapiddecrease (\bbRnu)$ and $z_i \in \bbC$, $n=1,2,\cdots,$ we have
    \begin{align}
     \sum_{i,j = 1}^{n} \bar{z_i} z_j C (f_i - f_j) \geq 0.
    \end{align}
\end{thm}
\begin{rem}
 This theorem is an infinite dimensional version of finite dimensional Bochner's theorem.
\end{rem}

\begin{thm}
 Suppose a real Hilbert space $H$ satisfies the following two conditions:
 1) an inclusion $\realrapiddecrease (\bbRnu) \subset H$ is dense;
 2) embedding is continuous.
 Then we can take $\realtempereddist (\bbRnu)$ as a measure space $Q$ realizing a Gaussian super-process $\phi (\cdot)$ indexed by $H$
 and $\phi (f)$ is given by
 \begin{align}
  \phi (f) (T) = T (f), \quad T \in \realtempereddist.
 \end{align}
\end{thm}
\begin{rem}
 Real $\alpha$-th Sobolev spaces $H^{\alpha}(\bbRnu)$ are examples of Hilbert spaces satisfying the condition in the above theorem.
\end{rem}
\begin{proof}
 A characteristic function of a Gaussian super-process indexed by $H$ is given by
 \begin{align}
  C (f) \defeq \E{e^{i \phi (f)}} = \exp \sqbk{- \frac{1}{4} \norm{f}^2}.
 \end{align}
 Since $\realrapiddecrease (\bbRnu) \subset H$, $C (\cdot)$ is a functional on $\realrapiddecrease (\bbRnu)$ and $C (0)=1$.
 By the assumption 2, a correspondence $f \to C (f)$ is continuous in the strong topology of $\realrapiddecrease (\bbRnu)$.
 Clearly $C (f)$ is of positive type.
 Hence, by Minlos' theorem, there exists a probability measure $\mu$ on $\realtempereddist (\bbRnu)$ such that
 \begin{align}
  C (f) = \int_{\realtempereddist (\bbRnu)} e^{i T (f)} d \mu (T), \quad f \in \realrapiddecrease (\bbRnu).
 \end{align}
 Define $\phi (f) (T) \defeq T (f)$, $T \in \realtempereddist$, $f \in \realrapiddecrease$.
 Then $\phi (f)$ becomes a GRV on $(\realtempereddist (\bbRnu), d \mu)$ and satisfies
 \begin{align}
  \E{\phi (f) \phi (g)} = \frac{1}{2} \bkt{f}{g}, \quad f, g \in \realrapiddecrease (\bbRnu).
 \end{align}
 The assumption 1 shows that we can define $\phi (f)$ for $f \in H$ by
 \begin{align}
  \phi (f) \defeq \lim_{n \to \infty} \phi (f_n), \quad \norm{f_n - f}_{H} \to 0.
 \end{align}
 Since $\abs{e^{ix} - e^{iy}} \leq \abs{x - y}$, we obtain
 \begin{align}
  \lim_{n \to \infty} \E{e^{i \phi (f_n)}}
  =
  \E{e^{i \phi (f)}}, \quad
  \lim_{n \to \infty} \exp \sqbk{- \frac{1}{4} \norm{f_n}^2}
  =
  \exp \sqbk{- \frac{1}{4} \norm{f}^2}.
 \end{align}
 Hence $\phi (f)$ is a GRV.
\end{proof}
\section{Application to quantum field theory and relation to operator algebraic formulation}

If having time.
\section{Appendix}

\subsection{Stone-Weierstrass theorem}

We consider the algebra $C_0 (X, \bbC)$ of complex-valued continuous functions on
a locally compact Hausdorff space $X$ with the topology of uniform convergence.
This is a $C^*$-algebra with the *-operation given by pointwise complex conjugation.
\begin{thm}
 Let $X$ be a locally compact Hausdorff space and let $A$ be a subset of $C_0 (X, \bbC)$ which satisfies the following two conditions:
 1) for any pair $x, y \in X$, $x \neq y$ there exists a function $p \in A$ which satisfies $p (x) \neq p (y)$;
 2) for any point $x \in X$ there exists a function $p \in A$ which satisfies $p (x) \neq 0$.
 Then the complex unital *-algebra generated by $A$ is dense in $C_0 (X, \bbC)$.
\end{thm}

\subsection{Minlos' theorem}

First we review Bochner' theorem.
A function $\phi \colon \bbRn \to \bbC$ is of positive type if, for any $x_1, \dots, x_n \in \bbRn$ and any $z_1, \dots, z_n \in \bbC$,
\begin{align}
 \sum_{i,j=1}^n \bar{z_i} z_j \phi (x_i - x_j) \geq 0.
\end{align}
\begin{thm}[Bochner, \cite{SeizoIto1}, Section 30]
 A function $\phi \colon \bbRn \to \bbC$ is of positive type with $\phi (0) = 1$ if and only if $\phi$ has the form
 \begin{align}
  \phi (x)
  =
  \int_{\bbRn} e^{2 \pi i \bkt{x}{k}} d \mu (k),
 \end{align}
 where $\mu$ is a Borel probability measure on $\bbRn$.
\end{thm}

Minlos' theorem is an infinite dimensional version of Bochner.
One of its proof uses Bochner directly: we use a finite dimensional net and apply it for each finite dimensional sub-spaces.
Then a net limit functional is the desired one.

There are two proofs in \cite{AsaoArai5}.
One is abstract and uses \textbf{nuclear extension}.
The other is concrete and uses a \textbf{quantum mechanical harmonic oscillator}
\chapter{Talk: Lecture on ergodic theory\label{introduction-to-ergodic-theory39}}

I will translate this.
\chapter{Statistics for idol management}

動画から適当に切り出してくる.
\part{Algebra}

\chapter{Commutative Ring}

I will translate.
\chapter{{\bfseries\sffamily TODO} Symmetry and group theory}

\section{運動方程式を不変にする変換}

\section{エネルギーを不変にする変換}

\section{群}

\section{Lorentz 群と Maxwell 方程式}

\section{解析力学小論}

\part{Geometry}

\chapter{Hyperbolic geometry for ergodic theory}

I will translate this.
\chapter{Guidance for algebraic geometry}

I will translate this chapter from the Japanese version.
\part{Interesting (counter) examples}

\chapter{Algebra}

\begin{ex}[Non-unital commutative ring]
 1) Let $L^1(\bbRd)$ be the space of absolutely Lebesgue integrable functions.
    A product is defined by convolution:
    \begin{align}
     \rbk{f * g} (x)
     \defeq
     \int_{\bbRd} f(y) g(x - y) dy.
    \end{align}
    Then $L^1(\bbRd)$ becomes a commutative ring but non-unital.
    A unit would be the Dirac's $\delta$ distribution.
    Note that the Kronecker's $\delta$ becomes a unit for the space of absolutely summable sequences $\ell^1$.
 2) Let $X$ be a locally compact Hausdorff space and $C_0(X)$ be a space of continuous functions vanishing at infinity.
    Then the space $C_0(X)$ becomes a non-unital commutative ring.
    This algebra is a commutative $C^*$-algebra.
\end{ex}
\begin{ex}[Non-unital non-commutative ring]
 Let $\calH$ be a infinite dimensional (separable) Hilbert space and $C \rbk{\calH}$ be a set of compact operators on $\calH$.
 Then $C (\calH)$ becomes a non-unital non-commutative algebra.
 This algebra is a non-commutative $C^*$-algebra.
\end{ex}
\chapter{Geometry}

\begin{ex}[Manifolds without countable base]
See \cite{CalabiRosenlicht1} for details.
\end{ex}

\begin{ex}[\cite{RichardGSwan1}]
In general it is not true that a map of vector bundles
has a kernel and image in the category of vector bundles.
\end{ex}
\begin{proof}
Let $I$ be a one dimensional unit interval, $\xi$ be the product bundle $I \times \bbR$
where $p(x, y) = x$.
Let $f \colon \xi \to \xi$ by $f(x,y) = (x, xy)$.
Then the image of $f$ has fiber of dimension 1 everwhere except at $x=0$
where the fiber is zero.
Thus $\image f$ cannot be a vector bundle.
Similarly $\ker f$ cannot be a vector bundle.
\end{proof}
\chapter{Analysis}

\section{Calculus}

\begin{ex}
There are functions which are continuous on $\bbQ$ and $\bbR$ and
which are continuous on $\bbQ$ but discontinuous on $\bbR$.
\end{ex}
\begin{proof}
There many functions which are continuous on $\bbQ$ and $\bbR$ and
many familiar functions are of this type.
For example an exponential function $e^x$ is defined on $\bbZ$ at first,
extended to $\bbQ$, and finally continuously extended to $\bbR$.
Functions which are not continuously extended to $\bbR$ is interesting.

Let us define a function as follows.
\begin{align}
 f(x)
 \defeq
 \begin{cases}
  0, & x^2 < 2, \\
  1, & \text{otherwise}.
 \end{cases}
\end{align}
This is continuous on $\bbQ$ but is discontinuous at $x = \sqrt{2}$.
\end{proof}
\section{From the site of Professor Moslehian}

In this section we reprint the examples from the site of Professor Moslehian \cite{MohammadSalMoslehian1}
When I mailed to him he permitted us to freely reuse
if we refer the site URL and the professor's name, Mohammad Sal Moslehian, once.
For the site URL, see the bibliography of \cite{MohammadSalMoslehian1}.
\subsection{Banach algebra}

\begin{ex}[unital Banach algebra, Banach Algebra Ex.1]\label{counterexamples-analysis-moslehian1}
Recall that $0$ and $1$ are called trivial idempotents.
\begin{enumerate}
\item A unital Banach algebra, except the algebra of complex numbers, without nontrivial idempotent.
\item A unital Banach algebra with a nontrivial idempotent.
\end{enumerate}
\end{ex}
\begin{proof}
Assume $X$ is a compact Hausdorff space.
We show that the Banach algebra $C(X)$ has no nontrivial idempotent iff $X$ is connected.

Let $0 \neq f \neq 1$ be an idempotent in $C(X)$.
Then $X = f^{-1} \rbk{\cbk{0}} \cup f^{-1} \rbk{\cbk{1}}$ implies that
$X$ is not connected.
Conversely if $X$ is disconnected and $X = G_1 \cup G_2$ with open disjoint sets $G_1$ and $G_2$,
then
\begin{align}
 f(x)
 =
 \begin{cases}
  1, & x \in G_1 \\
  0, & x \in G_2
 \end{cases}
\end{align}
is a nontrivial idempotent of $C(X)$.
\end{proof}
\begin{rem}[{\cite[Remarks of Prop. 7.9]{BonsallDuncan1}}]
If $A$ is a (not necessarily commutative) Banach algebra with an
element $a \in A$ such that $\sigma (A)$ is not connected,
then $A$ has a nontrivial idempotent.
\end{rem}

\begin{ex}[Banach Algebra Ex.2]
A Banach algebra generated by idempotents, i.e. elements $x$ such that $x^2 = x$.
\end{ex}
\begin{proof}
We show that the Banach algebra $C(X)$, where $X$ is a compact Hausdorff space,
with $\card X > 1$, is generated by idempotents iff $X$ is totally disconnected.

Recall that a topological space is said to be totally disconnected
if, for every distinct $x_1$, $x_2 \in X$, there are disjoint open sets
$G_1$ and $G_2$ such that $x_1 \in G_1$, $x_2 \in G_2$ and $X = G_1 \cup G_2$.

Suppose $X$ is totally disconnected, $x_1 \neq x_2$, $x_1 \in G_1$,
$x_2 \in G_2$, $X = G_1 \cup G_2$, $G_1 \cap G_2 = \emptyset$,
$G_1$ and $G_2$ are open.
Then the continous function
\begin{align}
 f(x)
 =
 \begin{cases}
  1, & x \in G_1, \\
  0, & x \in G_2,
 \end{cases}
\end{align}
separates $x_1$ and $x_2$.
So the closed self-adjoint subalgebra generated by idempotents,
by the Stone-Weierstrass theorem, is $C(X)$.

Conversely, suppose that $C(X)$ is generated by its idempotents.
Let $x_1$ and $x_2$ belong to $X$ and $x_1 \neq x_2$.
By Urysohn's lemma there is a function $f \in C(X)$ such that
$f(x_1) = 1$ and $f(x_2) = 0$.
Every element of the self-adjoint subalgebra generated by
idempotents is of the form
\begin{align}
 h
 =
 \sum_{i=1}^k \lambda_i g_i
\end{align}
for some idempotents $g_i$ and $\lambda_i \in \bbC$.
Hence there is a sequence $\rbk{h_n}$ of elements of the above form
such that $h_n \to f$ uniformly on $X$.
So $h_n(x_1) \to 1$ and $h_n(x_2) \to 0$.
Therefore there is a number $N$ such that $\abs{h_{N} (x_1)} > 1 / 2$
and $\abs{h_N (x_2)} < 1 / 2$.
So that
\begin{gather}
 x_1
 \in
 h_N^{-1} \rbk{\set{z \in \bbC}{\abs{z} > 1}}
 \eqdef
 G_1, \\
 x_2
 \in
 h_N^{-1} \rbk{\set{z \in \bbC}{\abs{z} < 1}}
 \eqdef
 G_2, \\
 G_1 \cup G_2
 =
 X, \\
 G_1 \cap G_2
 =
 \emptyset.
\end{gather}
Thus $X$ is totally disconnected.
\end{proof}

\begin{ex}[Banach Algebra Ex.3]
A compact Hausdorff space $X$ and subalgebras of $C(X)$ satisfying
in only three conditions of four following conditions:
1. uniformly closed,
2. separating the points of $X$,
3. containing constant functions,
4. closed under complex conjugation.
\end{ex}
\begin{proof}
(1., 2., 3.); i.e. a uniform algebra:
Consider a compact subset $X$ of $\bbC$ and suppose that $A$ is the uniform closure
of rational functions with poles out of $X$.

(2., 3., 4.):
With $X = [a, b]$, put $A$ to be the algebra of all polynomials in one variable.

(1., 3., 4.):
Let $X = [a, b]$, $x_1$ and $x_2$ are in $X$ and
\begin{align}
 A
 =
 \set{f \in C(X)}{f(x_1) = f(x_2)}.
\end{align}
\end{proof}

\begin{ex}[Banach Algebra Ex.4]
A Banach algebra $A$ such that $\Rad (A)$ is a proper subset of the set
$\set{x}{r(x) = 0}$ of all quasi-nilpotent elements,
where the above map $r$ is the spectral radius of an element $x \in A$
and $x \in A$ is called quasi-nilpotent if its spectrum satisfies $\sigma x = \cbk{0}$.
\end{ex}
\begin{proof}
(1.) Suppose that $H$ be a Hilbert space with $\dim H \geq 2$.
Let $x$, $y \in H \setminus \cbk{0}$ and $\bkt{x}{y} = 0$.
We use the notation $\ket{x} \bra{y}$ for the von Neumann-Schatten product, i.e.,
\begin{align}
 \ket{x} \bra{y} z
 \defeq
 \bkt{z}{y} x.
\end{align}
The norm of rank one operator $\ket{x} \bra{y}$ is $\norm{x} \norm{y} \neq 0$.
So
\begin{align}
 \ket{x} \bra{y}
 \neq 0.
\end{align}
Also
\begin{align}
 \rbk{\ket{x} \bra{y}}^2 z
 =
 \rbk{\ket{x} \bra{y}} \rbk{\bkt{z}{y} x}
 =
 \bkt{z}{y} \bkt{y}{x} x
 = 0,
\end{align}
so we have
\begin{align}
 \rbk{\ket{x} \bra{y}}^2
 = 0.
\end{align}
Hence it is quasi-nilpotent.
Since $\bbB (H)$ is semi-simple, $\ket{x} \bra{y} \notin \Rad \rbk{\bbB (H)} = \cbk{0}$.

We construct a concrete example.
Let $A = M_2 (\bbC) \simeq \bbB (\bbC^2)$.
Now $A$ is a $C^*$-algebra so $\Rad (A) = \cbk{0}$.
The element
\begin{align}
 x
 =
 \begin{pmatrix}
  0 & 1 \\
  0 & 0
 \end{pmatrix}
\end{align}
has the spectrum $\sigma (x) = \cbk{0}$ and so $r(x) = 0$.
Hence $\Rad (A)$ is not equal to $\set{x}{r(x) = 0}$.
\end{proof}

\begin{ex}[Banach Algebra Ex.5]
There is an algebraically semisimple non-commutative Banach algebra.
\end{ex}
\begin{proof}
We show that $\bbB (H)$, the algebra of bounded linear operators
from a Hilbert space $H$ into $H$ is semisimple.

Suppose that $x_0 \neq 0$ is fixed in $H$.
Then
\begin{align}
 I_{x_0}
 \defeq
 \set{T \in \bbB(H)}{T x_0 = 0}
\end{align}
is a left ideal in $\bbB (H)$.
We shall show that it is maximal.
Let $J$ be a left ideal properly containing $I_{x_0}$.
Then
\begin{align}
 J x_0
 \defeq
 \set{T x_0}{T \in J}
\end{align}
is a nonzero linear subspace of $H$
which is invariant under each $S \in \bbB(H)$.
If $J x_0 \neq H$ then there is a nonzero $y \in J x_0$ and a nonzero element $z \in H$
such that $z \notin J x_0$.
Setting $S = \ket{z} \bra{y} / \norm{y}^2 \in \bbB(H)$ we have $Sy = z$,
and then $z \in J x_{0}$ since $J x_0$ is invariant under all elements of $\bbB (H)$.
Thus $J x_0 = H$.

There is $U \in J$ such that $U x_0 = x_0$.
For each $T \in \bbB(H)$ it holds that $TU - UT \in I_{x_0}$.
Hence $T \in J + I_{x_0} \subset J$.
Therefore $\bbB (H) = J$.
Thus $\Rad (\bbB(H)) \subset \cap_{x \in H \setminus \cbk{0}} I_x = \cbk{0}$.
Therefore $\bbB(H)$ is algebraically semisimple.
\end{proof}

\begin{ex}[Banach Algebra Ex.6]
There is a semisimple commutative Banach algebra $A$
with a closed two-sided ideal $I$ such that $A/I$ is not semisimple.
\end{ex}

\begin{ex}[Banach Algebra Ex.7]
There exists a unital commutative Banach algebra with a non-maximal primary ideal.
\end{ex}
\begin{proof}
Suppose that $A$ is the algebra $C^m ([0, 1])$ of the complex valued $m \geq 1$ times
continously differentiable functions on $[0, 1]$ with the norm
\begin{align}
 \norm{f}
 =
 \sum_{k=0}^m \frac{1}{k!} \sup_{x \in [0, 1]} \abs{f^{(k)} (x)}.
\end{align}
Let $x_0 \in [0, 1]$ and
\begin{align}
 I
 =
 \set{f \in A}{f(x_0) = f'(x_0) = 0}.
\end{align}
Then $I$ is a closed two-sided ideal contained in only one maximal ideal,
i.e.,
\begin{align}
 \set{f \in A}{f(x_0) = 0}.
\end{align}
Note that the maximal ideals of $A$ are of the form
\begin{align}
 I_x
 =
 \set{f \in A}{f(x) = 0}, \quad x \in [0, 1].
\end{align}
A conclusion is that $C^m ([0, 1])$ is not spectral synthesis,
i.e., it has a closed two-sided ideal which is not the intersection
of maximal ideals containing this ideal.
\end{proof}
\begin{rem}
The disk algebra contains a non-maximal prime ideal, namely $\cbk{0}$.
\end{rem}

\begin{ex}[Banach Algebra Ex.8]
There is an (algebraically) simple Banach algebra.
\end{ex}
\begin{proof}
In the commutative case, consider the familiar Banach algebra $C(X)$ for compact $X$.
In the noncommutative case, consider the algebra $M_n(\bbC)$ of all $n \times n$ matrices
with entries in $\bbC$.
Identifying $M_n (\bbC)$ with $\bbB (\bbC^n) = K(\bbC^n)$, where $K (\bbC^n)$ is the set of compact operators,
 we may regard $M_n (\bbC)$ as a noncommutative $C^*$-algebra.

Suppose that $e_{i,j}$ is the matrix with the $(i,j)$-entry 1 and 0 elsewhere.
Then $e_{i,j} e_{k,l} = \delta_{j,k} e_{i,l}$, where $\delta$ denotes Kronecker's $\delta$.
Let $\Delta$ be a nontrivial two-sided ideal in $M_n(\bbC)$.
Let $A = \sum_{i,j} a_{i,j} e_{i,j} \in \Delta$ be a nonzero element.
Now we have the following:
\begin{align}
 e_{i,j} A e_{k,l}
 =
 a_{j,k} e_{i,l}.
\end{align}
We show that $a_{i,j} e_{i,j} \in \Delta$ for any $i$, $j$.
Set $X = (x_{i,j}) \in \Delta$ and $x_{1,1} = a_{i,j}$, and then we get
\begin{align}
 a_{i,j} e_{i,j}
 =
 x_{1,1} e_{i,j}
 =
 e_{i,1} X e_{1,j} \in \Delta.
\end{align}
Hence $A \in \Delta$ and then it holds that $\Delta = M_n(\bbC)$.
\end{proof}

\begin{ex}[Banach Algebra Ex.9]
An example of a Banach algebra $A$, a closed subalgebra $B$ of $A$ and an element $a \in A$ such that $\sigma_A a = \sigma_B a$.
\end{ex}
\begin{proof}
Let $H$ be a Hilbert space, $A = \bbB (H)$, $a = T$ be a nonzero element of $A$
and also let $B$ be a maximal commutative ($C^*$-)subalgebra containing $T$.
Then, by Proposition 2.2.7 in \cite{BratteliRobinson1}, we obtain
\begin{align}
 \sigma_A (a)
 =
 \sigma_B (a).
\end{align}
\end{proof}

\begin{ex}[Banach Algebra Ex.10]
There are reflexive/nonreflexive Banach algebras.
\end{ex}
\begin{proof}
$C^n$ is reflexive if $n \geq 1$.

The space of sequence $c_0$ is the set of ones whose element $(a_n)$ has finite support.
Then it holds that $c_0^{**} = \ell^1 = \ell^{\infty}$ and the inclusion
$c_0 \hookrightarrow \ell^{\infty}$ is proper.
Hence $c_0$ is not reflexive.
\end{proof}

\begin{ex}[Banach Algebra Ex.11]
There is an element of a Banach algebra which has no logarithm.
\end{ex}
\begin{proof}
Consider the unilateral shift operator on a separable Hilbert space $H$,
and then $u$ is a Fredholm of index
\begin{align}
 \ind u = \dimension \ker u - \dimension \coker u = 0 - 1 = -1.
\end{align}
If $\pi \colon \bbB(H) \to \bbB (H) / K(H)$ is the quotient map
and $\pi(u) = e^{w}$ for some $w$ in the Calkin algebra $\bbB(H) / K(H)$,
then there is an element $w' \in \bbB(H)$ with $\pi (w') = w$, so
\begin{align}
 \pi(u)
 =
 e^{w}
 =
 e^{\pi (w')}
 =
 \pi \rbk{e^{w'}}.
\end{align}
Hence $u - e^{w'} \in K(H)$, but $e^{w'}$ is invertible
and so $\ind u = \ind e^{w'} = 0$, which is a contradiction.
\end{proof}

\begin{ex}[Banach Algebra Ex.12]
There is an algebra can not be normed so that it cannot become a Banach algebra.
\end{ex}
\begin{proof}
The algebra of all complex valued infinitely many times continuously
differentiable functions on $[0, 1]$, $C^{\infty}([0, 1])$,
is semisimple, for
\begin{align}
 \Rad (A)
 =
 \bigcap_{t \in [0, 1]} \set{f \in C^{\infty}([0, 1])}{f(t) = 0}
 = 0.
\end{align}
Note that $f \mapsto f'$ is a derivation on $A$.
The Johnson theorem \cite[Theorem 18.21]{BonsallDuncan1} says that
$0$ is the only derivation on a semisimple Banach algebra.
It follows that $A = C^{\infty}([0, 1])$ is not Banach algebra under any norm.

A direct proof can be found in \cite[Corollary 4.1.12]{BernardAupetit1}.
This example is due to \cite{GESilov1}.
\end{proof}

\begin{ex}[Banach Algebra Ex.13]
There is a commutative radical Banach algebra.
\end{ex}
\begin{proof}
We show two examples.

(1) A Banach space with all products taken to be zero.
Then every element is quasi-invertible[fn:counter-example-moslehian-banach-algebra1].

[fn:counter-example-moslehian-banach-algebra1]I must confirm the definition of quasi-inverse.


(2) The Banach space $L^1([0, 1])$ with the product
\begin{align}
 (fg) (x)
 \defeq
 \int_0^x f(x - y) g(y) dy.
\end{align}
This has a generator $f_o (t) = t$, since
\begin{align}
 f^n_0 (t)
 =
 \frac{t^{n-1}}{(n-1)!},
\end{align}
the set of polynomials in one variable is $L^p$-dense in $C([0, 1])$
and $C([0, 1])$ is $L^p$-dense in $L^1([0, 1])$.
Moreover
\begin{align}
 \norm{f_0^n}
 =
 \int_0^1 \abs{f_o^n (t)} dt
 =
 \frac{1}{n!},
\end{align}
so its spectral radius
\begin{align}
 r(f_o)
 =
 \lim_{n \to \infty} \norm{f_o^n}^{1/n}
 =
 \lim_{n \to \infty} \rbk{n!}^{-1/n}
 = 0.
\end{align}
Therefore this algebra does not have any character, and hence
it is radical algebra.
\end{proof}

\begin{ex}[Banach Algebra Ex.14]
There is an element x of a Banach algebra such $r(x) < \norm{x}$,
where $r(x)$ is the spectral radius of $x$.
\end{ex}
\begin{proof}
Consider the following element $x$ in a $C^*$-algebra $M_2 (\bbC) = \bbB(\bbC^2)$,
\begin{align}
 x
 =
 \begin{bmatrix}
  0 & 1 \\
  0 & 0
 \end{bmatrix}.
\end{align}
Then the spectrum of $x$ is $\sigma (x) = \cbk{0}$ and hence its spectral radius $r(x) = 0$.
However we have $\norm{x} = 1$.
\end{proof}

\begin{ex}[Banach Algebra Ex.15]
There is a commutative Banach algebra $A$ with a unique ideal; i.e. $\Rad (A)$.
\end{ex}
\begin{proof}
Suppose $H = L^2(0, 1)$ with respect to the Lebesgue measure.
Then
\begin{align}
 (Vf) (x)
 =
 \int_{0}^x f(t)dt
\end{align}
defines an operator $V \in \bbB(H)$ which is called Volterra operator.
Clearly the closure $A$ of $\set{p(V)}{p \text{ is a polynomial}}$ in $\bbB(H)$
is the commutative Banach subalgebra of $\bbB(H)$ generated by $V$ and the identity operator $1$.

An straightforward computation shows that
\begin{align}
 \rbk{V^n f}(x)
 =
 \int_{x}^{x} \frac{(x-t)^{n-1}}{(n-1)!} f(t) dt
\end{align}
and so
\begin{align}
 \norm{V^n}
 =
 \frac{1}{(n-1!)}, \quad
 r(V)
 =
 \lim_{n \to \infty} \norm{V^n}^{1/n}
 = 0.
\end{align}
Hence $\sigma_{\bbB(H)} (V) = \cbk{0}$.
However, by \cite[VII. Theorem 5.4]{JohnConway1},
$\sigma_A(V)$ is equal to the polynomially convex hull of
$\sigma_{\bbB(H)} (V)$, hence $\sigma_A (V) = \cbk{0}$.
The maximai ideal space of $A$ is homemorphic to $\sigma_A (V) = 0$.
Hence the only character on $A$ is $\phi(\lambda) = \lambda$
and $\phi(x) = 0$ for $x \in A \setminus \bbC$.
Since $\phi$ is continuous, the unique maximal ideal space
is
\begin{align}
 \Rad (A)
 =
 \ker (\phi)
 =
 \overline{\set{p(V)}{p \text{ is a polynomial and } p(0) = 0}}.
\end{align}
\end{proof}

\begin{ex}[Banach Algebra Ex.16]
There is a Banach algebra $A$ that is a topological direct sum
(as a Banach space) of a pair of its Banach subalgebras which are isometrically isomorphic to $A$.
\end{ex}
\begin{proof}
Set $A = \ell^{\infty}$ and define the following two sets
\begin{align}
 E
 &\defeq
 \set{\rbk{x_n} \in \ell^{\infty}}{x_{2n} = 0}, \\
 F
 &\defeq
 \set{\rbk{x_n} \in \ell^{\infty}}{x_{2n - 1} = 0}.
\end{align}
Obviously $E$ and $F$ are closed subalgebras of $A$ and
\begin{align}
 A
 =
 E + F, \quad E \cap F = \cbk{0}.
\end{align}
So $E$ is a complemented subspace of $A$ with $F$ as a complementary subspace.
In addition a map
\begin{align}
 \phi \rbk{\rbk{x_1, x_2, x_3, \dots}}
 =
 \rbk{0, x_1, 0, x_2, 0, x_3, \dots}
\end{align}
is an isometrically isomorphism between $A$ and $E$.
One can similarly define an isometrically isomorphism between $A$ and $F$.

Note that if $E$ is a complemented infinite dimensional subspace of $\ell^{\infty}$
then $E$ is isomorphic to $\ell^{\infty}$.
See \cite{JoramLindenstrass1} for details.
\end{proof}
\section{Operator algebra}

\begin{ex}
If $X$ is connected and compact Hausdorff space.
then an (abelian) $C^*$-algebra $C(X)$ has no nontrivial projections.
\end{ex}
\begin{proof}
See the proof of Example \ref{counterexamples-analysis-moslehian1}.
\end{proof}
\chapter{DVD: Playing with interesting counter examples}

I will translate.
\part{Applied mathematics}

\chapter{Digital signal processing and algebraic geometry}

I will write this content from my movie in nicovideo.
\chapter{{\bfseries\sffamily TODO} Peano curve and its application to engineering}

I will write this content from my movie in nicovideo.
\part{Quantum mechanics and Quantum field theory}

\part{Statistical Mechanics and condensed matter physics}

\chapter{LASER: song by electrons}

I will write this content from my movie in nicovideo.
\chapter{Analysis for the Hubbard model}

I will write this content from my movie in nicovideo.
\part{Physical misc}

\chapter{Similarity for hydrodynamics and general relativity}

I will write this content from my movie in nicovideo.
\part{Reference}

\nocite{*}
\printindex
\bibliography{myref}
\end{document}
